<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>刷题记录4</title>
      <link href="2021/04/21/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%954/"/>
      <url>2021/04/21/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%954/</url>
      
        <content type="html"><![CDATA[<h1 id="FlareOn4-IgniteMe"><a href="#FlareOn4-IgniteMe" class="headerlink" title="[FlareOn4]IgniteMe"></a>[FlareOn4]IgniteMe</h1><a id="more"></a><p><a href="https://buuoj.cn/challenges#[FlareOn4]IgniteMe">题目链接</a><br>查看文件信息，32位，无壳。</p><p><img src="/2021/04/21/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%954/1.PNG"></p><blockquote><p>进入start函数</p></blockquote><p><img src="/2021/04/21/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%954/2.PNG"></p><blockquote><p>进入sub_4010F0</p></blockquote><p><img src="/2021/04/21/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%954/3.PNG"></p><p>去掉字符串中的‘\n’和‘\r’，不过最后好像没有用到。</p><blockquote><p>进入sub_401050</p></blockquote><p><img src="/2021/04/21/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%954/4.PNG"></p><p>其中v4可以通过看汇编代码得出，也可以通过动态调试得出。<br>sub_401020是读取长度，byte_403078是我们输入的flag。</p><blockquote><p>汇编代码</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">.text:00401000 sub_401000      proc near               ; CODE XREF: sub_401050+16↓p</span><br><span class="line">.text:00401000                 push    ebp</span><br><span class="line">.text:00401001                 mov     ebp, esp</span><br><span class="line">.text:00401003                 mov     eax, 80070057h</span><br><span class="line">.text:00401008                 mov     edx, eax</span><br><span class="line">.text:0040100A                 xor     ax, dx</span><br><span class="line">.text:0040100D                 rol     eax, 4</span><br><span class="line">.text:00401010                 shr     ax, 1</span><br><span class="line">.text:00401013                 pop     ebp</span><br><span class="line">.text:00401014                 retn</span><br><span class="line">.text:00401014 sub_401000      endp</span><br><span class="line">&#x2F;&#x2F;sub_401000的汇编代码</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">.text:00401050 sub_401050      proc near               ; CODE XREF: start+44↓p</span><br><span class="line">.text:00401050</span><br><span class="line">.text:00401050 var_C           &#x3D; dword ptr -0Ch</span><br><span class="line">.text:00401050 var_8           &#x3D; dword ptr -8</span><br><span class="line">.text:00401050 var_1           &#x3D; byte ptr -1</span><br><span class="line">.text:00401050</span><br><span class="line">.text:00401050                 push    ebp</span><br><span class="line">.text:00401051                 mov     ebp, esp</span><br><span class="line">.text:00401053                 sub     esp, 0Ch</span><br><span class="line">.text:00401056                 push    offset byte_403078</span><br><span class="line">.text:0040105B                 call    sub_401020</span><br><span class="line">.text:00401060                 add     esp, 4</span><br><span class="line">.text:00401063                 mov     [ebp+var_C], eax</span><br><span class="line">.text:00401066                 call    sub_401000</span><br><span class="line">.text:0040106B                 mov     [ebp+var_1], al</span><br><span class="line">.text:0040106E                 mov     eax, [ebp+var_C]</span><br><span class="line">.text:00401071                 sub     eax, 1</span><br><span class="line">.text:00401074                 mov     [ebp+var_8], eax</span><br><span class="line">.text:00401077                 jmp     short loc_401082</span><br><span class="line">.text:00401079 ; ---------------------------------------------------------------------------</span><br><span class="line">.text:00401079</span><br><span class="line">.text:00401079 loc_401079:                             ; CODE XREF: sub_401050+5D↓j</span><br><span class="line">.text:00401079                 mov     ecx, [ebp+var_8]</span><br><span class="line">.text:0040107C                 sub     ecx, 1</span><br><span class="line">.text:0040107F                 mov     [ebp+var_8], ecx</span><br><span class="line">.text:00401082</span><br><span class="line">.text:00401082 loc_401082:                             ; CODE XREF: sub_401050+27↑j</span><br><span class="line">.text:00401082                 cmp     [ebp+var_8], 0</span><br><span class="line">.text:00401086                 jl      short loc_4010AF</span><br><span class="line">.text:00401088                 mov     edx, [ebp+var_8]</span><br><span class="line">.text:0040108B                 movsx   eax, byte_403078[edx]</span><br><span class="line">.text:00401092                 movzx   ecx, [ebp+var_1]</span><br><span class="line">.text:00401096                 xor     eax, ecx</span><br><span class="line">.text:00401098                 mov     edx, [ebp+var_8]</span><br><span class="line">.text:0040109B                 mov     byte_403180[edx], al</span><br><span class="line">.text:004010A1                 mov     eax, [ebp+var_8]</span><br><span class="line">.text:004010A4                 mov     cl, byte_403078[eax]</span><br><span class="line">.text:004010AA                 mov     [ebp+var_1], cl</span><br><span class="line">.text:004010AD                 jmp     short loc_401079</span><br><span class="line">&#x2F;&#x2F;sub_401050的部分汇编代码（第一个for循环结束）</span><br></pre></td></tr></table></figure><blockquote><p>exp</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#define length(x) sizeof(x) &#x2F; sizeof(x[0])</span><br><span class="line"></span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">int flag[]&#x3D;&#123;13,  38,  73,  69,  42,  23, 120,  68,  43, 108, 93,  94,  69,  18,  47,  23,  43,  68, 111, 110, 86,   9,  95,  69,  71, 115,  38,  10,  13,  19, 23,  72,  66,   1,  64,  77,  12,   2, 105&#125;;</span><br><span class="line">int v4&#x3D;4;</span><br><span class="line">int i;</span><br><span class="line">for(i&#x3D;length(flag)-1;i&gt;&#x3D;0;i--)</span><br><span class="line">&#123;</span><br><span class="line">flag[i] ^&#x3D;v4;</span><br><span class="line">v4&#x3D;flag[i];</span><br><span class="line">&#125;</span><br><span class="line">for(i&#x3D;0;i&lt;length(flag);i++)</span><br><span class="line">&#123;</span><br><span class="line">printf(&quot;%c&quot;,flag[i]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><blockquote><p>flag{R_y0u_H0t_3n0ugH_t0_1gn1t3@flare-on.com}</p></blockquote><h1 id="o-strings-attached"><a href="#o-strings-attached" class="headerlink" title="o-strings-attached"></a>o-strings-attached</h1><p><a href="https://adworld.xctf.org.cn/task/answer?type=reverse&number=4&grade=0&id=5080&page=1">题目链接</a><br>查看文件信息，32位，无壳。</p><p><img src="/2021/04/21/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%954/5.PNG"></p><p>在加密函数最后添加断点，直接得到flag。</p><p><img src="/2021/04/21/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%954/6.PNG"></p><p><img src="/2021/04/21/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%954/7.PNG"></p><blockquote><p>9447{you_are_an_international_mystery}</p></blockquote><h1 id="csaw2013reversing2"><a href="#csaw2013reversing2" class="headerlink" title="csaw2013reversing2"></a>csaw2013reversing2</h1><p><a href="https://adworld.xctf.org.cn/task/answer?type=reverse&number=4&grade=0&id=5081&page=1">题目链接</a><br>查看文件信息，32位，无壳。</p><p><img src="/2021/04/21/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%954/8.PNG"></p><p>拖入ida中查看程序逻辑</p><blockquote><p>伪代码窗口</p></blockquote><p><img src="/2021/04/21/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%954/9.PNG"></p><p>进一步分析可知：</p><ol><li>sub_40102A的返回值为0</li><li>IsDebuggerPresent函数：<br> 如果当前进程运行在调试器的上下文，返回值为非零值。<br> 如果当前进程没有运行在调试器的上下文，返回值是零。</li></ol><p>lpMem是输出的flag，12-15行是输出的那个窗口，sub_401000是对lpMem进行加密的函数。<br>直接运行程序并不会对对lpMem进行加密，需要对程序进行修改.</p><blockquote><p>反汇编窗口</p></blockquote><p><img src="/2021/04/21/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%954/10.PNG"></p><ol><li>将 jnz     short loc_401096 改为 jmp     short loc_401096</li><li>将 int     3 nop</li><li>将 jmp     short loc_4010EF 改为 jmp     short loc_4010B9</li></ol><blockquote><p>patch后的程序</p></blockquote><p><img src="/2021/04/21/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%954/11.PNG"></p><p><img src="/2021/04/21/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%954/12.PNG"></p><blockquote><p>运行程序</p></blockquote><p><img src="/2021/04/21/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%954/13.PNG"></p><blockquote><p>flag{reversing_is_not_that_hard!}</p></blockquote>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>刷题记录3</title>
      <link href="2021/04/16/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%953/"/>
      <url>2021/04/16/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%953/</url>
      
        <content type="html"><![CDATA[<h1 id="羊城杯-2020-Bytecode"><a href="#羊城杯-2020-Bytecode" class="headerlink" title="[羊城杯 2020]Bytecode"></a>[羊城杯 2020]Bytecode</h1><a id="more"></a><p><a href="https://buuoj.cn/challenges#[%E7%BE%8A%E5%9F%8E%E6%9D%AF%202020]Bytecode">题目链接</a><br>这道题是python字节码，参考<a href="https://docs.python.org/zh-cn/3/library/dis.html?highlight=dis">官方文档</a>手动还原.</p><blockquote><p>字节码</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br></pre></td><td class="code"><pre><span class="line">  4           0 LOAD_CONST               0 (3)</span><br><span class="line">              3 LOAD_CONST               1 (37)</span><br><span class="line">              6 LOAD_CONST               2 (72)</span><br><span class="line">              9 LOAD_CONST               3 (9)</span><br><span class="line">             12 LOAD_CONST               4 (6)</span><br><span class="line">             15 LOAD_CONST               5 (132)</span><br><span class="line">             18 BUILD_LIST               6</span><br><span class="line">             21 STORE_NAME               0 (en)</span><br><span class="line">en&#x3D;[3,37,72,9,6,132]</span><br><span class="line"></span><br><span class="line">  5          24 LOAD_CONST               6 (101)</span><br><span class="line">             27 LOAD_CONST               7 (96)</span><br><span class="line">             30 LOAD_CONST               8 (23)</span><br><span class="line">             33 LOAD_CONST               9 (68)</span><br><span class="line">             36 LOAD_CONST              10 (112)</span><br><span class="line">             39 LOAD_CONST              11 (42)</span><br><span class="line">             42 LOAD_CONST              12 (107)</span><br><span class="line">             45 LOAD_CONST              13 (62)</span><br><span class="line">             48 LOAD_CONST               7 (96)</span><br><span class="line">             51 LOAD_CONST              14 (53)</span><br><span class="line">             54 LOAD_CONST              15 (176)</span><br><span class="line">             57 LOAD_CONST              16 (179)</span><br><span class="line">             60 LOAD_CONST              17 (98)</span><br><span class="line">             63 LOAD_CONST              14 (53)</span><br><span class="line">             66 LOAD_CONST              18 (67)</span><br><span class="line">             69 LOAD_CONST              19 (29)</span><br><span class="line">             72 LOAD_CONST              20 (41)</span><br><span class="line">             75 LOAD_CONST              21 (120)</span><br><span class="line">             78 LOAD_CONST              22 (60)</span><br><span class="line">             81 LOAD_CONST              23 (106)</span><br><span class="line">             84 LOAD_CONST              24 (51)</span><br><span class="line">             87 LOAD_CONST               6 (101)</span><br><span class="line">             90 LOAD_CONST              25 (178)</span><br><span class="line">             93 LOAD_CONST              26 (189)</span><br><span class="line">             96 LOAD_CONST               6 (101)</span><br><span class="line">             99 LOAD_CONST              27 (48)</span><br><span class="line">            102 BUILD_LIST              26</span><br><span class="line">            105 STORE_NAME               1 (output)</span><br><span class="line">output&#x3D;[101, 96, 23, 68, 112, 42, 107, 62, 96, 53, 176, 179, 98, 53, 67, 29, 41, 120, 60, 106, 51, 101, 178, 189, 101, 48]</span><br><span class="line"></span><br><span class="line">  7         108 LOAD_CONST              28 (&#39;welcome to GWHT2020&#39;)</span><br><span class="line">            111 PRINT_ITEM          </span><br><span class="line">            112 PRINT_NEWLINE       </span><br><span class="line"></span><br><span class="line">  9         113 LOAD_NAME                2 (raw_input)</span><br><span class="line">            116 LOAD_CONST              29 (&#39;please input your flag:&#39;)</span><br><span class="line">            119 CALL_FUNCTION            1</span><br><span class="line">            122 STORE_NAME               3 (flag)</span><br><span class="line">input(flag)</span><br><span class="line"></span><br><span class="line"> 10         125 LOAD_NAME                3 (flag)</span><br><span class="line">            128 STORE_NAME               4 (str)</span><br><span class="line">str&#x3D;flag</span><br><span class="line"></span><br><span class="line"> 12         131 LOAD_NAME                5 (len)</span><br><span class="line">            134 LOAD_NAME                4 (str)</span><br><span class="line">            137 CALL_FUNCTION            1</span><br><span class="line">            140 STORE_NAME               6 (a)</span><br><span class="line">a&#x3D;len(str)</span><br><span class="line"></span><br><span class="line"> 13         143 LOAD_NAME                6 (a)</span><br><span class="line">            146 LOAD_CONST              30 (38)</span><br><span class="line">            149 COMPARE_OP               0 (&lt;)</span><br><span class="line">            152 POP_JUMP_IF_FALSE      173</span><br><span class="line">if(a&lt;38)  </span><br><span class="line">    jump to 173</span><br><span class="line"></span><br><span class="line"> 14         155 LOAD_CONST              31 (&#39;lenth wrong!&#39;)</span><br><span class="line">            158 PRINT_ITEM          </span><br><span class="line">            159 PRINT_NEWLINE       </span><br><span class="line"></span><br><span class="line"> 15         160 LOAD_NAME                7 (exit)</span><br><span class="line">            163 LOAD_CONST              32 (0)</span><br><span class="line">            166 CALL_FUNCTION            1</span><br><span class="line">            169 POP_TOP             </span><br><span class="line">            170 JUMP_FORWARD             0 (to 173)</span><br><span class="line"></span><br><span class="line"> 17     &gt;&gt;  173 LOAD_NAME                8 (ord)</span><br><span class="line">            176 LOAD_NAME                4 (str)</span><br><span class="line">            179 LOAD_CONST              32 (0)</span><br><span class="line">            182 BINARY_SUBSCR       </span><br><span class="line">            183 CALL_FUNCTION            1</span><br><span class="line">            186 LOAD_CONST              33 (2020)</span><br><span class="line">            189 BINARY_MULTIPLY                         str[0]*2020</span><br><span class="line">            190 LOAD_NAME                8 (ord)</span><br><span class="line">            193 LOAD_NAME                4 (str)</span><br><span class="line">            196 LOAD_CONST              34 (1)</span><br><span class="line">            199 BINARY_SUBSCR       </span><br><span class="line">            200 CALL_FUNCTION            1</span><br><span class="line">            203 BINARY_ADD          </span><br><span class="line">            204 LOAD_CONST              33 (2020)</span><br><span class="line">            207 BINARY_MULTIPLY                         (str[0]*2020+str[1])*2020     </span><br><span class="line">            208 LOAD_NAME                8 (ord)</span><br><span class="line">            211 LOAD_NAME                4 (str)</span><br><span class="line">            214 LOAD_CONST              35 (2)</span><br><span class="line">            217 BINARY_SUBSCR       </span><br><span class="line">            218 CALL_FUNCTION            1</span><br><span class="line">            221 BINARY_ADD          </span><br><span class="line">            222 LOAD_CONST              33 (2020)</span><br><span class="line">            225 BINARY_MULTIPLY     </span><br><span class="line">            226 LOAD_NAME                8 (ord)</span><br><span class="line">            229 LOAD_NAME                4 (str)</span><br><span class="line">            232 LOAD_CONST               0 (3)</span><br><span class="line">            235 BINARY_SUBSCR       </span><br><span class="line">            236 CALL_FUNCTION            1</span><br><span class="line">            239 BINARY_ADD          </span><br><span class="line">            240 LOAD_CONST              33 (2020)</span><br><span class="line">            243 BINARY_MULTIPLY     </span><br><span class="line">            244 LOAD_NAME                8 (ord)</span><br><span class="line">            247 LOAD_NAME                4 (str)</span><br><span class="line">            250 LOAD_CONST              36 (4)</span><br><span class="line">            253 BINARY_SUBSCR       </span><br><span class="line">            254 CALL_FUNCTION            1</span><br><span class="line">            257 BINARY_ADD          </span><br><span class="line">            258 LOAD_CONST              37 (1182843538814603)</span><br><span class="line">            261 COMPARE_OP               2 (&#x3D;&#x3D;)</span><br><span class="line">            264 POP_JUMP_IF_FALSE      275</span><br><span class="line">if(((((str[0]*2020+str[1])*2020+str[2])*2020+str[3])*2020+str[4])!&#x3D;1182843538814603)</span><br><span class="line">    jump to 275</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> 18         267 LOAD_CONST              38 (&#39;good!continue\xe2\x80\xa6\xe2\x80\xa6&#39;)</span><br><span class="line">            270 PRINT_ITEM          </span><br><span class="line">            271 PRINT_NEWLINE       </span><br><span class="line">            272 JUMP_FORWARD            15 (to 290)</span><br><span class="line"></span><br><span class="line"> 20     &gt;&gt;  275 LOAD_CONST              39 (&#39;bye~&#39;)</span><br><span class="line">            278 PRINT_ITEM          </span><br><span class="line">            279 PRINT_NEWLINE       </span><br><span class="line"></span><br><span class="line"> 21         280 LOAD_NAME                7 (exit)</span><br><span class="line">            283 LOAD_CONST              32 (0)</span><br><span class="line">            286 CALL_FUNCTION            1</span><br><span class="line">            289 POP_TOP             </span><br><span class="line"></span><br><span class="line"> 23     &gt;&gt;  290 BUILD_LIST               0</span><br><span class="line">            293 STORE_NAME               9 (x)</span><br><span class="line"></span><br><span class="line"> 24         296 LOAD_CONST              40 (5)</span><br><span class="line">            299 STORE_NAME              10 (k)          k&#x3D;5</span><br><span class="line"></span><br><span class="line"> 25         302 SETUP_LOOP             128 (to 433)</span><br><span class="line">            305 LOAD_NAME               11 (range)</span><br><span class="line">            308 LOAD_CONST              41 (13)         range(13)</span><br><span class="line">            311 CALL_FUNCTION            1</span><br><span class="line">            314 GET_ITER            </span><br><span class="line">        &gt;&gt;  315 FOR_ITER               114 (to 432)</span><br><span class="line">            318 STORE_NAME              12 (i)</span><br><span class="line"></span><br><span class="line"> 26         321 LOAD_NAME                8 (ord)</span><br><span class="line">            324 LOAD_NAME                4 (str)</span><br><span class="line">            327 LOAD_NAME               10 (k)</span><br><span class="line">            330 BINARY_SUBSCR       </span><br><span class="line">            331 CALL_FUNCTION            1</span><br><span class="line">            334 STORE_NAME              13 (b)          b&#x3D;ord(str[k])</span><br><span class="line"></span><br><span class="line"> 27         337 LOAD_NAME                8 (ord)</span><br><span class="line">            340 LOAD_NAME                4 (str)</span><br><span class="line">            343 LOAD_NAME               10 (k)</span><br><span class="line">            346 LOAD_CONST              34 (1)</span><br><span class="line">            349 BINARY_ADD          </span><br><span class="line">            350 BINARY_SUBSCR       </span><br><span class="line">            351 CALL_FUNCTION            1</span><br><span class="line">            354 STORE_NAME              14 (c)          c&#x3D;ord(str[k+1])</span><br><span class="line"></span><br><span class="line"> 28         357 LOAD_NAME               14 (c)</span><br><span class="line">            360 LOAD_NAME                0 (en)</span><br><span class="line">            363 LOAD_NAME               12 (i)</span><br><span class="line">            366 LOAD_CONST               4 (6)</span><br><span class="line">            369 BINARY_MODULO                    </span><br><span class="line">            370 BINARY_SUBSCR       </span><br><span class="line">            371 BINARY_XOR                              </span><br><span class="line">            372 STORE_NAME              15 (a11)        a11&#x3D;c^en[i%6]</span><br><span class="line"></span><br><span class="line"> 29         375 LOAD_NAME               13 (b)</span><br><span class="line">            378 LOAD_NAME                0 (en)</span><br><span class="line">            381 LOAD_NAME               12 (i)</span><br><span class="line">            384 LOAD_CONST               4 (6)</span><br><span class="line">            387 BINARY_MODULO       </span><br><span class="line">            388 BINARY_SUBSCR       </span><br><span class="line">            389 BINARY_XOR          </span><br><span class="line">            390 STORE_NAME              16 (a22)        a22&#x3D;c^en[i%6]</span><br><span class="line"></span><br><span class="line"> 30         393 LOAD_NAME                9 (x)</span><br><span class="line">            396 LOAD_ATTR               17 (append)</span><br><span class="line">            399 LOAD_NAME               15 (a11)        x.append(a11)</span><br><span class="line">            402 CALL_FUNCTION            1</span><br><span class="line">            405 POP_TOP             </span><br><span class="line"></span><br><span class="line"> 31         406 LOAD_NAME                9 (x)</span><br><span class="line">            409 LOAD_ATTR               17 (append)</span><br><span class="line">            412 LOAD_NAME               16 (a22)        x.append(a22)</span><br><span class="line">            415 CALL_FUNCTION            1</span><br><span class="line">            418 POP_TOP             </span><br><span class="line"></span><br><span class="line"> 32         419 LOAD_NAME               10 (k)</span><br><span class="line">            422 LOAD_CONST              35 (2)</span><br><span class="line">            425 INPLACE_ADD                           </span><br><span class="line">            426 STORE_NAME              10 (k)          k+&#x3D;2</span><br><span class="line">            429 JUMP_ABSOLUTE          315</span><br><span class="line">        &gt;&gt;  432 POP_BLOCK           </span><br><span class="line"></span><br><span class="line"> 33     &gt;&gt;  433 LOAD_NAME                9 (x)</span><br><span class="line">            436 LOAD_NAME                1 (output)</span><br><span class="line">            439 COMPARE_OP               2 (&#x3D;&#x3D;)</span><br><span class="line">            442 POP_JUMP_IF_FALSE      453</span><br><span class="line">if(x!&#x3D;output)</span><br><span class="line">    jump to 453</span><br><span class="line"></span><br><span class="line"> 34         445 LOAD_CONST              38 (&#39;good!continue\xe2\x80\xa6\xe2\x80\xa6&#39;)</span><br><span class="line">            448 PRINT_ITEM          </span><br><span class="line">            449 PRINT_NEWLINE       </span><br><span class="line">            450 JUMP_FORWARD            15 (to 468)</span><br><span class="line"></span><br><span class="line"> 36     &gt;&gt;  453 LOAD_CONST              42 (&#39;oh,you are wrong!&#39;)</span><br><span class="line">            456 PRINT_ITEM          </span><br><span class="line">            457 PRINT_NEWLINE       </span><br><span class="line"></span><br><span class="line"> 37         458 LOAD_NAME                7 (exit)</span><br><span class="line">            461 LOAD_CONST              32 (0)</span><br><span class="line">            464 CALL_FUNCTION            1</span><br><span class="line">            467 POP_TOP             </span><br><span class="line"></span><br><span class="line"> 39     &gt;&gt;  468 LOAD_NAME                5 (len)</span><br><span class="line">            471 LOAD_NAME                4 (str)</span><br><span class="line">            474 CALL_FUNCTION            1</span><br><span class="line">            477 STORE_NAME              18 (l)          l&#x3D;len(str)</span><br><span class="line"></span><br><span class="line"> 40         480 LOAD_NAME                8 (ord)</span><br><span class="line">            483 LOAD_NAME                4 (str)</span><br><span class="line">            486 LOAD_NAME               18 (l)</span><br><span class="line">            489 LOAD_CONST              43 (7)</span><br><span class="line">            492 BINARY_SUBTRACT     </span><br><span class="line">            493 BINARY_SUBSCR                           </span><br><span class="line">            494 CALL_FUNCTION            1</span><br><span class="line">            497 STORE_NAME              19 (a1)         a1&#x3D;ord(str[l-7])</span><br><span class="line"></span><br><span class="line"> 41         500 LOAD_NAME                8 (ord)</span><br><span class="line">            503 LOAD_NAME                4 (str)</span><br><span class="line">            506 LOAD_NAME               18 (l)</span><br><span class="line">            509 LOAD_CONST               4 (6)</span><br><span class="line">            512 BINARY_SUBTRACT     </span><br><span class="line">            513 BINARY_SUBSCR       </span><br><span class="line">            514 CALL_FUNCTION            1</span><br><span class="line">            517 STORE_NAME              20 (a2)         a2&#x3D;ord(str[l-6])</span><br><span class="line"></span><br><span class="line"> 42         520 LOAD_NAME                8 (ord)</span><br><span class="line">            523 LOAD_NAME                4 (str)</span><br><span class="line">            526 LOAD_NAME               18 (l)</span><br><span class="line">            529 LOAD_CONST              40 (5)</span><br><span class="line">            532 BINARY_SUBTRACT     </span><br><span class="line">            533 BINARY_SUBSCR       </span><br><span class="line">            534 CALL_FUNCTION            1</span><br><span class="line">            537 STORE_NAME              21 (a3)</span><br><span class="line"></span><br><span class="line"> 43         540 LOAD_NAME                8 (ord)</span><br><span class="line">            543 LOAD_NAME                4 (str)</span><br><span class="line">            546 LOAD_NAME               18 (l)</span><br><span class="line">            549 LOAD_CONST              36 (4)</span><br><span class="line">            552 BINARY_SUBTRACT     </span><br><span class="line">            553 BINARY_SUBSCR       </span><br><span class="line">            554 CALL_FUNCTION            1</span><br><span class="line">            557 STORE_NAME              22 (a4)</span><br><span class="line"></span><br><span class="line"> 44         560 LOAD_NAME                8 (ord)</span><br><span class="line">            563 LOAD_NAME                4 (str)</span><br><span class="line">            566 LOAD_NAME               18 (l)</span><br><span class="line">            569 LOAD_CONST               0 (3)</span><br><span class="line">            572 BINARY_SUBTRACT     </span><br><span class="line">            573 BINARY_SUBSCR       </span><br><span class="line">            574 CALL_FUNCTION            1</span><br><span class="line">            577 STORE_NAME              23 (a5)</span><br><span class="line"></span><br><span class="line"> 45         580 LOAD_NAME                8 (ord)</span><br><span class="line">            583 LOAD_NAME                4 (str)</span><br><span class="line">            586 LOAD_NAME               18 (l)</span><br><span class="line">            589 LOAD_CONST              35 (2)</span><br><span class="line">            592 BINARY_SUBTRACT     </span><br><span class="line">            593 BINARY_SUBSCR       </span><br><span class="line">            594 CALL_FUNCTION            1</span><br><span class="line">            597 STORE_NAME              24 (a6)</span><br><span class="line"></span><br><span class="line"> 46         600 LOAD_NAME               19 (a1)</span><br><span class="line">            603 LOAD_CONST               0 (3)</span><br><span class="line">            606 BINARY_MULTIPLY     </span><br><span class="line">            607 LOAD_NAME               20 (a2)</span><br><span class="line">            610 LOAD_CONST              35 (2)</span><br><span class="line">            613 BINARY_MULTIPLY         </span><br><span class="line">            614 BINARY_ADD          </span><br><span class="line">            615 LOAD_NAME               21 (a3)</span><br><span class="line">            618 LOAD_CONST              40 (5)</span><br><span class="line">            621 BINARY_MULTIPLY     </span><br><span class="line">            622 BINARY_ADD          </span><br><span class="line">            623 LOAD_CONST              44 (1003)</span><br><span class="line">            626 COMPARE_OP               2 (&#x3D;&#x3D;)</span><br><span class="line">            629 POP_JUMP_IF_FALSE      807</span><br><span class="line">if((a[1]*3+a[2]*2+a[3]*5)!&#x3D;1003)</span><br><span class="line">    jump to 807</span><br><span class="line"></span><br><span class="line"> 47         632 LOAD_NAME               19 (a1)</span><br><span class="line">            635 LOAD_CONST              36 (4)</span><br><span class="line">            638 BINARY_MULTIPLY     </span><br><span class="line">            639 LOAD_NAME               20 (a2)</span><br><span class="line">            642 LOAD_CONST              43 (7)</span><br><span class="line">            645 BINARY_MULTIPLY     </span><br><span class="line">            646 BINARY_ADD          </span><br><span class="line">            647 LOAD_NAME               21 (a3)</span><br><span class="line">            650 LOAD_CONST               3 (9)</span><br><span class="line">            653 BINARY_MULTIPLY     </span><br><span class="line">            654 BINARY_ADD          </span><br><span class="line">            655 LOAD_CONST              45 (2013)</span><br><span class="line">            658 COMPARE_OP               2 (&#x3D;&#x3D;)</span><br><span class="line">            661 POP_JUMP_IF_FALSE      807</span><br><span class="line"></span><br><span class="line"> 48         664 LOAD_NAME               19 (a1)</span><br><span class="line">            667 LOAD_NAME               20 (a2)</span><br><span class="line">            670 LOAD_CONST              46 (8)</span><br><span class="line">            673 BINARY_MULTIPLY     </span><br><span class="line">            674 BINARY_ADD          </span><br><span class="line">            675 LOAD_NAME               21 (a3)</span><br><span class="line">            678 LOAD_CONST              35 (2)</span><br><span class="line">            681 BINARY_MULTIPLY     </span><br><span class="line">            682 BINARY_ADD          </span><br><span class="line">            683 LOAD_CONST              47 (1109)</span><br><span class="line">            686 COMPARE_OP               2 (&#x3D;&#x3D;)</span><br><span class="line">            689 POP_JUMP_IF_FALSE      804</span><br><span class="line"></span><br><span class="line"> 49         692 LOAD_NAME               22 (a4)</span><br><span class="line">            695 LOAD_CONST               0 (3)</span><br><span class="line">            698 BINARY_MULTIPLY     </span><br><span class="line">            699 LOAD_NAME               23 (a5)</span><br><span class="line">            702 LOAD_CONST              35 (2)</span><br><span class="line">            705 BINARY_MULTIPLY     </span><br><span class="line">            706 BINARY_ADD          </span><br><span class="line">            707 LOAD_NAME               24 (a6)</span><br><span class="line">            710 LOAD_CONST              40 (5)</span><br><span class="line">            713 BINARY_MULTIPLY     </span><br><span class="line">            714 BINARY_ADD          </span><br><span class="line">            715 LOAD_CONST              48 (671)</span><br><span class="line">            718 COMPARE_OP               2 (&#x3D;&#x3D;)</span><br><span class="line">            721 POP_JUMP_IF_FALSE      801</span><br><span class="line"></span><br><span class="line"> 50         724 LOAD_NAME               22 (a4)</span><br><span class="line">            727 LOAD_CONST              36 (4)</span><br><span class="line">            730 BINARY_MULTIPLY     </span><br><span class="line">            731 LOAD_NAME               23 (a5)</span><br><span class="line">            734 LOAD_CONST              43 (7)</span><br><span class="line">            737 BINARY_MULTIPLY     </span><br><span class="line">            738 BINARY_ADD          </span><br><span class="line">            739 LOAD_NAME               24 (a6)</span><br><span class="line">            742 LOAD_CONST               3 (9)</span><br><span class="line">            745 BINARY_MULTIPLY     </span><br><span class="line">            746 BINARY_ADD          </span><br><span class="line">            747 LOAD_CONST              49 (1252)</span><br><span class="line">            750 COMPARE_OP               2 (&#x3D;&#x3D;)</span><br><span class="line">            753 POP_JUMP_IF_FALSE      798</span><br><span class="line"></span><br><span class="line"> 51         756 LOAD_NAME               22 (a4)</span><br><span class="line">            759 LOAD_NAME               23 (a5)</span><br><span class="line">            762 LOAD_CONST              46 (8)</span><br><span class="line">            765 BINARY_MULTIPLY     </span><br><span class="line">            766 BINARY_ADD          </span><br><span class="line">            767 LOAD_NAME               24 (a6)</span><br><span class="line">            770 LOAD_CONST              35 (2)</span><br><span class="line">            773 BINARY_MULTIPLY     </span><br><span class="line">            774 BINARY_ADD          </span><br><span class="line">            775 LOAD_CONST              50 (644)</span><br><span class="line">            778 COMPARE_OP               2 (&#x3D;&#x3D;)</span><br><span class="line">            781 POP_JUMP_IF_FALSE      795</span><br><span class="line"></span><br><span class="line"> 52         784 LOAD_CONST              51 (&#39;congraduation!you get the right flag!&#39;)</span><br><span class="line">            787 PRINT_ITEM          </span><br><span class="line">            788 PRINT_NEWLINE       </span><br><span class="line">            789 JUMP_ABSOLUTE          795</span><br><span class="line">            792 JUMP_ABSOLUTE          798</span><br><span class="line">        &gt;&gt;  795 JUMP_ABSOLUTE          801</span><br><span class="line">        &gt;&gt;  798 JUMP_ABSOLUTE          804</span><br><span class="line">        &gt;&gt;  801 JUMP_ABSOLUTE          807</span><br><span class="line">        &gt;&gt;  804 JUMP_FORWARD             0 (to 807)</span><br><span class="line">        &gt;&gt;  807 LOAD_CONST              52 (None)</span><br><span class="line">            810 RETURN_VALUE </span><br></pre></td></tr></table></figure><blockquote><p>python源码</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">en&#x3D;[3,37,72,9,6,132]</span><br><span class="line">output&#x3D;[101, 96, 23, 68, 112, 42, 107, 62, 96, 53, 176, 179, 98, 53, 67, 29, 41, 120, 60, 106, 51, 101, 178, 189, 101, 48]</span><br><span class="line">print(&#39;welcome to GWHT2020&#39;)</span><br><span class="line">flag&#x3D;raw_input(&#39;please input your flag:&#39;)</span><br><span class="line">str&#x3D;flag</span><br><span class="line">a&#x3D;len(str)</span><br><span class="line">if a&gt;&#x3D;38:</span><br><span class="line">peint(&#39;lenth wrong!&#39;)</span><br><span class="line">exit(0)</span><br><span class="line">if((((ord(str[1])+2020*ord(str[0]))*2020+ord(str[2]))*2020+ord(str[3]))*2020+ord(str[4])!&#x3D;1182843538814603):</span><br><span class="line">print(&#39;bye~&#39;)</span><br><span class="line">exit(0)</span><br><span class="line">print(&#39;good!continue\xe2\x80\xa6\xe2\x80\xa6&#39;)</span><br><span class="line">k&#x3D;5</span><br><span class="line">for i in range(13):</span><br><span class="line">b&#x3D;ord(str[k])</span><br><span class="line">c&#x3D;ord(str[k+1])</span><br><span class="line">a11&#x3D;c^en[i%6]</span><br><span class="line">a22&#x3D;c^en[i%6]</span><br><span class="line">x.append(a11)</span><br><span class="line">x.append(a22)</span><br><span class="line">k+&#x3D;2</span><br><span class="line">if x!&#x3D;output:</span><br><span class="line">print(&#39;oh,you are wrong!&#39;)</span><br><span class="line">exit(0)</span><br><span class="line">l&#x3D;len(str)</span><br><span class="line">a1&#x3D;ord(str[l-7])</span><br><span class="line">a2&#x3D;ord(str[l-6])</span><br><span class="line">a3&#x3D;ord(str[l-5])</span><br><span class="line">a4&#x3D;ord(str[l-4])</span><br><span class="line">a5&#x3D;ord(str[l-3])</span><br><span class="line">a6&#x3D;ord(str[l-2])</span><br><span class="line">if((a1*3+a2*2+a3*5&#x3D;&#x3D;1003)&amp;(a1*4+a2*7+a3*9&#x3D;&#x3D;2013)&amp;(a1+a2*8+a3*2&#x3D;&#x3D;1109)&amp;(a4*3+a5*2+a6*5&#x3D;&#x3D;671)&amp;(a4*4+a5*7+a6*9&#x3D;&#x3D;1252)&amp;(a4+a5*8+a6*2&#x3D;&#x3D;644)):</span><br><span class="line">print(&#39;congraduation!you get the right flag!&#39;)</span><br></pre></td></tr></table></figure><blockquote><p>exp</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">from z3 import *</span><br><span class="line">en&#x3D;[3,37,72,9,6,132]</span><br><span class="line">output&#x3D;[101,96,23,68,112,42,107,62,96,53,176,179,98,53,67,29,41,120,60,106,51,101,178,189,101,48]</span><br><span class="line">x &#x3D; Solver()</span><br><span class="line">a1,a2,a3,a4,a5&#x3D;Ints(&quot;a1 a2 a3 a4 a5&quot;)</span><br><span class="line">x.add((((a1*2020+a2)*2020+a3)*2020+a4)*2020+a5&#x3D;&#x3D;1182843538814603)</span><br><span class="line">x.add(a1&gt;31,a2&gt;31,a3&gt;31,a4&gt;31,a5&gt;31)</span><br><span class="line">x.add(a1&lt;127,a2&lt;127,a3&lt;127,a4&lt;127,a5&lt;127)</span><br><span class="line">if x.check()&#x3D;&#x3D;sat:</span><br><span class="line">    print(x.model())</span><br><span class="line">a&#x3D;[71,87,72,84,123]</span><br><span class="line">flag&#x3D;&quot;&quot;</span><br><span class="line">for i in a:</span><br><span class="line">    flag+&#x3D;chr(i)</span><br><span class="line">print(flag)</span><br><span class="line">b&#x3D;[]</span><br><span class="line">k&#x3D;0</span><br><span class="line">for i in range(13):</span><br><span class="line">    b.append(output[k+1]^en[i%6])</span><br><span class="line">    b.append(output[k]^en[i%6])</span><br><span class="line">    k+&#x3D;2</span><br><span class="line">for i in b:</span><br><span class="line">    flag+&#x3D;chr(i)</span><br><span class="line">print(flag)</span><br><span class="line">xx &#x3D; Solver()</span><br><span class="line">a1,a2,a3,a4,a5,a6&#x3D;Ints(&quot;a1 a2 a3 a4 a5 a6&quot;)</span><br><span class="line">xx.add(a1*3+a2*2+a3*5&#x3D;&#x3D;1003)</span><br><span class="line">xx.add(a1*4+a2*7+a3*9&#x3D;&#x3D;2013)</span><br><span class="line">xx.add(a1+a2*8+a3*2&#x3D;&#x3D;1109)</span><br><span class="line">xx.add(a4*3+a5*2+a6*5&#x3D;&#x3D;671)</span><br><span class="line">xx.add(a4*4+a5*7+a6*9&#x3D;&#x3D;1252)</span><br><span class="line">xx.add(a4+a5*8+a6*2&#x3D;&#x3D;644)</span><br><span class="line">if xx.check()&#x3D;&#x3D;sat:</span><br><span class="line">    print(xx.model())</span><br><span class="line">c&#x3D;[97,101,102,102,55,51]</span><br><span class="line">for i in c:</span><br><span class="line">    flag+&#x3D;chr(i)</span><br><span class="line">flag+&#x3D;&#39;&#125;&#39;</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><blockquote><p>flag{cfa2b87b3f746a8f0ac5c5963faeff73}</p></blockquote><h1 id="BJDCTF-2nd-8086"><a href="#BJDCTF-2nd-8086" class="headerlink" title="[BJDCTF 2nd]8086"></a>[BJDCTF 2nd]8086</h1><p><a href="https://buuoj.cn/challenges#[BJDCTF%202nd]8086">题目链接</a><br>拖入64位ida中</p><p><img src="/2021/04/16/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%953/1.PNG"></p><p>只有一串字符、一个死循环和一堆数据。<br>将里面的数据强制转换为代码</p><p><img src="/2021/04/16/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%953/2.PNG"></p><p>是一个异或</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line"></span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    char flag[]&#x3D;&quot;]U[du~|t@&#123;z@wj.&#125;.~q@gjz&#123;z@wzqW~&#x2F;b;&quot;; </span><br><span class="line">    int i;</span><br><span class="line">    for(i&#x3D;0;i&lt;0x22;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        flag[i]^&#x3D;0x1f; </span><br><span class="line">    &#125;</span><br><span class="line">    printf(&quot;%s&quot;,flag);</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>flag{jack_de_hu1b1an_xuede_henHa0}</p></blockquote>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ida无法f5解决方案</title>
      <link href="2021/04/11/ida%E6%97%A0%E6%B3%95f5%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/"/>
      <url>2021/04/11/ida%E6%97%A0%E6%B3%95f5%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/</url>
      
        <content type="html"><![CDATA[<h1 id="call-analysis-failed"><a href="#call-analysis-failed" class="headerlink" title="call analysis failed"></a>call analysis failed</h1><a id="more"></a><p><img src="/2021/04/11/ida%E6%97%A0%E6%B3%95f5%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/1.PNG"></p><p>按下space键，找到错误地址：401095<br>进入call后面的函数</p><p><img src="/2021/04/11/ida%E6%97%A0%E6%B3%95f5%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/2.PNG"></p><p>选中整个函数，按‘d’转为数据，然后按下‘c’转换为代码</p><p><img src="/2021/04/11/ida%E6%97%A0%E6%B3%95f5%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/3.PNG"></p><p><img src="/2021/04/11/ida%E6%97%A0%E6%B3%95f5%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/4.PNG"></p><p>返回原来函数中，就可以f5了</p><p><img src="/2021/04/11/ida%E6%97%A0%E6%B3%95f5%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/5.PNG"></p><h1 id="无法选中函数"><a href="#无法选中函数" class="headerlink" title="无法选中函数"></a>无法选中函数</h1><p>找到了main函数，f5却显示没有选中函数</p><p><img src="/2021/04/11/ida%E6%97%A0%E6%B3%95f5%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/6.PNG"></p><p><img src="/2021/04/11/ida%E6%97%A0%E6%B3%95f5%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/7.PNG"></p><p>这里是main函数没有被识别<br>选中前面地址为红色的代码，按下‘p’，main函数就有了。</p><h1 id="positive-sp-value-has-been-found"><a href="#positive-sp-value-has-been-found" class="headerlink" title="positive sp value has been found"></a>positive sp value has been found</h1><p>堆栈不平衡导致</p><p><img src="/2021/04/11/ida%E6%97%A0%E6%B3%95f5%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/8.PNG"></p><p>打开选项中的常规（Options中的第一个），勾选上堆栈指针选项</p><p><img src="/2021/04/11/ida%E6%97%A0%E6%B3%95f5%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/9.PNG"></p><p>确定后界面是这样的</p><p><img src="/2021/04/11/ida%E6%97%A0%E6%B3%95f5%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/10.PNG"></p><p>选中图中指令部分(图中高亮代码)，按下 alt+k 更改堆栈指针，知道前面的堆栈指针均为正式且retn前堆栈指针值为0时就成功了。</p><p><img src="/2021/04/11/ida%E6%97%A0%E6%B3%95f5%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/11.PNG"></p><p><img src="/2021/04/11/ida%E6%97%A0%E6%B3%95f5%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/12.PNG"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>将python打包的.exe文件还原成.py文件</title>
      <link href="2021/04/11/%E5%B0%86python%E6%89%93%E5%8C%85%E7%9A%84-exe%E6%96%87%E4%BB%B6%E8%BF%98%E5%8E%9F%E6%88%90-py%E6%96%87%E4%BB%B6/"/>
      <url>2021/04/11/%E5%B0%86python%E6%89%93%E5%8C%85%E7%9A%84-exe%E6%96%87%E4%BB%B6%E8%BF%98%E5%8E%9F%E6%88%90-py%E6%96%87%E4%BB%B6/</url>
      
        <content type="html"><![CDATA[<h1 id="下载-pyinstxtractor-py"><a href="#下载-pyinstxtractor-py" class="headerlink" title="下载 pyinstxtractor.py"></a>下载 pyinstxtractor.py</h1><a id="more"></a><p>地址：<a href="https://buuoj.cn/challenges#[HDCTF2019]Maze">https://sourceforge.net/projects/pyinstallerextractor/</a></p><h1 id="把pyinstxtractor-py和exe文件放在同个目录下"><a href="#把pyinstxtractor-py和exe文件放在同个目录下" class="headerlink" title="把pyinstxtractor.py和exe文件放在同个目录下"></a>把pyinstxtractor.py和exe文件放在同个目录下</h1><p>打开cmd，进入该目录，输入：</p><blockquote><p>python pyinstxtractor.py xx.exe</p></blockquote><p>运行后生成xx.exe_extracted文件夹。</p><p><img src="/2021/04/11/%E5%B0%86python%E6%89%93%E5%8C%85%E7%9A%84-exe%E6%96%87%E4%BB%B6%E8%BF%98%E5%8E%9F%E6%88%90-py%E6%96%87%E4%BB%B6/1.PNG"></p><p>找到 Possible entry point 后的文件，在其前面加上pyc文件头</p><blockquote><p>420d 0d0a 0000 0000 0da9 1b60 a809 0000</p></blockquote><p>添加文件头可以使用010 Editor或Sublime Text 3等等。<br>原博客地址: <a href="https://blog.csdn.net/tymatlab/article/details/80511709">https://blog.csdn.net/tymatlab/article/details/80511709</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>刷题记录2</title>
      <link href="2021/04/10/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%952/"/>
      <url>2021/04/10/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%952/</url>
      
        <content type="html"><![CDATA[<h1 id="HDCTF2019-Maze"><a href="#HDCTF2019-Maze" class="headerlink" title="[HDCTF2019]Maze"></a>[HDCTF2019]Maze</h1><a id="more"></a><p><a href="https://buuoj.cn/challenges#[HDCTF2019]Maze">题目链接</a><br>查看文件信息，有upx壳，脱去。</p><p><img src="/2021/04/10/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%952/1.PNG"></p><p>由字符串找到关键函数</p><p><img src="/2021/04/10/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%952/2.PNG"></p><p><img src="/2021/04/10/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%952/3.PNG"></p><p>有一个花指令和没有声明的main函数，去掉花指令，在建立main函数即可。</p><p><img src="/2021/04/10/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%952/4.PNG"></p><p>转为数据，再将 0E8h nop掉，在转换回代码，然后识别main函数。</p><p><img src="/2021/04/10/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%952/5.PNG"></p><p><img src="/2021/04/10/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%952/6.PNG"></p><p>这之后就简单了，根据题目名和一个很明显的迷宫字符串，可知这是迷宫题。</p><p><img src="/2021/04/10/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%952/7.PNG"></p><p>重+走到F就行了</p><blockquote><p>flag{ssaaasaassdddw}</p></blockquote><h1 id="MRCTF2020-Xor"><a href="#MRCTF2020-Xor" class="headerlink" title="[MRCTF2020]Xor"></a>[MRCTF2020]Xor</h1><p><a href="https://buuoj.cn/challenges#[MRCTF2020]Xor">题目链接</a><br>查看文件信息, 32位文件</p><p><img src="/2021/04/10/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%952/8.PNG"></p><p>找到关键函数，f5反编译</p><p><img src="/2021/04/10/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%952/9.PNG"></p><p>转为文本模式，找到那个地址，点进去，转为数据，再转为代码，就可以f5了。</p><p><img src="/2021/04/10/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%952/10.PNG"></p><p><img src="/2021/04/10/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%952/11.PNG"></p><p>一个简单的异或<br>exp：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">char flag[27]&#x3D;&quot;MSAWB~FXZ:J:&#96;tQJ\&quot;N@ bpdd&#125;8g&quot;;</span><br><span class="line">int i;</span><br><span class="line">for(i&#x3D;0;i&lt;27;i++)</span><br><span class="line">&#123;</span><br><span class="line">flag[i]^&#x3D;i;</span><br><span class="line">printf(&quot;%c&quot;,flag[i]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;flag&#123;@_R3@1ly_E2_R3verse!&#125;</span><br></pre></td></tr></table></figure><h1 id="羊城杯-2020-easyre"><a href="#羊城杯-2020-easyre" class="headerlink" title="[羊城杯 2020]easyre"></a>[羊城杯 2020]easyre</h1><p><a href="https://buuoj.cn/challenges#[%E7%BE%8A%E5%9F%8E%E6%9D%AF%202020]easyre">题目链接</a><br>查看文件信息, 64位文件</p><p><img src="/2021/04/10/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%952/12.PNG"></p><p>进入main函数里，有三个加密</p><p><img src="/2021/04/10/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%952/13.PNG"></p><p>第一个加密</p><p><img src="/2021/04/10/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%952/14.PNG"></p><p>一个正常的base64加密</p><p>第二个加密</p><p><img src="/2021/04/10/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%952/15.PNG"></p><p>第三个加密</p><p><img src="/2021/04/10/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%952/16.PNG"></p><p><img src="/2021/04/10/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%952/17.PNG"></p><p>下面那个为加密二，上面的是加密三，加密三其实就是个变形的凯撒。</p><p>exp</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">#include&lt;stdlib.h&gt;</span><br><span class="line">#include&lt;math.h&gt;</span><br><span class="line"></span><br><span class="line">char str[52]&#x3D;&quot;EmBmP5Pmn7QcPU4gLYKv5QcMmB3PWHcP5YkPq3&#x3D;cT6QckkPckoRG&quot;;</span><br><span class="line">char table[65]&#x3D;&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+&#x2F;&quot;;</span><br><span class="line">char padding_char&#x3D;&#39;&#x3D;&#39;;</span><br><span class="line"></span><br><span class="line">void encode_three(char *a, int b)</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">int i;</span><br><span class="line">for ( i &#x3D; 0; i &lt; b; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    if ( a[i] &lt;&#x3D; 64 || a[i] &gt; 90 )</span><br><span class="line">    &#123;</span><br><span class="line">      if ( a[i] &lt;&#x3D; 96 || a[i] &gt; 122 )</span><br><span class="line">      &#123;</span><br><span class="line">        if ( a[i] &lt;&#x3D; 47 || a[i] &gt; 57 )</span><br><span class="line">         a[i] &#x3D; a[i];</span><br><span class="line">        else</span><br><span class="line">        &#123;</span><br><span class="line">        a[i] -&#x3D; 3;</span><br><span class="line">        if(a[i]&lt;47)</span><br><span class="line">        a[i]+&#x3D;10;</span><br><span class="line">        if(a[i]&gt;57)</span><br><span class="line">        a[i]-&#x3D;10;</span><br><span class="line">&#125;</span><br><span class="line">          </span><br><span class="line">     &#125;</span><br><span class="line">      else</span><br><span class="line">      &#123;</span><br><span class="line">        a[i] -&#x3D; 3;</span><br><span class="line">        if(a[i]&lt;97)</span><br><span class="line">        a[i]+&#x3D;26;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    else</span><br><span class="line">    &#123;</span><br><span class="line">      a[i] -&#x3D; 3;</span><br><span class="line">      if(a[i]&lt;65)</span><br><span class="line">        a[i]+&#x3D;26;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void encode_two(char *a, char *b)</span><br><span class="line">&#123;</span><br><span class="line">strncpy(b+26,a,13);</span><br><span class="line">strncpy(b,a+13,13);</span><br><span class="line">strncpy(b+39,a+26,13);</span><br><span class="line">strncpy(b+13,a+39,13);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int findchr(char *array,char ch)</span><br><span class="line">&#123;</span><br><span class="line">int i;</span><br><span class="line">    for(i&#x3D;0;i&lt;strlen(array);i++)</span><br><span class="line">&#123;</span><br><span class="line">        if(array[i]&#x3D;&#x3D;ch)&#123;</span><br><span class="line">            return i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void base64_decode(char *src,char *result)</span><br><span class="line">&#123;</span><br><span class="line">    int base_len;</span><br><span class="line">    int i,j&#x3D;0;</span><br><span class="line">    base_len&#x3D;strlen(src);</span><br><span class="line">    for(i&#x3D;0;i&lt;base_len;i++)</span><br><span class="line">&#123;</span><br><span class="line">        if(src[i]&#x3D;&#x3D;padding_char)</span><br><span class="line">            src[i]&#x3D;&#39;A&#39;;</span><br><span class="line">    &#125;</span><br><span class="line">    for(i&#x3D;0;i&lt;base_len;i+&#x3D;4)</span><br><span class="line">&#123;</span><br><span class="line">        result[j++]&#x3D;(findchr(table,src[i])&lt;&lt;2)+(findchr(table,src[i+1])&gt;&gt;4);</span><br><span class="line">        result[j++]&#x3D;(findchr(table,src[i+1])&lt;&lt;4)+(findchr(table,src[i+2])&gt;&gt;2);</span><br><span class="line">        result[j++]&#x3D;((findchr(table,src[i+2])&amp;3)&lt;&lt;6)+(findchr(table,src[i+3]));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">int main() </span><br><span class="line">&#123;</span><br><span class="line">char str3[100]&#x3D;&quot;&quot;;</span><br><span class="line">char str2[52]&#x3D;&quot;&quot;;</span><br><span class="line">encode_three(str, 52);</span><br><span class="line">encode_two(str, str2);</span><br><span class="line">base64_decode(str2, str3);</span><br><span class="line">printf(&quot;%s&quot;,str3);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>GWHT{672cc4778a38e80cb362987341133ea2}</p></blockquote><h1 id="特殊的-BASE64"><a href="#特殊的-BASE64" class="headerlink" title="特殊的 BASE64"></a>特殊的 BASE64</h1><p>查看文件信息, 64位文件</p><p><img src="/2021/04/10/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%952/18.PNG"></p><p>进入main函数和加密函数</p><p><img src="/2021/04/10/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%952/19.PNG"></p><p><img src="/2021/04/10/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%952/20.PNG"></p><p>只是改了一下密码表<br>exp</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    char a[]&#x3D;&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+&#x2F;&quot;;</span><br><span class="line">    char b[]&#x3D;&quot;AaBbCcDdEeFfGgHhIiJjKkLlMmNnOoPpQqRrSsTtUuVvWwXxYyZz0987654321&#x2F;+&quot;;</span><br><span class="line">    char c[]&#x3D;&quot;mTyqm7wjODkrNLcWl0eqO8K8gc1BPk1GNLgUpI&#x3D;&#x3D;&quot;;</span><br><span class="line">    int i,j;</span><br><span class="line">    for(i&#x3D;0;i&lt;strlen(c);i++)</span><br><span class="line">    &#123;</span><br><span class="line">        for(j&#x3D;0;j&lt;strlen(a);j++)</span><br><span class="line">        &#123;</span><br><span class="line">            if(b[j]&#x3D;&#x3D;c[i])</span><br><span class="line">            &#123;</span><br><span class="line">                c[i]&#x3D;a[j];</span><br><span class="line">                break;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    for(i&#x3D;0;i&lt;strlen(c);i++)</span><br><span class="line">    &#123;</span><br><span class="line">        printf(&quot;%c&quot;,c[i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后去在线解密</p><blockquote><p>flag{Special_Base64_By_Lich}</p></blockquote><h1 id="羊城杯-2020-login"><a href="#羊城杯-2020-login" class="headerlink" title="[羊城杯 2020]login"></a>[羊城杯 2020]login</h1><p>附件为py可执行文件，使用pyinstxtractor导出pyc文件</p><p><img src="/2021/04/10/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%952/21.PNG"></p><p>在login前加上pyc文件头，另存为login.pyc，即可反编译。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">#!&#x2F;usr&#x2F;bin&#x2F;env python</span><br><span class="line"># visit http:&#x2F;&#x2F;tool.lu&#x2F;pyc&#x2F; for more information</span><br><span class="line">import sys</span><br><span class="line">input1 &#x3D; input(&#39;input something:&#39;)</span><br><span class="line">if len(input1) !&#x3D; 14:</span><br><span class="line">    print(&#39;Wrong length!&#39;)</span><br><span class="line">    sys.exit()</span><br><span class="line">code &#x3D; []</span><br><span class="line">for i in range(13):</span><br><span class="line">    code.append(ord(input1[i]) ^ ord(input1[i + 1]))</span><br><span class="line"></span><br><span class="line">code.append(ord(input1[13]))</span><br><span class="line">a1 &#x3D; code[2]</span><br><span class="line">a2 &#x3D; code[1]</span><br><span class="line">a3 &#x3D; code[0]</span><br><span class="line">a4 &#x3D; code[3]</span><br><span class="line">a5 &#x3D; code[4]</span><br><span class="line">a6 &#x3D; code[5]</span><br><span class="line">a7 &#x3D; code[6]</span><br><span class="line">a8 &#x3D; code[7]</span><br><span class="line">a9 &#x3D; code[9]</span><br><span class="line">a10 &#x3D; code[8]</span><br><span class="line">a11 &#x3D; code[10]</span><br><span class="line">a12 &#x3D; code[11]</span><br><span class="line">a13 &#x3D; code[12]</span><br><span class="line">a14 &#x3D; code[13]</span><br><span class="line">if ((((a1 * 88 + a2 * 67 + a3 * 65 - a4 * 5) + a5 * 43 + a6 * 89 + a7 * 25 + a8 * 13 - a9 * 36) + a10 * 15 + a11 * 11 + a12 * 47 - a13 * 60) + a14 * 29 &#x3D;&#x3D; 22748) &amp; ((((a1 * 89 + a2 * 7 + a3 * 12 - a4 * 25) + a5 * 41 + a6 * 23 + a7 * 20 - a8 * 66) + a9 * 31 + a10 * 8 + a11 * 2 - a12 * 41 - a13 * 39) + a14 * 17 &#x3D;&#x3D; 7258) &amp; ((((a1 * 28 + a2 * 35 + a3 * 16 - a4 * 65) + a5 * 53 + a6 * 39 + a7 * 27 + a8 * 15 - a9 * 33) + a10 * 13 + a11 * 101 + a12 * 90 - a13 * 34) + a14 * 23 &#x3D;&#x3D; 26190) &amp; ((((a1 * 23 + a2 * 34 + a3 * 35 - a4 * 59) + a5 * 49 + a6 * 81 + a7 * 25 + (a8 &lt;&lt; 7) - a9 * 32) + a10 * 75 + a11 * 81 + a12 * 47 - a13 * 60) + a14 * 29 &#x3D;&#x3D; 37136) &amp; (((a1 * 38 + a2 * 97 + a3 * 35 - a4 * 52) + a5 * 42 + a6 * 79 + a7 * 90 + a8 * 23 - a9 * 36) + a10 * 57 + a11 * 81 + a12 * 42 - a13 * 62 - a14 * 11 &#x3D;&#x3D; 27915) &amp; ((((a1 * 22 + a2 * 27 + a3 * 35 - a4 * 45) + a5 * 47 + a6 * 49 + a7 * 29 + a8 * 18 - a9 * 26) + a10 * 35 + a11 * 41 + a12 * 40 - a13 * 61) + a14 * 28 &#x3D;&#x3D; 17298) &amp; ((((a1 * 12 + a2 * 45 + a3 * 35 - a4 * 9 - a5 * 42) + a6 * 86 + a7 * 23 + a8 * 85 - a9 * 47) + a10 * 34 + a11 * 76 + a12 * 43 - a13 * 44) + a14 * 65 &#x3D;&#x3D; 19875) &amp; (((a1 * 79 + a2 * 62 + a3 * 35 - a4 * 85) + a5 * 33 + a6 * 79 + a7 * 86 + a8 * 14 - a9 * 30) + a10 * 25 + a11 * 11 + a12 * 57 - a13 * 50 - a14 * 9 &#x3D;&#x3D; 22784) &amp; ((((a1 * 8 + a2 * 6 + a3 * 64 - a4 * 85) + a5 * 73 + a6 * 29 + a7 * 2 + a8 * 23 - a9 * 36) + a10 * 5 + a11 * 2 + a12 * 47 - a13 * 64) + a14 * 27 &#x3D;&#x3D; 9710) &amp; (((((a1 * 67 - a2 * 68) + a3 * 68 - a4 * 51 - a5 * 43) + a6 * 81 + a7 * 22 - a8 * 12 - a9 * 38) + a10 * 75 + a11 * 41 + a12 * 27 - a13 * 52) + a14 * 31 &#x3D;&#x3D; 13376) &amp; ((((a1 * 85 + a2 * 63 + a3 * 5 - a4 * 51) + a5 * 44 + a6 * 36 + a7 * 28 + a8 * 15 - a9 * 6) + a10 * 45 + a11 * 31 + a12 * 7 - a13 * 67) + a14 * 78 &#x3D;&#x3D; 24065) &amp; ((((a1 * 47 + a2 * 64 + a3 * 66 - a4 * 5) + a5 * 43 + a6 * 112 + a7 * 25 + a8 * 13 - a9 * 35) + a10 * 95 + a11 * 21 + a12 * 43 - a13 * 61) + a14 * 20 &#x3D;&#x3D; 27687) &amp; (((a1 * 89 + a2 * 67 + a3 * 85 - a4 * 25) + a5 * 49 + a6 * 89 + a7 * 23 + a8 * 56 - a9 * 92) + a10 * 14 + a11 * 89 + a12 * 47 - a13 * 61 - a14 * 29 &#x3D;&#x3D; 29250) &amp; (((a1 * 95 + a2 * 34 + a3 * 62 - a4 * 9 - a5 * 43) + a6 * 83 + a7 * 25 + a8 * 12 - a9 * 36) + a10 * 16 + a11 * 51 + a12 * 47 - a13 * 60 - a14 * 24 &#x3D;&#x3D; 15317):</span><br><span class="line">    print(&#39;flag is GWHT&#123;md5(your_input)&#125;&#39;)</span><br><span class="line">    print(&#39;Congratulations and have fun!&#39;)</span><br><span class="line">else:</span><br><span class="line">    print(&#39;Sorry,plz try again...&#39;)</span><br></pre></td></tr></table></figure><p>方程组+异或</p><blockquote><p>exp</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">from z3 import *</span><br><span class="line">x&#x3D;Solver()</span><br><span class="line">a1,a2,a3,a4,a5,a6,a7,a8,a9,a10,a11,a12,a13,a14&#x3D;Ints(&quot;a1 a2 a3 a4 a5 a6 a7 a8 a9 a10 a11 a12 a13 a14&quot;)</span><br><span class="line">x.add(a1 * 88 + a2 * 67 + a3 * 65 - a4 * 5 + a5 * 43 + a6 * 89 + a7 * 25 + a8 * 13 - a9 * 36 + a10 * 15 + a11 * 11 + a12 * 47 - a13 * 60 + a14 * 29 &#x3D;&#x3D; 22748)</span><br><span class="line">x.add(a1 * 89 + a2 * 7 + a3 * 12 - a4 * 25 + a5 * 41 + a6 * 23 + a7 * 20 - a8 * 66 + a9 * 31 + a10 * 8 + a11 * 2 - a12 * 41 - a13 * 39 + a14 * 17 &#x3D;&#x3D; 7258)</span><br><span class="line">x.add(a1 * 28 + a2 * 35 + a3 * 16 - a4 * 65 + a5 * 53 + a6 * 39 + a7 * 27 + a8 * 15 - a9 * 33 + a10 * 13 + a11 * 101 + a12 * 90 - a13 * 34 + a14 * 23 &#x3D;&#x3D; 26190)</span><br><span class="line">x.add(a1 * 23 + a2 * 34 + a3 * 35 - a4 * 59 + a5 * 49 + a6 * 81 + a7 * 25 + a8 * 128 - a9 * 32 + a10 * 75 + a11 * 81 + a12 * 47 - a13 * 60 + a14 * 29 &#x3D;&#x3D; 37136)</span><br><span class="line">x.add(a1 * 38 + a2 * 97 + a3 * 35 - a4 * 52 + a5 * 42 + a6 * 79 + a7 * 90 + a8 * 23 - a9 * 36 + a10 * 57 + a11 * 81 + a12 * 42 - a13 * 62 - a14 * 11 &#x3D;&#x3D; 27915)</span><br><span class="line">x.add(a1 * 22 + a2 * 27 + a3 * 35 - a4 * 45 + a5 * 47 + a6 * 49 + a7 * 29 + a8 * 18 - a9 * 26 + a10 * 35 + a11 * 41 + a12 * 40 - a13 * 61 + a14 * 28 &#x3D;&#x3D; 17298)</span><br><span class="line">x.add(a1 * 12 + a2 * 45 + a3 * 35 - a4 * 9 - a5 * 42 + a6 * 86 + a7 * 23 + a8 * 85 - a9 * 47 + a10 * 34 + a11 * 76 + a12 * 43 - a13 * 44 + a14 * 65 &#x3D;&#x3D; 19875)</span><br><span class="line">x.add(a1 * 79 + a2 * 62 + a3 * 35 - a4 * 85 + a5 * 33 + a6 * 79 + a7 * 86 + a8 * 14 - a9 * 30 + a10 * 25 + a11 * 11 + a12 * 57 - a13 * 50 - a14 * 9 &#x3D;&#x3D; 22784)</span><br><span class="line">x.add(a1 * 8 + a2 * 6 + a3 * 64 - a4 * 85 + a5 * 73 + a6 * 29 + a7 * 2 + a8 * 23 - a9 * 36 + a10 * 5 + a11 * 2 + a12 * 47 - a13 * 64 + a14 * 27 &#x3D;&#x3D; 9710)</span><br><span class="line">x.add(a1 * 67 - a2 * 68 + a3 * 68 - a4 * 51 - a5 * 43 + a6 * 81 + a7 * 22 - a8 * 12 - a9 * 38 + a10 * 75 + a11 * 41 + a12 * 27 - a13 * 52 + a14 * 31 &#x3D;&#x3D; 13376)</span><br><span class="line">x.add(a1 * 85 + a2 * 63 + a3 * 5 - a4 * 51 + a5 * 44 + a6 * 36 + a7 * 28 + a8 * 15 - a9 * 6 + a10 * 45 + a11 * 31 + a12 * 7 - a13 * 67 + a14 * 78 &#x3D;&#x3D; 24065)</span><br><span class="line">x.add(a1 * 47 + a2 * 64 + a3 * 66 - a4 * 5 + a5 * 43 + a6 * 112 + a7 * 25 + a8 * 13 - a9 * 35 + a10 * 95 + a11 * 21 + a12 * 43 - a13 * 61 + a14 * 20 &#x3D;&#x3D; 27687)</span><br><span class="line">x.add(a1 * 89 + a2 * 67 + a3 * 85 - a4 * 25 + a5 * 49 + a6 * 89 + a7 * 23 + a8 * 56 - a9 * 92 + a10 * 14 + a11 * 89 + a12 * 47 - a13 * 61 - a14 * 29 &#x3D;&#x3D; 29250)</span><br><span class="line">x.add(a1 * 95 + a2 * 34 + a3 * 62 - a4 * 9 - a5 * 43 + a6 * 83 + a7 * 25 + a8 * 12 - a9 * 36 + a10 * 16 + a11 * 51 + a12 * 47 - a13 * 60 - a14 * 24 &#x3D;&#x3D; 15317)</span><br><span class="line">if x.check()&#x3D;&#x3D;sat:</span><br><span class="line">    print(x.model())</span><br><span class="line">    </span><br><span class="line">a&#x3D;[10,24,119,7,104,43,28,91,108,52,88,74,88,33]</span><br><span class="line">flag&#x3D;&quot;&quot;</span><br><span class="line">for i in range(len(a)-2,-1,-1):</span><br><span class="line">    flag+&#x3D;chr(a[i]^a[i+1])</span><br><span class="line">    a[i]&#x3D;a[i]^a[i+1]</span><br><span class="line">flag &#x3D; flag[::-1]</span><br><span class="line">flag +&#x3D; chr(33)</span><br><span class="line">import hashlib as hb</span><br><span class="line">print(&quot;flag&#123;&quot;+hb.md5(str(flag).encode()).hexdigest()+&quot;&#125;&quot;)</span><br></pre></td></tr></table></figure><blockquote><p>flag{58964088b637e50d3a22b9510c1d1ef8}</p></blockquote>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>V-N2020 公开赛</title>
      <link href="2021/03/28/V-N2020-%E5%85%AC%E5%BC%80%E8%B5%9B/"/>
      <url>2021/03/28/V-N2020-%E5%85%AC%E5%BC%80%E8%B5%9B/</url>
      
        <content type="html"><![CDATA[<h1 id="CSRe"><a href="#CSRe" class="headerlink" title="CSRe"></a>CSRe</h1><a id="more"></a><p>Exeinfo PE查看程序，为C#，而且被混淆。<br>de4dot去除混淆。</p><p><img src="/2021/03/28/V-N2020-%E5%85%AC%E5%BC%80%E8%B5%9B/1.png"></p><p>拖入dnSpy32位中。</p><p><img src="/2021/03/28/V-N2020-%E5%85%AC%E5%BC%80%E8%B5%9B/2.png"></p><p><img src="/2021/03/28/V-N2020-%E5%85%AC%E5%BC%80%E8%B5%9B/3.png"></p><p>然后去在线解密，第一个解出来为314159，第二个为return.</p><blockquote><p>flag{1415turn}</p></blockquote>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>DASCTF</title>
      <link href="2021/03/28/DASCTF/"/>
      <url>2021/03/28/DASCTF/</url>
      
        <content type="html"><![CDATA[<h1 id="Enjoyit-1"><a href="#Enjoyit-1" class="headerlink" title="Enjoyit-1"></a>Enjoyit-1</h1><a id="more"></a><p>首先查看文件信息</p><p><img src="/2021/03/28/DASCTF/1.png"></p><p>是C#文件，32位，放入dnSpy32位中。</p><p><img src="/2021/03/28/DASCTF/2.png"></p><p>第18行是输入判断，输入的字符范围为ASCII码95-122位。<br>第21行是变过密码表的base64加密并判断是否与yQXHyBvN3g/81gv51QXG1QTBxRr/yvXK1hC=相等。<br>第26-29行是一个循环，运行程序这个循环会运行100000秒。<br>第31行是xtea加密的变形。<br>第37-41行是一个异或。</p><h2 id="方法一：静态分析"><a href="#方法一：静态分析" class="headerlink" title="方法一：静态分析"></a>方法一：静态分析</h2><p>base64解密：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">char a[]&#x3D;&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+&#x2F;&quot;;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">char b[]&#x3D;&quot;abcdefghijklmnopqrstuvwxyz0123456789+&#x2F;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#x3D;&quot;;</span><br><span class="line">    char c[]&#x3D;&quot;yQXHyBvN3g&#x2F;81gv51QXG1QTBxRr&#x2F;yvXK1hC&#x3D;&quot;;</span><br><span class="line">    int i,j;</span><br><span class="line">    for(i&#x3D;0;i&lt;strlen(c);i++)</span><br><span class="line">    &#123;</span><br><span class="line">        for(j&#x3D;0;j&lt;strlen(a);j++)</span><br><span class="line">        &#123;</span><br><span class="line">            if(b[j]&#x3D;&#x3D;c[i])</span><br><span class="line">            &#123;</span><br><span class="line">                c[i]&#x3D;a[j];</span><br><span class="line">                break;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    for(i&#x3D;0;i&lt;strlen(c);i++)</span><br><span class="line">    &#123;</span><br><span class="line">        printf(&quot;%c&quot;,c[i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>原密文:Y29tYnVzdGlibGVfb29sb25nX3RlYV9wbHo=<br>在线解密得：combustible_oolong_tea_plz</p></blockquote><p>有xtea加密得到的array：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdint.h&gt;</span><br><span class="line"> </span><br><span class="line">void encipher(unsigned int num_rounds, uint32_t v[2], uint32_t const key[26]) &#123;</span><br><span class="line">    unsigned int i;</span><br><span class="line">    uint32_t v0&#x3D;v[0], v1&#x3D;v[1], sum&#x3D;0, delta&#x3D;2654435464U;</span><br><span class="line">    for (i&#x3D;0; i &lt; num_rounds; i++) &#123;</span><br><span class="line">        v0 +&#x3D; (((v1 &lt;&lt; 4) ^ (v1 &gt;&gt; 5)) + v1) ^ (sum + key[sum &amp; 3]);</span><br><span class="line">        sum +&#x3D; delta;</span><br><span class="line">        v1 +&#x3D; (((v0 &lt;&lt; 4) ^ (v0 &gt;&gt; 5)) + v0) ^ (sum + key[(sum&gt;&gt;11) &amp; 3]);</span><br><span class="line">    &#125;</span><br><span class="line">    v[0]&#x3D;v0; v[1]&#x3D;v1;</span><br><span class="line">&#125;</span><br><span class="line"> int main()</span><br><span class="line">&#123;</span><br><span class="line">    uint32_t v[2]&#x3D;&#123;288,369&#125;;</span><br><span class="line">    uint32_t const k[26]&#x3D;&#123;0x63,0x6f,0x6d,0x62,0x75,0x73,0x74,0x69,0x62,0x6c,0x65,0x5f,0x6f,0x6f,0x6c,0x6f,0x6e,0x67,0x5f,0x74,0x65,0x61,0x5f,0x70,0x6c,0x7a&#125;;</span><br><span class="line">    unsigned int r&#x3D;32;</span><br><span class="line">    encipher(r, v, k);</span><br><span class="line">    printf(&quot;%0x%0x&quot;,v[0],v[1]);</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>将所得的数字当作字符串</p><blockquote><p>6308fe34b7fe6fdb</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    char a[32]&#x3D;&#123; 2, 5, 4, 13, 3, 84, 11, 4, 87, 3, 86, 3, 80, 7, 83, 3, 0, 4, 83, 94, 7, 84, 4, 0, 1, 83, 3, 84, 6, 83, 5, 80 &#125;;</span><br><span class="line">    char b[16]&#x3D;&quot;6308fe34b7fe6fdb&quot;;</span><br><span class="line">    int i;</span><br><span class="line">    for(i&#x3D;0;i&lt;32;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        a[i]&#x3D;a[i]^b[i%16];</span><br><span class="line">    &#125;</span><br><span class="line">    printf(&quot;flag&#123;%s&#125;&quot;,a);</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>flag{4645e180540ffa7a67cfa174cde105a2}</p></blockquote><h2 id="方法二：修改程序"><a href="#方法二：修改程序" class="headerlink" title="方法二：修改程序"></a>方法二：修改程序</h2><p>我们若直接输入combustible_oolong_tea_plz，程序运行100000秒后才会出flag，这是因为26-29行的循环。<br>只要把这个循环删去就行了。比静态分析简单多了。<br><img src="/2021/03/28/DASCTF/3.png"></p><blockquote><p>flag{4645e180540ffa7a67cfa174cde105a2}</p></blockquote><h1 id="drinkSomeTea"><a href="#drinkSomeTea" class="headerlink" title="drinkSomeTea"></a>drinkSomeTea</h1><p>32位文件，无壳</p><p><img src="/2021/03/28/DASCTF/4.PNG"></p><p>进入main函数f5</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">int __cdecl main(int argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  HANDLE v3; &#x2F;&#x2F; eax</span><br><span class="line">  void *v4; &#x2F;&#x2F; esi</span><br><span class="line">  int result; &#x2F;&#x2F; eax</span><br><span class="line">  DWORD v6; &#x2F;&#x2F; edi</span><br><span class="line">  char *v7; &#x2F;&#x2F; esi</span><br><span class="line">  DWORD v8; &#x2F;&#x2F; ebx</span><br><span class="line">  HANDLE v9; &#x2F;&#x2F; eax</span><br><span class="line">  void *v10; &#x2F;&#x2F; esi</span><br><span class="line">  DWORD NumberOfBytesRead; &#x2F;&#x2F; [esp+Ch] [ebp-8h]</span><br><span class="line">  DWORD NumberOfBytesWritten; &#x2F;&#x2F; [esp+10h] [ebp-4h]</span><br><span class="line"></span><br><span class="line">  sub_401000();</span><br><span class="line">  sub_4013B2(aWelcomeToMyTea);</span><br><span class="line">  v3 &#x3D; CreateFileA(FileName, 0xC0000000, 0, 0, 3u, 0x80u, 0);</span><br><span class="line">  v4 &#x3D; v3;</span><br><span class="line">  if ( v3 &#x3D;&#x3D; -1 )</span><br><span class="line">  &#123;</span><br><span class="line">    sub_4013B2(aIThinkYouDoNot);</span><br><span class="line">    result &#x3D; 0;</span><br><span class="line">  &#125;</span><br><span class="line">  else</span><br><span class="line">  &#123;</span><br><span class="line">    v6 &#x3D; GetFileSize(v3, 0);</span><br><span class="line">    if ( v6 &lt; 0xEA60 )</span><br><span class="line">    &#123;</span><br><span class="line">      SetFilePointer(v4, 0, 0, 0);</span><br><span class="line">      NumberOfBytesRead &#x3D; 0;</span><br><span class="line">      ReadFile(v4, &amp;unk_409988, v6, &amp;NumberOfBytesRead, 0);</span><br><span class="line">      CloseHandle(v4);</span><br><span class="line">      if ( (v6 &gt;&gt; 3) &gt; 0 )</span><br><span class="line">      &#123;</span><br><span class="line">        v7 &#x3D; &amp;unk_409988;</span><br><span class="line">        v8 &#x3D; v6 &gt;&gt; 3;</span><br><span class="line">        do</span><br><span class="line">        &#123;</span><br><span class="line">          (loc_4010A0)(v7, &amp;unk_407030);</span><br><span class="line">          v7 +&#x3D; 8;</span><br><span class="line">          --v8;</span><br><span class="line">        &#125;</span><br><span class="line">        while ( v8 );</span><br><span class="line">      &#125;</span><br><span class="line">      v9 &#x3D; CreateFileA(aTeaPngOut, 0xC0000000, 0, 0, 2u, 0x80u, 0);</span><br><span class="line">      v10 &#x3D; v9;</span><br><span class="line">      if ( v9 &#x3D;&#x3D; -1 )</span><br><span class="line">      &#123;</span><br><span class="line">        sub_4013B2(aIThinkYouDoNot);</span><br><span class="line">      &#125;</span><br><span class="line">      else</span><br><span class="line">      &#123;</span><br><span class="line">        NumberOfBytesWritten &#x3D; 0;</span><br><span class="line">        WriteFile(v9, &amp;unk_409988, v6, &amp;NumberOfBytesWritten, 0);</span><br><span class="line">        CloseHandle(v10);</span><br><span class="line">        sub_4013B2(aNowThisCupOfTe);</span><br><span class="line">      &#125;</span><br><span class="line">      result &#x3D; 0;</span><br><span class="line">    &#125;</span><br><span class="line">    else</span><br><span class="line">    &#123;</span><br><span class="line">      sub_4013B2(aYourTeaIsTooHo);</span><br><span class="line">      result &#x3D; 0;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>大致意思就是读取tea.png，经过(loc_4010A0)(v7, &amp;unk_407030)后，得到了文件tea.png.out<br>loc_4010A0有一个花指令</p><p><img src="/2021/03/28/DASCTF/5.PNG"></p><p>按‘d’转为数据</p><p><img src="/2021/03/28/DASCTF/6.PNG"></p><p>nop掉0E8h，剩余部分按‘c’转为代码</p><p><img src="/2021/03/28/DASCTF/7.PNG"></p><p>按‘p’创建函数，然后就能f5了</p><p><img src="/2021/03/28/DASCTF/8.PNG"></p><p>密钥</p><p><img src="/2021/03/28/DASCTF/9.PNG"></p><p>这个tea加密的数据都是interesting型的，所以要将普通的脚本改一下。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line"></span><br><span class="line">void decrypt (int* v, int* k) </span><br><span class="line">&#123;</span><br><span class="line">    int v0&#x3D;v[0], v1&#x3D;v[1], sum&#x3D;0xC6EF3720, i;  &#x2F;* set up *&#x2F;</span><br><span class="line">    int delta&#x3D;0x9e3779b9;                     &#x2F;* a key schedule constant *&#x2F;</span><br><span class="line">    int k0&#x3D;k[0], k1&#x3D;k[1], k2&#x3D;k[2], k3&#x3D;k[3];   &#x2F;* cache key *&#x2F;</span><br><span class="line">    for (i&#x3D;0; i&lt;32; i++) &#123;                         &#x2F;* basic cycle start *&#x2F;</span><br><span class="line">        v1 -&#x3D; ((v0&lt;&lt;4) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;5) + k3);</span><br><span class="line">        v0 -&#x3D; ((v1&lt;&lt;4) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;5) + k1);</span><br><span class="line">        sum -&#x3D; delta;</span><br><span class="line">    &#125;                                              &#x2F;* end cycle *&#x2F;</span><br><span class="line">    v[0]&#x3D;v0; v[1]&#x3D;v1;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    int v[14656];</span><br><span class="line">    int k[4]&#x3D;&#123;0x67616C66, 0x6B61667B, 0x6C665F65, 0x7D216761&#125;;</span><br><span class="line">    int i;</span><br><span class="line">    FILE *fp;</span><br><span class="line">    fp &#x3D; fopen(&quot;.&#x2F;tea.png.out&quot;, &quot;rb&quot;);</span><br><span class="line">    fread(&amp;v, 4, 14656, fp);</span><br><span class="line">    fclose(fp);</span><br><span class="line">    for(i&#x3D;0;i&lt;14656;i+&#x3D;2)</span><br><span class="line">    &#123;</span><br><span class="line">        decrypt(&amp;v[i], k);</span><br><span class="line">    &#125;</span><br><span class="line">    fp &#x3D; fopen(&quot;.&#x2F;tea.png&quot;, &quot;wb&quot;);</span><br><span class="line">    fwrite(&amp;v, 4, 14656, fp);</span><br><span class="line">    fclose(fp);</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2021/03/28/DASCTF/tea.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Nepctf</title>
      <link href="2021/03/28/Nepctf/"/>
      <url>2021/03/28/Nepctf/</url>
      
        <content type="html"><![CDATA[<h1 id="hardcsharp"><a href="#hardcsharp" class="headerlink" title="hardcsharp"></a>hardcsharp</h1><a id="more"></a><p>⽤dnspy32位打开，可发现是aes加密<br>反编译代码：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">using System;</span><br><span class="line"></span><br><span class="line">namespace hardcsharp</span><br><span class="line">&#123;</span><br><span class="line">&#x2F;&#x2F; Token: 0x02000002 RID: 2</span><br><span class="line">internal class Program</span><br><span class="line">&#123;</span><br><span class="line">&#x2F;&#x2F; Token: 0x06000001 RID: 1 RVA: 0x00002050 File Offset: 0x00000250</span><br><span class="line">private static void Main(string[] args)</span><br><span class="line">&#123;</span><br><span class="line">AesClass aesClass &#x3D; new AesClass();</span><br><span class="line">string text &#x3D; &quot;&quot;;</span><br><span class="line">string strB &#x3D; </span><br><span class="line">&quot;1Umgm5LG6lNPyRCd0LktJhJtyBN7ivpq+EKGmTAcXUM+0ikYZL4h4QTHGqH&#x2F;3Wh0&quot;;</span><br><span class="line">byte[] array &#x3D; new byte[]</span><br><span class="line">&#123;</span><br><span class="line">81, 82, 87, 81, 82, 87, 68, 92, 94, 86, 93, 18, 18, 18, 18, 18, 18, 18, 18, </span><br><span class="line">18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18</span><br><span class="line">&#125;;</span><br><span class="line">Console.WriteLine(&quot;Welcome to nepnep csharp test! plz input the magical code:&quot;);</span><br><span class="line">string text2 &#x3D; Console.ReadLine();</span><br><span class="line">if (text2.Length !&#x3D; 37)</span><br><span class="line">&#123;</span><br><span class="line">Console.WriteLine(&quot;Nope!&quot;);</span><br><span class="line">Console.ReadKey();</span><br><span class="line">return;</span><br><span class="line">&#125;</span><br><span class="line">if (text2.Substring(0, 4) !&#x3D; &quot;Nep&#123;&quot; || text2[36] !&#x3D; &#39;&#125;&#39;)</span><br><span class="line">&#123;</span><br><span class="line">Console.WriteLine(&quot;Nope!&quot;);</span><br><span class="line">Console.ReadKey();</span><br><span class="line">return;</span><br><span class="line">&#125;</span><br><span class="line">for (int i &#x3D; 0; i &lt; 32; i++)</span><br><span class="line">&#123;</span><br><span class="line">text +&#x3D; Convert.ToChar((int)(array[i] ^ 51)).ToString();</span><br><span class="line">&#125;</span><br><span class="line">if (string.Compare(aesClass.AesEncrypt(text2, text), strB) &#x3D;&#x3D; 0)</span><br><span class="line">&#123;</span><br><span class="line">Console.WriteLine(&quot;wow, you pass it!&quot;);</span><br><span class="line">Console.ReadKey();</span><br><span class="line">return;</span><br><span class="line">&#125;</span><br><span class="line">Console.WriteLine(&quot;Nope!&quot;);</span><br><span class="line">Console.ReadKey();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">public string AesEncrypt(string str, string key)</span><br><span class="line">&#123;</span><br><span class="line">if (string.IsNullOrEmpty(str))</span><br><span class="line">&#123;</span><br><span class="line">return null;</span><br><span class="line">&#125;</span><br><span class="line">byte[] bytes &#x3D; Encoding.UTF8.GetBytes(str);</span><br><span class="line">byte[] array &#x3D; new RijndaelManaged</span><br><span class="line">&#123;</span><br><span class="line">Key &#x3D; Encoding.UTF8.GetBytes(key),</span><br><span class="line">Mode &#x3D; CipherMode.ECB,</span><br><span class="line">Padding &#x3D; PaddingMode.PKCS7</span><br><span class="line">&#125;.CreateEncryptor().TransformFinalBlock(bytes, 0, bytes.Length);</span><br><span class="line">return Convert.ToBase64String(array, 0, array.Length);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>可知AES模式为ECB，填充模式为PKCS7Padding<br>解出来密钥：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    int num[32]&#x3D;&#123;81, 82, 87, 81, 82, 87, 68, 92, 94, 86, 93, 18, 18, 18, 18, 18, 18, 18, </span><br><span class="line">    18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18&#125;;</span><br><span class="line">    int i;</span><br><span class="line">    for (i&#x3D;0;i&lt;32;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        num[i]^&#x3D;51;</span><br><span class="line">    &#125;</span><br><span class="line">    for (i&#x3D;0;i&lt;32;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        printf(&quot;%c&quot;,num[i]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>密钥：badbadwomen!!!!!!!!!!!!!!!!!!!!!</p></blockquote><p>在线解密</p><p><img src="/2021/03/28/Nepctf/1.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Nep&#123;up_up_down_down_B_a_b_A_Nep_nep~&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>de4dot反混淆工具</title>
      <link href="2021/03/28/de4dot%E5%8F%8D%E6%B7%B7%E6%B7%86%E5%B7%A5%E5%85%B7/"/>
      <url>2021/03/28/de4dot%E5%8F%8D%E6%B7%B7%E6%B7%86%E5%B7%A5%E5%85%B7/</url>
      
        <content type="html"><![CDATA[<p>找到下载好的文件所在的位置</p><a id="more"></a><p><img src="/2021/03/28/de4dot%E5%8F%8D%E6%B7%B7%E6%B7%86%E5%B7%A5%E5%85%B7/1.png"></p><p>按住shift选择并右击，选择打开Powershell窗口</p><p><img src="/2021/03/28/de4dot%E5%8F%8D%E6%B7%B7%E6%B7%86%E5%B7%A5%E5%85%B7/2.png"></p><p> 输入.\De4Dot [目标文件的路径]</p><p><img src="/2021/03/28/de4dot%E5%8F%8D%E6%B7%B7%E6%B7%86%E5%B7%A5%E5%85%B7/4.png"></p><p>会生成一个名为：原文件名–cleaned.exe</p><p>去混淆前<br><img src="/2021/03/28/de4dot%E5%8F%8D%E6%B7%B7%E6%B7%86%E5%B7%A5%E5%85%B7/5.png"></p><p>去混淆后</p><p><img src="/2021/03/28/de4dot%E5%8F%8D%E6%B7%B7%E6%B7%86%E5%B7%A5%E5%85%B7/6.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>喝茶吗</title>
      <link href="2021/03/20/%E5%96%9D%E8%8C%B6%E5%90%97/"/>
      <url>2021/03/20/%E5%96%9D%E8%8C%B6%E5%90%97/</url>
      
        <content type="html"><![CDATA[<h1 id="一个神奇的加密"><a href="#一个神奇的加密" class="headerlink" title="一个神奇的加密"></a>一个神奇的加密</h1><a id="more"></a><h2 id="加密原理"><a href="#加密原理" class="headerlink" title="加密原理"></a>加密原理</h2><p><a href="https://blog.csdn.net/gsls200808/article/details/48243019">参考链接</a></p><h3 id="tea加密"><a href="#tea加密" class="headerlink" title="tea加密"></a>tea加密</h3><p>在密码学中，微型加密算法（Tiny Encryption Algorithm，TEA）是一种易于描述和执行的块密码，通常只需要很少的代码就可实现。其设计者是剑桥大学计算机实验室的大卫·惠勒与罗杰·尼达姆。这项技术最初于1994年提交给鲁汶的快速软件加密的研讨会上，并在该研讨会上演讲中首次发表。</p><p>在给出的代码中：加密使用的数据为2个32位无符号整数，密钥为4个32位无符号整数即密钥长度为128位<br>加密过程：<br><img src="/2021/03/20/%E5%96%9D%E8%8C%B6%E5%90%97/1.png"><br>算法实现：</p><p>C语言代码（需支持C99）</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdint.h&gt;</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F;加密函数</span><br><span class="line">void encrypt (uint32_t* v, uint32_t* k) &#123;</span><br><span class="line">    uint32_t v0&#x3D;v[0], v1&#x3D;v[1], sum&#x3D;0, i;           &#x2F;* set up *&#x2F;</span><br><span class="line">    uint32_t delta&#x3D;0x9e3779b9;                     &#x2F;* a key schedule constant *&#x2F;</span><br><span class="line">    uint32_t k0&#x3D;k[0], k1&#x3D;k[1], k2&#x3D;k[2], k3&#x3D;k[3];   &#x2F;* cache key *&#x2F;</span><br><span class="line">    for (i&#x3D;0; i &lt; 32; i++) &#123;                       &#x2F;* basic cycle start *&#x2F;</span><br><span class="line">        sum +&#x3D; delta;</span><br><span class="line">        v0 +&#x3D; ((v1&lt;&lt;4) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;5) + k1);</span><br><span class="line">        v1 +&#x3D; ((v0&lt;&lt;4) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;5) + k3);</span><br><span class="line">    &#125;                                              &#x2F;* end cycle *&#x2F;</span><br><span class="line">    v[0]&#x3D;v0; v[1]&#x3D;v1;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;解密函数</span><br><span class="line">void decrypt (uint32_t* v, uint32_t* k) &#123;</span><br><span class="line">    uint32_t v0&#x3D;v[0], v1&#x3D;v[1], sum&#x3D;0xC6EF3720, i;  &#x2F;* set up *&#x2F;</span><br><span class="line">    uint32_t delta&#x3D;0x9e3779b9;                     &#x2F;* a key schedule constant *&#x2F;</span><br><span class="line">    uint32_t k0&#x3D;k[0], k1&#x3D;k[1], k2&#x3D;k[2], k3&#x3D;k[3];   &#x2F;* cache key *&#x2F;</span><br><span class="line">    for (i&#x3D;0; i&lt;32; i++) &#123;                         &#x2F;* basic cycle start *&#x2F;</span><br><span class="line">        v1 -&#x3D; ((v0&lt;&lt;4) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;5) + k3);</span><br><span class="line">        v0 -&#x3D; ((v1&lt;&lt;4) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;5) + k1);</span><br><span class="line">        sum -&#x3D; delta;</span><br><span class="line">    &#125;                                              &#x2F;* end cycle *&#x2F;</span><br><span class="line">    v[0]&#x3D;v0; v[1]&#x3D;v1;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    uint32_t v[2]&#x3D;&#123;1,2&#125;,k[4]&#x3D;&#123;2,2,3,4&#125;;</span><br><span class="line">    &#x2F;&#x2F; v为要加密的数据是两个32位无符号整数</span><br><span class="line">    &#x2F;&#x2F; k为加密解密密钥，为4个32位无符号整数，即密钥长度为128位</span><br><span class="line">    printf(&quot;加密前原始数据：%u %u\n&quot;,v[0],v[1]);</span><br><span class="line">    encrypt(v, k);</span><br><span class="line">    printf(&quot;加密后的数据：%u %u\n&quot;,v[0],v[1]);</span><br><span class="line">    decrypt(v, k);</span><br><span class="line">    printf(&quot;解密后的数据：%u %u\n&quot;,v[0],v[1]);</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>执行结果：</p><blockquote><p>加密前原始数据：1 2<br>加密后的数据：1347371722 925494771<br>解密后的数据：1 2</p><p>Process returned 0 (0x0)   execution time : 0.020 s<br>Press any key to continue.</p></blockquote><h3 id="xtea加密"><a href="#xtea加密" class="headerlink" title="xtea加密"></a>xtea加密</h3><p>XTEA是TEA的升级版，增加了更多的密钥表，移位和异或操作等等，设计者是Roger Needham, David Wheeler<br>加密过程：<br><img src="/2021/03/20/%E5%96%9D%E8%8C%B6%E5%90%97/2.png"><br>算法实现：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdint.h&gt;</span><br><span class="line"> </span><br><span class="line">&#x2F;* take 64 bits of data in v[0] and v[1] and 128 bits of key[0] - key[3] *&#x2F;</span><br><span class="line"> </span><br><span class="line">void encipher(unsigned int num_rounds, uint32_t v[2], uint32_t const key[4]) &#123;</span><br><span class="line">    unsigned int i;</span><br><span class="line">    uint32_t v0&#x3D;v[0], v1&#x3D;v[1], sum&#x3D;0, delta&#x3D;0x9E3779B9;</span><br><span class="line">    for (i&#x3D;0; i &lt; num_rounds; i++) &#123;</span><br><span class="line">        v0 +&#x3D; (((v1 &lt;&lt; 4) ^ (v1 &gt;&gt; 5)) + v1) ^ (sum + key[sum &amp; 3]);</span><br><span class="line">        sum +&#x3D; delta;</span><br><span class="line">        v1 +&#x3D; (((v0 &lt;&lt; 4) ^ (v0 &gt;&gt; 5)) + v0) ^ (sum + key[(sum&gt;&gt;11) &amp; 3]);</span><br><span class="line">    &#125;</span><br><span class="line">    v[0]&#x3D;v0; v[1]&#x3D;v1;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">void decipher(unsigned int num_rounds, uint32_t v[2], uint32_t const key[4]) &#123;</span><br><span class="line">    unsigned int i;</span><br><span class="line">    uint32_t v0&#x3D;v[0], v1&#x3D;v[1], delta&#x3D;0x9E3779B9, sum&#x3D;delta*num_rounds;</span><br><span class="line">    for (i&#x3D;0; i &lt; num_rounds; i++) &#123;</span><br><span class="line">        v1 -&#x3D; (((v0 &lt;&lt; 4) ^ (v0 &gt;&gt; 5)) + v0) ^ (sum + key[(sum&gt;&gt;11) &amp; 3]);</span><br><span class="line">        sum -&#x3D; delta;</span><br><span class="line">        v0 -&#x3D; (((v1 &lt;&lt; 4) ^ (v1 &gt;&gt; 5)) + v1) ^ (sum + key[sum &amp; 3]);</span><br><span class="line">    &#125;</span><br><span class="line">    v[0]&#x3D;v0; v[1]&#x3D;v1;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    uint32_t v[2]&#x3D;&#123;1,2&#125;;</span><br><span class="line">    uint32_t const k[4]&#x3D;&#123;2,2,3,4&#125;;</span><br><span class="line">    unsigned int r&#x3D;32;&#x2F;&#x2F;num_rounds建议取值为32</span><br><span class="line">    &#x2F;&#x2F; v为要加密的数据是两个32位无符号整数</span><br><span class="line">    &#x2F;&#x2F; k为加密解密密钥，为4个32位无符号整数，即密钥长度为128位</span><br><span class="line">    printf(&quot;加密前原始数据：%u %u\n&quot;,v[0],v[1]);</span><br><span class="line">    encipher(r, v, k);</span><br><span class="line">    printf(&quot;加密后的数据：%u %u\n&quot;,v[0],v[1]);</span><br><span class="line">    decipher(r, v, k);</span><br><span class="line">    printf(&quot;解密后的数据：%u %u\n&quot;,v[0],v[1]);</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>执行结果：</p><blockquote><p>加密前原始数据：1 2<br>加密后的数据：1345390024 2801624574<br>解密后的数据：1 2</p><p>Process returned 0 (0x0)   execution time : 0.034 s<br>Press any key to continue.</p></blockquote><h3 id="xxtea加密"><a href="#xxtea加密" class="headerlink" title="xxtea加密"></a>xxtea加密</h3><p>XXTEA，又称Corrected Block TEA，是XTEA的升级版 ，设计者是Roger Needham, David Wheeler<br>加密过程：<br><img src="/2021/03/20/%E5%96%9D%E8%8C%B6%E5%90%97/3.png"><br>算法实现：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdint.h&gt;</span><br><span class="line">#define DELTA 0x9e3779b9</span><br><span class="line">#define MX (((z&gt;&gt;5^y&lt;&lt;2) + (y&gt;&gt;3^z&lt;&lt;4)) ^ ((sum^y) + (key[(p&amp;3)^e] ^ z)))</span><br><span class="line"> </span><br><span class="line">void btea(uint32_t *v, int n, uint32_t const key[4])</span><br><span class="line">&#123;</span><br><span class="line">    uint32_t y, z, sum;</span><br><span class="line">    unsigned p, rounds, e;</span><br><span class="line">    if (n &gt; 1)            &#x2F;* Coding Part *&#x2F;</span><br><span class="line">    &#123;</span><br><span class="line">        rounds &#x3D; 6 + 52&#x2F;n;</span><br><span class="line">        sum &#x3D; 0;</span><br><span class="line">        z &#x3D; v[n-1];</span><br><span class="line">        do</span><br><span class="line">        &#123;</span><br><span class="line">            sum +&#x3D; DELTA;</span><br><span class="line">            e &#x3D; (sum &gt;&gt; 2) &amp; 3;</span><br><span class="line">            for (p&#x3D;0; p&lt;n-1; p++)</span><br><span class="line">            &#123;</span><br><span class="line">                y &#x3D; v[p+1];</span><br><span class="line">                z &#x3D; v[p] +&#x3D; MX;</span><br><span class="line">            &#125;</span><br><span class="line">            y &#x3D; v[0];</span><br><span class="line">            z &#x3D; v[n-1] +&#x3D; MX;</span><br><span class="line">        &#125;</span><br><span class="line">        while (--rounds);</span><br><span class="line">    &#125;</span><br><span class="line">    else if (n &lt; -1)      &#x2F;* Decoding Part *&#x2F;</span><br><span class="line">    &#123;</span><br><span class="line">        n &#x3D; -n;</span><br><span class="line">        rounds &#x3D; 6 + 52&#x2F;n;</span><br><span class="line">        sum &#x3D; rounds*DELTA;</span><br><span class="line">        y &#x3D; v[0];</span><br><span class="line">        do</span><br><span class="line">        &#123;</span><br><span class="line">            e &#x3D; (sum &gt;&gt; 2) &amp; 3;</span><br><span class="line">            for (p&#x3D;n-1; p&gt;0; p--)</span><br><span class="line">            &#123;</span><br><span class="line">                z &#x3D; v[p-1];</span><br><span class="line">                y &#x3D; v[p] -&#x3D; MX;</span><br><span class="line">            &#125;</span><br><span class="line">            z &#x3D; v[n-1];</span><br><span class="line">            y &#x3D; v[0] -&#x3D; MX;</span><br><span class="line">            sum -&#x3D; DELTA;</span><br><span class="line">        &#125;</span><br><span class="line">        while (--rounds);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    uint32_t v[2]&#x3D; &#123;1,2&#125;;</span><br><span class="line">    uint32_t const k[4]&#x3D; &#123;2,2,3,4&#125;;</span><br><span class="line">    int n&#x3D; 2; &#x2F;&#x2F;n的绝对值表示v的长度，取正表示加密，取负表示解密</span><br><span class="line">    &#x2F;&#x2F; v为要加密的数据是两个32位无符号整数</span><br><span class="line">    &#x2F;&#x2F; k为加密解密密钥，为4个32位无符号整数，即密钥长度为128位</span><br><span class="line">    printf(&quot;加密前原始数据：%u %u\n&quot;,v[0],v[1]);</span><br><span class="line">    btea(v, n, k);</span><br><span class="line">    printf(&quot;加密后的数据：%u %u\n&quot;,v[0],v[1]);</span><br><span class="line">    btea(v, -n, k);</span><br><span class="line">    printf(&quot;解密后的数据：%u %u\n&quot;,v[0],v[1]);</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>执行结果：</p><blockquote><p>加密前原始数据：1 2<br>加密后的数据：3238569099 2059193138<br>解密后的数据：1 2</p><p>Process returned 0 (0x0)   execution time : 0.369 s<br>Press any key to continue.</p></blockquote><h2 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h2><h3 id="tea"><a href="#tea" class="headerlink" title="tea"></a>tea</h3><p><a href="https://pan.baidu.com/s/1jZogTyTC3aKMmBO9DyaEgg">附件链接</a> 提取码：0000<br><img src="/2021/03/20/%E5%96%9D%E8%8C%B6%E5%90%97/tea1.png"></p><p><img src="/2021/03/20/%E5%96%9D%E8%8C%B6%E5%90%97/tea2.png"></p><p><img src="/2021/03/20/%E5%96%9D%E8%8C%B6%E5%90%97/tea3.PNG"></p><p>脚本：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdint.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line"></span><br><span class="line">void decrypt (uint32_t* v, uint32_t* k, int n)</span><br><span class="line">&#123;</span><br><span class="line">int j;</span><br><span class="line">    for(j&#x3D;0;j&lt;n;j+&#x3D;2)</span><br><span class="line">    &#123;</span><br><span class="line">        uint32_t v0&#x3D;v[j], v1&#x3D;v[j+1], sum&#x3D;0xC6EF3720, i;  &#x2F;* set up *&#x2F;</span><br><span class="line">        uint32_t delta&#x3D;0x9e3779b9;                     &#x2F;* a key schedule constant *&#x2F;</span><br><span class="line">        uint32_t k0&#x3D;k[0], k1&#x3D;k[1], k2&#x3D;k[2], k3&#x3D;k[3];   &#x2F;* cache key *&#x2F;</span><br><span class="line">        for (i&#x3D;0; i&lt;32; i++)</span><br><span class="line">        &#123;                         &#x2F;* basic cycle start *&#x2F;</span><br><span class="line">            v1 -&#x3D; ((v0&lt;&lt;4) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;5) + k3);</span><br><span class="line">        v0 -&#x3D; ((v1&lt;&lt;4) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;5) + k1);</span><br><span class="line">            sum -&#x3D; delta;</span><br><span class="line">        &#125;                                              &#x2F;* end cycle *&#x2F;</span><br><span class="line">        v[j]&#x3D;v0; v[j+1]&#x3D;v1;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">unsigned int </span><br><span class="line">data[24]&#x3D;&#123;0xdd970cc4,0x818d6166,0xb47035f4,0xd099de74,0xb50c0b58,0x2cecb013,</span><br><span class="line">0x20ca556f,0x35301e68,0x457b62b2,0x91926c85,0xe15a695a,0x2e550212,0xdd0426e,0x839dc37,0x</span><br><span class="line">ba150ea0,</span><br><span class="line">0x2aad9fd7,0x6889d7e2,0x82f201d7,0x3374d877,0x2e17ed88,0x35196e88,0x236ab4b9,0x75c5e88,0</span><br><span class="line">xdb68bf4b&#125;;</span><br><span class="line">int i;</span><br><span class="line">unsigned int k[4]&#x3D;&#123;2,2,3,4&#125;;</span><br><span class="line">int n&#x3D;24;</span><br><span class="line">decrypt(data, k,n);</span><br><span class="line">for(i&#x3D;0;i&lt;n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        printf(&quot;%c&quot;,data[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>flag{YOU_FIND_THE_FLAG!}</p></blockquote><h3 id="xtea"><a href="#xtea" class="headerlink" title="xtea"></a>xtea</h3><p><a href="https://pan.baidu.com/s/1bAgbw0TAJMC_5uWO_UwqIQ">附件链接</a> 提取码：0000<br><img src="/2021/03/20/%E5%96%9D%E8%8C%B6%E5%90%97/xtea1.png"></p><p><img src="/2021/03/20/%E5%96%9D%E8%8C%B6%E5%90%97/xtea2.png"></p><p><img src="/2021/03/20/%E5%96%9D%E8%8C%B6%E5%90%97/xtea3.PNG"></p><p>脚本：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdint.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line"></span><br><span class="line">void decipher(uint32_t v[2], uint32_t const key[4], int n)</span><br><span class="line">&#123;</span><br><span class="line">    unsigned int i;</span><br><span class="line">    int num_rounds&#x3D;32;</span><br><span class="line">    int j;</span><br><span class="line">    for(j&#x3D;0;j&lt;n;j+&#x3D;2)</span><br><span class="line">    &#123;</span><br><span class="line">        uint32_t v0&#x3D;v[j], v1&#x3D;v[j+1], delta&#x3D;0x9E3779B9, sum&#x3D;delta*num_rounds;</span><br><span class="line">        for (i&#x3D;0; i &lt; num_rounds; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            v1 -&#x3D; (((v0 &lt;&lt; 4) ^ (v0 &gt;&gt; 5)) + v0) ^ (sum + key[(sum&gt;&gt;11) &amp; 3]);</span><br><span class="line">            sum -&#x3D; delta;</span><br><span class="line">            v0 -&#x3D; (((v1 &lt;&lt; 4) ^ (v1 &gt;&gt; 5)) + v1) ^ (sum + key[sum &amp; 3]);</span><br><span class="line">        &#125;</span><br><span class="line">        v[j]&#x3D;v0; v[j+1]&#x3D;v1;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">unsigned int data[26]&#x3D;&#123;0x27275d99,0x3c11048b,0x467297e3,0xc09af6b8,0xed74946a,0x2f994350,</span><br><span class="line">    0xf045f43e,0x81b107b8,0x899a9e3,0x2bc3d1b6,0x6f738cdb,0xfd9b7c7c,0xe52275fe,0x21586050,</span><br><span class="line">    0x6bd3d095,0xc1edbe2f,0x6f1f00b1,0x1613f009,0x6109db9,0xfef136d2,0x98dd74f9,0x750a3393,</span><br><span class="line">    0xb93cc79c,0x35df2918,0xba1f4f1c,0x5936c0c8&#125;;</span><br><span class="line"></span><br><span class="line">int i;</span><br><span class="line">unsigned int k[4]&#x3D;&#123;1,2,3,4&#125;;</span><br><span class="line">int n&#x3D;26;</span><br><span class="line">decipher(data, k, n);</span><br><span class="line">for(i&#x3D;0;i&lt;n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        printf(&quot;%c&quot;,data[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>flag{luoyu-1224.github.io}</p></blockquote><h3 id="xxtea"><a href="#xxtea" class="headerlink" title="xxtea"></a>xxtea</h3><p><a href="https://pan.baidu.com/s/1Kd_G9dwbLA7vP5yolYECaA">附件链接</a> 提取码：0000<br><img src="/2021/03/20/%E5%96%9D%E8%8C%B6%E5%90%97/xxtea2.png"></p><p><img src="/2021/03/20/%E5%96%9D%E8%8C%B6%E5%90%97/xxtea1.png"></p><p><img src="/2021/03/20/%E5%96%9D%E8%8C%B6%E5%90%97/xxtea3.PNG"></p><p>脚本：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">#define MX (z&gt;&gt;5^y&lt;&lt;2) + (y&gt;&gt;3^z&lt;&lt;4)^(sum^y) + (k[p&amp;3^e]^z);</span><br><span class="line"></span><br><span class="line">int check[26]&#x3D;&#123;0xecc7f567,0xecc3d63f,0xfd046ee,0x4231e0b8,0x2aa73061,0x376a03f2,</span><br><span class="line">0xef400f49,0x78b22f96,0x3c80565a,0x53cf31ae,0x1bf54a05,0x43ac56f8,0xeb92b3fd,0xd4abe89b,</span><br><span class="line">0xfd3b88db,0x6c65b706,0xbe48072b,0x3e445861,0x247e6144,0x79b5a5af,0x3e42487b,0x2ac44245,</span><br><span class="line">0x15e908f0,0x120e8173,0x69fea947,0x70917ef7&#125;;</span><br><span class="line"></span><br><span class="line">int btea(int* v, int n, unsigned int k[4])       </span><br><span class="line">&#123;</span><br><span class="line">    unsigned int z&#x3D;v[n-1], y&#x3D;v[0], sum&#x3D;0, e, DELTA&#x3D;0x9e3779b9;</span><br><span class="line">int p, q ;</span><br><span class="line">    if (n &gt; 1) </span><br><span class="line">&#123;</span><br><span class="line">    &#x2F;* 加密过程 *&#x2F;</span><br><span class="line">        q &#x3D; 6 + 52&#x2F;n;</span><br><span class="line">        while (q-- &gt; 0)</span><br><span class="line">        &#123;</span><br><span class="line">    sum +&#x3D; DELTA;</span><br><span class="line">e &#x3D; (sum &gt;&gt; 2) &amp; 3;</span><br><span class="line">            for (p&#x3D;0; p&lt;n-1; p++)</span><br><span class="line">&#123;</span><br><span class="line">y &#x3D; v[p+1];</span><br><span class="line">z &#x3D; v[p] +&#x3D; MX;</span><br><span class="line">&#125;</span><br><span class="line">            y &#x3D; v[0];</span><br><span class="line">z &#x3D; v[n-1] +&#x3D; MX;</span><br><span class="line">&#125;</span><br><span class="line">        return 0 ;</span><br><span class="line">    &#125;</span><br><span class="line">else if (n &lt; -1) </span><br><span class="line">&#123;</span><br><span class="line">    &#x2F;* 解密过程 *&#x2F;</span><br><span class="line">        n &#x3D; -n;</span><br><span class="line">q &#x3D; 6 + 52&#x2F;n;</span><br><span class="line">sum &#x3D; q*DELTA ;</span><br><span class="line">        while (sum !&#x3D; 0)</span><br><span class="line">&#123;</span><br><span class="line">    e &#x3D; (sum &gt;&gt; 2) &amp; 3;</span><br><span class="line">            for (p&#x3D;n-1; p&gt;0; p--) </span><br><span class="line">&#123;</span><br><span class="line">z &#x3D; v[p-1];</span><br><span class="line">y &#x3D; v[p] -&#x3D; MX;</span><br><span class="line">&#125;</span><br><span class="line">            z &#x3D; v[n-1]; </span><br><span class="line">y &#x3D; v[0] -&#x3D; MX;</span><br><span class="line">sum -&#x3D; DELTA; </span><br><span class="line">&#125;</span><br><span class="line">        return 0; </span><br><span class="line">&#125;  </span><br><span class="line">return 1; </span><br><span class="line">&#125;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">unsigned int k[4]&#x3D;&#123;1,2,3,4&#125;;</span><br><span class="line">int n&#x3D;26;</span><br><span class="line">btea(check, -n, k);</span><br><span class="line">int i;</span><br><span class="line">for(i&#x3D;0;i&lt;35;i++)</span><br><span class="line">&#123;</span><br><span class="line">    printf(&quot;%c&quot;,check[i]);</span><br><span class="line">&#125;</span><br><span class="line"> &#125; </span><br></pre></td></tr></table></figure><blockquote><p>flag{xxtea_is_interesting}</p></blockquote>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>base64在逆向中的应用</title>
      <link href="2021/03/20/base64%E5%9C%A8%E9%80%86%E5%90%91%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8/"/>
      <url>2021/03/20/base64%E5%9C%A8%E9%80%86%E5%90%91%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="base64的原理和C语言实现"><a href="#base64的原理和C语言实现" class="headerlink" title="base64的原理和C语言实现"></a>base64的原理和C语言实现</h1><a id="more"></a><p>原理参考此篇文章 <a href="https://blog.csdn.net/wo541075754/article/details/81734770">链接</a></p><p>C语言代码实现</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">#include&lt;stdio.h&gt;</span><br><span class="line">#include&lt;stdlib.h&gt;</span><br><span class="line">#include&lt;math.h&gt;</span><br><span class="line">#include&lt;string.h&gt;</span><br><span class="line"></span><br><span class="line">char table[65]&#x3D;&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+&#x2F;&quot;;</span><br><span class="line">char padding_char&#x3D;&#39;&#x3D;&#39;;</span><br><span class="line"></span><br><span class="line">int findchr(char *array,char ch)&#123;</span><br><span class="line">    for(int i&#x3D;0;i&lt;strlen(array);i++)&#123;</span><br><span class="line">        if(array[i]&#x3D;&#x3D;ch)&#123;</span><br><span class="line">            return i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void base64_encode(char *src,char *result)&#123;</span><br><span class="line">    int fill_bit&#x3D;0;</span><br><span class="line">    int data_length;</span><br><span class="line">    int result_length;</span><br><span class="line">    int index;</span><br><span class="line">    _Bool full&#x3D;trunc;</span><br><span class="line">    data_length&#x3D;strlen(src);</span><br><span class="line">    &#x2F;&#x2F;printf(&quot;length:%d\n&quot;,data_length);</span><br><span class="line">    fill_bit&#x3D;((3-strlen(src)%3)%3); &#x2F;&#x2F;计算未满字节，注意除去3的情况</span><br><span class="line">    for(int k&#x3D;0;k&lt;fill_bit;k++)&#123;</span><br><span class="line">        src[data_length+k]&#x3D;&#39;\0&#39;;</span><br><span class="line">    &#125;</span><br><span class="line">    int j&#x3D;0;</span><br><span class="line">    for(int i&#x3D;0;i&lt;data_length;i+&#x3D;3)&#123;</span><br><span class="line">        index&#x3D;src[i]&gt;&gt;2;</span><br><span class="line">        result[j++]&#x3D;table[index];</span><br><span class="line">        index&#x3D;((src[i]&amp;3)&lt;&lt;4)+(src[i+1]&gt;&gt;4);</span><br><span class="line">        result[j++]&#x3D;table[index];</span><br><span class="line">        index&#x3D;((src[i+1]&amp;15)&lt;&lt;2)+(src[i+2]&gt;&gt;6);</span><br><span class="line">        result[j++]&#x3D;table[index];</span><br><span class="line">        index&#x3D;(src[i+2]&amp;63);</span><br><span class="line">        result[j++]&#x3D;table[index];</span><br><span class="line">        &#x2F;&#x2F;&lt;&lt; &gt;&gt; 运算符的优先级低于+ -，注意加括号</span><br><span class="line">    &#125;</span><br><span class="line">    result_length&#x3D;strlen(result);</span><br><span class="line">    for(int k&#x3D;0;k&lt;fill_bit;k++)&#123;</span><br><span class="line">        result[result_length-1-k]&#x3D;padding_char; &#x2F;&#x2F;把多余的A字符替换为&#x3D;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void base64_decode(char *src,char *result)&#123;</span><br><span class="line">    int base_len;</span><br><span class="line">    int j&#x3D;0;</span><br><span class="line">    base_len&#x3D;strlen(src);</span><br><span class="line">    &#x2F;&#x2F;printf(&quot;length:%d\n&quot;,base_len);</span><br><span class="line">    for(int i&#x3D;0;i&lt;base_len;i++)&#123;</span><br><span class="line">        if(src[i]&#x3D;&#x3D;padding_char)</span><br><span class="line">            src[i]&#x3D;&#39;A&#39;;</span><br><span class="line">    &#125;</span><br><span class="line">    &#x2F;&#x2F;printf(&quot;%s\n&quot;,src);</span><br><span class="line">    for(int i&#x3D;0;i&lt;base_len;i+&#x3D;4)&#123;</span><br><span class="line">        result[j++]&#x3D;(findchr(table,src[i])&lt;&lt;2)+(findchr(table,src[i+1])&gt;&gt;4);</span><br><span class="line">        result[j++]&#x3D;(findchr(table,src[i+1])&lt;&lt;4)+(findchr(table,src[i+2])&gt;&gt;2);</span><br><span class="line">        result[j++]&#x3D;((findchr(table,src[i+2])&amp;3)&lt;&lt;6)+(findchr(table,src[i+3]));</span><br><span class="line">        &#x2F;&#x2F;注意编码是table对应的编码，不是原来的ascii码</span><br><span class="line">        &#x2F;&#x2F;按位运算符优先级低于位移运算符，注意括号</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int main()&#123;</span><br><span class="line">    char words[100]&#x3D;&quot;abc&quot;;</span><br><span class="line">    char en_words[100]&#x3D;&quot;&quot;;</span><br><span class="line">    char de_words[100]&#x3D;&quot;&quot;;</span><br><span class="line">    base64_encode(words,en_words);</span><br><span class="line">    printf(&quot;encode:%s\n&quot;,en_words);</span><br><span class="line">    base64_decode(en_words,de_words);</span><br><span class="line">    printf(&quot;decode:%s\n&quot;,de_words);</span><br><span class="line">    return 0;</span><br><span class="line">    &#x2F;&#x2F;摘抄于https:&#x2F;&#x2F;eqqie.cn&#x2F;index.php&#x2F;laji_note&#x2F;785&#x2F;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="base64在逆向中的应用"><a href="#base64在逆向中的应用" class="headerlink" title="base64在逆向中的应用"></a>base64在逆向中的应用</h1><h2 id="1-直接使用"><a href="#1-直接使用" class="headerlink" title="1.直接使用"></a>1.直接使用</h2><h3 id="flag为解密结果"><a href="#flag为解密结果" class="headerlink" title="flag为解密结果"></a>flag为解密结果</h3><p><a href="https://pan.baidu.com/s/1OekeF05h-IkH_16UZOaXQQ">附件链接</a> 提取码：0000<br><img src="/2021/03/20/base64%E5%9C%A8%E9%80%86%E5%90%91%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8/1.PNG"></p><p>图中的flag为ZmxhZ3t5b3VfZ2V0X2l0fQ==，经base64解码得</p><blockquote><p>flag{you_get_it}</p></blockquote><h3 id="flag为加密结果"><a href="#flag为加密结果" class="headerlink" title="flag为加密结果"></a>flag为加密结果</h3><p><a href="https://pan.baidu.com/s/15KN694_td7Ds7xKnp8ussw">附件链接</a> 提取码：0000<br><img src="/2021/03/20/base64%E5%9C%A8%E9%80%86%E5%90%91%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8/2.PNG"></p><p>图中的str也是ZmxhZ3t5b3VfZ2V0X2l0fQ==，经base64加密得</p><blockquote><p>flag：Wm14aFozdDViM1ZmWjJWMFgybDBmUT09</p></blockquote><h3 id="如何判断是加密还是解密"><a href="#如何判断是加密还是解密" class="headerlink" title="如何判断是加密还是解密"></a>如何判断是加密还是解密</h3><p>我们可以观察一下密码函数</p><blockquote><p>加密<br><img src="/2021/03/20/base64%E5%9C%A8%E9%80%86%E5%90%91%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8/3.PNG"><br>解密<br><img src="/2021/03/20/base64%E5%9C%A8%E9%80%86%E5%90%91%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8/4.PNG"></p></blockquote><p>可以发现，加密函数下有一个padding_char，点进去是一个‘=’，那这就是加密函数。<br>或者有‘&amp; 3’‘&amp; 0xf’‘&amp; 0x3f’‘= 61’,也是加密函数。<br>遇到此类题目时，大多数加密的。懒得分析也可以都试试，这也就是一会儿的时间。<br>最后的那个判断还可以和异或联系，注意一下就行，这里便不再举例，<br>下面的类型我只说加密，加密和解密的思路都是一样的。</p><h2 id="2-变化字母表"><a href="#2-变化字母表" class="headerlink" title="2.变化字母表"></a>2.变化字母表</h2><p>将base64原来的字母表改变顺序、位置得到新的加密结果。<br>有两种变化方式：1.直接改变；2.用函数改变</p><h3 id="直接改变"><a href="#直接改变" class="headerlink" title="直接改变"></a>直接改变</h3><p><a href="https://pan.baidu.com/s/1mE75zgqcVl2guLosEEiNwQ">附件链接</a> 提取码：0000<br><img src="/2021/03/20/base64%E5%9C%A8%E9%80%86%E5%90%91%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8/5.PNG"></p><p><img src="/2021/03/20/base64%E5%9C%A8%E9%80%86%E5%90%91%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8/6.PNG"></p><p>这一题的字母表改为了’0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ+/‘，根据这个字母表和原版字母表的差别，将密文修改为正确的密文。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">char a[]&#x3D;&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+&#x2F;&quot;;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">char b[]&#x3D;&quot;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ+&#x2F;&quot;;</span><br><span class="line">    char c[]&#x3D;&quot;pCNxpTJkq6AAnSAAnSpIg6tZ&quot;;</span><br><span class="line">    int i,j;</span><br><span class="line">    for(i&#x3D;0;i&lt;strlen(c);i++)</span><br><span class="line">    &#123;</span><br><span class="line">        for(j&#x3D;0;j&lt;strlen(a);j++)</span><br><span class="line">        &#123;</span><br><span class="line">            if(b[j]&#x3D;&#x3D;c[i])</span><br><span class="line">            &#123;</span><br><span class="line">                c[i]&#x3D;a[j];</span><br><span class="line">                break;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    for(i&#x3D;0;i&lt;strlen(c);i++)</span><br><span class="line">    &#123;</span><br><span class="line">        printf(&quot;%c&quot;,c[i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;Thi$_i$_fl@g&#125;</span><br></pre></td></tr></table></figure><h3 id="用函数改变"><a href="#用函数改变" class="headerlink" title="用函数改变"></a>用函数改变</h3><p><a href="https://pan.baidu.com/s/1VpBPqjboo7Wm5yQCXZO1JA">附件链接</a> 提取码：0000<br>这个是调用一个外部函数改变密码表的顺序。</p><p><img src="/2021/03/20/base64%E5%9C%A8%E9%80%86%E5%90%91%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8/7.PNG"></p><p><img src="/2021/03/20/base64%E5%9C%A8%E9%80%86%E5%90%91%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8/8.PNG"></p><p>这种方式比直接改变复杂了一点点。但也不难。<br>这里用了两次waaaagh函数，另一次再base64_encode里，没有显示。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">char a[]&#x3D;&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+&#x2F;&quot;;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">char b[]&#x3D;&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+&#x2F;&quot;;</span><br><span class="line">    char c[]&#x3D;&quot;tSdNt3ZouGQQr2QQr2tYkGx9&quot;;</span><br><span class="line">    int i,j;</span><br><span class="line">    int n&#x3D;10;</span><br><span class="line">char ch;</span><br><span class="line">while(n&lt;40)</span><br><span class="line">&#123;</span><br><span class="line">ch&#x3D;b[n];</span><br><span class="line">b[n]&#x3D;b[n+10];</span><br><span class="line">b[n+10]&#x3D;ch;</span><br><span class="line">n++;</span><br><span class="line">&#125;</span><br><span class="line">n&#x3D;10;</span><br><span class="line">while(n&lt;40)</span><br><span class="line">&#123;</span><br><span class="line">ch&#x3D;b[n];</span><br><span class="line">b[n]&#x3D;b[n+10];</span><br><span class="line">b[n+10]&#x3D;ch;</span><br><span class="line">n++;</span><br><span class="line">&#125;</span><br><span class="line">    for(i&#x3D;0;i&lt;strlen(c);i++)</span><br><span class="line">    &#123;</span><br><span class="line">        for(j&#x3D;0;j&lt;strlen(a);j++)</span><br><span class="line">        &#123;</span><br><span class="line">            if(b[j]&#x3D;&#x3D;c[i])</span><br><span class="line">            &#123;</span><br><span class="line">                c[i]&#x3D;a[j];</span><br><span class="line">                break;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    for(i&#x3D;0;i&lt;strlen(c);i++)</span><br><span class="line">    &#123;</span><br><span class="line">        printf(&quot;%c&quot;,c[i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;Thi$_i$_fl@g&#125;</span><br></pre></td></tr></table></figure><h1 id="buuctf"><a href="#buuctf" class="headerlink" title="buuctf"></a>buuctf</h1><h2 id="level3"><a href="#level3" class="headerlink" title="level3"></a>level3</h2><p><a href="https://buuoj.cn/challenges#[WUSTCTF2020]level3">题目链接</a><br><img src="/2021/03/20/base64%E5%9C%A8%E9%80%86%E5%90%91%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8/9.PNG"></p><p><img src="/2021/03/20/base64%E5%9C%A8%E9%80%86%E5%90%91%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8/10.PNG"></p><p>和上面的那题差不多。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">int i,j,v0,result;</span><br><span class="line">char ch[]&#x3D;&quot;d2G0ZjLwHjS7DmOzZAY0X2lzX3CoZV9zdNOydO9vZl9yZXZlcnGlfD&#x3D;&#x3D;&quot;;</span><br><span class="line">char base64_table[]&#x3D;&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+&#x2F;&quot;;</span><br><span class="line">char base64_table1[]&#x3D;&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+&#x2F;&quot;;</span><br><span class="line"> for ( i &#x3D; 0; i &lt;&#x3D; 9; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">    v0 &#x3D; base64_table[i];</span><br><span class="line">    base64_table[i] &#x3D; base64_table[19 - i];</span><br><span class="line">    result &#x3D; 19 - i;</span><br><span class="line">    base64_table[result] &#x3D; v0;</span><br><span class="line">    &#125;</span><br><span class="line">for(i&#x3D;0;i&lt;strlen(ch);i++)</span><br><span class="line">    &#123;</span><br><span class="line">        for(j&#x3D;0;j&lt;strlen(base64_table1);j++)</span><br><span class="line">        &#123;</span><br><span class="line">            if(base64_table[j]&#x3D;&#x3D;ch[i])</span><br><span class="line">            &#123;</span><br><span class="line">                ch[i]&#x3D;base64_table1[j];</span><br><span class="line">                break;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    for(i&#x3D;0;i&lt;strlen(ch);i++)</span><br><span class="line">    &#123;</span><br><span class="line">        printf(&quot;%c&quot;,ch[i]);</span><br><span class="line">    &#125;</span><br><span class="line">return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>flag{Base64_is_the_start_of_reverse}</p></blockquote><h2 id="usualCrypt"><a href="#usualCrypt" class="headerlink" title="usualCrypt"></a>usualCrypt</h2><p><a href="https://buuoj.cn/challenges#[ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020]usualCrypt">题目链接</a><br><img src="/2021/03/20/base64%E5%9C%A8%E9%80%86%E5%90%91%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8/11.PNG"></p><p><img src="/2021/03/20/base64%E5%9C%A8%E9%80%86%E5%90%91%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8/12.PNG"></p><p><img src="/2021/03/20/base64%E5%9C%A8%E9%80%86%E5%90%91%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8/13.PNG"></p><p><img src="/2021/03/20/base64%E5%9C%A8%E9%80%86%E5%90%91%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8/14.PNG"></p><p>这一题除了字母表的变化，还将密文的字母大小写交换了</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">char a[]&#x3D;&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+&#x2F;&quot;;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">char b[]&#x3D;&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+&#x2F;&quot;;</span><br><span class="line">    char c[]&#x3D;&quot;zMXHz3TIgnxLxJhFAdtZn2fFk3lYCrtPC2l9&quot;;</span><br><span class="line">    int i,j,v1;</span><br><span class="line">    int result &#x3D; 6;</span><br><span class="line">    for (i&#x3D;0;i&lt;strlen(c);i++)</span><br><span class="line">    &#123;</span><br><span class="line">    if ( c[i] &gt;&#x3D; &#39;a&#39; &amp;&amp; c[i] &lt;&#x3D; &#39;z&#39; )</span><br><span class="line">    &#123;</span><br><span class="line">        c[i] -&#x3D; 32;</span><br><span class="line">    &#125;</span><br><span class="line">      else if ( c[i] &gt;&#x3D; &#39;A&#39; &amp;&amp; c[i] &lt;&#x3D; &#39;Z&#39; )</span><br><span class="line">      &#123;</span><br><span class="line">        c[i] +&#x3D; 32;</span><br><span class="line">      &#125;</span><br><span class="line">      else</span><br><span class="line">      &#123;</span><br><span class="line">      c[i] &#x3D; c[i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">  do</span><br><span class="line">  &#123;</span><br><span class="line">    v1 &#x3D; b[result+10];</span><br><span class="line">    b[result+10] &#x3D; b[result];</span><br><span class="line">    b[result++] &#x3D; v1;</span><br><span class="line">  &#125;</span><br><span class="line">  while ( result &lt; 15 );</span><br><span class="line">    for(i&#x3D;0;i&lt;strlen(c);i++)</span><br><span class="line">    &#123;</span><br><span class="line">        for(j&#x3D;0;j&lt;strlen(a);j++)</span><br><span class="line">        &#123;</span><br><span class="line">            if(b[j]&#x3D;&#x3D;c[i])</span><br><span class="line">            &#123;</span><br><span class="line">                c[i]&#x3D;a[j];</span><br><span class="line">                break;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    for(i&#x3D;0;i&lt;strlen(c);i++)</span><br><span class="line">    &#123;</span><br><span class="line">        printf(&quot;%c&quot;,c[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>flag{bAse64_h2s_a_Surprise}</p></blockquote>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Jarvis OJ</title>
      <link href="2021/03/03/Jarvis-OJ/"/>
      <url>2021/03/03/Jarvis-OJ/</url>
      
        <content type="html"><![CDATA[<h1 id="stheasy"><a href="#stheasy" class="headerlink" title="stheasy"></a>stheasy</h1><a id="more"></a><p><a href="https://pan.baidu.com/s/1Ev7oxqScoIAP5-pb_ZKxdw">附件链接</a> 提取码：0000<br>放入ida32中，进入main函数。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">int __cdecl main()</span><br><span class="line">&#123;</span><br><span class="line">  char s; &#x2F;&#x2F; [esp+10h] [ebp-110h]</span><br><span class="line"></span><br><span class="line">  printf(&quot;Input flag:&quot;);</span><br><span class="line">  sub_80485A0(&amp;s, 0x100u);</span><br><span class="line">  if ( sub_8048630(&amp;s) )</span><br><span class="line">    puts(&quot;Flag is right.&quot;);</span><br><span class="line">  else</span><br><span class="line">    puts(&quot;Flag is wrong.&quot;);</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>查看sub_8048630</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">int __cdecl sub_8048630(char *s)</span><br><span class="line">&#123;</span><br><span class="line">  size_t v1; &#x2F;&#x2F; eax</span><br><span class="line">  int v3; &#x2F;&#x2F; edx</span><br><span class="line"></span><br><span class="line">  if ( s )</span><br><span class="line">  &#123;</span><br><span class="line">    v1 &#x3D; strlen(s);</span><br><span class="line">    if ( v1 )</span><br><span class="line">    &#123;</span><br><span class="line">      if ( v1 &#x3D;&#x3D; 29 )</span><br><span class="line">      &#123;</span><br><span class="line">        v3 &#x3D; 0;</span><br><span class="line">        while ( s[v3] &#x3D;&#x3D; stru_8049AE0[(stru_8049B15[v3] &#x2F; 3u - 2)] )</span><br><span class="line">        &#123;</span><br><span class="line">          if ( ++v3 &#x3D;&#x3D; 29 )</span><br><span class="line">            return 1;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>我们需要返回值为1，判断相等就行了。<br>脚本：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    int i;</span><br><span class="line">    int a[29]&#x3D;&#123;0x48,0x5D,0x8D,0x24,0x84,0x27,0x99,0x9F,0x54,0x18,0x1E,</span><br><span class="line">0x69,0x7E,0x33,0x15,0x72,0x8D,0x33,0x24,0x63,0x21,0x54,0x0C,0x78,</span><br><span class="line">0x78,0x78,0x78,0x78,0x1B&#125;;</span><br><span class="line">char b[]&#x3D;&quot;lk2j9Gh&#125;AgfY4ds-a6QW1#k5ER_T[cvLbV7nOm3ZeX&#123;CMt8SZo]U&quot;;</span><br><span class="line">int flag[29];</span><br><span class="line">    for(i&#x3D;0;i&lt;29;i++)</span><br><span class="line">    &#123;</span><br><span class="line">    flag[i]&#x3D;b[(a[i]&#x2F;3-2)];</span><br><span class="line">    if(flag[i]&lt;0)</span><br><span class="line">        flag[i]+&#x3D;128;</span><br><span class="line">    printf(&quot;%c&quot;,flag[i]);</span><br><span class="line">&#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>kctf{YoU_hAVe-GOt-fLg_233333}</p></blockquote><h1 id="FindKey"><a href="#FindKey" class="headerlink" title="FindKey"></a>FindKey</h1><p><a href="https://pan.baidu.com/s/1p4533RDCl_ba51tAAZGe0g">附件链接</a> 提取码：0000<br>这是一个pyc文件，将后缀改为pyc即可反编译。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">lookup &#x3D; [196,153, 149,206, 17,221, 10, 217, 167, 18, 36, 135, 103, 61, 111, 31, 92, 152, </span><br><span class="line">21, 228, 105, 191, 173, 41, 2, 245, 23, 144, 1, 246, 89, 178, 182, 119, 38, 85, 48, 226, </span><br><span class="line">165, 241, 166, 214, 71, 90, 151, 3, 109, 169, 150, 224, 69, 156, 158, 57, 181, 29, 200, 37, </span><br><span class="line">51, 252, 227, 93, 65, 82, 66, 80, 170, 77, 49, 177, 81, 94, 202, 107, 25, 73, 148, 98, 129, </span><br><span class="line">231, 212, 14, 84, 121, 174, 171, 64, 180, 233, 74, 140, 242, 75, 104, 253, 44, 39, 87, 86, </span><br><span class="line">27, 68, 22, 55, 76, 35, 248, 96, 5, 56, 20, 161, 213, 238, 220, 72, 100, 247, 8, 63, 249, </span><br><span class="line">145, 243, 155, 222, 122, 32, 43, 186, 0, 102, 216, 126, 15, 42, 115, 138, 240, 147, 229, </span><br><span class="line">204, 117, 223, 141, 159, 131, 232, 124, 254, 60, 116, 46, 113, 79, 16, 128, 6, 251, 40, </span><br><span class="line">205, 137, 199, 83, 54, 188, 19, 184, 201, 110, 255, 26, 91, 211, 132, 160, 168, 154, 185, </span><br><span class="line">183, 244, 78, 33, 123, 28, 59, 12, 210, 218, 47, 163, 215, 209, 108, 235, 237, 118, 101, </span><br><span class="line">24, 234, 106, 143, 88, 9, 136, 95, 30, 193, 176, 225, 198, 197, 194, 239, 134, 162, 192, </span><br><span class="line">11, 70, 58, 187, 50, 67, 236, 230, 13, 99, 190, 208, 207, 7, 53, 219, 203, 62, 114, 127, </span><br><span class="line">125, 164, 179, 175, 112, 172, 250, 133, 130, 52, 189, 97, 146, 34, 157, 120, 195, 45, 4, </span><br><span class="line">142, 139]</span><br><span class="line">pwda &#x3D; [188,155,11,58,251,208,204,202,150,120,206,237,114,92,126,6,42]</span><br><span class="line">pwdb &#x3D; [53,222,230,35,67,248,226,216,17,209,32,2,181,200,171,60,108]</span><br><span class="line">flag &#x3D; raw_input(&#39;Input your Key:&#39;).strip()</span><br><span class="line">if len(flag) !&#x3D; 17:</span><br><span class="line">    print &#39;Wrong Key!!&#39;</span><br><span class="line">    sys.exit(1)</span><br><span class="line">flag &#x3D; flag[::-1]</span><br><span class="line">for i in range(0, len(flag)):</span><br><span class="line">    if ord(flag[i]) + pwda[i] &amp; 255 !&#x3D; lookup[i + pwdb[i]]:</span><br><span class="line">        print &#39;Wrong Key!!&#39;</span><br><span class="line">        sys.exit(1)</span><br><span class="line"></span><br><span class="line">print &#39;Congratulations!!&#39;</span><br></pre></td></tr></table></figure><p>这里就是计算+倒序。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    int i;</span><br><span class="line">    int a[]&#x3D;&#123;196,153, 149,206, 17,221, 10, 217, 167, 18, 36, 135, 103, 61, 111, 31, 92, 152, </span><br><span class="line">    21, 228, 105, 191, 173, 41, 2, 245, 23, 144, 1, 246, 89, 178, 182, 119, 38, 85, 48, 226, </span><br><span class="line">    165, 241, 166, 214, 71, 90, 151, 3, 109, 169, 150, 224, 69, 156, 158, 57, 181, 29, 200, 37, </span><br><span class="line">    51, 252, 227, 93, 65, 82, 66, 80, 170, 77, 49, 177, 81, 94, 202, 107, 25, 73, 148, 98, 129, </span><br><span class="line">    231, 212, 14, 84, 121, 174, 171, 64, 180, 233, 74, 140, 242, 75, 104, 253, 44, 39, 87, 86, </span><br><span class="line">    27, 68, 22, 55, 76, 35, 248, 96, 5, 56, 20, 161, 213, 238, 220, 72, 100, 247, 8, 63, 249, </span><br><span class="line">    145, 243, 155, 222, 122, 32, 43, 186, 0, 102, 216, 126, 15, 42, 115, 138, 240, 147, 229, </span><br><span class="line">    204, 117, 223, 141, 159, 131, 232, 124, 254, 60, 116, 46, 113, 79, 16, 128, 6, 251, 40, </span><br><span class="line">    205, 137, 199, 83, 54, 188, 19, 184, 201, 110, 255, 26, 91, 211, 132, 160, 168, 154, 185, </span><br><span class="line">    183, 244, 78, 33, 123, 28, 59, 12, 210, 218, 47, 163, 215, 209, 108, 235, 237, 118, 101, </span><br><span class="line">    24, 234, 106, 143, 88, 9, 136, 95, 30, 193, 176, 225, 198, 197, 194, 239, 134, 162, 192, </span><br><span class="line">    11, 70, 58, 187, 50, 67, 236, 230, 13, 99, 190, 208, 207, 7, 53, 219, 203, 62, 114, 127, </span><br><span class="line">    125, 164, 179, 175, 112, 172, 250, 133, 130, 52, 189, 97, 146, 34, 157, 120, 195, 45, 4, </span><br><span class="line">    142, 139&#125;;</span><br><span class="line">    int b[]&#x3D;&#123;188,155,11,58,251,208,204,202,150,120,206,237,114,92,126,6,42&#125;;</span><br><span class="line">    int c[]&#x3D;&#123;53,222,230,35,67,248,226,216,17,209,32,2,181,200,171,60,108&#125;;</span><br><span class="line">    char flag[17];</span><br><span class="line">    for(i&#x3D;0;i&lt;17;i++)</span><br><span class="line">    &#123;</span><br><span class="line">    flag[i]&#x3D;a[i + c[i]]-b[i] &amp; 255;</span><br><span class="line">&#125;</span><br><span class="line">for(i&#x3D;16;i&gt;&#x3D;0;i--)</span><br><span class="line">&#123;</span><br><span class="line">printf(&quot;%c&quot;,flag[i]);</span><br><span class="line">&#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>下面这个是python的，比用C语言写简单多了</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">lookup &#x3D; [196,153, 149,206, 17,221, 10, 217, 167, 18, 36, 135, 103, 61, 111, 31, 92, 152, </span><br><span class="line">21, 228, 105, 191, 173, 41, 2, 245, 23, 144, 1, 246, 89, 178, 182, 119, 38, 85, 48, 226, </span><br><span class="line">165, 241, 166, 214, 71, 90, 151, 3, 109, 169, 150, 224, 69, 156, 158, 57, 181, 29, 200, 37, </span><br><span class="line">51, 252, 227, 93, 65, 82, 66, 80, 170, 77, 49, 177, 81, 94, 202, 107, 25, 73, 148, 98, 129, </span><br><span class="line">231, 212, 14, 84, 121, 174, 171, 64, 180, 233, 74, 140, 242, 75, 104, 253, 44, 39, 87, 86, </span><br><span class="line">27, 68, 22, 55, 76, 35, 248, 96, 5, 56, 20, 161, 213, 238, 220, 72, 100, 247, 8, 63, 249, </span><br><span class="line">145, 243, 155, 222, 122, 32, 43, 186, 0, 102, 216, 126, 15, 42, 115, 138, 240, 147, 229, </span><br><span class="line">204, 117, 223, 141, 159, 131, 232, 124, 254, 60, 116, 46, 113, 79, 16, 128, 6, 251, 40, </span><br><span class="line">205, 137, 199, 83, 54, 188, 19, 184, 201, 110, 255, 26, 91, 211, 132, 160, 168, 154, 185, </span><br><span class="line">183, 244, 78, 33, 123, 28, 59, 12, 210, 218, 47, 163, 215, 209, 108, 235, 237, 118, 101, </span><br><span class="line">24, 234, 106, 143, 88, 9, 136, 95, 30, 193, 176, 225, 198, 197, 194, 239, 134, 162, 192, </span><br><span class="line">11, 70, 58, 187, 50, 67, 236, 230, 13, 99, 190, 208, 207, 7, 53, 219, 203, 62, 114, 127, </span><br><span class="line">125, 164, 179, 175, 112, 172, 250, 133, 130, 52, 189, 97, 146, 34, 157, 120, 195, 45, 4, </span><br><span class="line">142, 139]</span><br><span class="line">pwda &#x3D; [188,155,11,58,251,208,204,202,150,120,206,237,114,92,126,6,42]</span><br><span class="line">pwdb &#x3D; [53,222,230,35,67,248,226,216,17,209,32,2,181,200,171,60,108]</span><br><span class="line">flag&#x3D;&quot;&quot;</span><br><span class="line">for i in range(0,17):</span><br><span class="line">    flag+&#x3D;chr(lookup[i + pwdb[i]]-pwda[i] &amp; 255)</span><br><span class="line">flag&#x3D;flag[::-1]</span><br><span class="line">print (flag)</span><br></pre></td></tr></table></figure><blockquote><p>PCTF{PyC_Cr4ck3r}</p></blockquote>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>java逆向</title>
      <link href="2021/03/03/java%E9%80%86%E5%90%91/"/>
      <url>2021/03/03/java%E9%80%86%E5%90%91/</url>
      
        <content type="html"><![CDATA[<h1 id="Java逆向解密"><a href="#Java逆向解密" class="headerlink" title="Java逆向解密"></a>Java逆向解密</h1><a id="more"></a><p><a href="https://buuoj.cn/challenges#Java%E9%80%86%E5%90%91%E8%A7%A3%E5%AF%86">题目链接</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">import java.util.ArrayList;</span><br><span class="line">import java.util.Scanner;</span><br><span class="line"></span><br><span class="line">public class Reverse &#123;</span><br><span class="line"></span><br><span class="line">   public static void main(String[] args) &#123;</span><br><span class="line">      Scanner s &#x3D; new Scanner(System.in);</span><br><span class="line">      System.out.println(&quot;Please input the flag 锛�&quot;);</span><br><span class="line">      String str &#x3D; s.next();</span><br><span class="line">      System.out.println(&quot;Your input is 锛�&quot;);</span><br><span class="line">      System.out.println(str);</span><br><span class="line">      char[] stringArr &#x3D; str.toCharArray();</span><br><span class="line">      Encrypt(stringArr);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   public static void Encrypt(char[] arr) &#123;</span><br><span class="line">      ArrayList Resultlist &#x3D; new ArrayList();</span><br><span class="line"></span><br><span class="line">      for(int KEY &#x3D; 0; KEY &lt; arr.length; ++KEY) &#123;</span><br><span class="line">         int KEYList &#x3D; arr[KEY] + 64 ^ 32;</span><br><span class="line">         Resultlist.add(Integer.valueOf(KEYList));</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      int[] var5 &#x3D; new int[]&#123;180, 136, 137, 147, 191, 137, 147, 191, 148, 136, 133, 191, </span><br><span class="line">         134, 140, 129, 135, 191, 65&#125;;</span><br><span class="line">      ArrayList var6 &#x3D; new ArrayList();</span><br><span class="line"></span><br><span class="line">      for(int j &#x3D; 0; j &lt; var5.length; ++j) &#123;</span><br><span class="line">         var6.add(Integer.valueOf(var5[j]));</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      System.out.println(&quot;Result:&quot;);</span><br><span class="line">      if(Resultlist.equals(var6)) &#123;</span><br><span class="line">         System.out.println(&quot;Congratulations锛�&quot;);</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">         System.err.println(&quot;Error锛�&quot;);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>很清晰的逻辑，直接写脚本。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    int i;</span><br><span class="line">    int a[18]&#x3D;&#123;180, 136, 137, 147, 191, 137, 147, 191, 148, 136, 133, 191, 134, 140, 129, </span><br><span class="line">      135, 191, 65&#125;;</span><br><span class="line">    for(i&#x3D;0;i&lt;18;i++)</span><br><span class="line">    &#123;</span><br><span class="line">    a[i]&#x3D;a[i]-64 ^ 32;</span><br><span class="line">printf(&quot;%c&quot;,a[i]); </span><br><span class="line">&#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>flag{This_is_the_flag_!}</p></blockquote><h1 id="Wust"><a href="#Wust" class="headerlink" title="Wust"></a>Wust</h1><p><a href="https://pan.baidu.com/s/11OVxyzhLx9z0A1pMTdYLxw">附件链接</a> 提取码：0000</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">import java.io.BufferedReader;</span><br><span class="line">import java.io.InputStreamReader;</span><br><span class="line"></span><br><span class="line">public class Wust &#123;</span><br><span class="line"></span><br><span class="line">   public static void main(String[] args) &#123;</span><br><span class="line">      System.out.println(&quot;WUSTCTF2021 Freshman competition&quot;);</span><br><span class="line">      System.out.println(&quot;Input your flag:&quot;);</span><br><span class="line">      BufferedReader br &#x3D; new BufferedReader(new InputStreamReader(System.in));</span><br><span class="line">      String str &#x3D; null;</span><br><span class="line">      int[] flag &#x3D; new int[]&#123;60, 23, 23, 41, 110, 66, 44, 17, 126, 68, 43, 26, 113, 71, 10&#125;;</span><br><span class="line"></span><br><span class="line">      try &#123;</span><br><span class="line">         str &#x3D; br.readLine();</span><br><span class="line">      &#125; catch (Exception var10) &#123;</span><br><span class="line">         System.out.println(&quot;ERROR: Undefined Exception.&quot;);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      if(str.isEmpty()) &#123;</span><br><span class="line">         System.out.println(&quot;Nothing received.&quot;);</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">         if(str.length() !&#x3D; 22) &#123;</span><br><span class="line">            System.out.println(&quot;len Wrong!&quot;);</span><br><span class="line">            return;</span><br><span class="line">         &#125;</span><br><span class="line"></span><br><span class="line">         String head &#x3D; str.substring(0, 5);</span><br><span class="line">         if(!head.equals(&quot;flag&#123;&quot;)) &#123;</span><br><span class="line">            System.out.println(&quot;head Wrong!&quot;);</span><br><span class="line">            return;</span><br><span class="line">         &#125;</span><br><span class="line"></span><br><span class="line">         String m &#x3D; str.substring(5, str.length() - 1);</span><br><span class="line"></span><br><span class="line">         for(int i &#x3D; 0; i &lt; m.length() - 1; ++i) &#123;</span><br><span class="line">            char a &#x3D; m.charAt(i);</span><br><span class="line">            char b &#x3D; m.charAt(i + 1);</span><br><span class="line">            int c &#x3D; a ^ b;</span><br><span class="line">            if(c !&#x3D; flag[i]) &#123;</span><br><span class="line">               System.out.println(&quot;Wrong!&quot;);</span><br><span class="line">               return;</span><br><span class="line">            &#125;</span><br><span class="line">         &#125;</span><br><span class="line"></span><br><span class="line">         System.out.println(&quot;Congratulations!&quot;);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个就是输入flag，flag[2]=flag[1]^60,flag[3]=glag[2]^23,以此类推。<br>众所周知，大部分flag都是有意义的一串字符，这里我采用了穷举。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main(void)</span><br><span class="line">&#123;</span><br><span class="line">int i,j;</span><br><span class="line">int s[16];</span><br><span class="line">int f[15]&#x3D;&#123;60, 23, 23, 41, 110, 66, 44, 17, 126, 68, 43, 26, 113, 71, 10&#125;;</span><br><span class="line">for(i&#x3D;32;i&lt;127;i++)</span><br><span class="line">&#123;</span><br><span class="line">s[0]&#x3D;i;</span><br><span class="line">for(j&#x3D;0;j&lt;15;j++)</span><br><span class="line">&#123;</span><br><span class="line">s[j+1]&#x3D;f[j]^s[j];</span><br><span class="line">&#125;</span><br><span class="line">for(j&#x3D;0;j&lt;16;j++)</span><br><span class="line">&#123;</span><br><span class="line">printf(&quot;%c&quot;,s[j]);</span><br><span class="line">&#125;</span><br><span class="line">printf(&quot;\n&quot;);</span><br><span class="line">&#125;</span><br><span class="line">return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>flag{Jvav_1s_N0t_E4sy}</p></blockquote>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>python逆向</title>
      <link href="2021/03/03/python%E9%80%86%E5%90%91/"/>
      <url>2021/03/03/python%E9%80%86%E5%90%91/</url>
      
        <content type="html"><![CDATA[<h1 id="test"><a href="#test" class="headerlink" title="test"></a>test</h1><a id="more"></a><p><a href="https://pan.baidu.com/s/1DGgkAlcAH1QP1LROT60Ipg">附件链接</a> 提取码：0000</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">from libnum import *</span><br><span class="line">ans &#x3D; 0x6675FA7F228DBCEB6A2DC223A37FC64FE67E61L</span><br><span class="line">flag &#x3D; s2n(input(&#39;Input your flag: &#39;))</span><br><span class="line">flag ^&#x3D; flag &gt;&gt; 10</span><br><span class="line">if flag &#x3D;&#x3D; ans:</span><br><span class="line">    print(&#39;You are right!&#39;)</span><br><span class="line">else:</span><br><span class="line">    print(&#39;Try again!&#39;)</span><br></pre></td></tr></table></figure><p>flag的前十位与ans的前十位相同，flag的11-20位是flag1-10位与ans的11-20位异或的结果，以下为脚本。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">int ans[151]&#x3D;&#123;1,1,0,0,1,1,0,0,1,1,1,0,1,0,1,1,1,1,1,1,0,1,0,0,1,1,1,1,1,1,1,0,0,1,0,0,0,</span><br><span class="line">1,0,1,0,0,0,1,1,0,1,1,0,1,1,1,1,0,</span><br><span class="line">0,1,1,1,0,1,0,1,1,0,1,1,0,1,0,1,0,0,0,1,0,1,1,0,1,1,1,0,0,0,0,1,0,0,0,1,0,0,0,1,1,1,0,1,</span><br><span class="line">0,0,0,1,1,0,1,1,1,1,1,1,1,1,1,0,0,</span><br><span class="line">0,1,1,0,0,1,0,0,1,1,1,1,1,1,1,0,0,1,1,0,0,1,1,1,1,1,1,0,0,1,1,0,0,0,0,1&#125;;</span><br><span class="line">int flag[151];</span><br><span class="line">int i,k,j&#x3D;10;</span><br><span class="line">for(i&#x3D;0;i&lt;10;i++)</span><br><span class="line">&#123;</span><br><span class="line">flag[i]&#x3D;ans[i];</span><br><span class="line">printf(&quot;%d&quot;,flag[i]);</span><br><span class="line">&#125;</span><br><span class="line">for(k&#x3D;0;k&lt;14;k++)</span><br><span class="line">&#123;</span><br><span class="line">for(i&#x3D;j;i&lt;j+10;i++)</span><br><span class="line">&#123;</span><br><span class="line">flag[i]&#x3D;ans[i]^flag[i-10];</span><br><span class="line">printf(&quot;%d&quot;,flag[i]);</span><br><span class="line">&#125;</span><br><span class="line">j&#x3D;j+10;</span><br><span class="line">&#125;</span><br><span class="line">flag[151]&#x3D;flag[141]^ans[151];</span><br><span class="line">printf(&quot;%d&quot;,flag[151]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出结果为2进制，转16进制再转字符串。</p><blockquote><p>flag{Sh1ft_4nd_X0r}</p></blockquote><h1 id="pyre"><a href="#pyre" class="headerlink" title="pyre"></a>pyre</h1><p><a href="https://buuoj.cn/challenges#[GWCTF%202019]pyre">题目链接</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">print &#39;Welcome to Re World!&#39;</span><br><span class="line">print &#39;Your input1 is your flag~&#39;</span><br><span class="line">l &#x3D; len(input1)</span><br><span class="line">for i in range(l):</span><br><span class="line">    num &#x3D; ((input1[i] + i) % 128 + 128) % 128</span><br><span class="line">    code +&#x3D; num</span><br><span class="line"></span><br><span class="line">for i in range(l - 1):</span><br><span class="line">    code[i] &#x3D; code[i] ^ code[i + 1]</span><br><span class="line"></span><br><span class="line">print code</span><br><span class="line">code &#x3D; [</span><br><span class="line">    &#39;\x1f&#39;,</span><br><span class="line">    &#39;\x12&#39;,</span><br><span class="line">    &#39;\x1d&#39;,</span><br><span class="line">    &#39;(&#39;,</span><br><span class="line">    &#39;0&#39;,</span><br><span class="line">    &#39;4&#39;,</span><br><span class="line">    &#39;\x01&#39;,</span><br><span class="line">    &#39;\x06&#39;,</span><br><span class="line">    &#39;\x14&#39;,</span><br><span class="line">    &#39;4&#39;,</span><br><span class="line">    &#39;,&#39;,</span><br><span class="line">    &#39;\x1b&#39;,</span><br><span class="line">    &#39;U&#39;,</span><br><span class="line">    &#39;?&#39;,</span><br><span class="line">    &#39;o&#39;,</span><br><span class="line">    &#39;6&#39;,</span><br><span class="line">    &#39;*&#39;,</span><br><span class="line">    &#39;:&#39;,</span><br><span class="line">    &#39;\x01&#39;,</span><br><span class="line">    &#39;D&#39;,</span><br><span class="line">    &#39;;&#39;,</span><br><span class="line">    &#39;%&#39;,</span><br><span class="line">    &#39;\x13&#39;]</span><br></pre></td></tr></table></figure><p>第五行其实就是num=input1[i]+i,超过127，就减去128.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    int i,j;</span><br><span class="line">    int code[23]&#x3D;&#123;0x1f,0x12,0x1d,&#39;(&#39;,&#39;0&#39;,&#39;4&#39;,0x01,0x06,0x14,&#39;4&#39;,&#39;,&#39;,0x1b,</span><br><span class="line">    &#39;U&#39;,&#39;?&#39;,&#39;o&#39;,&#39;6&#39;,&#39;*&#39;,&#39;:&#39;,0x01,&#39;D&#39;,&#39;;&#39;,&#39;%&#39;,0x13&#125;;</span><br><span class="line">    for(i&#x3D;21;i&gt;&#x3D;0;i--)</span><br><span class="line">    &#123;</span><br><span class="line">    code[i]&#x3D;code[i]^code[i + 1];</span><br><span class="line">&#125;</span><br><span class="line">for(i&#x3D;0;i&lt;23;i++)</span><br><span class="line">&#123;</span><br><span class="line">code[i]-&#x3D;i;</span><br><span class="line">if(code[i]&lt;0)</span><br><span class="line">    code[i]+&#x3D;128;</span><br><span class="line">printf(&quot;%c&quot;,code[i]);</span><br><span class="line">&#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>flag{Just_Re_1s_Ha66y!}</p></blockquote>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>某不知名网站题目</title>
      <link href="2021/03/02/%E6%9F%90%E4%B8%8D%E7%9F%A5%E5%90%8D%E7%BD%91%E7%AB%99%E9%A2%98%E7%9B%AE/"/>
      <url>2021/03/02/%E6%9F%90%E4%B8%8D%E7%9F%A5%E5%90%8D%E7%BD%91%E7%AB%99%E9%A2%98%E7%9B%AE/</url>
      
        <content type="html"><![CDATA[<h1 id="equations"><a href="#equations" class="headerlink" title="equations"></a>equations</h1><a id="more"></a><p><a href="https://pan.baidu.com/s/1NK0Gtr3oqlk2Jn2mgasROQ">附件链接</a> 提取码：0000<br>题目翻译城中文为方程组<br>放入ida64中</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line">234923  89 30 21 11 28 97 68 91 36 29 54 38 18 31 27 25 42 93 45 89 80 94 57 68 59 75 74 </span><br><span class="line">47 40 25 68 52 86 81 38 23 90 80 54 66 80 36</span><br><span class="line">233479  65 11 81 65 58 53 86 44 62 39 64 41 93 67 34 30 25 45 76 17 91 47 57 82 26 17 94 </span><br><span class="line">51 21 80 59 26 75 75 25 67 52 23 81 57 79 98</span><br><span class="line">231388  63 83 55 29 57 53 31 99 27 92 85 98 63 80 18 78 79 28 96 16 95 27 25 71 40 89 79 </span><br><span class="line">81 13 85 41 44 50 55 11 32 76 65 20 37 58 27</span><br><span class="line">223405  39 69 44 25 49 15 16 96 35 32 92 95 11 58 31 90 67 72 83 78 15 25 93 96 97 31 58 </span><br><span class="line">59 14 86 36 37 22 75 43 72 13 26 18 64 64 83</span><br><span class="line">234762  94 82 88 51 31 71 44 74 26 46 95 66 54 75 19 72 93 16 85 54 46 87 15 46 74 27 26 </span><br><span class="line">48 83 13 38 94 45 52 24 72 59 71 32 65 24 93</span><br><span class="line">242484  34 75 68 93 79 19 14 76 60 69 73 29 48 61 49 64 98 29 77 81 85 11 87 11 72 63 87 </span><br><span class="line">40 47 48 87 54 88 27 26 67 93 50 79 42 12 32</span><br><span class="line">232356  76 61 21 72 11 93 13 63 15 13 73 49 48 76 52 81 62 78 84 79 95 74 57 21 13 95 15 </span><br><span class="line">93 57 38 89 98 68 69 21 40 20 55 62 29 54 40</span><br><span class="line">239858  98 66 92 23 97 55 72 69 81 41 38 21 56 95 86 39 78 53 65 37 80 56 38 60 94 72 20 </span><br><span class="line">43 50 28 81 63 12 60 32 12 22 86 65 32 76 71</span><br><span class="line">218896  32 15 73 84 27 21 74 21 35 26 85 28 57 91 37 12 67 47 10 74 62 53 73 84 94 46 74 </span><br><span class="line">47 57 40 88 71 13 32 81 95 57 28 13 94 45 34</span><br><span class="line">249026  50 47 34 57 12 34 76 54 79 18 44 73 50 92 51 72 39 91 26 74 97 42 86 79 53 50 62 </span><br><span class="line">14 71 55 87 64 77 62 63 48 27 81 93 85 65 83</span><br><span class="line">222855  92 26 78 74 25 38 64 98 68 71 14 99 92 11 31 29 20 52 17 10 21 37 99 52 66 32 57 </span><br><span class="line">58 25 25 93 54 96 70 18 66 84 27 44 28 52 83</span><br><span class="line">210754  53 39 23 68 62 44 98 17 80 16 63 51 15 49 84 23 97 26 65 35 11 83 43 64 21 39 37 </span><br><span class="line">79 73 61 55 57 58 69 16 10 48 86 80 13 67 32</span><br><span class="line">261049  12 69 82 77 95 22 21 85 79 58 48 83 47 77 64 80 56 35 78 67 46 93 51 75 69 62 44 </span><br><span class="line">11 46 98 37 93 34 53 87 46 85 79 69 81 45 86</span><br><span class="line">254017  51 74 62 62 86 10 49 94 65 50 62 95 48 66 14 84 61 41 89 78 46 60 20 97 32 65 61 </span><br><span class="line">78 57 16 64 97 81 81 76 61 27 46 99 64 35 99</span><br><span class="line">202040  15 47 16 70 28 32 65 82 53 32 29 25 69 96 52 76 22 41 82 91 47 24 55 40 18 19 52 </span><br><span class="line">83 37 51 89 37 27 55 40 82 61 27 26 28 30 73</span><br><span class="line">213614  11 29 51 69 81 96 58 97 36 81 18 62 73 32 72 11 49 61 69 67 54 30 10 70 42 27 19 </span><br><span class="line">11 97 83 27 40 63 12 41 21 84 74 22 19 65 79</span><br><span class="line">246738  76 64 47 17 80 57 93 11 79 98 56 86 23 67 63 11 54 72 80 44 50 61 14 43 80 48 63 </span><br><span class="line">52 99 79 40 64 49 55 52 78 48 60 44 32 85 98</span><br><span class="line">204859  77 34 26 66 87 76 58 39 81 60 83 23 16 62 33 36 85 40 64 78 22 11 81 81 27 12 11 </span><br><span class="line">41 15 19 69 20 26 66 17 87 50 67 47 21 31 81</span><br><span class="line">248644  56 66 51 80 33 73 76 42 13 91 75 90 82 20 15 99 33 18 22 28 39 17 74 54 78 47 61 </span><br><span class="line">68 73 95 60 52 84 11 78 67 82 79 31 94 78 74</span><br><span class="line">227559  24 15 63 20 81 71 50 77 98 71 98 43 57 10 66 53 36 45 44 54 90 22 96 68 98 27 71 </span><br><span class="line">78 37 43 20 50 82 84 19 76 59 27 47 31 19 31</span><br><span class="line">215120  45 66 23 77 41 65 99 35 67 29 63 77 55 36 27 63 43 70 55 11 28 17 77 90 28 57 62 </span><br><span class="line">98 84 96 36 43 30 73 32 25 34 14 91 18 73 26</span><br><span class="line">218244  65 25 41 22 34 46 91 70 35 22 65 60 96 58 76 80 21 62 59 70 51 50 39 14 31 39 79 </span><br><span class="line">49 45 82 74 35 56 24 93 47 32 41 14 15 71 51</span><br><span class="line">229321  45 99 29 14 89 72 48 43 92 10 94 13 33 94 59 22 65 29 23 86 67 83 28 46 83 89 48 </span><br><span class="line">59 28 38 82 32 70 50 28 39 24 60 17 37 60 90</span><br><span class="line">233372  62 66 17 38 19 83 12 98 61 57 63 67 69 10 24 75 60 87 76 37 91 35 20 30 24 77 29 </span><br><span class="line">27 40 36 98 82 20 67 45 96 99 80 17 55 74 55</span><br><span class="line">251643  64 68 36 79 23 96 16 40 79 16 85 77 99 56 95 99 60 28 11 96 22 66 47 66 90 48 80 </span><br><span class="line">34 22 47 66 80 37 43 75 84 23 21 39 85 64 95</span><br><span class="line">245051  14 55 61 90 62 91 24 31 40 34 88 59 65 26 16 28 36 33 81 91 99 57 69 75 32 98 17 </span><br><span class="line">60 94 16 89 51 35 74 87 98 52 39 73 41 65 65</span><br><span class="line">228339  58 64 96 49 96 43 13 28 42 90 80 33 68 62 42 78 75 56 20 66 45 63 10 72 41 63 28 </span><br><span class="line">42 60 26 76 20 98 19 51 68 80 12 48 68 80 15</span><br><span class="line">271672  93 74 76 39 79 99 22 66 47 40 85 58 50 56 84 93 65 65 56 66 95 32 84 48 51 68 30 </span><br><span class="line">96 93 60 83 79 54 61 99 77 12 51 31 93 54 12</span><br><span class="line">207826  30 29 52 29 91 81 31 28 75 84 10 40 14 34 26 70 94 74 27 38 55 13 21 55 79 94 45 </span><br><span class="line">41 39 62 56 25 10 54 61 58 23 97 95 70 18 62</span><br><span class="line">208076  19 60 27 79 53 21 21 47 52 26 42 82 20 87 74 57 88 22 67 95 69 24 50 14 31 26 38 </span><br><span class="line">40 31 46 17 67 85 54 33 46 43 72 84 94 67 29</span><br><span class="line">230168  37 52 47 30 99 11 20 20 41 72 46 78 97 93 47 73 48 35 85 99 77 49 48 75 94 44 29 </span><br><span class="line">11 18 71 82 88 27 70 95 26 19 73 61 51 55 51</span><br><span class="line">195444  92 21 36 77 36 27 25 45 48 16 73 90 71 53 47 39 75 33 96 11 22 18 15 48 20 16 90 </span><br><span class="line">50 66 11 49 91 23 60 81 53 57 18 19 40 54 48</span><br><span class="line">233025  47 22 61 36 88 58 42 13 69 33 89 93 93 75 31 98 65 94 77 16 14 99 21 89 90 37 27 </span><br><span class="line">11 22 80 66 65 31 70 76 29 49 92 51 38 27 47</span><br><span class="line">224202  69 33 97 97 51 59 15 17 92 59 84 19 33 54 78 15 50 28 40 68 75 23 55 38 69 46 21 </span><br><span class="line">39 36 74 84 90 31 57 81 21 46 66 63 23 43 82</span><br><span class="line">246170  26 52 48 41 14 64 11 31 90 49 93 92 45 56 99 85 81 26 34 27 55 55 85 26 41 83 41 </span><br><span class="line">46 89 41 66 96 92 16 47 73 59 85 57 88 70 49</span><br><span class="line">223337  26 74 51 31 10 55 23 33 62 97 93 71 96 89 28 35 63 26 66 12 83 67 39 72 92 78 70 </span><br><span class="line">19 63 76 74 70 84 31 18 22 54 74 32 30 65 15</span><br><span class="line">244180  88 20 28 71 54 74 73 90 12 35 49 94 69 20 18 88 80 88 73 65 19 40 23 17 21 48 71 </span><br><span class="line">89 96 61 92 81 74 36 78 16 81 39 43 12 80 91</span><br><span class="line">241027  30 64 16 36 85 58 43 97 90 85 79 28 28 86 24 40 43 22 95 74 73 29 35 13 82 67 77 </span><br><span class="line">76 19 70 29 61 92 51 82 98 40 83 72 33 81 41</span><br><span class="line">225646  55 16 69 49 35 88 71 14 64 16 23 34 81 89 66 79 20 40 11 10 52 74 55 26 64 30 97 </span><br><span class="line">65 51 88 55 59 20 18 97 86 65 28 44 71 64 93</span><br><span class="line">217174  48 91 36 87 35 11 40 67 90 25 39 85 29 97 57 44 99 88 34 83 75 10 73 63 44 63 56 </span><br><span class="line">17 94 16 28 78 55 63 19 22 37 36 42 16 49 51</span><br><span class="line">222271  51 55 27 49 54 89 77 58 15 36 25 43 71 57 78 55 54 58 28 79 87 92 39 88 61 11 27 </span><br><span class="line">66 59 96 79 75 69 25 16 40 68 30 16 12 51 48</span><br><span class="line">203973  71 29 57 59 30 75 67 39 95 14 48 49 35 93 56 94 14 59 12 49 19 40 16 86 79 38 31 </span><br><span class="line">43 82 14 51 85 85 19 99 35 30 19 26 15 32 77</span><br></pre></td></tr></table></figure><p>最终结果转换成字符串即可。</p><blockquote><p>flag{nO_w@y_y0u_woRk_ou7_mY_equ4tions_5et}</p></blockquote><h1 id="re-1"><a href="#re-1" class="headerlink" title="re_1"></a>re_1</h1><p><a href="https://pan.baidu.com/s/1VidIkvouV3V1GUSc79yMFQ">附件链接</a> 提取码：0000<br>ida64打开，进入main函数</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line">int __cdecl main(int argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  void **v3; &#x2F;&#x2F; rdx</span><br><span class="line">  void *v5; &#x2F;&#x2F; [rsp+40h] [rbp-330h]</span><br><span class="line">  void *v6; &#x2F;&#x2F; [rsp+48h] [rbp-328h]</span><br><span class="line">  void *v7; &#x2F;&#x2F; [rsp+50h] [rbp-320h]</span><br><span class="line">  void *v8; &#x2F;&#x2F; [rsp+58h] [rbp-318h]</span><br><span class="line">  void *v9; &#x2F;&#x2F; [rsp+60h] [rbp-310h]</span><br><span class="line">  void *v10; &#x2F;&#x2F; [rsp+68h] [rbp-308h]</span><br><span class="line">  void *v11; &#x2F;&#x2F; [rsp+70h] [rbp-300h]</span><br><span class="line">  void *v12; &#x2F;&#x2F; [rsp+78h] [rbp-2F8h]</span><br><span class="line">  void *v13; &#x2F;&#x2F; [rsp+80h] [rbp-2F0h]</span><br><span class="line">  void *v14; &#x2F;&#x2F; [rsp+88h] [rbp-2E8h]</span><br><span class="line">  void *v15; &#x2F;&#x2F; [rsp+90h] [rbp-2E0h]</span><br><span class="line">  void *v16; &#x2F;&#x2F; [rsp+98h] [rbp-2D8h]</span><br><span class="line">  void *v17; &#x2F;&#x2F; [rsp+A0h] [rbp-2D0h]</span><br><span class="line">  void *v18; &#x2F;&#x2F; [rsp+A8h] [rbp-2C8h]</span><br><span class="line">  void *v19; &#x2F;&#x2F; [rsp+B0h] [rbp-2C0h]</span><br><span class="line">  void *v20; &#x2F;&#x2F; [rsp+B8h] [rbp-2B8h]</span><br><span class="line">  void *v21; &#x2F;&#x2F; [rsp+C0h] [rbp-2B0h]</span><br><span class="line">  void *v22; &#x2F;&#x2F; [rsp+C8h] [rbp-2A8h]</span><br><span class="line">  void *v23; &#x2F;&#x2F; [rsp+D0h] [rbp-2A0h]</span><br><span class="line">  void *v24; &#x2F;&#x2F; [rsp+D8h] [rbp-298h]</span><br><span class="line">  void *v25; &#x2F;&#x2F; [rsp+E0h] [rbp-290h]</span><br><span class="line">  void *v26; &#x2F;&#x2F; [rsp+E8h] [rbp-288h]</span><br><span class="line">  void *v27; &#x2F;&#x2F; [rsp+F0h] [rbp-280h]</span><br><span class="line">  void *v28; &#x2F;&#x2F; [rsp+F8h] [rbp-278h]</span><br><span class="line">  void *v29; &#x2F;&#x2F; [rsp+100h] [rbp-270h]</span><br><span class="line">  void *v30; &#x2F;&#x2F; [rsp+108h] [rbp-268h]</span><br><span class="line">  void *v31; &#x2F;&#x2F; [rsp+110h] [rbp-260h]</span><br><span class="line">  void *v32; &#x2F;&#x2F; [rsp+118h] [rbp-258h]</span><br><span class="line">  void *v33; &#x2F;&#x2F; [rsp+120h] [rbp-250h]</span><br><span class="line">  void *v34; &#x2F;&#x2F; [rsp+128h] [rbp-248h]</span><br><span class="line">  void *v35; &#x2F;&#x2F; [rsp+130h] [rbp-240h]</span><br><span class="line">  void *v36; &#x2F;&#x2F; [rsp+138h] [rbp-238h]</span><br><span class="line">  void *v37; &#x2F;&#x2F; [rsp+140h] [rbp-230h]</span><br><span class="line">  void *v38; &#x2F;&#x2F; [rsp+148h] [rbp-228h]</span><br><span class="line">  void *v39; &#x2F;&#x2F; [rsp+150h] [rbp-220h]</span><br><span class="line">  void *v40; &#x2F;&#x2F; [rsp+158h] [rbp-218h]</span><br><span class="line">  void *v41; &#x2F;&#x2F; [rsp+160h] [rbp-210h]</span><br><span class="line">  void *v42; &#x2F;&#x2F; [rsp+168h] [rbp-208h]</span><br><span class="line">  void *v43; &#x2F;&#x2F; [rsp+170h] [rbp-200h]</span><br><span class="line">  void *v44; &#x2F;&#x2F; [rsp+178h] [rbp-1F8h]</span><br><span class="line">  int v45; &#x2F;&#x2F; [rsp+368h] [rbp-8h]</span><br><span class="line">  int i; &#x2F;&#x2F; [rsp+36Ch] [rbp-4h]</span><br><span class="line"></span><br><span class="line">  v3 &#x3D; &amp;v5;</span><br><span class="line">  memset(&amp;v5, 0, 0x320uLL);</span><br><span class="line">  v5 &#x3D; &amp;unk_483004;</span><br><span class="line">  v6 &#x3D; &amp;unk_483007;</span><br><span class="line">  v7 &#x3D; &amp;unk_483004;</span><br><span class="line">  v8 &#x3D; &amp;unk_48300A;</span><br><span class="line">  v9 &#x3D; &amp;unk_48300D;</span><br><span class="line">  v10 &#x3D; &amp;unk_483010;</span><br><span class="line">  v11 &#x3D; &amp;unk_483013;</span><br><span class="line">  v12 &#x3D; &amp;unk_483016;</span><br><span class="line">  v13 &#x3D; &amp;unk_483019;</span><br><span class="line">  v14 &#x3D; &amp;unk_48301C;</span><br><span class="line">  v15 &#x3D; &amp;unk_48301F;</span><br><span class="line">  v16 &#x3D; &amp;unk_483022;</span><br><span class="line">  v17 &#x3D; &amp;unk_483022;</span><br><span class="line">  v18 &#x3D; &amp;unk_483022;</span><br><span class="line">  v19 &#x3D; &amp;unk_483025;</span><br><span class="line">  v20 &#x3D; &amp;unk_48300A;</span><br><span class="line">  v21 &#x3D; &amp;unk_483019;</span><br><span class="line">  v22 &#x3D; &amp;unk_483016;</span><br><span class="line">  v23 &#x3D; &amp;unk_483028;</span><br><span class="line">  v24 &#x3D; &amp;unk_48302B;</span><br><span class="line">  v25 &#x3D; &amp;unk_483010;</span><br><span class="line">  v26 &#x3D; &amp;unk_48302E;</span><br><span class="line">  v27 &#x3D; &amp;unk_48301F;</span><br><span class="line">  v28 &#x3D; &amp;unk_483031;</span><br><span class="line">  v29 &#x3D; &amp;unk_483010;</span><br><span class="line">  v30 &#x3D; &amp;unk_483034;</span><br><span class="line">  v31 &#x3D; &amp;unk_483034;</span><br><span class="line">  v32 &#x3D; &amp;unk_483022;</span><br><span class="line">  v33 &#x3D; &amp;unk_483025;</span><br><span class="line">  v34 &#x3D; &amp;unk_483034;</span><br><span class="line">  v35 &#x3D; &amp;unk_483025;</span><br><span class="line">  v36 &#x3D; &amp;unk_48300A;</span><br><span class="line">  v37 &#x3D; &amp;unk_48302B;</span><br><span class="line">  v38 &#x3D; &amp;unk_48302E;</span><br><span class="line">  v39 &#x3D; &amp;unk_483034;</span><br><span class="line">  v40 &#x3D; &amp;unk_48302B;</span><br><span class="line">  v41 &#x3D; &amp;unk_48302E;</span><br><span class="line">  v42 &#x3D; &amp;unk_483037;</span><br><span class="line">  v43 &#x3D; &amp;unk_48302B;</span><br><span class="line">  v44 &#x3D; &amp;unk_48303A;</span><br><span class="line">  for ( i &#x3D; 0; i &lt;&#x3D; 39; ++i )</span><br><span class="line">    v45 &#x3D; fun(*(&amp;v5 + i));</span><br><span class="line">  system(&quot;pause&quot;, argv, v3);</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">signed __int64 __fastcall fun(__int64 a1)</span><br><span class="line">&#123;</span><br><span class="line">  signed __int64 v2; &#x2F;&#x2F; [rsp+8h] [rbp-10h]</span><br><span class="line">  int v3; &#x2F;&#x2F; [rsp+10h] [rbp-8h]</span><br><span class="line">  int i; &#x2F;&#x2F; [rsp+14h] [rbp-4h]</span><br><span class="line">  v2 &#x3D; 0LL;</span><br><span class="line">  for ( i &#x3D; 0; *(i + a1); ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    if ( *(i + a1) &gt; 47 &amp;&amp; *(i + a1) &lt;&#x3D; 57 )</span><br><span class="line">      v3 &#x3D; *(i + a1) - 48;</span><br><span class="line">    if ( *(i + a1) &gt; 96 &amp;&amp; *(i + a1) &lt;&#x3D; 122 )</span><br><span class="line">      v3 &#x3D; *(i + a1) - 87;</span><br><span class="line">    if ( *(i + a1) &gt; 64 &amp;&amp; *(i + a1) &lt;&#x3D; 90 )</span><br><span class="line">      v3 &#x3D; *(i + a1) - 55;</span><br><span class="line">    v2 &#x3D; 16 * v2 + v3;</span><br><span class="line">  &#125;</span><br><span class="line">  return v2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这一题除了有点废手就没什么了。<br>脚本：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    int a[80]&#x3D;&#123;0x37,0x33,0x37,0x39,0x37,0x33,0x36,0x33,0x37,0x34,0x36,0x36,0x37,0x62,0x37,0x37,</span><br><span class="line">    0x33,0x34,0x33,0x35,0x36,0x35,0x36,0x34,0x36,0x34,0x36,0x34,0x33,0x36,0x36,0x33,0x33,0x34,</span><br><span class="line">    0x33,0x37,0x36,0x31,0x33,0x39,0x36,0x36,0x33,0x38,0x36,0x35,0x33,0x32,0x36,0x36,0x33,0x31,</span><br><span class="line">    0x33,0x31,0x36,0x34,0x33,0x36,0x33,0x31,0x33,0x36,0x36,0x33,0x33,0x39,0x33,0x38,0x33,0x31,</span><br><span class="line">    0x33,0x39,0x33,0x38,0x36,0x32,0x33,0x39,0x37,0x64&#125;;</span><br><span class="line">    int flag[80];</span><br><span class="line">    int v3,v2&#x3D;0;</span><br><span class="line">    for(int i&#x3D;0;i&lt;80;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        if ( a[i] &gt; 47 &amp;&amp; a[i] &lt;&#x3D; 57 )</span><br><span class="line">        &#123;</span><br><span class="line">            v3 &#x3D; a[i] - 48;</span><br><span class="line">            a[i]&#x3D; v3;</span><br><span class="line">            flag[i]&#x3D;a[i];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        else if ( a[i] &gt; 96 &amp;&amp; a[i] &lt;&#x3D; 122 )</span><br><span class="line">        &#123;</span><br><span class="line">            v3 &#x3D; a[i] - 87;</span><br><span class="line">            a[i]&#x3D; v3;</span><br><span class="line">            flag[i]&#x3D;a[i];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        else if ( a[i] &gt; 64 &amp;&amp; a[i] &lt;&#x3D; 90 )</span><br><span class="line">        &#123;</span><br><span class="line">            v3 &#x3D; a[i] - 55;</span><br><span class="line">            a[i]&#x3D; v3;</span><br><span class="line">            flag[i]&#x3D;a[i];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        else</span><br><span class="line">        &#123;</span><br><span class="line">            a[i]&#x3D; 0;</span><br><span class="line">            flag[i]&#x3D;a[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    for(int i&#x3D;0;i&lt;80;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        if(flag[i]!&#x3D; 0);</span><br><span class="line">        printf(&quot;%0x&quot;,flag[i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>接着16进制字符串。</p><blockquote><p>sysctf{w45eddd6c47a9f8e2f11d616c98198b9}</p></blockquote><h1 id="ez-re"><a href="#ez-re" class="headerlink" title="ez_re"></a>ez_re</h1><p><a href="https://pan.baidu.com/s/14LzmZK_3QGRU-uN9IKaetg">附件链接</a> 提取码：0000<br>拖入ida中，查看main函数</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">int __cdecl main(int argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  __int64 v3; &#x2F;&#x2F; rdx</span><br><span class="line">  int result; &#x2F;&#x2F; eax</span><br><span class="line">  __int64 v5; &#x2F;&#x2F; rdx</span><br><span class="line">  char v6; &#x2F;&#x2F; [rsp+0h] [rbp-30h]</span><br><span class="line">  unsigned __int64 v7; &#x2F;&#x2F; [rsp+28h] [rbp-8h]</span><br><span class="line"></span><br><span class="line">  v7 &#x3D; __readfsqword(0x28u);</span><br><span class="line">  puts(&quot;You got something good for me?\n&gt;&quot;, argv, envp);</span><br><span class="line">  _isoc99_scanf(&quot;%33s&quot;);</span><br><span class="line">  if ( j_strlen_ifunc(&amp;v6, &amp;v6) &#x3D;&#x3D; 33 )</span><br><span class="line">  &#123;</span><br><span class="line">    crypto(&amp;v6);</span><br><span class="line">    printf(&quot;checking...&quot;);</span><br><span class="line">    if ( check(&amp;v6) )</span><br><span class="line">      puts(&quot;Well done,h4cker!&quot;, &amp;v6, v5);</span><br><span class="line">    else</span><br><span class="line">      puts(&quot;O0ops....&quot;, &amp;v6, v5);</span><br><span class="line">    result &#x3D; 0;</span><br><span class="line">  &#125;</span><br><span class="line">  else</span><br><span class="line">  &#123;</span><br><span class="line">    puts(&quot;O0ops....&quot;, &amp;v6, v3);</span><br><span class="line">    result &#x3D; 0;</span><br><span class="line">  &#125;</span><br><span class="line">  return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">_BYTE *__fastcall crypto(__int64 a1)</span><br><span class="line">&#123;</span><br><span class="line">  _BYTE *result; &#x2F;&#x2F; rax</span><br><span class="line">  signed int v2; &#x2F;&#x2F; [rsp+10h] [rbp-8h]</span><br><span class="line">  signed int v3; &#x2F;&#x2F; [rsp+14h] [rbp-4h]</span><br><span class="line"></span><br><span class="line">  v2 &#x3D; 55;</span><br><span class="line">  v3 &#x3D; 0;</span><br><span class="line">  while ( v3 &lt;&#x3D; 32 )</span><br><span class="line">  &#123;</span><br><span class="line">    *(v3 + a1) -&#x3D; 2;</span><br><span class="line">    result &#x3D; (v3 + a1);</span><br><span class="line">    *result ^&#x3D; v2;</span><br><span class="line">    ++v3;</span><br><span class="line">    ++v2;</span><br><span class="line">  &#125;</span><br><span class="line">  return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall check(__int64 a1)</span><br><span class="line">&#123;</span><br><span class="line">  unsigned int v2; &#x2F;&#x2F; [rsp+18h] [rbp-8h]</span><br><span class="line">  signed int i; &#x2F;&#x2F; [rsp+1Ch] [rbp-4h]</span><br><span class="line"></span><br><span class="line">  v2 &#x3D; 1;</span><br><span class="line">  sleep(2LL);</span><br><span class="line">  for ( i &#x3D; 0; i &lt;&#x3D; 32; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    if ( *(i + a1) !&#x3D; byte_6D4100[i] )</span><br><span class="line">      v2 &#x3D; 0;</span><br><span class="line">  &#125;</span><br><span class="line">  return v2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>一个异或加一个比较。<br>脚本：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    int v2 &#x3D; 55;</span><br><span class="line">    int v3 &#x3D; 0;</span><br><span class="line">    char flag[33];</span><br><span class="line">    char result[33];</span><br><span class="line">    int byte_6D4100[33]&#x3D;&#123;0x53,0x52,0x66,0x5F,0x42,0x4F,0x71,0x50,0xD,0x21,0x28,0x1F,0x6C,</span><br><span class="line">    0x35,0x18,0x26,0x79,</span><br><span class="line">    0x39,0x2E,0x2B,0x16,0x7F,0x24,0x29,0x25,0x3A,0xC,0x1F,0x37,9,0x25,0x67,0x2C&#125;;</span><br><span class="line">    int i;</span><br><span class="line">    for ( i &#x3D; 0; i &lt;&#x3D; 32; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">        flag[i] &#x3D; byte_6D4100[i];</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    for ( i &#x3D; 0; i &lt;&#x3D; 32; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">        result[i] &#x3D; flag[i]^v2;</span><br><span class="line">        result[i] +&#x3D; 2;</span><br><span class="line">        v2++;</span><br><span class="line">        printf(&quot;%c&quot;,result[i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>flag{uNp4ck_1s_b@sic_5kill_Of_r3}</p></blockquote>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>攻防世界</title>
      <link href="2021/03/01/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/"/>
      <url>2021/03/01/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/</url>
      
        <content type="html"><![CDATA[<h1 id="Shuffle"><a href="#Shuffle" class="headerlink" title="Shuffle"></a>Shuffle</h1><a id="more"></a><p><a href="https://adworld.xctf.org.cn/task/answer?type=reverse&number=4&grade=1&id=4942&page=1">题目链接</a><br>ida64打开，进入main函数</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">s &#x3D; &#39;S&#39;;</span><br><span class="line">v11 &#x3D; &#39;E&#39;;</span><br><span class="line">v12 &#x3D; &#39;C&#39;;</span><br><span class="line">v13 &#x3D; &#39;C&#39;;</span><br><span class="line">v14 &#x3D; &#39;O&#39;;</span><br><span class="line">v15 &#x3D; &#39;N&#39;;</span><br><span class="line">v16 &#x3D; &#39;&#123;&#39;;</span><br><span class="line">v17 &#x3D; &#39;W&#39;;</span><br><span class="line">v18 &#x3D; &#39;e&#39;;</span><br><span class="line">v19 &#x3D; &#39;l&#39;;</span><br><span class="line">v20 &#x3D; &#39;c&#39;;</span><br><span class="line">v21 &#x3D; &#39;o&#39;;</span><br><span class="line">v22 &#x3D; &#39;m&#39;;</span><br><span class="line">v23 &#x3D; &#39;e&#39;;</span><br><span class="line">v24 &#x3D; &#39; &#39;;</span><br><span class="line">v25 &#x3D; &#39;t&#39;;</span><br><span class="line">v26 &#x3D; &#39;o&#39;;</span><br><span class="line">v27 &#x3D; &#39; &#39;;</span><br><span class="line">v28 &#x3D; &#39;t&#39;;</span><br><span class="line">v29 &#x3D; &#39;h&#39;;</span><br><span class="line">v30 &#x3D; &#39;e&#39;;</span><br><span class="line">v31 &#x3D; &#39; &#39;;</span><br><span class="line">v32 &#x3D; &#39;S&#39;;</span><br><span class="line">v33 &#x3D; &#39;E&#39;;</span><br><span class="line">v34 &#x3D; &#39;C&#39;;</span><br><span class="line">v35 &#x3D; &#39;C&#39;;</span><br><span class="line">v36 &#x3D; &#39;O&#39;;</span><br><span class="line">v37 &#x3D; &#39;N&#39;;</span><br><span class="line">v38 &#x3D; &#39; &#39;;</span><br><span class="line">v39 &#x3D; &#39;2&#39;;</span><br><span class="line">v40 &#x3D; &#39;0&#39;;</span><br><span class="line">v41 &#x3D; &#39;1&#39;;</span><br><span class="line">v42 &#x3D; &#39;4&#39;;</span><br><span class="line">v43 &#x3D; &#39; &#39;;</span><br><span class="line">v44 &#x3D; &#39;C&#39;;</span><br><span class="line">v45 &#x3D; &#39;T&#39;;</span><br><span class="line">v46 &#x3D; &#39;F&#39;;</span><br><span class="line">v47 &#x3D; &#39;!&#39;;</span><br><span class="line">v48 &#x3D; &#39;&#125;&#39;;</span><br></pre></td></tr></table></figure><blockquote><p>SECCON{Welcome to the SECCON 2014 CTF!}</p></blockquote><h1 id="666"><a href="#666" class="headerlink" title="666"></a>666</h1><p><a href="https://adworld.xctf.org.cn/task/answer?type=reverse&number=4&grade=1&id=5573&page=1">题目链接</a><br>ida64打开</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">int __cdecl main(int argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  char s; &#x2F;&#x2F; [rsp+0h] [rbp-1E0h]</span><br><span class="line">  char v5; &#x2F;&#x2F; [rsp+F0h] [rbp-F0h]</span><br><span class="line"></span><br><span class="line">  memset(&amp;s, 0, 0x1EuLL);</span><br><span class="line">  printf(&quot;Please Input Key: &quot;, 0LL);</span><br><span class="line">  __isoc99_scanf(&quot;%s&quot;, &amp;v5);</span><br><span class="line">  encode(&amp;v5, &amp;s);</span><br><span class="line">  if ( strlen(&amp;v5) &#x3D;&#x3D; key )</span><br><span class="line">  &#123;</span><br><span class="line">    if ( !strcmp(&amp;s, enflag) )</span><br><span class="line">      puts(&quot;You are Right&quot;);</span><br><span class="line">    else</span><br><span class="line">      puts(&quot;flag&#123;This_1s_f4cker_flag&#125;&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">int __fastcall encode(const char *a1, __int64 a2)</span><br><span class="line">&#123;</span><br><span class="line">  char v3[32]; &#x2F;&#x2F; [rsp+10h] [rbp-70h]</span><br><span class="line">  char v4[32]; &#x2F;&#x2F; [rsp+30h] [rbp-50h]</span><br><span class="line">  char v5[40]; &#x2F;&#x2F; [rsp+50h] [rbp-30h]</span><br><span class="line">  int v6; &#x2F;&#x2F; [rsp+78h] [rbp-8h]</span><br><span class="line">  int i; &#x2F;&#x2F; [rsp+7Ch] [rbp-4h]</span><br><span class="line"></span><br><span class="line">  i &#x3D; 0;</span><br><span class="line">  v6 &#x3D; 0;</span><br><span class="line">  if ( strlen(a1) !&#x3D; key )</span><br><span class="line">    return puts(&quot;Your Length is Wrong&quot;);</span><br><span class="line">  for ( i &#x3D; 0; i &lt; key; i +&#x3D; 3 )</span><br><span class="line">  &#123;</span><br><span class="line">    v5[i] &#x3D; key ^ (a1[i] + 6);</span><br><span class="line">    v4[i + 1] &#x3D; (a1[i + 1] - 6) ^ key;</span><br><span class="line">    v3[i + 2] &#x3D; a1[i + 2] ^ 6 ^ key;</span><br><span class="line">    *(_BYTE *)(a2 + i) &#x3D; v5[i];</span><br><span class="line">    *(_BYTE *)(a2 + i + 1LL) &#x3D; v4[i + 1];</span><br><span class="line">    *(_BYTE *)(a2 + i + 2LL) &#x3D; v3[i + 2];</span><br><span class="line">  &#125;</span><br><span class="line">  return a2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>逻辑很清晰，直接写脚本</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">char f[18]&#x3D;&quot;izwhroz\&quot;\&quot;w\&quot;v.K\&quot;.Ni&quot;;</span><br><span class="line">int i,j,k;</span><br><span class="line">    for ( i &#x3D; 0; i &lt; 18; i+&#x3D;3 )</span><br><span class="line">    &#123;</span><br><span class="line">    f[i]&#x3D;(f[i]^18)-6;</span><br><span class="line">    f[i+1]&#x3D;(f[i+1]^18)+6;</span><br><span class="line">    f[i+2]&#x3D;f[i+2]^18^6;</span><br><span class="line">        printf(&quot;%c%c%c&quot;,f[i],f[i+1],f[i+2]);</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>unctf{b66_6b6_66b}</p></blockquote><h1 id="Reversing-x64Elf-100"><a href="#Reversing-x64Elf-100" class="headerlink" title="Reversing-x64Elf-100"></a>Reversing-x64Elf-100</h1><p><a href="https://adworld.xctf.org.cn/task/answer?type=reverse&number=4&grade=1&id=4826&page=1">题目链接</a><br>拖入ida</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">signed __int64 __fastcall main(__int64 a1, char **a2, char **a3)</span><br><span class="line">&#123;</span><br><span class="line">  signed __int64 result; &#x2F;&#x2F; rax</span><br><span class="line">  char s; &#x2F;&#x2F; [rsp+0h] [rbp-110h]</span><br><span class="line">  unsigned __int64 v5; &#x2F;&#x2F; [rsp+108h] [rbp-8h]</span><br><span class="line"></span><br><span class="line">  v5 &#x3D; __readfsqword(0x28u);</span><br><span class="line">  printf(&quot;Enter the password: &quot;, a2, a3);</span><br><span class="line">  if ( !fgets(&amp;s, 255, stdin) )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( sub_4006FD(&amp;s) )</span><br><span class="line">  &#123;</span><br><span class="line">    puts(&quot;Incorrect password!&quot;);</span><br><span class="line">    result &#x3D; 1LL;</span><br><span class="line">  &#125;</span><br><span class="line">  else</span><br><span class="line">  &#123;</span><br><span class="line">    puts(&quot;Nice!&quot;);</span><br><span class="line">    result &#x3D; 0LL;</span><br><span class="line">  &#125;</span><br><span class="line">  return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">signed __int64 __fastcall sub_4006FD(__int64 a1)</span><br><span class="line">&#123;</span><br><span class="line">  signed int i; &#x2F;&#x2F; [rsp+14h] [rbp-24h]</span><br><span class="line">  const char *v3; &#x2F;&#x2F; [rsp+18h] [rbp-20h]</span><br><span class="line">  const char *v4; &#x2F;&#x2F; [rsp+20h] [rbp-18h]</span><br><span class="line">  const char *v5; &#x2F;&#x2F; [rsp+28h] [rbp-10h]</span><br><span class="line"></span><br><span class="line">  v3 &#x3D; &quot;Dufhbmf&quot;;</span><br><span class="line">  v4 &#x3D; &quot;pG&#96;imos&quot;;</span><br><span class="line">  v5 &#x3D; &quot;ewUglpt&quot;;</span><br><span class="line">  for ( i &#x3D; 0; i &lt;&#x3D; 11; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    if ( (&amp;v3)[i % 3][2 * (i &#x2F; 3)] - *(i + a1) !&#x3D; 1 )</span><br><span class="line">      return 1LL;</span><br><span class="line">  &#125;</span><br><span class="line">  return 0LL;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>直接上脚本</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">char a[3][7]&#x3D;&#123;&#123;&#39;D&#39;,&#39;u&#39;,&#39;f&#39;,&#39;h&#39;,&#39;b&#39;,&#39;m&#39;,&#39;f&#39;&#125;,&#123;&#39;p&#39;,&#39;G&#39;,&#39;&#96;&#39;,&#39;i&#39;,&#39;m&#39;,&#39;o&#39;,&#39;s&#39;&#125;,&#123;&#39;e&#39;,&#39;w&#39;,&#39;U&#39;,&#39;g</span><br><span class="line">  &#39;,&#39;l&#39;,&#39;p&#39;,&#39;t&#39;&#125;&#125;;</span><br><span class="line">int i;</span><br><span class="line">char flag[11];</span><br><span class="line">for ( i &#x3D; 0; i &lt;&#x3D; 11; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">        flag[i]&#x3D;a[i % 3][2 * (i &#x2F; 3)]-1;</span><br><span class="line">        printf(&quot;%c&quot;,flag[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>Code_Talkers</p></blockquote><h1 id="IgniteMe"><a href="#IgniteMe" class="headerlink" title="IgniteMe"></a>IgniteMe</h1><p><a href="https://adworld.xctf.org.cn/task/answer?type=reverse&number=4&grade=1&id=4590&page=1">题目链接</a><br>ida32打开</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">  v3 &#x3D; sub_402B30(&amp;unk_446360, &quot;Give me your flag:&quot;);</span><br><span class="line">  sub_4013F0(v3, sub_403670);</span><br><span class="line">  sub_401440(v11, 127);</span><br><span class="line">  if ( strlen(v11) &lt; 0x1E &amp;&amp; strlen(v11) &gt; 4 )</span><br><span class="line">  &#123;</span><br><span class="line">    strcpy(v10, &quot;EIS&#123;&quot;);</span><br><span class="line">    for ( i &#x3D; 0; i &lt; strlen(v10); ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      if ( v11[i] !&#x3D; v10[i] )</span><br><span class="line">      &#123;</span><br><span class="line">        v6 &#x3D; sub_402B30(&amp;unk_446360, &quot;Sorry, keep trying! &quot;);</span><br><span class="line">        sub_4013F0(v6, sub_403670);</span><br><span class="line">        return 0;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    if ( v12 &#x3D;&#x3D; &#39;&#125;&#39; )</span><br><span class="line">    &#123;</span><br><span class="line">      if ( sub_4011C0(v11) )</span><br><span class="line">        v8 &#x3D; sub_402B30(&amp;unk_446360, &quot;Congratulations! &quot;);</span><br><span class="line">      else</span><br><span class="line">        v8 &#x3D; sub_402B30(&amp;unk_446360, &quot;Sorry, keep trying! &quot;);</span><br><span class="line">      sub_4013F0(v8, sub_403670);</span><br><span class="line">      result &#x3D; 0;</span><br><span class="line">    &#125;</span><br><span class="line">    else</span><br><span class="line">    &#123;</span><br><span class="line">      v7 &#x3D; sub_402B30(&amp;unk_446360, &quot;Sorry, keep trying! &quot;);</span><br><span class="line">      sub_4013F0(v7, sub_403670);</span><br><span class="line">      result &#x3D; 0;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  else</span><br><span class="line">  &#123;</span><br><span class="line">    v4 &#x3D; sub_402B30(&amp;unk_446360, &quot;Sorry, keep trying!&quot;);</span><br><span class="line">    sub_4013F0(v4, sub_403670);</span><br><span class="line">    result &#x3D; 0;</span><br><span class="line">  &#125;</span><br><span class="line">  return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">bool __cdecl sub_4011C0(char *a1)</span><br><span class="line">&#123;</span><br><span class="line">  size_t v2; &#x2F;&#x2F; eax</span><br><span class="line">  signed int v3; &#x2F;&#x2F; [esp+50h] [ebp-B0h]</span><br><span class="line">  char v4[32]; &#x2F;&#x2F; [esp+54h] [ebp-ACh]</span><br><span class="line">  int v5; &#x2F;&#x2F; [esp+74h] [ebp-8Ch]</span><br><span class="line">  int v6; &#x2F;&#x2F; [esp+78h] [ebp-88h]</span><br><span class="line">  size_t i; &#x2F;&#x2F; [esp+7Ch] [ebp-84h]</span><br><span class="line">  char v8[128]; &#x2F;&#x2F; [esp+80h] [ebp-80h]</span><br><span class="line"></span><br><span class="line">  if ( strlen(a1) &lt;&#x3D; 4 )</span><br><span class="line">    return 0;</span><br><span class="line">  i &#x3D; 4;</span><br><span class="line">  v6 &#x3D; 0;</span><br><span class="line">  while ( i &lt; strlen(a1) - 1 )</span><br><span class="line">    v8[v6++] &#x3D; a1[i++];</span><br><span class="line">  v8[v6] &#x3D; 0;</span><br><span class="line">  v5 &#x3D; 0;</span><br><span class="line">  v3 &#x3D; 0;</span><br><span class="line">  memset(v4, 0, 0x20u);</span><br><span class="line">  for ( i &#x3D; 0; ; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v2 &#x3D; strlen(v8);</span><br><span class="line">    if ( i &gt;&#x3D; v2 )</span><br><span class="line">      break;</span><br><span class="line">    if ( v8[i] &gt;&#x3D; 97 &amp;&amp; v8[i] &lt;&#x3D; 122 )</span><br><span class="line">    &#123;</span><br><span class="line">      v8[i] -&#x3D; 32;</span><br><span class="line">      v3 &#x3D; 1;</span><br><span class="line">    &#125;</span><br><span class="line">    if ( !v3 &amp;&amp; v8[i] &gt;&#x3D; 65 &amp;&amp; v8[i] &lt;&#x3D; 90 )</span><br><span class="line">      v8[i] +&#x3D; 32;</span><br><span class="line">    v4[i] &#x3D; byte_4420B0[i] ^ sub_4013C0(v8[i]);</span><br><span class="line">    v3 &#x3D; 0;</span><br><span class="line">  &#125;</span><br><span class="line">  return strcmp(&quot;GONDPHyGjPEKruv&#123;&#123;pj]X@rF&quot;, v4) &#x3D;&#x3D; 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这道题就是输入flag，然后大小写相互变化，最后再异或。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">int a[32]&#x3D;&#123;0x0D,0x13,0x17,0x11,0x02,0x01,0x20,0x1D,0x0C,0x02,0x19,0x2F,0x17,0x2B,</span><br><span class="line">        0x24,0x1F,0x1E,0x16,0x09,0x0F,0x15,0x27,0x13,0x26,0x0A,0x2F,0x1E,0x1A,0x2D,</span><br><span class="line">0x0C,0x22,0x04&#125;;</span><br><span class="line">char b[24]&#x3D;&quot;GONDPHyGjPEKruv&#123;&#123;pj]X@rF&quot;;</span><br><span class="line">int i,j,v3&#x3D;0;</span><br><span class="line">    for ( i &#x3D; 0; i &lt; 24; i++ )</span><br><span class="line">    &#123;</span><br><span class="line">    b[i]&#x3D;((b[i]^a[i])-72)^0x55;</span><br><span class="line">    if ( b[i] &gt;&#x3D; 97 &amp;&amp; b[i] &lt;&#x3D; 122 )</span><br><span class="line">        &#123;</span><br><span class="line">            b[i] -&#x3D; 32;</span><br><span class="line">            v3 &#x3D; 1;</span><br><span class="line">        &#125;</span><br><span class="line">        if ( !v3 &amp;&amp; b[i] &gt;&#x3D; 65 &amp;&amp; b[i] &lt;&#x3D; 90 )</span><br><span class="line">            b[i] +&#x3D; 32;</span><br><span class="line">    printf(&quot;%c&quot;,b[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>wadx_tdgk_aihc_ihkn_pjlm</p></blockquote><h1 id="easyRE1"><a href="#easyRE1" class="headerlink" title="easyRE1"></a>easyRE1</h1><p><a href="https://adworld.xctf.org.cn/task/answer?type=reverse&number=4&grade=1&id=5592&page=2">题目链接</a><br>ida直接看main函数</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">int __cdecl main(int argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  char s1; &#x2F;&#x2F; [rsp+10h] [rbp-110h]</span><br><span class="line">  unsigned __int64 v5; &#x2F;&#x2F; [rsp+118h] [rbp-8h]</span><br><span class="line"></span><br><span class="line">  v5 &#x3D; __readfsqword(0x28u);</span><br><span class="line">  puts(&quot;What is the password?&quot;);</span><br><span class="line">  gets(&amp;s1);</span><br><span class="line">  if ( !strcmp(&amp;s1, &quot;the password&quot;) )</span><br><span class="line">    puts(&quot;FLAG:db2f62a36a018bce28e46d976e3f9864&quot;);</span><br><span class="line">  else</span><br><span class="line">    puts(&quot;Wrong!!&quot;);</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>试着提交一下，对了。</p><blockquote><p>flag{db2f62a36a018bce28e46d976e3f9864}</p></blockquote><h1 id="ReverseMe-120"><a href="#ReverseMe-120" class="headerlink" title="ReverseMe-120"></a>ReverseMe-120</h1><p><a href="https://adworld.xctf.org.cn/task/answer?type=reverse&number=4&grade=1&id=4825&page=2">题目链接</a><br>ida32打开，查看字符串。</p><p><img src="/2021/03/01/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/ReverseMe-120.png"></p><p>这道题很可能与base家族有关。</p><p><img src="/2021/03/01/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/1.png"></p><p>main函数里的运算只有41-44行<br>写脚本</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">char a[100]&#x3D;&quot;you_know_how_to_remove_junk_code&quot;;</span><br><span class="line">int i;</span><br><span class="line">    for ( i &#x3D; 0; i &lt; strlen(a); i++ )</span><br><span class="line">    &#123;</span><br><span class="line">    a[i] ^&#x3D; 0x25;</span><br><span class="line">    printf(&quot;%c&quot;,a[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>通常情况下，再base64解码就出来了，但这道题竟然是加密，以后还是要认真看ida里的函数。</p><blockquote><p>XEpQek5LSlJ6TUpSelFKeldASEpTQHpPUEtOekZKQUA=</p></blockquote>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>hgame</title>
      <link href="2021/03/01/hgame/"/>
      <url>2021/03/01/hgame/</url>
      
        <content type="html"><![CDATA[<h1 id="apacha"><a href="#apacha" class="headerlink" title="apacha"></a>apacha</h1><a id="more"></a><p><a href="https://pan.baidu.com/s/1M0GtstGLe4Gge1fknju5hQ">题目附件</a>提取码：89ri<br>xxtea加密<br><a href="http://www.elecfans.com/emb/danpianji/20110825212016.html">XXTEA加密算法的原理及其C语言实现</a><br>拖入ida</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall main(__int64 a1, char **a2, char **a3)</span><br><span class="line">&#123;</span><br><span class="line">  _DWORD *v3; &#x2F;&#x2F; rbx</span><br><span class="line">  __int64 v4; &#x2F;&#x2F; rax</span><br><span class="line">  int v6; &#x2F;&#x2F; [rsp+0h] [rbp-48h]</span><br><span class="line">  int v7; &#x2F;&#x2F; [rsp+4h] [rbp-44h]</span><br><span class="line">  int v8; &#x2F;&#x2F; [rsp+8h] [rbp-40h]</span><br><span class="line">  int v9; &#x2F;&#x2F; [rsp+Ch] [rbp-3Ch]</span><br><span class="line">  char v10[40]; &#x2F;&#x2F; [rsp+10h] [rbp-38h]</span><br><span class="line">  unsigned __int64 v11; &#x2F;&#x2F; [rsp+38h] [rbp-10h]</span><br><span class="line"></span><br><span class="line">  v11 &#x3D; __readfsqword(0x28u);</span><br><span class="line">  v6 &#x3D; 1;</span><br><span class="line">  v7 &#x3D; 2;</span><br><span class="line">  v8 &#x3D; 3;</span><br><span class="line">  v9 &#x3D; 4;</span><br><span class="line">  sub_11AA(a1, a2, a3);</span><br><span class="line">  __printf_chk(1LL, &quot;Please input: &quot;);</span><br><span class="line">  __isoc99_scanf(&quot;%35s&quot;, v10);</span><br><span class="line">  if ( (unsigned int)strlen(v10) !&#x3D; 35 )       &#x2F;&#x2F;验证长度</span><br><span class="line">  &#123;</span><br><span class="line">    puts(&quot;wrong length!&quot;);</span><br><span class="line">    exit(0);</span><br><span class="line">  &#125;</span><br><span class="line">  v3 &#x3D; malloc(0x8CuLL);</span><br><span class="line">  v4 &#x3D; 0LL;</span><br><span class="line">  do</span><br><span class="line">  &#123;</span><br><span class="line">    v3[v4] &#x3D; v10[v4];</span><br><span class="line">    ++v4;</span><br><span class="line">  &#125;</span><br><span class="line">  while ( v4 !&#x3D; 35 );</span><br><span class="line">  sub_1447(v3, 35LL, &amp;v6, v10);                &#x2F;&#x2F;xxtea加密</span><br><span class="line">  if ( (unsigned int)sub_1550(v3, 35LL) )      &#x2F;&#x2F;再次验证</span><br><span class="line">    puts(&quot;    :)  Flag is your input.&quot;);</span><br><span class="line">  else</span><br><span class="line">    puts(&quot;    :(  Try again.&quot;);</span><br><span class="line">  return 0LL;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>脚本：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#define MX (z&gt;&gt;5^y&lt;&lt;2) + (y&gt;&gt;3^z&lt;&lt;4)^(sum^y) + (k[p&amp;3^e]^z);</span><br><span class="line">int btea(int* v, int n, unsigned int k[4])       </span><br><span class="line">&#123;</span><br><span class="line">    unsigned int z&#x3D;v[n-1], y&#x3D;v[0], sum&#x3D;0, e, DELTA&#x3D;0x9e3779b9;</span><br><span class="line">int p, q ;</span><br><span class="line">    if (n &gt; 1) </span><br><span class="line">&#123;</span><br><span class="line">    &#x2F;* 加密过程 *&#x2F;</span><br><span class="line">        q &#x3D; 6 + 52&#x2F;n;</span><br><span class="line">        while (q-- &gt; 0)</span><br><span class="line">        &#123;</span><br><span class="line">    sum +&#x3D; DELTA;</span><br><span class="line">e &#x3D; (sum &gt;&gt; 2) &amp; 3;</span><br><span class="line">            for (p&#x3D;0; p&lt;n-1; p++)</span><br><span class="line">&#123;</span><br><span class="line">y &#x3D; v[p+1];</span><br><span class="line">z &#x3D; v[p] +&#x3D; MX;</span><br><span class="line">&#125;</span><br><span class="line">            y &#x3D; v[0];</span><br><span class="line">z &#x3D; v[n-1] +&#x3D; MX;</span><br><span class="line">&#125;</span><br><span class="line">        return 0 ;</span><br><span class="line">    &#125;</span><br><span class="line">else if (n &lt; -1) </span><br><span class="line">&#123;</span><br><span class="line">    &#x2F;* 解密过程 *&#x2F;</span><br><span class="line">        n &#x3D; -n;</span><br><span class="line">q &#x3D; 6 + 52&#x2F;n;</span><br><span class="line">sum &#x3D; q*DELTA ;</span><br><span class="line">        while (sum !&#x3D; 0)</span><br><span class="line">&#123;</span><br><span class="line">    e &#x3D; (sum &gt;&gt; 2) &amp; 3;</span><br><span class="line">            for (p&#x3D;n-1; p&gt;0; p--) </span><br><span class="line">&#123;</span><br><span class="line">z &#x3D; v[p-1];</span><br><span class="line">y &#x3D; v[p] -&#x3D; MX;</span><br><span class="line">&#125;</span><br><span class="line">            z &#x3D; v[n-1]; </span><br><span class="line">y &#x3D; v[0] -&#x3D; MX;</span><br><span class="line">sum -&#x3D; DELTA; </span><br><span class="line">&#125;</span><br><span class="line">        return 0; </span><br><span class="line">&#125;  </span><br><span class="line">return 1; </span><br><span class="line">&#125;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">unsigned int check[35]&#x3D;&#123;0x0E74EB323,0x0B7A72836,0x59CA6FE2,0x967CC5C1,0x0E7802674,0x3D2D54E6,</span><br><span class="line">0x8A9D0356,0x99DCC39C,0x7026D8ED,0x6A33FDAD,0x0F496550A,0x5C9C6F9E,0x1BE5D04C,0x6723AE17,</span><br><span class="line">0x5270A5C2,0x0AC42130A,0x84BE67B2,0x705CC779,0x5C513D98,0x0FB36DA2D,0x22179645,0x5CE3529D,</span><br><span class="line">0x0D189E1FB,0x0E85BD489,0x73C8D11F,0x54B5C196,0x0B67CB490,0x2117E4CA,0x9DE3F994,0x2F5AA1AA,</span><br><span class="line">0x0A7E801FD,0x0C30D6EAB,0x1BADDC9C,0x3453B04A,0x92A406F9&#125;;</span><br><span class="line">int n&#x3D;35;</span><br><span class="line">unsigned int k[4]&#x3D;&#123;1,2,3,4&#125;;</span><br><span class="line">btea(check, -n, k);</span><br><span class="line">int i;</span><br><span class="line">for(i&#x3D;0;i&lt;35;i++)</span><br><span class="line">&#123;</span><br><span class="line">    printf(&quot;%c&quot;,check[i]);</span><br><span class="line">&#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;上述算法描述中，v表示为运算的长整型数据的首地址，k为长整型的密钥的首地址，n表示要要运算的组元个数，正表示加密，负表示解密。N是以32bit为基本单位的组元个数。</span><br></pre></td></tr></table></figure><blockquote><p>hgame{l00ks_1ike_y0u_f0Und_th3_t34}</p></blockquote><h1 id="helloRe"><a href="#helloRe" class="headerlink" title="helloRe"></a>helloRe</h1><p><a href="https://pan.baidu.com/s/1t1QacPyctI_WSWYYMA5_FQ">题目附件</a>提取码：ciyc<br>这道题就是异或与比较<br>直接上脚本</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">char memory[22];</span><br><span class="line">int a&#x3D;0x0FF;</span><br><span class="line">int b[22]&#x3D;&#123;0x97, 0x99, 0x9C, 0x91, 0x9E, 0x81, 0x91, 0x9D, 0x9B, 0x9A, 0x9A, 0xAB, 0x81, 0x97, 0xAE, 0x80, 0x83, 0x8F, 0x94, 0x89, 0x99, 0x97&#125;;</span><br><span class="line">for (int i &#x3D; 0; i &lt; 23; i++)</span><br><span class="line">&#123;</span><br><span class="line">memory[i]&#x3D;b[i]^a;</span><br><span class="line">a--;</span><br><span class="line">&#125;</span><br><span class="line">printf(&quot;%s&quot;, memory);</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br><span class="line">&gt;hgame&#123;hello_re_player&#125;</span><br></pre></td></tr></table></figure><h1 id="pypy"><a href="#pypy" class="headerlink" title="pypy"></a>pypy</h1><p><a href="https://pan.baidu.com/s/11-_mbvb6tZezucy2DbU7CQ">题目附件</a>提取码：a5mm<br>python字节码，参考文档还原，好像有软件可以直接还原。<br><a href="https://docs.python.org/zh-cn/3.7/library/dis.html">文档链接</a><br>大致意思为：输入flag，去flag第六位至倒数第一位，flag[2i]与flag[2i+1]交换，<br>flag[i]^=i,最后输出的flag为30466633346f59213b4139794520572b45514d61583151576638643a</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line">  4           0 LOAD_GLOBAL              0 (input)</span><br><span class="line">              2 LOAD_CONST               1 (&#39;give me your flag:\n&#39;)</span><br><span class="line">              4 CALL_FUNCTION            1</span><br><span class="line">              6 STORE_FAST               0 (raw_flag)</span><br><span class="line"></span><br><span class="line">  5           8 LOAD_GLOBAL              1 (list)</span><br><span class="line">             10 LOAD_FAST                0 (raw_flag)</span><br><span class="line">             12 LOAD_CONST               2 (6)</span><br><span class="line">             14 LOAD_CONST               3 (-1)</span><br><span class="line">             16 BUILD_SLICE              2                  </span><br><span class="line">             18 BINARY_SUBSCR</span><br><span class="line">             20 CALL_FUNCTION            1</span><br><span class="line">             22 STORE_FAST               1 (cipher)              cipher&#x3D;flag[6::-1]</span><br><span class="line"></span><br><span class="line">  6          24 LOAD_GLOBAL              2 (len)</span><br><span class="line">             26 LOAD_FAST                1 (cipher)</span><br><span class="line">             28 CALL_FUNCTION            1</span><br><span class="line">             30 STORE_FAST               2 (length)           length&#x3D;len(cipher)</span><br><span class="line"></span><br><span class="line">  8          32 LOAD_GLOBAL              3 (range)</span><br><span class="line">             34 LOAD_FAST                2 (length)</span><br><span class="line">             36 LOAD_CONST               4 (2)</span><br><span class="line">             38 BINARY_FLOOR_DIVIDE                              range(length&#x2F;2)</span><br><span class="line">             40 CALL_FUNCTION            1</span><br><span class="line">             42 GET_ITER</span><br><span class="line">        &gt;&gt;   44 FOR_ITER                54 (to 100)</span><br><span class="line">             46 STORE_FAST               3 (i)</span><br><span class="line"></span><br><span class="line">  9          48 LOAD_FAST                1 (cipher)</span><br><span class="line">             50 LOAD_CONST               4 (2)</span><br><span class="line">             52 LOAD_FAST                3 (i)</span><br><span class="line">             54 BINARY_MULTIPLY                                  2i</span><br><span class="line">             56 LOAD_CONST               5 (1)</span><br><span class="line">             58 BINARY_ADD                                       2i+1</span><br><span class="line">             60 BINARY_SUBSCR                                    cipher[2i+1]</span><br><span class="line">             62 LOAD_FAST                1 (cipher)</span><br><span class="line">             64 LOAD_CONST               4 (2)</span><br><span class="line">             66 LOAD_FAST                3 (i)</span><br><span class="line">             68 BINARY_MULTIPLY</span><br><span class="line">             70 BINARY_SUBSCR                                    cipher[2i]</span><br><span class="line">             72 ROT_TWO                                          cipher[2i]与cipher[2i+1]交换</span><br><span class="line">             74 LOAD_FAST                1 (cipher)</span><br><span class="line">             76 LOAD_CONST               4 (2)</span><br><span class="line">             78 LOAD_FAST                3 (i)</span><br><span class="line">             80 BINARY_MULTIPLY</span><br><span class="line">             82 STORE_SUBSCR</span><br><span class="line">             84 LOAD_FAST                1 (cipher)</span><br><span class="line">             86 LOAD_CONST               4 (2)</span><br><span class="line">             88 LOAD_FAST                3 (i)</span><br><span class="line">             90 BINARY_MULTIPLY</span><br><span class="line">             92 LOAD_CONST               5 (1)</span><br><span class="line">             94 BINARY_ADD</span><br><span class="line">             96 STORE_SUBSCR                                     新的cipher</span><br><span class="line">             98 JUMP_ABSOLUTE           44</span><br><span class="line"></span><br><span class="line"> 12     &gt;&gt;  100 BUILD_LIST               0</span><br><span class="line">            102 STORE_FAST               4 (res)</span><br><span class="line"></span><br><span class="line"> 13         104 LOAD_GLOBAL              3 (range)</span><br><span class="line">            106 LOAD_FAST                2 (length)</span><br><span class="line">            108 CALL_FUNCTION            1</span><br><span class="line">            110 GET_ITER                                         range(length)</span><br><span class="line">        &gt;&gt;  112 FOR_ITER                26 (to 140)</span><br><span class="line">            114 STORE_FAST               3 (i)</span><br><span class="line"></span><br><span class="line"> 14         116 LOAD_FAST                4 (res)</span><br><span class="line">            118 LOAD_METHOD              4 (append)</span><br><span class="line">            120 LOAD_GLOBAL              5 (ord)</span><br><span class="line">            122 LOAD_FAST                1 (cipher)</span><br><span class="line">            124 LOAD_FAST                3 (i)</span><br><span class="line">            126 BINARY_SUBSCR</span><br><span class="line">            128 CALL_FUNCTION            1</span><br><span class="line">            130 LOAD_FAST                3 (i)</span><br><span class="line">            132 BINARY_XOR                                       res&#x3D;ord(cipher[i])^i</span><br><span class="line">            134 CALL_METHOD              1</span><br><span class="line">            136 POP_TOP</span><br><span class="line">            138 JUMP_ABSOLUTE          112</span><br><span class="line"></span><br><span class="line"> 15     &gt;&gt;  140 LOAD_GLOBAL              6 (bytes)</span><br><span class="line">            142 LOAD_FAST                4 (res)</span><br><span class="line">            144 CALL_FUNCTION            1</span><br><span class="line">            146 LOAD_METHOD              7 (hex)</span><br><span class="line">            148 CALL_METHOD              0</span><br><span class="line">            150 STORE_FAST               4 (res)</span><br><span class="line"></span><br><span class="line"> 16         152 LOAD_GLOBAL              8 (print)</span><br><span class="line">            154 LOAD_CONST               6 (&#39;your flag: &#39;)  </span><br><span class="line">            156 LOAD_FAST                4 (res)                 输出res(hex)</span><br><span class="line">            158 BINARY_ADD</span><br><span class="line">            160 CALL_FUNCTION            1</span><br><span class="line">            162 POP_TOP</span><br><span class="line">            164 LOAD_CONST               0 (None)</span><br><span class="line">            166 RETURN_VALUE</span><br><span class="line"></span><br><span class="line"># your flag: 30466633346f59213b4139794520572b45514d61583151576638643a</span><br></pre></td></tr></table></figure><p>脚本：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">int flag[28]&#x3D;&#123;0x30,0x46,0x66,0x33,0x34,0x6f,0x59,0x21,0x3b,0x41,0x39,0x79,0x45,0x20,0x57,0x2b,0x45,0x51,0x4d,0x61,0x58,0x31,0x51,0x57,0x66,0x38,0x64,0x3a&#125;;</span><br><span class="line">int i,a;</span><br><span class="line">for(i&#x3D;0;i&lt;28;i++)</span><br><span class="line">&#123;</span><br><span class="line">flag[i]^&#x3D;i;</span><br><span class="line">&#125;</span><br><span class="line">for(i&#x3D;0;i&lt;14;i++)</span><br><span class="line">&#123;</span><br><span class="line">a&#x3D;flag[2*i];</span><br><span class="line">flag[2*i]&#x3D;flag[2*i+1];</span><br><span class="line">flag[2*i+1]&#x3D;a;</span><br><span class="line">&#125;</span><br><span class="line">for(i&#x3D;0;i&lt;28;i++)</span><br><span class="line">&#123;</span><br><span class="line">printf(&quot;%c&quot;,flag[i]);</span><br><span class="line">&#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hgame&#123;G00dj0&amp;_H3r3-I$Y@Ur_$L@G!~!~&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>刷题记录</title>
      <link href="2021/03/01/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/"/>
      <url>2021/03/01/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<h1 id="luck-guy"><a href="#luck-guy" class="headerlink" title="luck_guy"></a>luck_guy</h1><a id="more"></a><p><a href="https://buuoj.cn/challenges#[GXYCTF2019]luck_guy">题目链接</a><br>查看文件信息，是64位文件，拖进ida里，可以发现get_flag为flag的变换函数。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">unsigned __int64 get_flag()</span><br><span class="line">&#123;</span><br><span class="line">  unsigned int v0; &#x2F;&#x2F; eax</span><br><span class="line">  char v1; &#x2F;&#x2F; al</span><br><span class="line">  signed int i; &#x2F;&#x2F; [rsp+4h] [rbp-3Ch]</span><br><span class="line">  signed int j; &#x2F;&#x2F; [rsp+8h] [rbp-38h]</span><br><span class="line">  __int64 s; &#x2F;&#x2F; [rsp+10h] [rbp-30h]</span><br><span class="line">  char v6; &#x2F;&#x2F; [rsp+18h] [rbp-28h]</span><br><span class="line">  unsigned __int64 v7; &#x2F;&#x2F; [rsp+38h] [rbp-8h]</span><br><span class="line"></span><br><span class="line">  v7 &#x3D; __readfsqword(0x28u);</span><br><span class="line">  v0 &#x3D; time(0LL);</span><br><span class="line">  srand(v0);</span><br><span class="line">  for ( i &#x3D; 0; i &lt;&#x3D; 4; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    switch ( rand() % 200 )</span><br><span class="line">    &#123;</span><br><span class="line">      case 1:</span><br><span class="line">        puts(&quot;OK, it&#39;s flag:&quot;);</span><br><span class="line">        memset(&amp;s, 0, 0x28uLL);</span><br><span class="line">        strcat(&amp;s, f1);</span><br><span class="line">        strcat(&amp;s, &amp;f2);</span><br><span class="line">        printf(&quot;%s&quot;, &amp;s);</span><br><span class="line">        break;</span><br><span class="line">      case 2:</span><br><span class="line">        printf(&quot;Solar not like you&quot;);</span><br><span class="line">        break;</span><br><span class="line">      case 3:</span><br><span class="line">        printf(&quot;Solar want a girlfriend&quot;);</span><br><span class="line">        break;</span><br><span class="line">      case 4:</span><br><span class="line">        v6 &#x3D; 0;</span><br><span class="line">        s &#x3D; 9180147350284624745LL;</span><br><span class="line">        strcat(&amp;f2, &amp;s);</span><br><span class="line">        break;</span><br><span class="line">      case 5:</span><br><span class="line">        for ( j &#x3D; 0; j &lt;&#x3D; 7; ++j )</span><br><span class="line">        &#123;</span><br><span class="line">          if ( j % 2 &#x3D;&#x3D; 1 )</span><br><span class="line">            v1 &#x3D; *(&amp;f2 + j) - 2;</span><br><span class="line">          else</span><br><span class="line">            v1 &#x3D; *(&amp;f2 + j) - 1;</span><br><span class="line">          *(&amp;f2 + j) &#x3D; v1;</span><br><span class="line">        &#125;</span><br><span class="line">        break;</span><br><span class="line">      default:</span><br><span class="line">        puts(&quot;emmm,you can&#39;t find flag 23333&quot;);</span><br><span class="line">        break;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  return __readfsqword(0x28u) ^ v7;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这里是先运行case 4，然后case 5，最后case 1.<br>脚本：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">int a[8]&#x3D;&#123;0x69,0x63,0x75,0x67,0x60,0x6f,0x66,0x7f&#125;;</span><br><span class="line">int i,v1;</span><br><span class="line">for(i&#x3D;0;i&lt;8;i++)</span><br><span class="line">&#123;</span><br><span class="line">if ( i % 2 &#x3D;&#x3D; 1 )</span><br><span class="line">            a[i] -&#x3D; 2;</span><br><span class="line">        else</span><br><span class="line">            a[i] -&#x3D; 1;</span><br><span class="line">        printf(&quot;%c&quot;,a[i]);</span><br><span class="line">&#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>flag{do_not_hate_me}</p></blockquote><h1 id="JustRE"><a href="#JustRE" class="headerlink" title="JustRE"></a>JustRE</h1><p><a href="https://buuoj.cn/challenges#[BJDCTF2020]JustRE">题目链接</a><br>ida32打开</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">BOOL __stdcall DialogFunc(HWND hWnd, UINT a2, WPARAM a3, LPARAM a4)</span><br><span class="line">&#123;</span><br><span class="line">  CHAR String; &#x2F;&#x2F; [esp+0h] [ebp-64h]</span><br><span class="line"></span><br><span class="line">  if ( a2 !&#x3D; 272 )</span><br><span class="line">  &#123;</span><br><span class="line">    if ( a2 !&#x3D; 273 )</span><br><span class="line">      return 0;</span><br><span class="line">    if ( a3 !&#x3D; 1 &amp;&amp; a3 !&#x3D; 2 )</span><br><span class="line">    &#123;</span><br><span class="line">      sprintf(&amp;String, aD, ++dword_4099F0);</span><br><span class="line">      if ( dword_4099F0 &#x3D;&#x3D; 19999 )</span><br><span class="line">      &#123;</span><br><span class="line">        sprintf(&amp;String, aBjdDD2069a4579, 19999, 0);</span><br><span class="line">        SetWindowTextA(hWnd, &amp;String);</span><br><span class="line">        return 0;</span><br><span class="line">      &#125;</span><br><span class="line">      SetWindowTextA(hWnd, &amp;String);</span><br><span class="line">      return 0;</span><br><span class="line">    &#125;</span><br><span class="line">    EndDialog(hWnd, a3);</span><br><span class="line">  &#125;</span><br><span class="line">  return 1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>第14行，我把那两个数直接带进去，就对了。</p><blockquote><p>flag{1999902069a45792d233ac}</p></blockquote><h1 id="rome"><a href="#rome" class="headerlink" title="rome"></a>rome</h1><p><a href="https://buuoj.cn/challenges#[ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020]rome">题目链接</a><br>ida32打开</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line">int func()</span><br><span class="line">&#123;</span><br><span class="line">  int result; &#x2F;&#x2F; eax</span><br><span class="line">  int v1; &#x2F;&#x2F; [esp+14h] [ebp-44h]</span><br><span class="line">  int v2; &#x2F;&#x2F; [esp+18h] [ebp-40h]</span><br><span class="line">  int v3; &#x2F;&#x2F; [esp+1Ch] [ebp-3Ch]</span><br><span class="line">  int v4; &#x2F;&#x2F; [esp+20h] [ebp-38h]</span><br><span class="line">  unsigned __int8 v5; &#x2F;&#x2F; [esp+24h] [ebp-34h]</span><br><span class="line">  unsigned __int8 v6; &#x2F;&#x2F; [esp+25h] [ebp-33h]</span><br><span class="line">  unsigned __int8 v7; &#x2F;&#x2F; [esp+26h] [ebp-32h]</span><br><span class="line">  unsigned __int8 v8; &#x2F;&#x2F; [esp+27h] [ebp-31h]</span><br><span class="line">  unsigned __int8 v9; &#x2F;&#x2F; [esp+28h] [ebp-30h]</span><br><span class="line">  int v10; &#x2F;&#x2F; [esp+29h] [ebp-2Fh]</span><br><span class="line">  int v11; &#x2F;&#x2F; [esp+2Dh] [ebp-2Bh]</span><br><span class="line">  int v12; &#x2F;&#x2F; [esp+31h] [ebp-27h]</span><br><span class="line">  int v13; &#x2F;&#x2F; [esp+35h] [ebp-23h]</span><br><span class="line">  unsigned __int8 v14; &#x2F;&#x2F; [esp+39h] [ebp-1Fh]</span><br><span class="line">  char v15; &#x2F;&#x2F; [esp+3Bh] [ebp-1Dh]</span><br><span class="line">  char v16; &#x2F;&#x2F; [esp+3Ch] [ebp-1Ch]</span><br><span class="line">  char v17; &#x2F;&#x2F; [esp+3Dh] [ebp-1Bh]</span><br><span class="line">  char v18; &#x2F;&#x2F; [esp+3Eh] [ebp-1Ah]</span><br><span class="line">  char v19; &#x2F;&#x2F; [esp+3Fh] [ebp-19h]</span><br><span class="line">  char v20; &#x2F;&#x2F; [esp+40h] [ebp-18h]</span><br><span class="line">  char v21; &#x2F;&#x2F; [esp+41h] [ebp-17h]</span><br><span class="line">  char v22; &#x2F;&#x2F; [esp+42h] [ebp-16h]</span><br><span class="line">  char v23; &#x2F;&#x2F; [esp+43h] [ebp-15h]</span><br><span class="line">  char v24; &#x2F;&#x2F; [esp+44h] [ebp-14h]</span><br><span class="line">  char v25; &#x2F;&#x2F; [esp+45h] [ebp-13h]</span><br><span class="line">  char v26; &#x2F;&#x2F; [esp+46h] [ebp-12h]</span><br><span class="line">  char v27; &#x2F;&#x2F; [esp+47h] [ebp-11h]</span><br><span class="line">  char v28; &#x2F;&#x2F; [esp+48h] [ebp-10h]</span><br><span class="line">  char v29; &#x2F;&#x2F; [esp+49h] [ebp-Fh]</span><br><span class="line">  char v30; &#x2F;&#x2F; [esp+4Ah] [ebp-Eh]</span><br><span class="line">  char v31; &#x2F;&#x2F; [esp+4Bh] [ebp-Dh]</span><br><span class="line">  int i; &#x2F;&#x2F; [esp+4Ch] [ebp-Ch]</span><br><span class="line"></span><br><span class="line">  v15 &#x3D; 81;</span><br><span class="line">  v16 &#x3D; 115;</span><br><span class="line">  v17 &#x3D; 119;</span><br><span class="line">  v18 &#x3D; 51;</span><br><span class="line">  v19 &#x3D; 115;</span><br><span class="line">  v20 &#x3D; 106;</span><br><span class="line">  v21 &#x3D; 95;</span><br><span class="line">  v22 &#x3D; 108;</span><br><span class="line">  v23 &#x3D; 122;</span><br><span class="line">  v24 &#x3D; 52;</span><br><span class="line">  v25 &#x3D; 95;</span><br><span class="line">  v26 &#x3D; 85;</span><br><span class="line">  v27 &#x3D; 106;</span><br><span class="line">  v28 &#x3D; 119;</span><br><span class="line">  v29 &#x3D; 64;</span><br><span class="line">  v30 &#x3D; 108;</span><br><span class="line">  v31 &#x3D; 0;</span><br><span class="line">  printf(&quot;Please input:&quot;);</span><br><span class="line">  scanf(&quot;%s&quot;, &amp;v5);</span><br><span class="line">  result &#x3D; v5;</span><br><span class="line">  if ( v5 &#x3D;&#x3D; &#39;A&#39; )</span><br><span class="line">  &#123;</span><br><span class="line">    result &#x3D; v6;</span><br><span class="line">    if ( v6 &#x3D;&#x3D; &#39;C&#39; )</span><br><span class="line">    &#123;</span><br><span class="line">      result &#x3D; v7;</span><br><span class="line">      if ( v7 &#x3D;&#x3D; &#39;T&#39; )</span><br><span class="line">      &#123;</span><br><span class="line">        result &#x3D; v8;</span><br><span class="line">        if ( v8 &#x3D;&#x3D; &#39;F&#39; )</span><br><span class="line">        &#123;</span><br><span class="line">          result &#x3D; v9;</span><br><span class="line">          if ( v9 &#x3D;&#x3D; &#39;&#123;&#39; )</span><br><span class="line">          &#123;</span><br><span class="line">            result &#x3D; v14;</span><br><span class="line">            if ( v14 &#x3D;&#x3D; &#39;&#125;&#39; )</span><br><span class="line">            &#123;</span><br><span class="line">              v1 &#x3D; v10;</span><br><span class="line">              v2 &#x3D; v11;</span><br><span class="line">              v3 &#x3D; v12;</span><br><span class="line">              v4 &#x3D; v13;</span><br><span class="line">              for ( i &#x3D; 0; i &lt;&#x3D; 15; ++i )</span><br><span class="line">              &#123;</span><br><span class="line">                if ( *(&amp;v1 + i) &gt; 64 &amp;&amp; *(&amp;v1 + i) &lt;&#x3D; 90 )</span><br><span class="line">                  *(&amp;v1 + i) &#x3D; (*(&amp;v1 + i) - 51) % 26 + 65;</span><br><span class="line">                if ( *(&amp;v1 + i) &gt; 96 &amp;&amp; *(&amp;v1 + i) &lt;&#x3D; 122 )</span><br><span class="line">                  *(&amp;v1 + i) &#x3D; (*(&amp;v1 + i) - 79) % 26 + 97;</span><br><span class="line">              &#125;</span><br><span class="line">              for ( i &#x3D; 0; i &lt;&#x3D; 15; ++i )</span><br><span class="line">              &#123;</span><br><span class="line">                result &#x3D; *(&amp;v15 + i);</span><br><span class="line">                if ( *(&amp;v1 + i) !&#x3D; result )</span><br><span class="line">                  return result;</span><br><span class="line">              &#125;</span><br><span class="line">              result &#x3D; printf(&quot;You are correct!&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这里就是你输入16个字符，经过变化和v15-v30比较，直接爆破。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">int check[16]&#x3D;&#123;81,115,119,51,115,106,95,108,122,52,95,85,106,119,64,108&#125;;</span><br><span class="line">int i,j,k;</span><br><span class="line">    for ( i &#x3D; 0; i &lt; 16; i++ )</span><br><span class="line">    &#123;</span><br><span class="line">        for(j&#x3D;0;j&lt;127;j++)</span><br><span class="line">        &#123;</span><br><span class="line">        k&#x3D;j;</span><br><span class="line">            if ( j &gt; 64 &amp;&amp; j &lt;&#x3D; 90 )</span><br><span class="line">                j &#x3D; (j - 51) % 26 + 65;</span><br><span class="line">            if ( j &gt; 96 &amp;&amp; j &lt;&#x3D; 122 )</span><br><span class="line">                j &#x3D; (j - 79) % 26 + 97;</span><br><span class="line">            if(j&#x3D;&#x3D;check[i])</span><br><span class="line">                printf(&quot;%c&quot;,k);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>flag{Cae3ar_th4_Gre@t}</p></blockquote><h1 id="re"><a href="#re" class="headerlink" title="re"></a>re</h1><p><a href="https://buuoj.cn/challenges#[GUET-CTF2019]re">题目链接</a><br>文件包有upx壳，脱掉。<br>进入main函数，然后跳至sub_4009AE，a1为flag，算出来就行，第七位没有，手动爆破。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">_BOOL8 __fastcall sub_4009AE(char *a1)</span><br><span class="line">&#123;</span><br><span class="line">  if ( 1629056 * *a1 !&#x3D; 166163712 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 6771600 * a1[1] !&#x3D; 731332800 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 3682944 * a1[2] !&#x3D; 357245568 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 10431000 * a1[3] !&#x3D; 1074393000 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 3977328 * a1[4] !&#x3D; 489211344 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 5138336 * a1[5] !&#x3D; 518971936 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 7532250 * a1[7] !&#x3D; 406741500 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 5551632 * a1[8] !&#x3D; 294236496 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 3409728 * a1[9] !&#x3D; 177305856 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 13013670 * a1[10] !&#x3D; 650683500 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 6088797 * a1[11] !&#x3D; 298351053 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 7884663 * a1[12] !&#x3D; 386348487 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 8944053 * a1[13] !&#x3D; 438258597 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 5198490 * a1[14] !&#x3D; 249527520 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 4544518 * a1[15] !&#x3D; 445362764 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 3645600 * a1[17] !&#x3D; 174988800 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 10115280 * a1[16] !&#x3D; 981182160 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 9667504 * a1[18] !&#x3D; 493042704 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 5364450 * a1[19] !&#x3D; 257493600 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 13464540 * a1[20] !&#x3D; 767478780 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 5488432 * a1[21] !&#x3D; 312840624 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 14479500 * a1[22] !&#x3D; 1404511500 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 6451830 * a1[23] !&#x3D; 316139670 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 6252576 * a1[24] !&#x3D; 619005024 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 7763364 * a1[25] !&#x3D; 372641472 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 7327320 * a1[26] !&#x3D; 373693320 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 8741520 * a1[27] !&#x3D; 498266640 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 8871876 * a1[28] !&#x3D; 452465676 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 4086720 * a1[29] !&#x3D; 208422720 )</span><br><span class="line">    return 0LL;</span><br><span class="line">  if ( 9374400 * a1[30] &#x3D;&#x3D; 515592000 )</span><br><span class="line">    return 5759124 * a1[31] &#x3D;&#x3D; 719890500;</span><br><span class="line">  return 0LL;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>flag{e165421110ba03099a1c039337}</p></blockquote><h1 id="level1"><a href="#level1" class="headerlink" title="level1"></a>level1</h1><p><a href="https://buuoj.cn/challenges#[WUSTCTF2020]level1">题目链接</a><br>ida64打开<br>找到main函数，这里逻辑很清晰，直接上脚本。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">int a1[19]&#x3D;&#123;198,232,816,200,1536,300,6144,984,51200,570,92160,1200,565248,756,1474560,800</span><br><span class="line">    6291456,1782,65536000&#125;;</span><br><span class="line">int i;</span><br><span class="line">for(i&#x3D;0;i&lt;19;i++)</span><br><span class="line">&#123;</span><br><span class="line">if ( (i+1) &amp; 1 )</span><br><span class="line">            printf(&quot;%c&quot;, (a1[i] &gt;&gt; (i+1) ) );</span><br><span class="line">        else</span><br><span class="line">            printf(&quot;%c&quot;, (a1[i]&#x2F;(i+1) ) );</span><br><span class="line">&#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>flag{d9-dE6-20c}</p></blockquote><h1 id="xxor"><a href="#xxor" class="headerlink" title="xxor"></a>xxor</h1><p>ida64打开<br>进入main函数</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall main(__int64 a1, char **a2, char **a3)</span><br><span class="line">&#123;</span><br><span class="line">  signed int i; &#x2F;&#x2F; [rsp+8h] [rbp-68h]</span><br><span class="line">  signed int j; &#x2F;&#x2F; [rsp+Ch] [rbp-64h]</span><br><span class="line">  __int64 v6; &#x2F;&#x2F; [rsp+10h] [rbp-60h]</span><br><span class="line">  __int64 v7; &#x2F;&#x2F; [rsp+18h] [rbp-58h]</span><br><span class="line">  __int64 v8; &#x2F;&#x2F; [rsp+20h] [rbp-50h]</span><br><span class="line">  __int64 v9; &#x2F;&#x2F; [rsp+28h] [rbp-48h]</span><br><span class="line">  __int64 v10; &#x2F;&#x2F; [rsp+30h] [rbp-40h]</span><br><span class="line">  __int64 v11; &#x2F;&#x2F; [rsp+40h] [rbp-30h]</span><br><span class="line">  __int64 v12; &#x2F;&#x2F; [rsp+48h] [rbp-28h]</span><br><span class="line">  __int64 v13; &#x2F;&#x2F; [rsp+50h] [rbp-20h]</span><br><span class="line">  __int64 v14; &#x2F;&#x2F; [rsp+58h] [rbp-18h]</span><br><span class="line">  __int64 v15; &#x2F;&#x2F; [rsp+60h] [rbp-10h]</span><br><span class="line">  unsigned __int64 v16; &#x2F;&#x2F; [rsp+68h] [rbp-8h]</span><br><span class="line"></span><br><span class="line">  v16 &#x3D; __readfsqword(0x28u);</span><br><span class="line">  puts(&quot;Let us play a game?&quot;);</span><br><span class="line">  puts(&quot;you have six chances to input&quot;);</span><br><span class="line">  puts(&quot;Come on!&quot;);</span><br><span class="line">  v6 &#x3D; 0LL;</span><br><span class="line">  v7 &#x3D; 0LL;</span><br><span class="line">  v8 &#x3D; 0LL;</span><br><span class="line">  v9 &#x3D; 0LL;</span><br><span class="line">  v10 &#x3D; 0LL;</span><br><span class="line">  for ( i &#x3D; 0; i &lt;&#x3D; 5; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    printf(&quot;%s&quot;, &quot;input: &quot;, i);</span><br><span class="line">    __isoc99_scanf(&quot;%d&quot;, &amp;v6 + 4 * i);</span><br><span class="line">  &#125;</span><br><span class="line">  v11 &#x3D; 0LL;</span><br><span class="line">  v12 &#x3D; 0LL;</span><br><span class="line">  v13 &#x3D; 0LL;</span><br><span class="line">  v14 &#x3D; 0LL;</span><br><span class="line">  v15 &#x3D; 0LL;</span><br><span class="line">  for ( j &#x3D; 0; j &lt;&#x3D; 4; j +&#x3D; 2 )</span><br><span class="line">  &#123;</span><br><span class="line">    dword_601078 &#x3D; *(&amp;v6 + j);</span><br><span class="line">    dword_60107C &#x3D; *(&amp;v6 + j + 1);</span><br><span class="line">    sub_400686(&amp;dword_601078, &amp;unk_601060);</span><br><span class="line">    *(&amp;v11 + j) &#x3D; dword_601078;</span><br><span class="line">    *(&amp;v11 + j + 1) &#x3D; dword_60107C;</span><br><span class="line">  &#125;</span><br><span class="line">  if ( sub_400770(&amp;v11) !&#x3D; 1 )</span><br><span class="line">  &#123;</span><br><span class="line">    puts(&quot;NO NO NO~ &quot;);</span><br><span class="line">    exit(0);</span><br><span class="line">  &#125;</span><br><span class="line">  puts(&quot;Congratulation!\n&quot;);</span><br><span class="line">  puts(&quot;You seccess half\n&quot;);</span><br><span class="line">  puts(&quot;Do not forget to change input to hex and combine~\n&quot;);</span><br><span class="line">  puts(&quot;ByeBye&quot;);</span><br><span class="line">  return 0LL;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这道题分为两步，我们从下往上分析。</p><h2 id="sub-400770"><a href="#sub-400770" class="headerlink" title="sub_400770"></a>sub_400770</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">signed __int64 __fastcall sub_400770(_DWORD *a1)</span><br><span class="line">&#123;</span><br><span class="line">  signed __int64 result; &#x2F;&#x2F; rax</span><br><span class="line"></span><br><span class="line">  if ( a1[2] - a1[3] !&#x3D; 2225223423LL || a1[3] + a1[4] !&#x3D; 4201428739LL || a1[2] - a1[4] !&#x3D; </span><br><span class="line">    1121399208LL )</span><br><span class="line">  &#123;</span><br><span class="line">    puts(&quot;Wrong!&quot;);</span><br><span class="line">    result &#x3D; 0LL;</span><br><span class="line">  &#125;</span><br><span class="line">  else if ( *a1 !&#x3D; -548868226 || a1[5] !&#x3D; -2064448480 || a1[1] !&#x3D; 550153460 )</span><br><span class="line">  &#123;</span><br><span class="line">    puts(&quot;Wrong!&quot;);</span><br><span class="line">    result &#x3D; 0LL;</span><br><span class="line">  &#125;</span><br><span class="line">  else</span><br><span class="line">  &#123;</span><br><span class="line">    puts(&quot;good!&quot;);</span><br><span class="line">    result &#x3D; 1LL;</span><br><span class="line">  &#125;</span><br><span class="line">  return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个函数简单，计算方程组就行。</p><blockquote><p>a1[2] - a1[3] == 2225223423<br>a1[3] + a1[4] == 4201428739<br>a1[2] - a1[4] == 1121399208<br>结果：a1[2]3774025685  a1[3]=1548802262  a1[4]=2652626477</p></blockquote><h2 id="sub-400686"><a href="#sub-400686" class="headerlink" title="sub_400686"></a>sub_400686</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall sub_400686(unsigned int *a1, _DWORD *a2)</span><br><span class="line">&#123;</span><br><span class="line">  __int64 result; &#x2F;&#x2F; rax</span><br><span class="line">  unsigned int v3; &#x2F;&#x2F; [rsp+1Ch] [rbp-24h]</span><br><span class="line">  unsigned int v4; &#x2F;&#x2F; [rsp+20h] [rbp-20h]</span><br><span class="line">  int v5; &#x2F;&#x2F; [rsp+24h] [rbp-1Ch]</span><br><span class="line">  unsigned int i; &#x2F;&#x2F; [rsp+28h] [rbp-18h]</span><br><span class="line"></span><br><span class="line">  v3 &#x3D; *a1;</span><br><span class="line">  v4 &#x3D; a1[1];</span><br><span class="line">  v5 &#x3D; 0;</span><br><span class="line">  for ( i &#x3D; 0; i &lt;&#x3D; 0x3F; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v5 +&#x3D; 1166789954;</span><br><span class="line">    v3 +&#x3D; (v4 + v5 + 11) ^ ((v4 &lt;&lt; 6) + *a2) ^ ((v4 &gt;&gt; 9) + a2[1]) ^ 0x20;</span><br><span class="line">    v4 +&#x3D; (v3 + v5 + 20) ^ ((v3 &lt;&lt; 6) + a2[2]) ^ ((v3 &gt;&gt; 9) + a2[3]) ^ 0x10;</span><br><span class="line">  &#125;</span><br><span class="line">  *a1 &#x3D; v3;</span><br><span class="line">  result &#x3D; v4;</span><br><span class="line">  a1[1] &#x3D; v4;</span><br><span class="line">  return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>a1为flag，a[2]={2,2,3,4}<br>这个函数就是进行异或操作，我们将它逆过来。<br>脚本：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    unsigned int a[6]&#x3D;&#123;3746099070,550153460,3774025685,1548802262,2652626477,2230518816 &#125;;</span><br><span class="line">    unsigned int b[4]&#x3D;&#123;2,2,3,4&#125;;</span><br><span class="line">    unsigned int v3, v4,v5;</span><br><span class="line">    int i;</span><br><span class="line">    for ( i &#x3D; 0; i &lt;&#x3D; 4; i +&#x3D; 2)</span><br><span class="line">    &#123;</span><br><span class="line">        v3 &#x3D; a[i];</span><br><span class="line">        v4 &#x3D; a[i + 1];</span><br><span class="line">        v5 &#x3D; 1166789954*0x40;</span><br><span class="line">        for (int i &#x3D; 0; i &lt;&#x3D; 0x3F; ++i) &#123;</span><br><span class="line">            v4 -&#x3D; (v3 + v5 + 20) ^ ((v3 &lt;&lt; 6) + b[2]) ^ ((v3 &gt;&gt; 9) + b[3]) ^ 0x10;</span><br><span class="line">            v3 -&#x3D; (v4 + v5 + 11) ^ ((v4 &lt;&lt; 6) + b[0]) ^ ((v4 &gt;&gt; 9) + b[1]) ^ 0x20;</span><br><span class="line">            v5 -&#x3D; 1166789954;</span><br><span class="line">        &#125;</span><br><span class="line">        a[i] &#x3D; v3;</span><br><span class="line">        a[i + 1] &#x3D; v4;</span><br><span class="line">    &#125;</span><br><span class="line">    for (i&#x3D;0;i&lt;6;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        printf(&quot;%0x&quot;,a[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出的十六进制再转为字符串。</p><blockquote><p>flag{re_is_great!}</p></blockquote><h1 id="Challenge1"><a href="#Challenge1" class="headerlink" title="Challenge1"></a>Challenge1</h1><p>ida32打开，进入main函数</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">int __cdecl main(int argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  char Buffer; &#x2F;&#x2F; [esp+0h] [ebp-94h]</span><br><span class="line">  char *v5; &#x2F;&#x2F; [esp+80h] [ebp-14h]</span><br><span class="line">  char *v6; &#x2F;&#x2F; [esp+84h] [ebp-10h]</span><br><span class="line">  HANDLE v7; &#x2F;&#x2F; [esp+88h] [ebp-Ch]</span><br><span class="line">  HANDLE hFile; &#x2F;&#x2F; [esp+8Ch] [ebp-8h]</span><br><span class="line">  DWORD NumberOfBytesWritten; &#x2F;&#x2F; [esp+90h] [ebp-4h]</span><br><span class="line"></span><br><span class="line">  hFile &#x3D; GetStdHandle(0xFFFFFFF5);</span><br><span class="line">  v7 &#x3D; GetStdHandle(0xFFFFFFF6);</span><br><span class="line">  v6 &#x3D; &quot;x2dtJEOmyjacxDemx2eczT5cVS9fVUGvWTuZWjuexjRqy24rV29q&quot;;</span><br><span class="line">  WriteFile(hFile, &quot;Enter password:\r\n&quot;, 0x12u, &amp;NumberOfBytesWritten, 0);</span><br><span class="line">  ReadFile(v7, &amp;Buffer, 0x80u, &amp;NumberOfBytesWritten, 0);</span><br><span class="line">  v5 &#x3D; sub_401260(&amp;Buffer, NumberOfBytesWritten - 2);</span><br><span class="line">  if ( !strcmp(v5, v6) )</span><br><span class="line">    WriteFile(hFile, &quot;Correct!\r\n&quot;, 0xBu, &amp;NumberOfBytesWritten, 0);</span><br><span class="line">  else</span><br><span class="line">    WriteFile(hFile, &quot;Wrong password\r\n&quot;, 0x11u, &amp;NumberOfBytesWritten, 0);</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>进入第15行</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">_BYTE *__cdecl sub_401260(int a1, unsigned int a2)</span><br><span class="line">&#123;</span><br><span class="line">  unsigned int v3; &#x2F;&#x2F; ST24_4</span><br><span class="line">  int v4; &#x2F;&#x2F; ST2C_4</span><br><span class="line">  int v5; &#x2F;&#x2F; [esp+Ch] [ebp-24h]</span><br><span class="line">  int v6; &#x2F;&#x2F; [esp+10h] [ebp-20h]</span><br><span class="line">  int v7; &#x2F;&#x2F; [esp+14h] [ebp-1Ch]</span><br><span class="line">  int i; &#x2F;&#x2F; [esp+1Ch] [ebp-14h]</span><br><span class="line">  _BYTE *v9; &#x2F;&#x2F; [esp+24h] [ebp-Ch]</span><br><span class="line">  int v10; &#x2F;&#x2F; [esp+28h] [ebp-8h]</span><br><span class="line">  unsigned int v11; &#x2F;&#x2F; [esp+2Ch] [ebp-4h]</span><br><span class="line"></span><br><span class="line">  v9 &#x3D; malloc(4 * ((a2 + 2) &#x2F; 3) + 1);</span><br><span class="line">  if ( !v9 )</span><br><span class="line">    return 0;</span><br><span class="line">  v11 &#x3D; 0;</span><br><span class="line">  v10 &#x3D; 0;</span><br><span class="line">  while ( v11 &lt; a2 )</span><br><span class="line">  &#123;</span><br><span class="line">    if ( v11 &gt;&#x3D; a2 )</span><br><span class="line">      v7 &#x3D; 0;</span><br><span class="line">    else</span><br><span class="line">      v7 &#x3D; *(v11++ + a1);</span><br><span class="line">    if ( v11 &gt;&#x3D; a2 )</span><br><span class="line">      v6 &#x3D; 0;</span><br><span class="line">    else</span><br><span class="line">      v6 &#x3D; *(v11++ + a1);</span><br><span class="line">    if ( v11 &gt;&#x3D; a2 )</span><br><span class="line">      v5 &#x3D; 0;</span><br><span class="line">    else</span><br><span class="line">      v5 &#x3D; *(v11++ + a1);</span><br><span class="line">    v3 &#x3D; v5 + (v7 &lt;&lt; 16) + (v6 &lt;&lt; 8);</span><br><span class="line">    v9[v10] &#x3D; byte_413000[(v3 &gt;&gt; 18) &amp; 0x3F];</span><br><span class="line">    v4 &#x3D; v10 + 1;</span><br><span class="line">    v9[v4++] &#x3D; byte_413000[(v3 &gt;&gt; 12) &amp; 0x3F];</span><br><span class="line">    v9[v4++] &#x3D; byte_413000[(v3 &gt;&gt; 6) &amp; 0x3F];</span><br><span class="line">    v9[v4] &#x3D; byte_413000[v5 &amp; 0x3F];</span><br><span class="line">    v10 &#x3D; v4 + 1;</span><br><span class="line">  &#125;</span><br><span class="line">  for ( i &#x3D; 0; i &lt; dword_413040[a2 % 3]; ++i )</span><br><span class="line">    v9[4 * ((a2 + 2) &#x2F; 3) - i - 1] &#x3D; 61;</span><br><span class="line">  v9[4 * ((a2 + 2) &#x2F; 3)] &#x3D; 0;</span><br><span class="line">  return v9;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>再字符串中有：ZYXABCDEFGHIJKLMNOPQRSTUVWzyxabcdefghijklmnopqrstuvw0123456789+/<br>很明显的base64加密，但密码表变了，根据密码表的变化，将密文转换成正常的base64.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">int i;</span><br><span class="line">char flag[52]&#x3D;&quot;x2dtJEOmyjacxDemx2eczT5cVS9fVUGvWTuZWjuexjRqy24rV29q&quot;;</span><br><span class="line">for(i&#x3D;0;i&lt;52;i++)</span><br><span class="line">&#123;</span><br><span class="line">if ((flag[i]&lt;&#x3D;&#39;W&#39;&amp;&amp;flag[i]&gt;&#x3D;&#39;A&#39;)||(flag[i]&lt;&#x3D;&#39;w&#39;&amp;&amp;flag[i]&gt;&#x3D;&#39;a&#39;))</span><br><span class="line">    flag[i]+&#x3D;3;  </span><br><span class="line">        else if (flag[i] &#x3D;&#x3D; &#39;X&#39;)</span><br><span class="line">         flag[i] &#x3D; &#39;C&#39;;</span><br><span class="line">        else if (flag[i] &#x3D;&#x3D; &#39;Y&#39;)</span><br><span class="line">         flag[i] &#x3D; &#39;B&#39;;</span><br><span class="line">        else if (flag[i] &#x3D;&#x3D; &#39;Z&#39;)</span><br><span class="line">         flag[i] &#x3D; &#39;A&#39;;</span><br><span class="line">        else if (flag[i] &#x3D;&#x3D; &#39;x&#39;)</span><br><span class="line">         flag[i] &#x3D; &#39;c&#39;;</span><br><span class="line">        else if (flag[i] &#x3D;&#x3D; &#39;y&#39;)</span><br><span class="line">         flag[i] &#x3D; &#39;b&#39;;</span><br><span class="line">        else if (flag[i] &#x3D;&#x3D; &#39;z&#39;)</span><br><span class="line">         flag[i] &#x3D; &#39;a&#39;;</span><br><span class="line">        else if (flag[i]&gt;&#x3D;0&amp;&amp;flag[i]&lt;&#x3D;9)</span><br><span class="line">         flag[i] &#x3D; i;</span><br><span class="line">         printf(&quot;%c&quot;,flag[i]);</span><br><span class="line">&#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出base64解码就行。</p><blockquote><p>flag{sh00ting_phish_in_a_barrel@flare-on.com}</p></blockquote><h1 id="Universe-final-answer"><a href="#Universe-final-answer" class="headerlink" title="Universe_final_answer"></a>Universe_final_answer</h1><p>ida64打开<br>进入main函数，然后跳转至本题的关键函数。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">bool __fastcall sub_860(char *a1)</span><br><span class="line">&#123;</span><br><span class="line">  int v1; &#x2F;&#x2F; ecx</span><br><span class="line">  int v2; &#x2F;&#x2F; esi</span><br><span class="line">  int v3; &#x2F;&#x2F; edx</span><br><span class="line">  int v4; &#x2F;&#x2F; er9</span><br><span class="line">  int v5; &#x2F;&#x2F; er11</span><br><span class="line">  int v6; &#x2F;&#x2F; ebp</span><br><span class="line">  int v7; &#x2F;&#x2F; ebx</span><br><span class="line">  int v8; &#x2F;&#x2F; er8</span><br><span class="line">  int v9; &#x2F;&#x2F; er10</span><br><span class="line">  bool result; &#x2F;&#x2F; al</span><br><span class="line">  int v11; &#x2F;&#x2F; [rsp+0h] [rbp-38h]</span><br><span class="line"></span><br><span class="line">  v1 &#x3D; a1[1];</span><br><span class="line">  v2 &#x3D; *a1;</span><br><span class="line">  v3 &#x3D; a1[2];</span><br><span class="line">  v4 &#x3D; a1[3];</span><br><span class="line">  v5 &#x3D; a1[4];</span><br><span class="line">  v6 &#x3D; a1[6];</span><br><span class="line">  v7 &#x3D; a1[5];</span><br><span class="line">  v8 &#x3D; a1[7];</span><br><span class="line">  v9 &#x3D; a1[8];</span><br><span class="line">  result &#x3D; 0;</span><br><span class="line">  if ( -85 * v9 + 58 * v8 + 97 * v6 + v7 + -45 * v5 + 84 * v4 + 95 * v2 - 20 * v1 + 12 * </span><br><span class="line">    v3 &#x3D;&#x3D; 12613 )</span><br><span class="line">  &#123;</span><br><span class="line">    v11 &#x3D; a1[9];</span><br><span class="line">    if ( 30 * v11 + -70 * v9 + -122 * v6 + -81 * v7 + -66 * v5 + -115 * v4 + -41 * v3 + </span><br><span class="line">      -86 * v1 - 15 * v2 - 30 * v8 &#x3D;&#x3D; -54400</span><br><span class="line">      &amp;&amp; -103 * v11 + 120 * v8 + 108 * v7 + 48 * v4 + -89 * v3 + 78 * v1 - 41 * v2 + 31 * </span><br><span class="line">      v5 - (v6 &lt;&lt; 6) - 120 * v9 &#x3D;&#x3D; -10283</span><br><span class="line">      &amp;&amp; 71 * v6 + (v7 &lt;&lt; 7) + 99 * v5 + -111 * v3 + 85 * v1 + 79 * v2 - 30 * v4 - 119 * </span><br><span class="line">      v8 + 48 * v9 - 16 * v11 &#x3D;&#x3D; 22855</span><br><span class="line">      &amp;&amp; 5 * v11 + 23 * v9 + 122 * v8 + -19 * v6 + 99 * v7 + -117 * v5 + -69 * v3 + 22 * </span><br><span class="line">      v1 - 98 * v2 + 10 * v4 &#x3D;&#x3D; -2944</span><br><span class="line">      &amp;&amp; -54 * v11 + -23 * v8 + -82 * v3 + -85 * v2 + 124 * v1 - 11 * v4 - 8 * v5 - 60 * </span><br><span class="line">      v7 + 95 * v6 + 100 * v9 &#x3D;&#x3D; -2222</span><br><span class="line">      &amp;&amp; -83 * v11 + -111 * v7 + -57 * v2 + 41 * v1 + 73 * v3 - 18 * v4 + 26 * v5 + 16 * </span><br><span class="line">      v6 + 77 * v8 - 63 * v9 &#x3D;&#x3D; -13258</span><br><span class="line">      &amp;&amp; 81 * v11 + -48 * v9 + 66 * v8 + -104 * v6 + -121 * v7 + 95 * v5 + 85 * v4 + 60 * </span><br><span class="line">      v3 + -85 * v2 + 80 * v1 &#x3D;&#x3D; -1559</span><br><span class="line">      &amp;&amp; 101 * v11 + -85 * v9 + 7 * v6 + 117 * v7 + -83 * v5 + -101 * v4 + 90 * v3 + -28 * </span><br><span class="line">      v1 + 18 * v2 - v8 &#x3D;&#x3D; 6308 )</span><br><span class="line">    &#123;</span><br><span class="line">      result &#x3D; 99 * v11 + -28 * v9 + 5 * v8 + 93 * v6 + -18 * v7 + -127 * v5 + 6 * v4 + -9 </span><br><span class="line">      * v3 + -93 * v1 + 58 * v2 &#x3D;&#x3D; -1697;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这就是解方程，解出来后v2和v1互换，v7和v6互换。<br>结果：F0uRTy_7w@，输入到程序中得到flag，但我不会。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;F0uRTy_7w@_42&#125;</span><br></pre></td></tr></table></figure><h1 id="basic-re"><a href="#basic-re" class="headerlink" title="basic-re"></a>basic-re</h1><p>ida64打开，字符串里直接看到flag，这种题怎么这么靠后。</p><blockquote><p>flag{str1ngs_1s_y0ur_fr13nd}</p></blockquote><h1 id="hello-world-go"><a href="#hello-world-go" class="headerlink" title="hello_world_go"></a>hello_world_go</h1><p>ida64打开，进入main函数<br><img src="/2021/03/01/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/hello_world_go1.PNG"></p><p><img src="/2021/03/01/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/hello_world_go2.PNG"></p><blockquote><p>flag{hello_world_gogogo}</p></blockquote><h1 id="Cr0ssfun"><a href="#Cr0ssfun" class="headerlink" title="Cr0ssfun"></a>Cr0ssfun</h1><p>ida64打开，转一下字符就是flag。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">a1[10] &#x3D;&#x3D; &#39;p&#39; &amp;&amp; a1[13] &#x3D;&#x3D; &#39;@&#39; &amp;&amp; a1[3] &#x3D;&#x3D; &#39;f&#39; &amp;&amp; a1[26] &#x3D;&#x3D; &#39;r&#39; &amp;&amp; a1[20] &#x3D;&#x3D; &#39;e&#39;</span><br><span class="line">a1[7] &#x3D;&#x3D; &#39;0&#39; &amp;&amp; a1[16] &#x3D;&#x3D; &#39;_&#39; &amp;&amp; a1[11] &#x3D;&#x3D; &#39;p&#39; &amp;&amp; a1[23] &#x3D;&#x3D; &#39;e&#39; &amp;&amp; a1[30] &#x3D;&#x3D; &#39;u&#39;</span><br><span class="line">*a1 &#x3D;&#x3D; &#39;w&#39; &amp;&amp; a1[6] &#x3D;&#x3D; &#39;2&#39; &amp;&amp; a1[22] &#x3D;&#x3D; &#39;s&#39; &amp;&amp; a1[31] &#x3D;&#x3D; &#39;n&#39; &amp;&amp; a1[12] &#x3D;&#x3D; &#39;_&#39;</span><br><span class="line">a1[15] &#x3D;&#x3D; &#39;d&#39; &amp;&amp; a1[8] &#x3D;&#x3D; &#39;&#123;&#39; &amp;&amp; a1[18] &#x3D;&#x3D; &#39;3&#39; &amp;&amp; a1[28] &#x3D;&#x3D; &#39;_&#39; &amp;&amp; a1[21] &#x3D;&#x3D; &#39;r&#39;</span><br><span class="line">a1[2] &#x3D;&#x3D; &#39;t&#39; &amp;&amp; a1[9] &#x3D;&#x3D; &#39;c&#39; &amp;&amp; a1[32] &#x3D;&#x3D; &#39;&#125;&#39; &amp;&amp; a1[19] &#x3D;&#x3D; &#39;v&#39; &amp;&amp; a1[5] &#x3D;&#x3D; &#39;0&#39;</span><br><span class="line">      &amp;&amp; a1[14] &#x3D;&#x3D; &#39;n&#39;</span><br><span class="line">a1[4] &#x3D;&#x3D; &#39;2&#39; &amp;&amp; a1[17] &#x3D;&#x3D; &#39;r&#39; &amp;&amp; a1[29] &#x3D;&#x3D; &#39;f&#39; &amp;&amp; a1[17] &#x3D;&#x3D; &#39;r&#39; &amp;&amp; a1[24] &#x3D;&#x3D; &#39;_&#39;</span><br><span class="line">a1[1] &#x3D;&#x3D; &#39;c&#39; &amp;&amp; a1[25] &#x3D;&#x3D; &#39;@&#39; &amp;&amp; a1[27] &#x3D;&#x3D; &#39;e&#39;</span><br></pre></td></tr></table></figure><p>整理一下顺序就行了。<br>flag{cpp_@nd_r3verse_@re_fun}</p><h1 id="easyre"><a href="#easyre" class="headerlink" title="easyre"></a>easyre</h1><p><a href="https://buuoj.cn/challenges#[ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020]easyre">题目链接</a><br>ida32打开，进入main函数。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">int __cdecl main(int argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  char v4; &#x2F;&#x2F; [esp+12h] [ebp-2Eh]</span><br><span class="line">  char v5; &#x2F;&#x2F; [esp+13h] [ebp-2Dh]</span><br><span class="line">  char v6; &#x2F;&#x2F; [esp+14h] [ebp-2Ch]</span><br><span class="line">  char v7; &#x2F;&#x2F; [esp+15h] [ebp-2Bh]</span><br><span class="line">  char v8; &#x2F;&#x2F; [esp+16h] [ebp-2Ah]</span><br><span class="line">  char v9; &#x2F;&#x2F; [esp+17h] [ebp-29h]</span><br><span class="line">  char v10; &#x2F;&#x2F; [esp+18h] [ebp-28h]</span><br><span class="line">  char v11; &#x2F;&#x2F; [esp+19h] [ebp-27h]</span><br><span class="line">  char v12; &#x2F;&#x2F; [esp+1Ah] [ebp-26h]</span><br><span class="line">  char v13; &#x2F;&#x2F; [esp+1Bh] [ebp-25h]</span><br><span class="line">  char v14; &#x2F;&#x2F; [esp+1Ch] [ebp-24h]</span><br><span class="line">  char v15; &#x2F;&#x2F; [esp+1Dh] [ebp-23h]</span><br><span class="line">  int v16; &#x2F;&#x2F; [esp+1Eh] [ebp-22h]</span><br><span class="line">  int v17; &#x2F;&#x2F; [esp+22h] [ebp-1Eh]</span><br><span class="line">  int v18; &#x2F;&#x2F; [esp+26h] [ebp-1Ah]</span><br><span class="line">  __int16 v19; &#x2F;&#x2F; [esp+2Ah] [ebp-16h]</span><br><span class="line">  char v20; &#x2F;&#x2F; [esp+2Ch] [ebp-14h]</span><br><span class="line">  char v21; &#x2F;&#x2F; [esp+2Dh] [ebp-13h]</span><br><span class="line">  char v22; &#x2F;&#x2F; [esp+2Eh] [ebp-12h]</span><br><span class="line">  int v23; &#x2F;&#x2F; [esp+2Fh] [ebp-11h]</span><br><span class="line">  int v24; &#x2F;&#x2F; [esp+33h] [ebp-Dh]</span><br><span class="line">  int v25; &#x2F;&#x2F; [esp+37h] [ebp-9h]</span><br><span class="line">  char v26; &#x2F;&#x2F; [esp+3Bh] [ebp-5h]</span><br><span class="line">  int i; &#x2F;&#x2F; [esp+3Ch] [ebp-4h]</span><br><span class="line"></span><br><span class="line">  __main();</span><br><span class="line">  v4 &#x3D; &#39;*&#39;;</span><br><span class="line">  v5 &#x3D; &#39;F&#39;;</span><br><span class="line">  v6 &#x3D; &#39;\&#39;&#39;;</span><br><span class="line">  v7 &#x3D; &#39;&quot;&#39;;</span><br><span class="line">  v8 &#x3D; &#39;N&#39;;</span><br><span class="line">  v9 &#x3D; &#39;,&#39;;</span><br><span class="line">  v10 &#x3D; &#39;&quot;&#39;;</span><br><span class="line">  v11 &#x3D; &#39;(&#39;;</span><br><span class="line">  v12 &#x3D; &#39;I&#39;;</span><br><span class="line">  v13 &#x3D; &#39;?&#39;;</span><br><span class="line">  v14 &#x3D; &#39;+&#39;;</span><br><span class="line">  v15 &#x3D; &#39;@&#39;;</span><br><span class="line">  printf(&quot;Please input:&quot;);</span><br><span class="line">  scanf(&quot;%s&quot;, &amp;v19);</span><br><span class="line">  if ( v19 !&#x3D; &#39;A&#39; || HIBYTE(v19) !&#x3D; &#39;C&#39; || v20 !&#x3D; &#39;T&#39; || v21 !&#x3D; &#39;F&#39; || v22 !&#x3D; &#39;&#123;&#39; || v26 </span><br><span class="line">  !&#x3D; &#39;&#125;&#39; )</span><br><span class="line">    return 0;</span><br><span class="line">  v16 &#x3D; v23;</span><br><span class="line">  v17 &#x3D; v24;</span><br><span class="line">  v18 &#x3D; v25;</span><br><span class="line">  for ( i &#x3D; 0; i &lt;&#x3D; 11; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    if ( *(&amp;v4 + i) !&#x3D; _data_start__[*(&amp;v16 + i) - 1] )</span><br><span class="line">      return 0;</span><br><span class="line">  &#125;</span><br><span class="line">  printf(&quot;You are correct!&quot;);</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输入12个字符，这些字符代表的数字，就是_data_start__的下标+1.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">char </span><br><span class="line">  a[96]&#x3D;&#123;0x7E,0x7D,0x7C,0x7B,0x7A,0x79,0x78,0x77,0x76,0x75,0x74,0x73,0x72,0x71,0x70,0x6F,</span><br><span class="line">    0x6E,0x6D,0x6C,0x6B,0x6A,0x69,0x68,0x67,0x66,0x65,0x64,0x63,0x62,0x61,0x60,0x5F,</span><br><span class="line">    0x5E,0x5D,0x5C,0x5B,0x5A,0x59,0x58,0x57,0x56,0x55,0x54,0x53,0x52,0x51,0x50,0x4F,</span><br><span class="line">    0x4E,0x4D,0x4C,0x4B,0x4A,0x49,0x48,0x47,0x46,0x45,0x44,0x43,0x42,0x41,0x40,0x3F,</span><br><span class="line">    0x3E,0x3D,0x3C,0x3B,0x3A,0x39,0x38,0x37,0x36,0x35,0x34,0x33,0x32,0x31,0x30,0x2F,</span><br><span class="line">    0x2E,0x2D,0x2C,0x2B,0x2A,0x29,0x28,0x27,0x26,0x25,0x24,0x23,0x20,0x21,0x22,0x00,&#125;;</span><br><span class="line">int b[12]&#x3D;&#123;42,70,39,34,78,44,34,40,73,63,43,64&#125;;</span><br><span class="line">int i,j;</span><br><span class="line">for(i&#x3D;0;i&lt;12;i++)</span><br><span class="line">&#123;</span><br><span class="line">for(j&#x3D;0;j&lt;96;j++)</span><br><span class="line">&#123;</span><br><span class="line">if(a[j]&#x3D;&#x3D;b[i])</span><br><span class="line">printf(&quot;%c&quot;,j+1);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>flag{U9X_1S_W6@T?}</p></blockquote>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Buuctf——刮开有奖</title>
      <link href="2021/01/19/Buuctf%E2%80%94%E2%80%94%E5%88%AE%E5%BC%80%E6%9C%89%E5%A5%96/"/>
      <url>2021/01/19/Buuctf%E2%80%94%E2%80%94%E5%88%AE%E5%BC%80%E6%9C%89%E5%A5%96/</url>
      
        <content type="html"><![CDATA[<h1 id="Buuctf——刮开有奖"><a href="#Buuctf——刮开有奖" class="headerlink" title="Buuctf——刮开有奖"></a>Buuctf——刮开有奖</h1><a id="more"></a><p><a href="https://buuoj.cn/challenges#%E5%88%AE%E5%BC%80%E6%9C%89%E5%A5%96">题目链接</a><br><a href="https://docs.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-dialogboxparama">DialogBoxParamA函数</a><br><a href="https://docs.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-getdlgitemtexta">GetDlgItemTextA函数</a></p><h2 id="1-查看文件信息"><a href="#1-查看文件信息" class="headerlink" title="1.查看文件信息"></a>1.查看文件信息</h2><p><img src="/2021/01/19/Buuctf%E2%80%94%E2%80%94%E5%88%AE%E5%BC%80%E6%9C%89%E5%A5%96/1.png"></p><h2 id="2-分析伪代码"><a href="#2-分析伪代码" class="headerlink" title="2.分析伪代码"></a>2.分析伪代码</h2><p>32位ida打开，发现WinMain函数，然后查看伪代码。</p><p><img src="/2021/01/19/Buuctf%E2%80%94%E2%80%94%E5%88%AE%E5%BC%80%E6%9C%89%E5%A5%96/2.png"></p><p>进入DialogFunc。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">BOOL __userpurge DialogFunc@&lt;eax&gt;(int a1@&lt;edi&gt;, int a2@&lt;esi&gt;, HWND hDlg, UINT a4, WPARAM </span><br><span class="line">a5, LPARAM a6)</span><br><span class="line">&#123;</span><br><span class="line">  const char *v6; &#x2F;&#x2F; esi</span><br><span class="line">  const char *v7; &#x2F;&#x2F; edi</span><br><span class="line">  int v9; &#x2F;&#x2F; [esp+4h] [ebp-20030h]</span><br><span class="line">  int v10; &#x2F;&#x2F; [esp+8h] [ebp-2002Ch]</span><br><span class="line">  int v11; &#x2F;&#x2F; [esp+Ch] [ebp-20028h]</span><br><span class="line">  int v12; &#x2F;&#x2F; [esp+10h] [ebp-20024h]</span><br><span class="line">  int v13; &#x2F;&#x2F; [esp+14h] [ebp-20020h]</span><br><span class="line">  int v14; &#x2F;&#x2F; [esp+18h] [ebp-2001Ch]</span><br><span class="line">  int v15; &#x2F;&#x2F; [esp+1Ch] [ebp-20018h]</span><br><span class="line">  int v16; &#x2F;&#x2F; [esp+20h] [ebp-20014h]</span><br><span class="line">  int v17; &#x2F;&#x2F; [esp+24h] [ebp-20010h]</span><br><span class="line">  int v18; &#x2F;&#x2F; [esp+28h] [ebp-2000Ch]</span><br><span class="line">  int v19; &#x2F;&#x2F; [esp+2Ch] [ebp-20008h]</span><br><span class="line">  CHAR String; &#x2F;&#x2F; [esp+30h] [ebp-20004h]</span><br><span class="line">  char v21; &#x2F;&#x2F; [esp+31h] [ebp-20003h]</span><br><span class="line">  char v22; &#x2F;&#x2F; [esp+32h] [ebp-20002h]</span><br><span class="line">  char v23; &#x2F;&#x2F; [esp+33h] [ebp-20001h]</span><br><span class="line">  char v24; &#x2F;&#x2F; [esp+34h] [ebp-20000h]</span><br><span class="line">  char v25; &#x2F;&#x2F; [esp+10030h] [ebp-10004h]</span><br><span class="line">  char v26; &#x2F;&#x2F; [esp+10031h] [ebp-10003h]</span><br><span class="line">  char v27; &#x2F;&#x2F; [esp+10032h] [ebp-10002h]</span><br><span class="line">  int v28; &#x2F;&#x2F; [esp+20028h] [ebp-Ch]</span><br><span class="line">  int v29; &#x2F;&#x2F; [esp+2002Ch] [ebp-8h]</span><br><span class="line"></span><br><span class="line">  __alloca_probe();</span><br><span class="line">  if ( a4 &#x3D;&#x3D; 272 )</span><br><span class="line">    return 1;</span><br><span class="line">  v29 &#x3D; a2;</span><br><span class="line">  v28 &#x3D; a1;</span><br><span class="line">  if ( a4 !&#x3D; 273 )</span><br><span class="line">    return 0;</span><br><span class="line">  if ( a5 &#x3D;&#x3D; 1001 )</span><br><span class="line">  &#123;</span><br><span class="line">    memset(&amp;String, 0, 0xFFFFu);</span><br><span class="line">    GetDlgItemTextA(hDlg, 1000, &amp;String, 0xFFFF);</span><br><span class="line">    if ( strlen(&amp;String) &#x3D;&#x3D; 8 )</span><br><span class="line">    &#123;</span><br><span class="line">      v9 &#x3D; 90;</span><br><span class="line">      v10 &#x3D; 74;</span><br><span class="line">      v11 &#x3D; 83;</span><br><span class="line">      v12 &#x3D; 69;</span><br><span class="line">      v13 &#x3D; 67;</span><br><span class="line">      v14 &#x3D; 97;</span><br><span class="line">      v15 &#x3D; 78;</span><br><span class="line">      v16 &#x3D; 72;</span><br><span class="line">      v17 &#x3D; 51;</span><br><span class="line">      v18 &#x3D; 110;</span><br><span class="line">      v19 &#x3D; 103;</span><br><span class="line">      sub_4010F0(&amp;v9, 0, 10);</span><br><span class="line">      memset(&amp;v25, 0, 0xFFFFu);</span><br><span class="line">      v6 &#x3D; sub_401000(&amp;v25, strlen(&amp;v25));</span><br><span class="line">      memset(&amp;v25, 0, 0xFFFFu);</span><br><span class="line">      v26 &#x3D; v23;</span><br><span class="line">      v25 &#x3D; v22;</span><br><span class="line">      v27 &#x3D; v24;</span><br><span class="line">      v7 &#x3D; sub_401000(&amp;v25, strlen(&amp;v25));</span><br><span class="line">      if ( String &#x3D;&#x3D; v9 + 34</span><br><span class="line">        &amp;&amp; v21 &#x3D;&#x3D; v13</span><br><span class="line">        &amp;&amp; 4 * v22 - 141 &#x3D;&#x3D; 3 * v11</span><br><span class="line">        &amp;&amp; v23 &#x2F; 4 &#x3D;&#x3D; 2 * (v16 &#x2F; 9)</span><br><span class="line">        &amp;&amp; !strcmp(v6, &quot;ak1w&quot;)</span><br><span class="line">        &amp;&amp; !strcmp(v7, &quot;V1Ax&quot;) )</span><br><span class="line">      &#123;</span><br><span class="line">        MessageBoxA(hDlg, &quot;U g3t 1T!&quot;, &quot;@_@&quot;, 0);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">  &#125;</span><br><span class="line">  if ( a5 !&#x3D; 1 &amp;&amp; a5 !&#x3D; 2 )</span><br><span class="line">    return 0;</span><br><span class="line">  EndDialog(hDlg, a5);</span><br><span class="line">  return 1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>函数sub_4010F0(&amp;v9, 0, 10)伪代码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">int __cdecl sub_4010F0(int a1, int a2, int a3)</span><br><span class="line">&#123;</span><br><span class="line">  int result; &#x2F;&#x2F; eax</span><br><span class="line">  int i; &#x2F;&#x2F; esi</span><br><span class="line">  int v5; &#x2F;&#x2F; ecx</span><br><span class="line">  int v6; &#x2F;&#x2F; edx</span><br><span class="line"></span><br><span class="line">  result &#x3D; a3;</span><br><span class="line">  for ( i &#x3D; a2; i &lt;&#x3D; a3; a2 &#x3D; i )</span><br><span class="line">  &#123;</span><br><span class="line">    v5 &#x3D; 4 * i;</span><br><span class="line">    v6 &#x3D; *(4 * i + a1);</span><br><span class="line">    if ( a2 &lt; result &amp;&amp; i &lt; result )</span><br><span class="line">    &#123;</span><br><span class="line">      do</span><br><span class="line">      &#123;</span><br><span class="line">        if ( v6 &gt; *(a1 + 4 * result) )</span><br><span class="line">        &#123;</span><br><span class="line">          if ( i &gt;&#x3D; result )</span><br><span class="line">            break;</span><br><span class="line">          ++i;</span><br><span class="line">          *(v5 + a1) &#x3D; *(a1 + 4 * result);</span><br><span class="line">          if ( i &gt;&#x3D; result )</span><br><span class="line">            break;</span><br><span class="line">          while ( *(a1 + 4 * i) &lt;&#x3D; v6 )</span><br><span class="line">          &#123;</span><br><span class="line">            if ( ++i &gt;&#x3D; result )</span><br><span class="line">              goto LABEL_13;</span><br><span class="line">          &#125;</span><br><span class="line">          if ( i &gt;&#x3D; result )</span><br><span class="line">            break;</span><br><span class="line">          v5 &#x3D; 4 * i;</span><br><span class="line">          *(a1 + 4 * result) &#x3D; *(4 * i + a1);</span><br><span class="line">        &#125;</span><br><span class="line">        --result;</span><br><span class="line">      &#125;</span><br><span class="line">      while ( i &lt; result );</span><br><span class="line">    &#125;</span><br><span class="line">LABEL_13:</span><br><span class="line">    *(a1 + 4 * result) &#x3D; v6;</span><br><span class="line">    sub_4010F0(a1, a2, i - 1);</span><br><span class="line">    result &#x3D; a3;</span><br><span class="line">    ++i;</span><br><span class="line">  &#125;</span><br><span class="line">  return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这里是将v9-v19进行变化，得到新的v9-v19，以下为脚本。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int __cdecl sub_4010F0(char *a1, int a2, int a3);</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    char v9[11] &#x3D; &#123;90,74,83,69,67,97,78,72,51,110,103&#125;;</span><br><span class="line">    sub_4010F0(v9, 0, 10);</span><br><span class="line">    for (int j&#x3D;0;j&lt;11;j++)</span><br><span class="line">        printf(&quot;%c&quot;,v9[j]);</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br><span class="line">int __cdecl sub_4010F0(char *a1, int a2, int a3)</span><br><span class="line">&#123;</span><br><span class="line">    int result;</span><br><span class="line">    int i;</span><br><span class="line">    int v5;</span><br><span class="line">    int v6;</span><br><span class="line">    result &#x3D; a3;</span><br><span class="line">    for ( i &#x3D; a2; i &lt;&#x3D; a3; a2 &#x3D; i )</span><br><span class="line">    &#123;</span><br><span class="line">        v5 &#x3D; i;</span><br><span class="line">        v6 &#x3D; a1[i];</span><br><span class="line">        if ( a2 &lt; result &amp;&amp; i &lt; result )</span><br><span class="line">        &#123;</span><br><span class="line">            do</span><br><span class="line">            &#123;</span><br><span class="line">                if ( v6 &gt; a1[result] )</span><br><span class="line">                &#123;</span><br><span class="line">                    if ( i &gt;&#x3D; result )</span><br><span class="line">                        break;</span><br><span class="line">                    ++i;</span><br><span class="line">                    a1[v5] &#x3D; a1[result];</span><br><span class="line">                    if ( i &gt;&#x3D; result )</span><br><span class="line">                        break;</span><br><span class="line">                    while ( a1[i] &lt;&#x3D; v6 )</span><br><span class="line">                    &#123;</span><br><span class="line">                        if ( ++i &gt;&#x3D; result )</span><br><span class="line">                        goto LABEL_13;</span><br><span class="line">                    &#125;</span><br><span class="line">                    if ( i &gt;&#x3D; result )</span><br><span class="line">                        break;</span><br><span class="line">                    v5 &#x3D; i;</span><br><span class="line">                    a1[result] &#x3D; a1[i];</span><br><span class="line">                &#125;</span><br><span class="line">                --result;</span><br><span class="line">            &#125;</span><br><span class="line">            while ( i &lt; result );</span><br><span class="line">        &#125;</span><br><span class="line">    LABEL_13:</span><br><span class="line">        a1[result] &#x3D; v6;</span><br><span class="line">        sub_4010F0(a1, a2, i - 1);</span><br><span class="line">        result &#x3D; a3;</span><br><span class="line">        ++i;</span><br><span class="line">  &#125;</span><br><span class="line">  return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2021/01/19/Buuctf%E2%80%94%E2%80%94%E5%88%AE%E5%BC%80%E6%9C%89%E5%A5%96/3.png"></p><p>接着查看函数sub_401000</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">BOOL __userpurge DialogFunc@&lt;eax&gt;(int a1@&lt;edi&gt;, int a2@&lt;esi&gt;, HWND hDlg, UINT a4, WPARAM a5, LPARAM a6)</span><br><span class="line">&#123;</span><br><span class="line">  const char *v6; &#x2F;&#x2F; esi</span><br><span class="line">  const char *v7; &#x2F;&#x2F; edi</span><br><span class="line">  int v9; &#x2F;&#x2F; [esp+4h] [ebp-20030h]</span><br><span class="line">  int v10; &#x2F;&#x2F; [esp+8h] [ebp-2002Ch]</span><br><span class="line">  int v11; &#x2F;&#x2F; [esp+Ch] [ebp-20028h]</span><br><span class="line">  int v12; &#x2F;&#x2F; [esp+10h] [ebp-20024h]</span><br><span class="line">  int v13; &#x2F;&#x2F; [esp+14h] [ebp-20020h]</span><br><span class="line">  int v14; &#x2F;&#x2F; [esp+18h] [ebp-2001Ch]</span><br><span class="line">  int v15; &#x2F;&#x2F; [esp+1Ch] [ebp-20018h]</span><br><span class="line">  int v16; &#x2F;&#x2F; [esp+20h] [ebp-20014h]</span><br><span class="line">  int v17; &#x2F;&#x2F; [esp+24h] [ebp-20010h]</span><br><span class="line">  int v18; &#x2F;&#x2F; [esp+28h] [ebp-2000Ch]</span><br><span class="line">  int v19; &#x2F;&#x2F; [esp+2Ch] [ebp-20008h]</span><br><span class="line">  CHAR String; &#x2F;&#x2F; [esp+30h] [ebp-20004h]</span><br><span class="line">  char v21; &#x2F;&#x2F; [esp+31h] [ebp-20003h]</span><br><span class="line">  char v22; &#x2F;&#x2F; [esp+32h] [ebp-20002h]</span><br><span class="line">  char v23; &#x2F;&#x2F; [esp+33h] [ebp-20001h]</span><br><span class="line">  char v24; &#x2F;&#x2F; [esp+34h] [ebp-20000h]</span><br><span class="line">  char v25; &#x2F;&#x2F; [esp+10030h] [ebp-10004h]</span><br><span class="line">  char v26; &#x2F;&#x2F; [esp+10031h] [ebp-10003h]</span><br><span class="line">  char v27; &#x2F;&#x2F; [esp+10032h] [ebp-10002h]</span><br><span class="line">  int v28; &#x2F;&#x2F; [esp+20028h] [ebp-Ch]</span><br><span class="line">  int v29; &#x2F;&#x2F; [esp+2002Ch] [ebp-8h]</span><br><span class="line"></span><br><span class="line">  __alloca_probe();</span><br><span class="line">  if ( a4 &#x3D;&#x3D; 272 )</span><br><span class="line">    return 1;</span><br><span class="line">  v29 &#x3D; a2;</span><br><span class="line">  v28 &#x3D; a1;</span><br><span class="line">  if ( a4 !&#x3D; 273 )</span><br><span class="line">    return 0;</span><br><span class="line">  if ( a5 &#x3D;&#x3D; 1001 )</span><br><span class="line">  &#123;</span><br><span class="line">    memset(&amp;String, 0, 0xFFFFu);</span><br><span class="line">    GetDlgItemTextA(hDlg, 1000, &amp;String, 0xFFFF);</span><br><span class="line">    if ( strlen(&amp;String) &#x3D;&#x3D; 8 )</span><br><span class="line">    &#123;</span><br><span class="line">      v9 &#x3D; 90;</span><br><span class="line">      v10 &#x3D; 74;</span><br><span class="line">      v11 &#x3D; 83;</span><br><span class="line">      v12 &#x3D; 69;</span><br><span class="line">      v13 &#x3D; 67;</span><br><span class="line">      v14 &#x3D; 97;</span><br><span class="line">      v15 &#x3D; 78;</span><br><span class="line">      v16 &#x3D; 72;</span><br><span class="line">      v17 &#x3D; 51;</span><br><span class="line">      v18 &#x3D; 110;</span><br><span class="line">      v19 &#x3D; 103;</span><br><span class="line">      sub_4010F0(&amp;v9, 0, 10);</span><br><span class="line">      memset(&amp;v25, 0, 0xFFFFu);</span><br><span class="line">      v6 &#x3D; sub_401000(&amp;v25, strlen(&amp;v25));</span><br><span class="line">      memset(&amp;v25, 0, 0xFFFFu);</span><br><span class="line">      v26 &#x3D; v23;</span><br><span class="line">      v25 &#x3D; v22;</span><br><span class="line">      v27 &#x3D; v24;</span><br><span class="line">      v7 &#x3D; sub_401000(&amp;v25, strlen(&amp;v25));</span><br><span class="line">      if ( String &#x3D;&#x3D; v9 + 34</span><br><span class="line">        &amp;&amp; v21 &#x3D;&#x3D; v13</span><br><span class="line">        &amp;&amp; 4 * v22 - 141 &#x3D;&#x3D; 3 * v11</span><br><span class="line">        &amp;&amp; v23 &#x2F; 4 &#x3D;&#x3D; 2 * (v16 &#x2F; 9)</span><br><span class="line">        &amp;&amp; !strcmp(v6, &quot;ak1w&quot;)</span><br><span class="line">        &amp;&amp; !strcmp(v7, &quot;V1Ax&quot;) )</span><br><span class="line">      &#123;</span><br><span class="line">        MessageBoxA(hDlg, &quot;U g3t 1T!&quot;, &quot;@_@&quot;, 0);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">  &#125;</span><br><span class="line">  if ( a5 !&#x3D; 1 &amp;&amp; a5 !&#x3D; 2 )</span><br><span class="line">    return 0;</span><br><span class="line">  EndDialog(hDlg, a5);</span><br><span class="line">  return 1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2021/01/19/Buuctf%E2%80%94%E2%80%94%E5%88%AE%E5%BC%80%E6%9C%89%E5%A5%96/4.png"></p><p>我们可以猜测这里应该是base64加密。</p><h2 id="3-得出flag"><a href="#3-得出flag" class="headerlink" title="3.得出flag"></a>3.得出flag</h2><p><img src="/2021/01/19/Buuctf%E2%80%94%E2%80%94%E5%88%AE%E5%BC%80%E6%9C%89%E5%A5%96/8.png"></p><p>string是一个8位的数组，再结合最开始的定义：</p><p><img src="/2021/01/19/Buuctf%E2%80%94%E2%80%94%E5%88%AE%E5%BC%80%E6%9C%89%E5%A5%96/5.png"></p><p><img src="/2021/01/19/Buuctf%E2%80%94%E2%80%94%E5%88%AE%E5%BC%80%E6%9C%89%E5%A5%96/6.png"></p><p><img src="/2021/01/19/Buuctf%E2%80%94%E2%80%94%E5%88%AE%E5%BC%80%E6%9C%89%E5%A5%96/7.png"></p><p>而且v22-v24压入了同一处，v25-v27压入了同一处。<br>之后将”ak1w”和”V1Ax”进行base64解密。前三个为ak1w的，后三个为V1Ax的。</p><p><img src="/2021/01/19/Buuctf%E2%80%94%E2%80%94%E5%88%AE%E5%BC%80%E6%9C%89%E5%A5%96/9.png"></p><p>将这些字符拼接再一起就是flag。<br>由于v7是经v22、v23、v24得来的，所WP1先输入，jMp后输入。</p><p><img src="/2021/01/19/Buuctf%E2%80%94%E2%80%94%E5%88%AE%E5%BC%80%E6%9C%89%E5%A5%96/10.png"></p><p>flag{UJWP1jMp}</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="2021/01/19/hello-world/"/>
      <url>2021/01/19/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><a id="more"></a><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>寒假第一周</title>
      <link href="2021/01/16/%E5%AF%92%E5%81%87%E7%AC%AC%E4%B8%80%E5%91%A8/"/>
      <url>2021/01/16/%E5%AF%92%E5%81%87%E7%AC%AC%E4%B8%80%E5%91%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="SimpleRev"><a href="#SimpleRev" class="headerlink" title="SimpleRev"></a>SimpleRev</h1><a id="more"></a><p><a href="https://buuoj.cn/challenges#SimpleRev">题目链接</a><br>查看文件信息</p><p><img src="/2021/01/16/%E5%AF%92%E5%81%87%E7%AC%AC%E4%B8%80%E5%91%A8/SimpleRev_1.png"></p><p><img src="/2021/01/16/%E5%AF%92%E5%81%87%E7%AC%AC%E4%B8%80%E5%91%A8/SimpleRev_2.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">unsigned __int64 Decry()</span><br><span class="line">&#123;</span><br><span class="line">  char v1; &#x2F;&#x2F; [rsp+Fh] [rbp-51h]</span><br><span class="line">  int v2; &#x2F;&#x2F; [rsp+10h] [rbp-50h]</span><br><span class="line">  int v3; &#x2F;&#x2F; [rsp+14h] [rbp-4Ch]</span><br><span class="line">  int i; &#x2F;&#x2F; [rsp+18h] [rbp-48h]</span><br><span class="line">  int v5; &#x2F;&#x2F; [rsp+1Ch] [rbp-44h]</span><br><span class="line">  char src[8]; &#x2F;&#x2F; [rsp+20h] [rbp-40h]</span><br><span class="line">  __int64 v7; &#x2F;&#x2F; [rsp+28h] [rbp-38h]</span><br><span class="line">  int v8; &#x2F;&#x2F; [rsp+30h] [rbp-30h]</span><br><span class="line">  __int64 v9; &#x2F;&#x2F; [rsp+40h] [rbp-20h]</span><br><span class="line">  __int64 v10; &#x2F;&#x2F; [rsp+48h] [rbp-18h]</span><br><span class="line">  int v11; &#x2F;&#x2F; [rsp+50h] [rbp-10h]</span><br><span class="line">  unsigned __int64 v12; &#x2F;&#x2F; [rsp+58h] [rbp-8h]</span><br><span class="line"></span><br><span class="line">  v12 &#x3D; __readfsqword(0x28u);</span><br><span class="line">  *(_QWORD *)src &#x3D; &#39;SLCDN&#39;;</span><br><span class="line">  v7 &#x3D; 0LL;</span><br><span class="line">  v8 &#x3D; 0;</span><br><span class="line">  v9 &#x3D; &#39;wodah&#39;;</span><br><span class="line">  v10 &#x3D; 0LL;</span><br><span class="line">  v11 &#x3D; 0;</span><br><span class="line">  text &#x3D; (char *)join(key3, &amp;v9);               &#x2F;&#x2F; text&#x3D;killshadow</span><br><span class="line">  strcpy(key, key1);                            &#x2F;&#x2F; key&#x3D;ADSFKDNCLS</span><br><span class="line">  strcat(key, src);</span><br><span class="line">  v2 &#x3D; 0;</span><br><span class="line">  v3 &#x3D; 0;</span><br><span class="line">  getchar();</span><br><span class="line">  v5 &#x3D; strlen(key);</span><br><span class="line">  for ( i &#x3D; 0; i &lt; v5; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    if ( key[v3 % v5] &gt; 64 &amp;&amp; key[v3 % v5] &lt;&#x3D; 90 )&#x2F;&#x2F; 大写变小写</span><br><span class="line">      key[i] &#x3D; key[v3 % v5] + 32;</span><br><span class="line">    ++v3;</span><br><span class="line">  &#125;</span><br><span class="line">  printf(&quot;Please input your flag:&quot;, src);</span><br><span class="line">  while ( 1 )</span><br><span class="line">  &#123;</span><br><span class="line">    v1 &#x3D; getchar();</span><br><span class="line">    if ( v1 &#x3D;&#x3D; 10 )</span><br><span class="line">      break;</span><br><span class="line">    if ( v1 &#x3D;&#x3D; 32 )</span><br><span class="line">    &#123;</span><br><span class="line">      ++v2;</span><br><span class="line">    &#125;</span><br><span class="line">    else</span><br><span class="line">    &#123;</span><br><span class="line">      if ( v1 &lt;&#x3D; 96 || v1 &gt; 122 )</span><br><span class="line">      &#123;</span><br><span class="line">        if ( v1 &gt; 64 &amp;&amp; v1 &lt;&#x3D; 90 )</span><br><span class="line">          str2[v2] &#x3D; (v1 - 39 - key[v3++ % v5] + 97) % 26 + 97;</span><br><span class="line">      &#125;</span><br><span class="line">      else</span><br><span class="line">      &#123;</span><br><span class="line">        str2[v2] &#x3D; (v1 - 39 - key[v3++ % v5] + 97) % 26 + 97;</span><br><span class="line">      &#125;</span><br><span class="line">      if ( !(v3 % v5) )</span><br><span class="line">        putchar(32);</span><br><span class="line">      ++v2;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  if ( !strcmp(text, str2) )</span><br><span class="line">    puts(&quot;Congratulation!\n&quot;);</span><br><span class="line">  else</span><br><span class="line">    puts(&quot;Try again!\n&quot;);</span><br><span class="line">  return __readfsqword(0x28u) ^ v12;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个伪代码就是将key由大写变为小写，即key = “ADSFKNDCLS”。<br>然后输入v1，我们对v1进行运算得到str2，将str2与text比较相同就正确。这里v1就是flag，我们知道str2，所以对v1进行逆运算，以下为脚本。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    char text[]&#x3D;&quot;killshadow&quot;;</span><br><span class="line">    char key[]&#x3D;&quot;adsfkndcls&quot;;</span><br><span class="line">    int v5 &#x3D; strlen(key),i,j,v3&#x3D;0;</span><br><span class="line">    char flag[v5];</span><br><span class="line">    for ( i &#x3D; 0; i &lt; v5; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">        if ( key[v3 % v5] &gt; 64 &amp;&amp; key[v3 % v5] &lt;&#x3D; 90 )</span><br><span class="line">            key[i] &#x3D; key[v3 % v5] + 32;</span><br><span class="line">        ++v3;</span><br><span class="line">    &#125;</span><br><span class="line">    for(i&#x3D;0;i&lt;v5;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        for(j&#x3D;0;j&lt;5;j++)</span><br><span class="line">        &#123;</span><br><span class="line">            flag[i] &#x3D; text[i] - 97 + 26*j + 39 -97 + key[i];</span><br><span class="line">            if(flag[i] &gt;&#x3D; 65 &amp;&amp; flag[i] &lt;&#x3D; 90)</span><br><span class="line">                printf(&quot;%c&quot;,flag[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2021/01/16/%E5%AF%92%E5%81%87%E7%AC%AC%E4%B8%80%E5%91%A8/SimpleRev_3.png"></p><p>最后在外面套上falg。</p><h1 id="xor"><a href="#xor" class="headerlink" title="xor"></a>xor</h1><p><a href="https://buuoj.cn/challenges#xor">题目链接</a><br>查看文件信息</p><p><img src="/2021/01/16/%E5%AF%92%E5%81%87%E7%AC%AC%E4%B8%80%E5%91%A8/xor_1.png"></p><p>ida查看main函数伪代码</p><p><img src="/2021/01/16/%E5%AF%92%E5%81%87%E7%AC%AC%E4%B8%80%E5%91%A8/xor_2.png"></p><p>意思就是输入33个字符，后一位与前一位进行异或运算，异或后的结果与global比较，相同则成功。我们对global进行逆运算，得出的即是flag。两次异或会还原，所以异或的逆运算还是异或。<br>下面为脚本。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    char v6[33];</span><br><span class="line">    char global[33]&#x3D;&#123;&#39;f&#39;,0xA,&#39;k&#39;,0xC,&#39;w&#39;,&#39;&amp;&#39;,&#39;O&#39;,&#39;.&#39;,&#39;@&#39;,0x11,&#39;x&#39;,0x0D,&#39;Z&#39;,&#39;;&#39;,&#39;U&#39;,0x11,&#39;p&#39;</span><br><span class="line">    ,0x19,&#39;F&#39;,0x1F,&#39;v&#39;,&#39;&quot;&#39;,&#39;M&#39;,&#39;#&#39;,&#39;D&#39;,0x0E,&#39;g&#39;,6,&#39;h&#39;,0x0F,&#39;G&#39;,&#39;2&#39;,&#39;O&#39;&#125;;</span><br><span class="line">    int i;</span><br><span class="line">    for ( i &#x3D; 1; i &lt; 33; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">        v6[i] &#x3D;global[i] ^ global[i - 1];</span><br><span class="line">        printf(&quot;%c&quot;,v6[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2021/01/16/%E5%AF%92%E5%81%87%E7%AC%AC%E4%B8%80%E5%91%A8/xor_4.png"></p><p>第一位f是不运算的，抄上就行了。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>第二周学习与做题记录</title>
      <link href="2020/12/05/%E7%AC%AC%E4%BA%8C%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/"/>
      <url>2020/12/05/%E7%AC%AC%E4%BA%8C%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<h1 id="学习记录"><a href="#学习记录" class="headerlink" title="学习记录"></a>学习记录</h1><a id="more"></a><ol><li>学习了while、for、do while循环</li><li>学习了&gt;、&gt;=、!=、==、+=等运算符</li></ol><h1 id="Write-up"><a href="#Write-up" class="headerlink" title="Write_up"></a>Write_up</h1><h2 id="easyre"><a href="#easyre" class="headerlink" title="easyre"></a>easyre</h2><p><a href="https://buuoj.cn/challenges#easyre">题目链接</a><br>查看文件信息</p><p><img src="/2020/12/05/%E7%AC%AC%E4%BA%8C%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/easyre_1.PNG"></p><p>IDA打开搜索字符串即找到flag</p><p><img src="/2020/12/05/%E7%AC%AC%E4%BA%8C%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/easyre_2.PNG"></p><h2 id="reverse1"><a href="#reverse1" class="headerlink" title="reverse1"></a>reverse1</h2><p><a href="https://buuoj.cn/challenges#reverse1">题目链接</a><br>查看文件信息</p><p><img src="/2020/12/05/%E7%AC%AC%E4%BA%8C%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/reverse1_1.PNG"></p><p>IDA打开查看字符串</p><p><img src="/2020/12/05/%E7%AC%AC%E4%BA%8C%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/reverse1_2.PNG"></p><p>由 this is the right flag 转到主要函数</p><p><img src="/2020/12/05/%E7%AC%AC%E4%BA%8C%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/reverse1_4.PNG"></p><p><img src="/2020/12/05/%E7%AC%AC%E4%BA%8C%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/reverse1_3.PNG"></p><p>flag为{hell0_w0rld}</p><h2 id="reverse3"><a href="#reverse3" class="headerlink" title="reverse3"></a>reverse3</h2><p><a href="https://buuoj.cn/challenges#reverse3">题目链接</a><br>查看文件信息</p><p><img src="/2020/12/05/%E7%AC%AC%E4%BA%8C%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/reverse3_1.PNG"></p><p>ida32打开查看main函数</p><p><img src="/2020/12/05/%E7%AC%AC%E4%BA%8C%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/reverse3_2.PNG"></p><p>sub_4110BE经过跳转为下方函数</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">void *__cdecl sub_411AB0(char *a1, unsigned int a2, int *a3)</span><br><span class="line">&#123;</span><br><span class="line">  int v4; &#x2F;&#x2F; STE0_4</span><br><span class="line">  int v5; &#x2F;&#x2F; STE0_4</span><br><span class="line">  int v6; &#x2F;&#x2F; STE0_4</span><br><span class="line">  int v7; &#x2F;&#x2F; [esp+D4h] [ebp-38h]</span><br><span class="line">  signed int i; &#x2F;&#x2F; [esp+E0h] [ebp-2Ch]</span><br><span class="line">  unsigned int v9; &#x2F;&#x2F; [esp+ECh] [ebp-20h]</span><br><span class="line">  int v10; &#x2F;&#x2F; [esp+ECh] [ebp-20h]</span><br><span class="line">  signed int v11; &#x2F;&#x2F; [esp+ECh] [ebp-20h]</span><br><span class="line">  void *Dst; &#x2F;&#x2F; [esp+F8h] [ebp-14h]</span><br><span class="line">  char *v13; &#x2F;&#x2F; [esp+104h] [ebp-8h]</span><br><span class="line"></span><br><span class="line">  if ( !a1 || !a2 )</span><br><span class="line">    return 0;</span><br><span class="line">  v9 &#x3D; a2 &#x2F; 3;</span><br><span class="line">  if ( (signed int)(a2 &#x2F; 3) % 3 )</span><br><span class="line">    ++v9;</span><br><span class="line">  v10 &#x3D; 4 * v9;</span><br><span class="line">  *a3 &#x3D; v10;</span><br><span class="line">  Dst &#x3D; malloc(v10 + 1);</span><br><span class="line">  if ( !Dst )</span><br><span class="line">    return 0;</span><br><span class="line">  j_memset(Dst, 0, v10 + 1);</span><br><span class="line">  v13 &#x3D; a1;</span><br><span class="line">  v11 &#x3D; a2;</span><br><span class="line">  v7 &#x3D; 0;</span><br><span class="line">  while ( v11 &gt; 0 )</span><br><span class="line">  &#123;</span><br><span class="line">    byte_41A144[2] &#x3D; 0;</span><br><span class="line">    byte_41A144[1] &#x3D; 0;</span><br><span class="line">    byte_41A144[0] &#x3D; 0;</span><br><span class="line">    for ( i &#x3D; 0; i &lt; 3 &amp;&amp; v11 &gt;&#x3D; 1; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      byte_41A144[i] &#x3D; *v13;</span><br><span class="line">      --v11;</span><br><span class="line">      ++v13;</span><br><span class="line">    &#125;</span><br><span class="line">    if ( !i )</span><br><span class="line">      break;</span><br><span class="line">    switch ( i )</span><br><span class="line">    &#123;</span><br><span class="line">      case 1:</span><br><span class="line">        *((_BYTE *)Dst + v7) &#x3D; aAbcdefghijklmn[(signed int)(unsigned __int8)byte_41A144[0] &gt;&gt; 2];</span><br><span class="line">        v4 &#x3D; v7 + 1;</span><br><span class="line">        *((_BYTE *)Dst + v4++) &#x3D; aAbcdefghijklmn[((byte_41A144[1] &amp; 0xF0) &gt;&gt; 4) | </span><br><span class="line">         16 * (byte_41A144[0] &amp; 3)];</span><br><span class="line">        *((_BYTE *)Dst + v4++) &#x3D; aAbcdefghijklmn[64];</span><br><span class="line">        *((_BYTE *)Dst + v4) &#x3D; aAbcdefghijklmn[64];</span><br><span class="line">        v7 &#x3D; v4 + 1;</span><br><span class="line">        break;</span><br><span class="line">      case 2:</span><br><span class="line">        *((_BYTE *)Dst + v7) &#x3D; aAbcdefghijklmn[(signed int)(unsigned __int8)byte_41A144[0] &gt;&gt; 2];</span><br><span class="line">        v5 &#x3D; v7 + 1;</span><br><span class="line">        *((_BYTE *)Dst + v5++) &#x3D; aAbcdefghijklmn[((byte_41A144[1] &amp; 0xF0) &gt;&gt; 4) |</span><br><span class="line">        16 * (byte_41A144[0] &amp; 3)];</span><br><span class="line">        *((_BYTE *)Dst + v5++) &#x3D; aAbcdefghijklmn[((byte_41A144[2] &amp; 0xC0) &gt;&gt; 6) |</span><br><span class="line">        4 * (byte_41A144[1] &amp; 0xF)];</span><br><span class="line">        *((_BYTE *)Dst + v5) &#x3D; aAbcdefghijklmn[64];</span><br><span class="line">        v7 &#x3D; v5 + 1;</span><br><span class="line">        break;</span><br><span class="line">      case 3:</span><br><span class="line">        *((_BYTE *)Dst + v7) &#x3D; aAbcdefghijklmn[(signed int)(unsigned __int8)byte_41A144[0] &gt;&gt; 2];</span><br><span class="line">        v6 &#x3D; v7 + 1;</span><br><span class="line">        *((_BYTE *)Dst + v6++) &#x3D; aAbcdefghijklmn[((byte_41A144[1] &amp; 0xF0) &gt;&gt; 4) |</span><br><span class="line">        16 * (byte_41A144[0] &amp; 3)];</span><br><span class="line">        *((_BYTE *)Dst + v6++) &#x3D; aAbcdefghijklmn[((byte_41A144[2] &amp; 0xC0) &gt;&gt; 6) |</span><br><span class="line">        4 * (byte_41A144[1] &amp; 0xF)];</span><br><span class="line">        *((_BYTE *)Dst + v6) &#x3D; aAbcdefghijklmn[byte_41A144[2] &amp; 0x3F];</span><br><span class="line">        v7 &#x3D; v6 + 1;</span><br><span class="line">        break;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  *((_BYTE *)Dst + v7) &#x3D; 0;</span><br><span class="line">  return Dst;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2020/12/05/%E7%AC%AC%E4%BA%8C%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/reverse3_3.PNG"></p><p>应该是将str进行base64加密</p><p><img src="/2020/12/05/%E7%AC%AC%E4%BA%8C%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/reverse3_4.PNG"></p><p>将整个程序还原一下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">int main(void)</span><br><span class="line">&#123;</span><br><span class="line">char Dest[100] &#x3D; &#123;0&#125;;</span><br><span class="line">char Str2[] &#x3D; &quot;e3nifIH9b_C@n@dH&quot;;</span><br><span class="line">int i, v8;</span><br><span class="line">v8 &#x3D; strlen(Str2);</span><br><span class="line">for ( i &#x3D; 0; i &lt; v8; i++ )</span><br><span class="line">&#123;</span><br><span class="line">Dest[i] &#x3D; Str2[i] - i;</span><br><span class="line">printf(&quot;%c&quot;, Dest[i]);</span><br><span class="line">&#125;</span><br><span class="line">return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出为e2lfbDB2ZV95b3V9<br>base64解码为{i_l0ve_you}</p><h2 id="GKCTF2020-Check-1n"><a href="#GKCTF2020-Check-1n" class="headerlink" title="[GKCTF2020]Check_1n"></a>[GKCTF2020]Check_1n</h2><p><a href="https://buuoj.cn/challenges#reverse3">题目链接</a><br>查看文件信息</p><p><img src="/2020/12/05/%E7%AC%AC%E4%BA%8C%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/%5BGKCTF2020%5DCheck_1n_1.PNG"></p><p>打开程序提示输入密码，随意输个提示密码错误<br>在ida中搜索’密码错误’</p><p><img src="/2020/12/05/%E7%AC%AC%E4%BA%8C%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/%5BGKCTF2020%5DCheck_1n_2.PNG"></p><p>跳转至指定函数，找到’密码错误’所在位置</p><p><img src="/2020/12/05/%E7%AC%AC%E4%BA%8C%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/%5BGKCTF2020%5DCheck_1n_3.PNG"></p><p><img src="/2020/12/05/%E7%AC%AC%E4%BA%8C%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/%5BGKCTF2020%5DCheck_1n_4.PNG"></p><p>密码为HelloWorld</p><p><img src="/2020/12/05/%E7%AC%AC%E4%BA%8C%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/%5BGKCTF2020%5DCheck_1n_5.PNG"></p><p>选中flag，base64解码</p><p><img src="/2020/12/05/%E7%AC%AC%E4%BA%8C%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/%5BGKCTF2020%5DCheck_1n_6.PNG"></p><p>根据提示打开’打砖块’, flag自动出现</p><p><img src="/2020/12/05/%E7%AC%AC%E4%BA%8C%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/%5BGKCTF2020%5DCheck_1n_7.PNG"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>补充</title>
      <link href="2020/11/29/%E8%A1%A5%E5%85%85/"/>
      <url>2020/11/29/%E8%A1%A5%E5%85%85/</url>
      
        <content type="html"><![CDATA[<h1 id="背景正在优化中。"><a href="#背景正在优化中。" class="headerlink" title="背景正在优化中。"></a>背景正在优化中。</h1><a id="more"></a><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">default_cover: </span><br><span class="line">    - &#x2F;img&#x2F;1.jpg</span><br><span class="line">    - &#x2F;img&#x2F;2.jpg</span><br><span class="line">    - &#x2F;img&#x2F;3.jpg</span><br><span class="line">    - &#x2F;img&#x2F;4.png</span><br><span class="line">    - &#x2F;img&#x2F;5.jpg</span><br><span class="line">    - &#x2F;img&#x2F;6.jpg</span><br><span class="line">    - &#x2F;img&#x2F;7.png</span><br><span class="line">    - &#x2F;img&#x2F;8.png</span><br><span class="line">    - &#x2F;img&#x2F;9.png</span><br><span class="line">    - &#x2F;img&#x2F;10.png</span><br><span class="line">    - &#x2F;img&#x2F;11.png</span><br><span class="line">    - &#x2F;img&#x2F;12.png</span><br><span class="line">    - &#x2F;img&#x2F;13.png</span><br><span class="line">    - &#x2F;img&#x2F;14.png</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>编程练习</title>
      <link href="2020/11/29/%E8%8F%9C%E9%B8%A1%E7%9A%84%E7%BC%96%E7%A8%8B%E7%BB%83%E4%B9%A0/"/>
      <url>2020/11/29/%E8%8F%9C%E9%B8%A1%E7%9A%84%E7%BC%96%E7%A8%8B%E7%BB%83%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<h1 id="C语言篇"><a href="#C语言篇" class="headerlink" title="C语言篇"></a>C语言篇</h1><a id="more"></a><h2 id="计算1-2-3-…-n"><a href="#计算1-2-3-…-n" class="headerlink" title="计算1+2+3+…+n"></a>计算1+2+3+…+n</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt; &#x2F;&#x2F;计算1+2+3+...+n </span><br><span class="line"> int main(void)</span><br><span class="line"> &#123;</span><br><span class="line">int a, b, c, d;</span><br><span class="line">b &#x3D; 0;</span><br><span class="line">c &#x3D; 0;</span><br><span class="line">printf(&quot;请输入1开始程序\n&quot;);</span><br><span class="line">while(scanf(&quot;%d&quot;, &amp;d) &#x3D;&#x3D; 1)</span><br><span class="line">&#123;</span><br><span class="line">printf(&quot;请输入n（为数字），输出结果为：1+2+3+...+n\n&quot;);</span><br><span class="line">    scanf(&quot;%d&quot;, &amp;a);</span><br><span class="line">    while (b &lt;&#x3D; a)</span><br><span class="line">        &#123;</span><br><span class="line">         c &#x3D; b + c;</span><br><span class="line">         b++; </span><br><span class="line">        &#125;</span><br><span class="line">    printf(&quot;1+2+3+...+n &#x3D; %d\n&quot;, c);</span><br><span class="line">    printf(&quot;请输入q离开程序，或者输入1再次开始程序计算令一个1+2+3+...+n\n&quot;);</span><br><span class="line">    b &#x3D; 0;</span><br><span class="line">    c &#x3D; 0;</span><br><span class="line">    &#125;</span><br><span class="line">return 0;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><h2 id="计算n！"><a href="#计算n！" class="headerlink" title="计算n！"></a>计算n！</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt; &#x2F;&#x2F;计算n！ (不精确且最大为170)</span><br><span class="line">int main(void)</span><br><span class="line">&#123;</span><br><span class="line">int a, b, d;</span><br><span class="line">double c;</span><br><span class="line">b &#x3D; 1;</span><br><span class="line">c &#x3D; 1;</span><br><span class="line">printf(&quot;请输入1开始程序\n&quot;);</span><br><span class="line">while(scanf(&quot;%d&quot;, &amp;d) &#x3D;&#x3D; 1)</span><br><span class="line">&#123;</span><br><span class="line">printf(&quot;请输入n（为数字），输出结果为n！：\n&quot;);</span><br><span class="line">    scanf(&quot;%d&quot;, &amp;a);</span><br><span class="line">    while (b &lt;&#x3D; a)</span><br><span class="line">        &#123;</span><br><span class="line">        c &#x3D; b * c;</span><br><span class="line">        b++; </span><br><span class="line">        &#125;</span><br><span class="line">    printf(&quot;n! &#x3D; %e\n&quot;, c);</span><br><span class="line">    printf(&quot;请输入q离开程序，或者输入1再次开始程序计算令一个数的阶乘\n&quot;);</span><br><span class="line">    b &#x3D; 1;</span><br><span class="line">    c &#x3D; 1;</span><br><span class="line">    &#125;</span><br><span class="line">return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>第一周学习与做题记录</title>
      <link href="2020/11/28/%E7%AC%AC%E4%B8%80%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/"/>
      <url>2020/11/28/%E7%AC%AC%E4%B8%80%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<h1 id="学习记录"><a href="#学习记录" class="headerlink" title="学习记录"></a>学习记录</h1><a id="more"></a><h2 id="C语言篇"><a href="#C语言篇" class="headerlink" title="C语言篇"></a>C语言篇</h2><ol><li>学习了——strlen()函数</li><li>学习了关键字——const</li><li>学习了字符串</li><li>如何创建、储存字符串</li><li>如何用strlen()函数获取字符串长度</li><li>用C预处理器指令#define和ANSCI的const修饰创建符号常量</li></ol><h2 id="x86汇编篇"><a href="#x86汇编篇" class="headerlink" title="x86汇编篇"></a>x86汇编篇</h2><h3 id="常用x86汇编指令："><a href="#常用x86汇编指令：" class="headerlink" title="常用x86汇编指令："></a>常用x86汇编指令：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">MOV MOV EAX,ECX(将ECX的值存入EAX)</span><br><span class="line">ADD ADD EAX,ECX EAX+&#x3D;ECX(将EAX加上ECX的值)</span><br><span class="line">SUB SUB EAX,ECX EAX-&#x3D;ECX(将EAX减去ECX的值)</span><br><span class="line">INC INC EAX EAX++ (将EAX的值加1)</span><br><span class="line">DEC DEC EAX EAX-- (将EAX的值减1)</span><br><span class="line">LEA LEA EAX,[ECX+4] (将ECX+4的值存入EAX)</span><br><span class="line">CMP CMP EAX ECX if(EAX&#x3D;&#x3D;ECX) ZF&#x3D;1 else ZF&#x3D;0 (将两个值比较并根据结果设置0标志位ZF)</span><br><span class="line">TEST TEST EAX EAX if(eax&#x3D;&#x3D;0) ZF&#x3D;1 else ZF&#x3D;0 (将值与0比较并根据结果设置0标志位ZF)</span><br><span class="line">JE(JZ) JE 04001000 if(ZF&#x3D;&#x3D;1) GOTO 04001000 (若ZF为1，则跳转道04001000)</span><br><span class="line">JNE(JNZ) JNE 04001000 if(ZF&#x3D;&#x3D;0) GOTO 04001000 (若ZF为0，则跳转道04001000)</span><br><span class="line">JMP JMP 04001000 GOTO 04001000 (无条件跳转道04001000)</span><br><span class="line">CALL CALL IstrcmpW (调用IstrcmpW)</span><br><span class="line">PUSH PUSH 00000001 (将00000001入栈)</span><br><span class="line">POP POP EAX (出栈并将获取的值存入EAX)</span><br></pre></td></tr></table></figure><h1 id="Write-up"><a href="#Write-up" class="headerlink" title="Write_up"></a>Write_up</h1><h2 id="insanity"><a href="#insanity" class="headerlink" title="insanity"></a>insanity</h2><p><a href="https://adworld.xctf.org.cn/task/answer?type=reverse&number=4&grade=0&id=5079&page=1">题目链接</a><br>搜索字符串直接获取flag</p><p><img src="/2020/11/28/%E7%AC%AC%E4%B8%80%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/insanity.PNG"></p><h2 id="re1"><a href="#re1" class="headerlink" title="re1"></a>re1</h2><p><a href="https://adworld.xctf.org.cn/task/answer?type=reverse&number=4&grade=0&id=5073&page=1">题目链接</a><br>ida打开，观察main函数伪代码</p><p><img src="/2020/11/28/%E7%AC%AC%E4%B8%80%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/re1_1.png"></p><p>然后在16进制试图搜索flag</p><p><img src="/2020/11/28/%E7%AC%AC%E4%B8%80%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/re1_2.png"></p><p>双击转到</p><p><img src="/2020/11/28/%E7%AC%AC%E4%B8%80%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/re1_3.png"></p><h2 id="game"><a href="#game" class="headerlink" title="game"></a>game</h2><p><a href="https://adworld.xctf.org.cn/task/answer?type=reverse&number=4&grade=0&id=5074&page=1">题目链接</a><br>ida打开，查看main函数伪代码，在结尾跳转多次，发现</p><p><img src="/2020/11/28/%E7%AC%AC%E4%B8%80%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/game_1.png"></p><p>还有一堆数字，以及一个for循环。</p><p><img src="/2020/11/28/%E7%AC%AC%E4%B8%80%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/game_2.png"></p><p>此for循环运行结果即为flag。</p><p>还原一下程序：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main(void)</span><br><span class="line">&#123;</span><br><span class="line">    int a[56] &#x3D; &#123;18,64,98,5,2,4,6,3,6,48,49,65,32,12,48,65,31,78,62,32,49,32,1,57,96,3,21,9,4,</span><br><span class="line">        62,3,5,4,1,2,3,44,65,78,32,16,97,54,16,44,52,32,64,89,45,32,65,15,34,18,16,0&#125;;</span><br><span class="line">    int b[56] &#x3D; &#123;123,32,18,98,119,108,65,41,124,80,125,38,124,111,74,49,83,108,94,108,84,6,</span><br><span class="line">        96,83,44,121,104,110,32,95,117,101,99,123,127,119,96,48,107,71,92,29,81,107,</span><br><span class="line">        90,85,64,12,43,76,86,13,114,1,117,126,0&#125;;</span><br><span class="line">    int i &#x3D; 1;</span><br><span class="line">    while(i&lt;&#x3D;56)</span><br><span class="line">        &#123;</span><br><span class="line">        a[i] ^&#x3D; b[i];</span><br><span class="line">            a[i] ^&#x3D; 19;</span><br><span class="line">            printf(&quot;%c&quot;, a[i]);</span><br><span class="line">            i++;</span><br><span class="line">        &#125;</span><br><span class="line"> return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出结果即为flag。</p><h2 id="Hello-CTF"><a href="#Hello-CTF" class="headerlink" title="Hello, CTF"></a>Hello, CTF</h2><p><a href="https://adworld.xctf.org.cn/task/answer?type=reverse&number=4&grade=0&id=5075&page=1">题目链接</a><br>查看main函数伪代码：</p><p><img src="/2020/11/28/%E7%AC%AC%E4%B8%80%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/Hello,CTF_1.png"></p><p>‘v13’16进制转字符串。</p><p><img src="/2020/11/28/%E7%AC%AC%E4%B8%80%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/Hello,CTF_2.png"></p><h2 id="open-source"><a href="#open-source" class="headerlink" title="open-source"></a>open-source</h2><p><a href="https://adworld.xctf.org.cn/task/answer?type=reverse&number=4&grade=0&id=5076&page=1">题目链接</a><br>此题文件可直接放入编译器中打开。</p><p><img src="/2020/11/28/%E7%AC%AC%E4%B8%80%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/open-source.png"></p><p>直接计算：51966*31337+8*11+7-1615810207=12648430<br>转16进制：c0ffee</p><h2 id="simple-unpack"><a href="#simple-unpack" class="headerlink" title="simple-unpack"></a>simple-unpack</h2><p><a href="https://adworld.xctf.org.cn/task/answer?type=reverse&number=4&grade=0&id=5077&page=1">题目链接</a><br>查看文件</p><p><img src="/2020/11/28/%E7%AC%AC%E4%B8%80%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/simple-unpack_2.png"></p><p>软件去壳，再用ida打开</p><p><img src="/2020/11/28/%E7%AC%AC%E4%B8%80%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/simple-unpack_4.png"></p><h2 id="logmein"><a href="#logmein" class="headerlink" title="logmein"></a>logmein</h2><p><a href="https://adworld.xctf.org.cn/task/answer?type=reverse&number=4&grade=0&id=5078&page=1">题目链接</a><br>ida打开，查看main函数伪代码：</p><p><img src="/2020/11/28/%E7%AC%AC%E4%B8%80%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/logmein_1.png"></p><p>还原程序：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">#define _BYTE unsigned char</span><br><span class="line">int main(void)</span><br><span class="line">&#123;</span><br><span class="line">char v8[18] &#x3D; &quot;:\&quot;AL_RT^L*.?+6&#x2F;46&quot;;</span><br><span class="line">long long int v7 &#x3D; 28537194573619560;</span><br><span class="line">int v6 &#x3D; 7;</span><br><span class="line">char s[18] &#x3D; &quot; &quot;;</span><br><span class="line">int i;</span><br><span class="line">for(i &#x3D; 0; i &lt; strlen(v8); ++i)</span><br><span class="line">&#123;</span><br><span class="line">s[i] &#x3D; (char)(*((_BYTE *)&amp;v7 + i % v6) ^ v8[i]);</span><br><span class="line">&#125;</span><br><span class="line">printf(&quot;%s&quot;, s);</span><br><span class="line">return 0; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出结果即为flag。</p><h2 id="getit"><a href="#getit" class="headerlink" title="getit"></a>getit</h2><p><a href="https://adworld.xctf.org.cn/task/answer?type=reverse&number=4&grade=0&id=5082&page=1">题目链接</a><br>ida打开，查看main函数伪代码：</p><p><img src="/2020/11/28/%E7%AC%AC%E4%B8%80%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/getit_1.png"></p><p><img src="/2020/11/28/%E7%AC%AC%E4%B8%80%E5%91%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/getit_2.png"></p><p>还原程序：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">int main(void)</span><br><span class="line">&#123;</span><br><span class="line">int v5 &#x3D; 0;</span><br><span class="line">int v3;</span><br><span class="line">char s[100] &#x3D; &quot;c61b68366edeb7bdce3c6820314b7498&quot;;</span><br><span class="line">char t[100] &#x3D; &quot;SharifCTF&#123;????????????????????????????????&#125;&quot;;</span><br><span class="line">while ( v5 &lt; strlen(s) )</span><br><span class="line">            &#123;</span><br><span class="line">                if ( v5 &amp; 1 )</span><br><span class="line">                 v3 &#x3D; 1;</span><br><span class="line">                else</span><br><span class="line">                 v3 &#x3D; -1;</span><br><span class="line">                *(t + v5 + 10) &#x3D; s[v5] + v3;</span><br><span class="line">                v5 &#x3D; v5 + 1;</span><br><span class="line">            &#125;</span><br><span class="line">    printf(&quot;%s&quot;, t);</span><br><span class="line">return 0; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出结果即为flag。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Markdown基本语法</title>
      <link href="2020/11/20/Markdown%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95/"/>
      <url>2020/11/20/Markdown%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<h1 id="一、标题"><a href="#一、标题" class="headerlink" title="一、标题"></a>一、标题</h1><a id="more"></a><p>在想要设置为标题的文字前面加#来表示<br>一个#是一级标题，二个#是二级标题，以此类推。支持六级标题。</p><p>示例(实际应用中去掉前方\或丨)：<br>\1. # 这是一级标题<br>\2. ## 这是二级标题<br>\3. ### 这是三级标题<br>\4. #### 这是四级标题<br>\4. ##### 这是五级标题<br>\6. ###### 这是六级标题<br>效果：</p><h1 id="这是一级标题"><a href="#这是一级标题" class="headerlink" title="这是一级标题"></a>这是一级标题</h1><h2 id="这是二级标题"><a href="#这是二级标题" class="headerlink" title="这是二级标题"></a>这是二级标题</h2><h3 id="这是三级标题"><a href="#这是三级标题" class="headerlink" title="这是三级标题"></a>这是三级标题</h3><h4 id="这是四级标题"><a href="#这是四级标题" class="headerlink" title="这是四级标题"></a>这是四级标题</h4><h5 id="这是五级标题"><a href="#这是五级标题" class="headerlink" title="这是五级标题"></a>这是五级标题</h5><h6 id="这是六级标题"><a href="#这是六级标题" class="headerlink" title="这是六级标题"></a>这是六级标题</h6><h1 id="二、字体"><a href="#二、字体" class="headerlink" title="二、字体"></a>二、字体</h1><p> 要加粗的文字左右分别用两个”<em>“号包起来<br> 要倾斜的文字左右分别用一个”</em>“号包起来<br> 要倾斜和加粗的文字左右分别用三个”<em>“号包起来<br> 要加删除线的文字左右分别用两个”~~”号包起来<br>示例：<br>\1. <strong>这是加粗的文字</strong><br>\2. <em>这是倾斜的文字</em><br>\3. **</em>这是斜体加粗的文字***<br>\4. <del>这是加删除线的文字</del></p><p>效果：<br><strong>这是加粗的文字</strong><br><em>这是倾斜的文字</em><br>**<em>这是斜体加粗的文字**</em><br><del>这是加删除线的文字</del></p><h1 id="三、引用"><a href="#三、引用" class="headerlink" title="三、引用"></a>三、引用</h1><p>在引用的文字前加&gt;即可。引用也可以嵌套，如加两个&gt;&gt;三个&gt;&gt;&gt;<br>n个…<br>示例：<br>\1. &gt;这是引用的内容<br>\2. &gt;&gt;这是引用的内容<br>\3. &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;这是引用的内容</p><p>效果：</p><blockquote><p>这是引用的内容</p><blockquote><p>这是引用的内容</p><blockquote><blockquote><blockquote><blockquote><blockquote><blockquote><blockquote><blockquote><p>这是引用的内容</p></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote><h1 id="四、分割线"><a href="#四、分割线" class="headerlink" title="四、分割线"></a>四、分割线</h1><p>三个或者三个以上的 - 或者 * 都可以。<br>示例：<br>\1. —<br>\2. —-<br>\3. <strong>*<br>\4. ***</strong></p><h2 id="效果："><a href="#效果：" class="headerlink" title="效果："></a>效果：</h2><hr><hr><hr><blockquote><p>持续更新中</p></blockquote><p><a href="https://www.jianshu.com/p/191d1e21f7ed/">文章内容来源</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>前n项和</title>
      <link href="2020/11/19/%E5%89%8Dn%E9%A1%B9%E5%92%8C/"/>
      <url>2020/11/19/%E5%89%8Dn%E9%A1%B9%E5%92%8C/</url>
      
        <content type="html"><![CDATA[<h1 id="计算前n项和（C语言）"><a href="#计算前n项和（C语言）" class="headerlink" title="计算前n项和（C语言）"></a>计算前n项和（C语言）</h1><a id="more"></a><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt; &#x2F;&#x2F;计算1+2+3+...+n </span><br><span class="line">int main(void)</span><br><span class="line">&#123;</span><br><span class="line">int a, b, c, d;</span><br><span class="line">b &#x3D; 0;</span><br><span class="line">c &#x3D; 0;</span><br><span class="line">printf(&quot;请输入1开始程序\n&quot;);</span><br><span class="line">while(scanf(&quot;%d&quot;, &amp;d) &#x3D;&#x3D; 1)</span><br><span class="line">&#123;</span><br><span class="line">printf(&quot;请输入n（为数字），输出结果为：1+2+3+...+n\n&quot;);</span><br><span class="line">    scanf(&quot;%d&quot;, &amp;a);</span><br><span class="line">    while (b &lt;&#x3D; a)</span><br><span class="line">        &#123;</span><br><span class="line">         c &#x3D; b + c;</span><br><span class="line">         b++; </span><br><span class="line">        &#125;</span><br><span class="line">    printf(&quot;1+2+3+...+n &#x3D; %d\n&quot;, c);</span><br><span class="line">    printf(&quot;请输入q离开程序，或者输入1再次开始程序计算令一个1+2+3+...+n\n&quot;);</span><br><span class="line">    b &#x3D; 0;</span><br><span class="line">    c &#x3D; 0;</span><br><span class="line">   &#125;</span><br><span class="line">return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>因本人能力限制，不会其他的函数，所以此代码比较复杂。</p></blockquote><hr><h2 id="推荐一本C语言入门书籍"><a href="#推荐一本C语言入门书籍" class="headerlink" title="推荐一本C语言入门书籍"></a>推荐一本C语言入门书籍</h2><p><img src="https://img1.doubanio.com/view/subject/l/public/s29438897.jpg" alt="C Primer Plus"><br><a href="https://item.jd.com/12627795.html">购买C Primer Plus（京东）</a></p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
